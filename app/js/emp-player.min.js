/**
 * @license
 * EMP-Player 2.1.103-344 
 * Copyright Ericsson, Inc. <https://www.ericsson.com/>
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.empPlayer=t()}(this,function(){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function c(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t,i){return(s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&o(n,i.prototype),n}).apply(null,arguments)}function t(e){var r="function"==typeof Map?new Map:void 0;return(t=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,i)}function i(){return s(e,arguments,n(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),o(i,e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var d="undefined"!=typeof window?window:void 0!==a?a:"undefined"!=typeof self?self:{},p=d.videojs,x=new function(){this.ENDED="ended",this.ERROR="error",this.LOADED_DATA="loadeddata",this.TIMESHIFT_CHANGE="timeshiftchange",this.DURATION_CHANGE="durationchange",this.LOADED_METADATA="loadedmetadata",this.SEEKING="seeking",this.TIME_UPDATE="timeupdate",this.USER_ACTIVE="useractive",this.USERIN_ACTIVE="userinactive",this.VOLUME_CHANGE="volumechange",this.LOAD_START="loadstart",this.CAN_PLAY="canplay",this.PLAYING="playing",this.WAITING="waiting",this.SEEKED="seeked",this.ABORT="abort",this.PLAY="play",this.PAUSE="pause",this.DISPOSE="dispose",this.MODE_CHANGE="modechange",this.CHANGE="change",this.ADD_TRACK="addtrack",this.REMOVE_TRACK="removetrack",this.METRIC_CHANGED="metricchanged",this.RECOVERABLE_ASSET_ERROR="recoverableasseterror",this.BITRATE_CHANGED="bitratechanged",this.CLOSE="close",this.READY="ready",this.RESIZE="resize",this.TAP="tap",this.CLICK="click",this.FOCUS="focus",this.BLUR="blur",this.BEFORE_MODAL_OPEN="beforemodalopen",this.MODAL_OPEN="modalopen",this.BEFORE_MODAL_CLOSE="beforemodalclose",this.MODAL_CLOSE="modalclose",this.BEFORE_MODAL_FILL="beforemodalfill",this.MODAL_FILL="modalfill",this.BEFORE_MODAL_EMPTY="beforemodalempty",this.MODAL_EMPTY="modalempty",this.CAN_PLAY_THROUGH="canplaythrough",this.FIRST_PLAY="firstplay",this.PROGRESS="progress",this.SUSPEND="suspend",this.EMPTIED="emptied",this.STALLED="stalled",this.RATE_CHANGE="ratechange",this.TEXT_TRACK_CHANGE="texttrackchange",this.TRACK_CHANGE="trackchanged",this.POSTER_CHANGE="posterchange",this.KEY_DOWN="keydown",this.KEY_UP="keyup",this.MOUSE_DOWN="mousedown",this.MOUSE_MOVE="mousemove",this.MOUSE_UP="mouseup",this.TOUCH_START="touchstart",this.TOUCH_MOVE="touchmove",this.TOUCH_END="touchend",this.TOUCH_LEAVE="touchleave",this.TOUCH_CANCEL="touchcancel",this.FULLSCREEN_CHANGE="fullscreenchange",this.ENTER_FULL_WINDOW="enterFullWindow",this.EXIT_FULL_WINDOW="exitFullWindow",this.CONTROLS_ENABLED="controlsenabled",this.CONTROLS_DISABLED="controlsdisabled",this.USING_NATIVE_CONTROLS="usingnativecontrols",this.USING_CUSTOM_CONTROLS="usingcustomcontrols",this.SLIDER_ACTIVE="slideractive",this.SLIDER_INACTIVE="sliderinactive",this.ENTITLEMENT_CHANGE="entitlementchange",this.ENTITLEMENT_LOAD_START="entitlementloadstart",this.PLAYER_CREATED="playercreated",this.RESTARTING="restarting",this.AD_TIMELINE_CHANGED="adtimelinechanged",this.CHROMECAST_CASTING="chromecastcasting",this.CHROMECAST_STOPPED="chromecaststopped",this.STOPPED="stopped",this.READY_TO_PLAY="readytoplay",this.PROGRAM_CHANGED="programchanged",this.ASSET_CHANGED="assetchanged",this.SEGMENT_MISSING="segmentmissing",this.AIRPLAY_START="airplayStart",this.REPLAY="replay",this.DOWNLOAD_PROGRESS="downloadprogress",this.DRM_SESSION_UPDATE="drmsessionupdate"},m=function(e){return y(e)?Object.keys(e):[]};function f(t,i){m(t).forEach(function(e){return i(t[e],e)})}function g(i){for(var e=arguments.length,t=new Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Object.assign?Object.assign.apply(Object,[i].concat(t)):(t.forEach(function(e){e&&f(e,function(e,t){i[t]=e})}),i)}function y(e){return!!e&&"object"==typeof e}function v(r,n){var o={};return Object.keys(r).forEach(function(e){var t=r[e],i=n[e]||e;o[i]=t}),o}function T(e){return"string"==typeof e||!!e&&"object"==typeof e&&"[object String]"===Object.prototype.toString.call(e)}function O(t){var i={assetId:void 0,programId:void 0,channelId:void 0};try{i=JSON.parse(t)}catch(e){i.assetId=t}return i}function _(e,t){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function E(e){return new RegExp(/^.*\//).exec(e)[0]}var D={UNKNOWN:100,LOAD_ASSET:101,ENTITLEMENT:102,ENTITLEMENT2:103,SHAKA_TECH:200,HLS_TECH:300,CHROMECAST_TECH:500,HLS_MSE_TECH:1e4,DASHIF_TECH:2e4},k=function(n){function o(e,t,i){var r;return void 0===t&&(t=D.UNKNOWN),void 0===i&&(i=null),(r=n.call(this)||this).code=t,T(e)?r.message=e:e.message&&(r.message=e.message),r.status=i,Error.captureStackTrace&&Error.captureStackTrace(u(r),o),r}return c(o,n),l(o,[{key:"codes",get:function(){return D}}]),o}(t(Error)),b=!1,S=function(){b&&A(null,arguments)};d.EMP_DEBUG_LOG&&(S=d.console&&d.console.log&&console.log.bind(console)||function(){});var L=S;if(L.history=[],L.error=function(){A("error",arguments)},L.warn=function(){A("warn",arguments)},L.debug=function(){A("debug",arguments)},d.EMP_DEBUG_LOG){var C=function(){};L.debug=d.console&&d.console.debug&&console.debug.bind(console)||C,L.warn=d.WARN=d.console&&d.console.warn&&console.warn.bind(console)||C,L.error=d.ERROR=d.console&&d.console.error&&console.error.bind(console)||C}function A(e,t){var i=Array.prototype.slice.call(t),r=function(){},n=d.console||{log:r,warn:r,error:r,trace:r};e?i.unshift(e.toUpperCase()+":"):e="log",i.unshift("EMPPlayer:"),n[e].apply?n[e].apply(n,i):n[e](i.join(" "))}L.setLogToBrowserConsole=function(e){void 0===e&&(e=!1),b=e};var I=1;var w=function(e,t,i){t.guid||(t.guid=I++);var r=function(){return t.apply(e,arguments)};return r.guid=i?i+"_"+t.guid:t.guid,r},P=function(t,i){var r=Date.now();return function(){var e=Date.now();i<=e-r&&(t.apply(void 0,arguments),r=e)}},R=p.getComponent("MenuItem"),N=p.getComponent("Component"),M=function(n){function e(e,t){var i,r=t.bitrate;return t.label=0===r?"auto":Math.max(0,Math.round(r/1e3))+" kbps",t.selected=0===r,(i=n.call(this,e,t)||this).bitrate=r,i.player_.on(x.BITRATE_CHANGED,function(e,t){i.el()&&(0===i.bitrate?i.selected(t.auto):i.selected(!t.auto&&t.bitrate===i.bitrate))}),i}return c(e,n),e.prototype.handleClick=function(e){this.player_.bitrate(this.bitrate)},e}(R);N.registerComponent("BitrateMenuItem",M);var B=p.getComponent("MenuButton"),U=p.getComponent("Component"),F=function(n){function e(e,t){var i;(i=n.call(this,e,t)||this).el_.setAttribute("aria-label","Bitrate menu"),i.hide();var r=w(u(i),i.update);return i.player_.on(x.LOADED_DATA,r),i.player_.on(x.CHROMECAST_CASTING,r),i.player_.on(x.ENDED,function(){return i.hide()}),i.player_.on(x.PLAYING,function(){i.items&&1<i.items.length&&"EmpHLS"!==i.player_.techName_&&i.show()}),i.player_.on(x.DISPOSE,function(){this.player_.on(x.LOADED_DATA,r)}),i}c(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-bitrate-button "+n.prototype.buildCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]);var t=this.player_.bitrates();if(!t||1===t.length||"EmpHLS"===this.player_.techName_)return this.hide(),e;0<t.length&&e.push(new M(this.player_,{selectable:!0,bitrate:0}));for(var i=0;i<t.length;i++){var r=t[i];e.push(new M(this.player_,{selectable:!0,bitrate:r}))}return this.show(),e},e}(B);F.prototype.controlText_="Bitrate",U.registerComponent("BitrateButton",F);var H,j=void 0!==a?a:"undefined"!=typeof window?window:{};"undefined"!=typeof document?H=document:(H=j["__GLOBAL_DOCUMENT_CACHE@4"])||(H=j["__GLOBAL_DOCUMENT_CACHE@4"]={});var G=H;var V=function(e){for(var t="",i=0;i<arguments.length;i++)t+=e[i].replace(/\n\r?\s*/g,"")+(arguments[i+1]||"");return t};function $(e,t){if(!e||!t)return"";if("function"!=typeof d.getComputedStyle)return e.currentStyle[t]||"";var i=d.getComputedStyle(e);return i?i[t]:""}function W(){var e,t,i=(e=["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],t||(t=e.slice(0)),e.raw=t,e);return W=function(){return i},i}function q(){return G===d.document&&void 0!==G.createElement}function K(e,n,t,i){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===t&&(t={});var r,o,s=G.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t,i,r=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(L.warn(V(W(),e,r)),s.setAttribute(e,r)):"textContent"===e?(i=r,void 0===(t=s).textContent?t.innerText=i:t.textContent=i):s[e]=r}),Object.getOwnPropertyNames(t).forEach(function(e){s.setAttribute(e,t[e])}),i&&(r=s,(o=i,"function"==typeof o&&(o=o()),(Array.isArray(o)?o:[o]).map(function(e){return"function"==typeof e&&(e=e()),y(i=e)&&1===i.nodeType||y(t=e)&&3===t.nodeType?e:"string"==typeof e&&/\S/.test(e)?G.createTextNode(e):void 0;var t,i}).filter(function(e){return e})).forEach(function(e){return r.appendChild(e)})),s}var Y={bitrates:function(e){return e.tech_&&void 0!==e.tech_.bitrates?e.techGet_("bitrates"):[]},bitrate:function(e,t){return e.tech_&&void 0!==e.tech_.bitrate?(void 0!==t&&e.techCall_("bitrate",t),e.techGet_("bitrate")):0},canRestart:function(e){return!e.tech_||void 0===e.tech_.canRestart||e.techGet_("canRestart")},restart:function(e,t,i){e.currentSource()&&(e.options_.startTime=0,e.options_.absoluteStartTime=void 0,e.previousAbsoluteStartTime=void 0,e.options_.autoplay||(e.options_.autoplay=!0,e.one("play",function(){e.options_.autoplay=!1})),e.trigger(x.RESTARTING),e.options_.useLastViewedOffset=i?(e.options_.absoluteStartTime=i,!1):t,e.trigger(x.REPLAY))},getSelectedAudioTrack:function(e){for(var t=e.audioTracks(),i=t.length;i--;){var r=t[i];if(r.enabled)return r.language}return null},getSelectedTextTrack:function(e){for(var t=e.textTracks(),i=t.length;i--;){var r=t[i];if("showing"===r.mode)return r.language}return null},loadAsset:function(e,t,i,r,n){void 0===n&&(n=function(){});var o={assetId:t,programId:i,channelId:r};e.one(x.LOADED_DATA,function(){n(e.entitlement)}),e.startResetAndReloadTimer_&&e.startResetAndReloadTimer_(),e.src({type:"video/emp",src:JSON.stringify(o)})},currentAsset:function(e,t,i,r){if(!t&&!i&&!r){var n=e.cache_.source;return n&&n.src&&"video/emp"===n.type?O(n.src):n&&n.assetId?{assetId:n.assetId,programId:n.programId,channelId:n.channelId}:null}if(L("Update currentAsset",t,i,r),e.cache_.source&&"video/emp"===e.cache_.source.type)e.cache_.source.src=JSON.stringify({assetId:t,programId:i,channelId:r});else if(e.cache_.source&&e.cache_.source.assetId)e.cache_.source.assetId=t,e.cache_.source.programId=i,e.cache_.source.channelId=r;else{var o={assetId:t,programId:i,channelId:r};e.cache_.source={type:"video/emp",src:JSON.stringify(o)}}e.cache_.sources=[e.cache_.source]},getAbsoluteTime:function(e){if(!e.tech_||void 0===e.tech_.getAbsoluteTime)return new Date(0);var t=this.getServerTime(e),i=e.tech_.getAbsoluteTime(t);if("EmpCast"!==e.techName_){var r=this.getEntitlement(e);i&&r&&r.isStaticCachupAsLive?i=new Date(i.getTime()+r.streamInfo.start.getTime()):r&&r.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=new Date(1e3*e.tech_.baseCurrentTime()+r.streamInfo.start.getTime()))}return i&&i.getTime?i:new Date(0)},getPlayheadTime:function(e){var t=this.getAbsoluteTime(e);return t?t.getTime():0},timeBehindLive:function(e){if(!e.tech_||void 0===e.tech_.timeBehindLive)return 0;var t=0,i=this.getServerTime(e),r=this.getEntitlement(e);return(t=r&&r.isStaticCachupAsLive?(i-this.getPlayheadTime(e))/1e3:e.tech_.timeBehindLive(i))!==1/0&&t?Math.round(t):0},liveDelay:function(e){var t=0;return this.isLive(e)&&(t=e.tech_&&void 0!==e.tech_.liveDelay?e.tech_.liveDelay():(this.getServerTime(e)-this.getSeekTimerange(e).end)/1e3),Math.round(t)},stop:function(e,t){e.stopProgramService&&e.stopProgramService(),e.sourceChanging_=!1,e.cache_.sources=[],e.tech_&&void 0!==e.tech_.stop?(e.techCall_("stop",t),e.techCall_("stopTrackingCurrentTime")):(e.techCall_("stopTrackingCurrentTime"),t&&t())},timeShiftEnabled:function(e){return!e.tech_||void 0===e.tech_.timeShiftEnabled||e.techGet_("timeShiftEnabled")},baseCurrentTime:function(e){return e.tech_&&void 0!==e.tech_.baseCurrentTime?e.techGet_("baseCurrentTime"):e.currentTime()},baseDuration:function(e){return e.tech_&&void 0!==e.tech_.duration?e.techGet_("duration"):0},startTimeLive:function(e){if(!e.tech_||void 0===e.tech_.startTimeLive)return 0;var t=this.getServerTime(e),i=e.tech_.startTimeLive(t),r=this.getEntitlement(e);return r&&r.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=r.streamInfo.referenceTime),r&&r.isStaticCachupAsLive&&"EmpCast"!==e.techName_&&(i=r.streamInfo.referenceTime),i},driftingTime:function(e){if(!e.tech_||!this.isLive(e)||"EmpShaka"!==e.techName_)return NaN;var t=this.getEntitlement(e);if(!t)return NaN;var i=e.tech_.getPresentationStartTime();return i=(t.streamInfo.referenceTime-i)/1e3,Math.round(i)},isLive:function(e){return!(!e.tech_||void 0===e.tech_.live)&&e.techGet_("live")},isCatchupAsLive:function(e){var t=this.getEntitlement(e);return!this.isLive(e)&&t&&t.live},getBitrate:function(e){return e.tech_&&void 0!==e.tech_.getBitrate?e.techGet_("getBitrate"):0},duration:function(e,t){return e.tech_&&void 0!==e.tech_.duration?(e.duration(t),e.techGet_("duration")):e.duration(t)},techVersion:function(e){return e.tech_&&void 0!==e.tech_.techVersion?e.techGet_("techVersion"):"2.x.x"},canSeekTo:function(e,t){if(!1===this.timeShiftEnabled(e)||!e.hasStarted())return!1;var i=this.getEntitlement(e);return!(i&&e.cache_&&!1===i.ffEnabled&&e.cache_.currentTime<=t)&&!(i&&e.cache_&&!1===i.rwEnabled&&e.cache_.currentTime>=t)},remainingTime:function(e){if(e.tech_&&void 0!==e.tech_.remainingTime)return e.techGet_("remainingTime");var t=e.duration();return t===1/0||0===t?1/0:t-e.currentTime()},casting:function(e,t){return!(!e.castPlugin||!e.castPlugin().canOverride("Cast"))&&(e.cache_.sources=t,e.cache_.source=t[0],e.castPlugin().cast(),!0)},setAbsoluteTime:function(e,t){if(e.tech_&&void 0!==e.tech_.setAbsoluteTime){var i=this.getServerTime(e);if("EmpCast"!==e.techName_){var r=this.getEntitlement(e);if(r&&r.isStaticCachupAsLive){if(t.getTime()<r.streamInfo.start.getTime())L("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),t=0;else{if(t.getTime()>=r.streamInfo.end.getTime())return L("setAbsoluteTime","playNextProgram"),void this.playProgram(e,t);t=t.getTime()-r.streamInfo.start.getTime()}return void e.techCall_("setCurrentTime",t/1e3)}if(r&&r.isDynamicCachupAsLive)if(t.getTime()<r.streamInfo.start.getTime()){if(L("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),"HLS"===e.streamType)return void e.techCall_("setCurrentTime",0);t=new Date(r.streamInfo.start.getTime())}else if("HLS"===e.streamType)return t-=r.streamInfo.start.getTime(),void e.techCall_("setCurrentTime",t/1e3)}e.techCall_("setAbsoluteTime",{date:t,nowDate:i})}else{var n=(t.getTime()-new Date(0))/1e3;e.currentTime(n)}},gotoLive:function(e){if(e.sourceChanging_)L("gotoLive ignore sourceChanging");else if(e.tech_.gotoLive)e.techCall_("gotoLive");else{var t=this.getEntitlement(e);if(t&&t.isDynamicCachupAsLive)this.setAbsoluteTime(e,new Date(e.getServerTime()));else if(t&&t.isStaticCachupAsLive){var i=this.currentAsset(e);i&&i.channelId&&e.startPlayback(null,i.channelId,null)}else if(this.isLive(e)){var r=e.duration();e.currentTime(r)}else L.warn("Not suppoted for VOD")}},setPlayheadTime:function(e,t){this.setAbsoluteTime(e,new Date(t))},supportsEpgProgramChange:function(e){if(e.tech_&&void 0!==e.tech_.supportsEpgProgramChange)return e.techGet_("supportsEpgProgramChange")},program:function(e){return e.tech_&&void 0!==e.tech_.program?e.techGet_("program"):null},playPreviousProgram:function(n,o){n.sourceChanging_?L("playPreviousProgram ignore sourceChanging"):n.programService&&(n.sourceChanging_=!0,n.programService().getPreviousProgram(function(e,t){if(t)n.sourceChanging_=!1,L.warn("playPreviousProgram",t);else{var i={};if(o){i.playFrom="startTime";var r=new Date(e.endTime);r.setSeconds(r.getSeconds()-30),i.startTime=r}else i.playFrom="beginning";n.startPlayback(e.assetId,e.channelId,e.programId,i)}}))},playNextProgram:function(r){r.sourceChanging_?L("playNextProgram ignore sourceChanging"):r.programService&&r.programService().currentProgram&&this.getServerTime(r)>r.programService().currentProgram.end.getTime()&&(r.sourceChanging_=!0,r.programService().getNextProgram(function(e,t){if(t)r.sourceChanging_=!1,L.warn("playNextProgram",t);else{var i={playFrom:"beginning"};r.startPlayback(e.assetId,e.channelId,e.programId,i)}}))},playProgram:function(r,n){r.sourceChanging_?L("playProgram ignore sourceChanging"):r.programService&&(r.sourceChanging_=!0,r.programService().getProgram(n,function(e,t){if(t)r.sourceChanging_=!1,L.warn("getProgram",t);else{var i={playFrom:"startTime"};i.startTime=n,r.startPlayback(e.assetId,e.channelId,e.programId,i)}}))},getServerTime:function(e){return e.programService&&e.programService()&&e.programService().exposure?e.programService().exposure.getCachedServerTime():Date.now()},getEntitlement:function(e){if(e.programService)return e.programService().entitlement();if(e.tech_){var t=e.tech_.options_;if(t&&t.source&&t.source.playSessionId)return t.source}return null},getSeekTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.seekable||e.seeking())return t;var i=e.techGet_("seekable");if(i&&0<i.length){var r=this.getEntitlement(e),n=0;if(r&&r.isDynamicCachupAsLive&&"HLS"===e.streamType&&(n=r.streamInfo.referenceTime),t.start=1e3*i.start(i.length-1)+n,t.end=1e3*i.end(i.length-1)+n,"EmpCast"===e.techName_){var o=this.liveDelay(e);t.end>this.getServerTime(e)-1e3*o&&(t.end=this.getServerTime(e)-1e3*o)}}return t},getBufferedTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.buffered||e.seeking())return t;var i=e.techGet_("buffered");return i&&0<i.length&&(t.start=Math.round(1e3*i.start(i.length-1)),t.end=Math.round(1e3*i.end(i.length-1))),t},setTechProgram:function(e,t){e.tech_&&void 0!==e.tech_.program&&e.techCall_("program",t)},setTechVOD:function(e,t){e.tech_&&void 0!==e.tech_.VOD&&e.techCall_("VOD",t)}},X=p.getComponent("Button"),z=p.getComponent("Component"),J=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).updateShowing(),i.on(i.player(),x.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),x.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),x.TIME_UPDATE,function(){return i.timeUpdate()}),i.on(i.player(),x.ENDED,function(){return i.hide()}),i}c(e,r);var t=e.prototype;return t.createEl=function(){var e=r.prototype.createEl.call(this,"button",{className:"emp-live-control vjs-control"});return this.contentEl_=K("div",{className:"emp-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},t.updateShowing=function(){this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive?this.show():this.hide()},t.timeUpdate=function(){if(this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive){var e=this.player().timeBehindLive();this.player().isLive()&&e<20?this.addClass("emp-live-edge"):this.removeClass("emp-live-edge")}},t.handleClick=function(){this.player().gotoLive()},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(X);function Z(e,t){void 0===t&&(t=e),e=e<0?0:e;var i=Math.floor(e%60),r=Math.floor(e/60%60),n=Math.floor(e/3600),o=Math.floor(t/60%60),s=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(n=r=i="-"),(n=0<n||0<s?n+":":"")+(r=((n||10<=o)&&r<10?"0"+r:r)+":")+(i=i<10?"0"+i:i)}z.registerComponent("EmpLiveDisplay",J);var Q=p.getComponent("Component"),ee=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).on(i.player(),x.PLAYING,function(){return i.updateVisibility()}),i.on(i.player(),x.DURATION_CHANGE,function(){return i.updateVisibility()}),i.on(i.player(),x.SEEKED,function(){return i.updateVisibility()}),i.addClass("vjs-hidden"),i}c(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"emp-ad-marker"})},t.buildCSSClass=function(){return"emp-ad-marker "+r.prototype.buildCSSClass.call(this)},t.updateVisibility=function(){if(this.player_.duration()){var e=this.options_.element;e.offset+e.duration<this.player_.currentTime()?this.addClass("emp-ad-past"):this.removeClass("emp-ad-past");var t=e.offset/this.player_.duration();1<=t&&(t=1);var i=e.duration/this.player_.duration();1<=i&&(i=1),this.el_.style.left=(100*t).toFixed(2)+"%",this.el_.style.width=(100*i).toFixed(2)+"%",this.show()}},t.dispose=function(){r.prototype.dispose.call(this)},e}(Q);Q.registerComponent("EmpMarker",ee);var te=p.getComponent("Component"),ie=function(i){function e(e,t){return i.call(this,e,t)||this}return c(e,i),e.prototype.update=function(i,r){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e=n.player_.duration(),t=Z(r*e,e);n.el_.style.left=i.width*r+"px",n.getChild("timeTooltip").update(i,r,t)})},e}(p.getComponent("MouseTimeDisplay"));te.registerComponent("MouseTimeDisplay",ie);var re,ne,oe,se,ae=d.navigator&&d.navigator.userAgent||"",le=/AppleWebKit\/([\d.]+)/i.exec(ae),ce=(le&&parseFloat(le.pop()),/iPad/i.test(ae)),ue=0<=d.navigator.userAgent.indexOf("CrKey"),he=/iPhone/i.test(ae)&&!ce,pe=/iPod/i.test(ae),de=he||ce||pe,me=((re=ae.match(/OS (\d+)_/i))&&re[1]&&re[1],/Android/i.test(ae)),fe=function(){var e=ae.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),ge=(me&&/webkit/i.test(ae),/Firefox/i.test(ae),/Edge/i.test(ae)),ye=!ge&&/Chrome/i.test(ae),ve=((ne=ae.match(/Chrome\/(\d+)/))&&ne[1]&&parseFloat(ne[1]),/MSIE\s8\.0/.test(ae),oe=/MSIE\s(\d+)\.\d/.exec(ae),!(se=oe&&parseFloat(oe[1]))&&/Trident\/7.0/i.test(ae)&&/rv:11.0/.test(ae)&&(se=11),se),Te=/Tizen/i.test(ae),_e=/webOS/i.test(ae)||/Web0S/i.test(ae)||/WebOS/i.test(ae)||/NetCast/i.test(ae),Ee=(/SmartTV/i.test(ae),/Safari/i.test(ae),ge||null!==ve);q()&&("ontouchstart"in d||d.DocumentTouch&&(d.document,d.DocumentTouch)),q()&&d.document.createElement("video").style;function be(){try{var e=d.navigator,t=d.screen,i=e.mimeTypes.length;return i+=e.userAgent.replace(/\D+/g,""),i+=e.plugins.length,i+=t.height||"",i+=t.width||"",i+=t.pixelDepth||""}catch(e){}return 0}var Se=p.getComponent("Component"),Ce=p.getComponent("Slider"),Ae=ue||d.EMP_DEBUG_CHROMECAST?1e3:30,Ie=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).markers=[],i.update=P(w(u(i),i.update),Ae),i.on(e,x.TIME_UPDATE,i.update),i.on(e,x.ENDED,i.handleEnded),i.on(e,x.AD_TIMELINE_CHANGED,i.updateMarkers),i.updateInterval=null,i.on(e,["playing"],function(){i.updateInterval&&(i.clearInterval(i.updateInterval),i.updateInterval=null),ue||d.EMP_DEBUG_CHROMECAST||(i.updateInterval=i.setInterval(function(){i.requestAnimationFrame(function(){i.update()})},Ae))}),i.on(e,["ended","pause","waiting"],function(){i.updateInterval&&(i.clearInterval(i.updateInterval),i.updateInterval=null)}),i.on(e,["timeupdate","ended"],i.update),i}c(e,r);var t=e.prototype;return t.updateMarkers=function(e,t){var i=this.markers,r=Array.isArray(i),n=0;for(i=r?i:i[Symbol.iterator]();;){var o;if(r){if(n>=i.length)break;o=i[n++]}else{if((n=i.next()).done)break;o=n.value}var s=o;this.removeChild(s)}if(t&&t.timeline){var a=t.timeline.getAllElements(),l=Array.isArray(a),c=0;for(a=l?a:a[Symbol.iterator]();;){var u;if(l){if(c>=a.length)break;u=a[c++]}else{if((c=a.next()).done)break;u=c.value}var h=u;if("advert"===h.type){var p=new ee(this.player_,{element:h});this.markers.push(p),this.addChild(p),p.updateVisibility()}}}},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update_=function(e,t){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Z(e,i),Z(i,i)],"{1} of {2}")),ue||d.EMP_DEBUG_CHROMECAST||this.bar.update(function(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat($(e,"height"))),i.width||(i.width=parseFloat($(e,"width"))),i}}(this.el_),t)},t.update=function(e,t){var i=r.prototype.update.call(this);return this.update_(this.getCurrentTime_(),i),i},t.getCurrentTime_=function(){return this.player_.scrubbing()?(this.player_.getCache().currentTime,this.player_.getCache().currentTime):(this.player_.getCache().currentTime=this.player_.currentTime(),this.player_.currentTime())},t.handleEnded=function(e){this.update_(this.player_.duration(),1);var t=this.markers,i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var n;if(i){if(r>=t.length)break;n=t[r++]}else{if((r=t.next()).done)break;n=r.value}var o=n;this.removeChild(o)}},t.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return 1<=e?1:e},t.handleMouseDown=function(e){this.player_.scrubbing(!0),r.prototype.handleMouseDown.call(this,e)},t.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.setCurrentTime(t)},t.setCurrentTime=function(e){var t=0===(this.player_.src()?this.player_.src():"").indexOf("offline:"),i=this.player_.buffered().start(0),r=this.player_.buffered().end(0);this.player_.getCache().currentTime=(t||i<=e&&e<=r?this.player_.currentTime(e):this.player_.scrubbing()?this.player_.getCache().currentTime=e:this.player_.currentTime(e),e)},t.throttleSetCurrentTime=function(e){null!==this.seekTimeoutId_&&d.clearTimeout(this.seekTimeoutId_);var t=this.player_.buffered().start(0),i=this.player_.buffered().end(0);t<=e&&e<=i?(this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e):(this.player_.scrubbing(!0),this.player_.getCache().currentTime=e,this.seekTimeoutId_=d.setTimeout(this.onSeekInputTimeout_.bind(this,e),1e3))},t.onSeekInputTimeout_=function(e){this.seekTimeoutId_=null,this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e},t.enable=function(){r.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},t.disable=function(){r.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},t.handleMouseUp=function(e){r.prototype.handleMouseUp.call(this,e),this.player_.scrubbing(!1),this.setCurrentTime(this.player_.getCache().currentTime)},t.stepForward=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime+5)},t.stepBack=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime-5)},t.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):r.prototype.handleKeyPress&&r.prototype.handleKeyPress.call(this,e)},e}(Ce);Ie.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},ve&&!(8<ve)||de||me||Ie.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Ie.prototype.playerEvent="timeupdate",Se.registerComponent("SeekBar",Ie);var we=p.getComponent("Button"),Pe=p.getComponent("Component"),xe=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).shouldRestart_=!0,i.updateShowing(),i.on(i.player(),x.LOADED_METADATA,i.updateShowing),i.on(i.player(),x.PLAYING,function(){i.shouldRestart_=!1,i.updateShowing()}),i.on(i.player(),x.ERROR,function(){i.shouldRestart_=!0}),i}c(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"emp-restart-control "+r.prototype.buildCSSClass.call(this)},t.updateShowing=function(){this.player().canRestart()?this.show():this.hide()},t.handleClick=function(){if(!0!==this.shouldRestart_){this.player_.scrubbing(!0);var e,t,i=!this.player_.paused();this.player_.pause(),this.player_.currentTime(0),this.player_.scrubbing(!1),i&&(e=this.player_.play(),void 0!==(t=e)&&"function"==typeof t.then&&e.then(null,function(e){}))}else this.player_.restart()},e}(we);xe.prototype.controlText_="Restart",Pe.registerComponent("EmpRestartButton",xe);var Oe=p.getComponent("Button"),De=p.getComponent("Component"),ke=function(r){function e(e,t){var i;return t=g({seconds:30},t),(i=r.call(this,e,t)||this).controlText("Forward "+t.seconds+"s"),e.on(x.TIMESHIFT_CHANGE,function(){return i.onTimeshift()}),e.on(x.PROGRAM_CHANGED,function(e,t){return i.updateEnabled(t&&t.program)}),e.on(x.DURATION_CHANGE,function(){return i.updateEnabled()}),i.updateEnabled(),i}c(e,r);var t=e.prototype;return t.updateEnabled=function(e){this.entitlement&&!this.entitlement.ffEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Forward restricted")):(this.enable(),this.show(),this.controlText("Forward "+this.options_.seconds+"s"))},t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.buildCSSClass=function(){return"emp-forward-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()+this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(Oe);ke.prototype.controlText_="Forward",De.registerComponent("EmpForwardButton",ke);var Le=p.getComponent("Button"),Re=p.getComponent("Component"),Ne=function(r){function e(e,t){var i;return t=g({seconds:30},t),(i=r.call(this,e,t)||this).controlText("Rewind "+t.seconds+"s"),e.on(x.TIMESHIFT_CHANGE,function(){return i.onTimeshift()}),e.on(x.PROGRAM_CHANGED,function(e,t){return i.updateEnabled(t&&t.program)}),e.on(x.DURATION_CHANGE,function(){return i.updateEnabled()}),i.updateEnabled(),i}c(e,r);var t=e.prototype;return t.updateEnabled=function(e){this.entitlement&&!this.entitlement.rwEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Rewind restricted")):(this.enable(),this.show(),this.controlText("Rewind "+this.options_.seconds+"s"))},t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.buildCSSClass=function(){return"emp-rewind-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()-this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(Le);Ne.prototype.controlText_="Rewind",Re.registerComponent("EmpRewindButton",Ne);var Me=p.getComponent("Button"),Be=p.getComponent("Component"),Ue=function(i){function e(e,t){return i.call(this,e,t)||this}c(e,i);var t=e.prototype;return t.buildCSSClass=function(){return"emp-reload-control "+i.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.restart()},e}(Me);Ue.prototype.controlText_="Reload",Be.registerComponent("EmpReloadButton",Ue);var Fe=p.getComponent("Component"),He=ue||d.EMP_DEBUG_CHROMECAST?1e3:30,je=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).mode_=t.mode||"remainingTime",i.throttledUpdateContent=P(w(u(i),i.updateContent),He),i.on(e,x.TIME_UPDATE,i.throttledUpdateContent),i.on(e,x.DURATION_CHANGE,i.updateContent),e.on(x.ENDED,function(){i.hide()}),e.on(x.PLAYING,function(){i.show()}),i}c(e,r);var t=e.prototype;return t.createEl=function(){var e="emp-time vjs-time-control vjs-remaining-time vjs-control";this.options_&&"remainingTime"===this.options_.mode?e+=" emp-remaining-time":e+=" emp-currentTime-time";var t=r.prototype.createEl.call(this,"div",{className:e});return this.contentEl_=K("div",{className:"emp-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span>0:00"},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.updateContent=function(){if("currentTime"===this.mode_){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),t=this.localize("Current Time"),i=Z(e,this.player_.duration());i!==this.formattedTime_&&(this.formattedTime_=i,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span>"+i)}else{var r=this.player_.duration();if(r){var n,o=this.localize("Remaining Time");if(4294967295<r)(n="")!==this.formattedTime_&&(this.formattedTime_=n,this.contentEl_.innerHTML='<span class="vjs-control-text">'+o+"</span>"+n);else{var s=this.player_.remainingTime();s<0&&(s=0),(n=Z(s))!==this.formattedTime_&&(this.formattedTime_=n,this.contentEl_.innerHTML='<span class="vjs-control-text">'+o+"</span>"+n)}}}},e}(Fe);Fe.registerComponent("EmpTimeDisplay",je),Fe.registerComponent("EmpTimeDisplay2",je);var Ge=p.getComponent("Button"),Ve=p.getComponent("Component"),$e=function(n){function e(e,t,i){var r;return(r=n.call(this,e,t,i)||this).el_.setAttribute("aria-label","Stop Playback"),e.on(x.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),e.on(x.PLAYING,function(){return r.onTimeshift()}),e.on(x.ENDED,function(){return r.hide()}),r}c(e,n);var t=e.prototype;return t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.hide():this.show())},t.handleClick=function(e){this.player()&&this.player().stop()},t.buildCSSClass=function(){return"emp-stop-control vjs-icon-square "+n.prototype.buildCSSClass.call(this)},e}(Ge);$e.prototype.kind_="stop",$e.prototype.controlText_="stop",Ve.registerComponent("EmpStopButton",$e);var We=p.getComponent("PlayToggle"),qe=p.getComponent("Component"),Ke=function(n){function e(e,t,i){var r;return(r=n.call(this,e,t,i)||this).el_.setAttribute("aria-label","Play Toggle"),e.on(x.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),e.on(x.PLAYING,function(){return r.onTimeshift()}),r}c(e,n);var t=e.prototype;return t.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.handleClick=function(e){n.prototype.handleClick.call(this,e)},t.buildCSSClass=function(){return""+n.prototype.buildCSSClass.call(this)},e}(We);Ke.prototype.kind_="playToggle",Ke.prototype.controlText_="playToggle",qe.registerComponent("EmpPlayToggle",Ke);var Ye=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).addClass("vjs-hidden"),e.ready(function(){i.initAirPlay()}),i}c(e,r);var t=e.prototype;return t.initAirPlay=function(){var t=this.player();d.WebKitPlaybackTargetAvailabilityEvent&&t.el().getElementsByTagName("video")[0].addEventListener("webkitplaybacktargetavailabilitychanged",function(e){switch(e.availability){case"available":L("Airplay available"),t.on("loadeddata",function(){t.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")&&(this.entitlement&&this.entitlement.airplayBlocked?t.controlBar.airplayToggle.hide():t.controlBar.airplayToggle.show())});break;case"not-available":L("Airplay not-available")}})},t.buildCSSClass=function(){return"vjs-airplay-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.entitlement&&this.entitlement.airplayBlocked?L("Airplay Blocked"):(this.player().el().getElementsByTagName("video")[0].webkitShowPlaybackTargetPicker(),this.player().trigger(x.AIRPLAY_START))},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(p.getComponent("Button"));Ye.prototype.controlText_="Airplay",p.registerComponent("AirplayToggle",Ye);var Xe=p.getComponent("Button"),ze=p.getComponent("Component"),Je=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).controlText("Next program"),i.updateShowing(),i.on(i.player(),x.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),x.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),x.PROGRAM_CHANGED,function(e,t){return i.updateShowing(t&&t.program)}),i}c(e,r);var t=e.prototype;return t.updateShowing=function(e){e=e||this.player().getProgramDetails(),!this.player().noEPG()&&this.entitlement&&e?(this.show(),this.enable()):this.hide(),e&&Date.now()<e.end.getTime()&&this.disable(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.buildCSSClass=function(){return"emp-next-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player().ended()||this.player().playNextProgram()},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(Xe);Je.prototype.controlText_="Next",ze.registerComponent("EmpNextButton",Je);var Ze=p.getComponent("Button"),Qe=p.getComponent("Component"),et=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).controlText("Previous Program"),i.updateShowing(),i.on(i.player(),x.PLAYING,function(){return i.updateShowing()}),i.on(i.player(),x.DURATION_CHANGE,function(){return i.updateShowing()}),i.on(i.player(),x.PROGRAM_CHANGED,function(){return i.updateShowing()}),i}c(e,r);var t=e.prototype;return t.updateShowing=function(){var e=this.player().getProgramDetails();!this.player().noEPG()&&this.entitlement&&e?this.show():this.hide(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.buildCSSClass=function(){return"emp-previous-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player().ended()||this.player().playPreviousProgram()},l(e,[{key:"entitlement",get:function(){return Y.getEntitlement(this.player())}}]),e}(Ze);et.prototype.controlText_="Previous",Qe.registerComponent("EmpPreviousButton",et);var tt=p.getComponent("ControlBar"),it=p.getComponent("Component"),rt=function(e){function t(){return e.apply(this,arguments)||this}return c(t,e),t}(tt);function nt(e,t){return Array.isArray(e)?ot(e):void 0===e||void 0===t?ot():ot([[e,t]])}function ot(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:st.bind(null,"start",0,e),end:st.bind(null,"end",1,e)}}function st(e,t,i,r){return void 0===r&&(L.warn("DEPRECATED: Function '"+e+"' on 'TimeRanges' called without an index argument."),r=0),function(e,t,i){if(t<0||i<t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is greater than or equal to the maximum bound ("+i+").")}(e,r,i.length-1),i[r][t]}rt.prototype.options_={loadEvent:"play",children:{empPlayToggle:{},empReloadButton:{},empStopButton:{},empPreviousButton:{},empRewindButton:{},empForwardButton:{},empNextButton:{},volumePanel:{inline:!1},empTimeDisplay:{mode:"currentTime"},timeDivider:{},durationDisplay:{},empLiveDisplay:{},progressControl:{},empTimeDisplay2:{mode:"remainingTime"},customControlSpacer:{},empRestartButton:{},playbackRateMenuButton:{},chaptersButton:{},bitrateButton:{},audioTrackButton:{},subsCapsButton:{},airplayToggle:{},fullscreenToggle:{}}},it.registerComponent("ControlBar",rt);var at=p.getComponent("Component"),lt="#222",ct={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function ut(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}var ht=function(n){function e(i,e,t){var r;return r=n.call(this,i,e,t)||this,i.on("loadstart",w(u(r),r.toggleDisplay)),i.on("texttrackchange",w(u(r),r.updateDisplay)),i.on("loadstart",w(u(r),r.preselectTrack)),i.ready(w(u(r),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else if("DASH"!==i.streamType&&"HLS"!==i.streamType&&"EmpCast"!==i.techName_){i.on("fullscreenchange",w(this,this.updateDisplay));for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}else this.hide()})),r}c(e,n);var t=e.prototype;return t.preselectTrack=function(){for(var e,t,i,r={captions:1,subtitles:1},n=this.player_.textTracks(),o=this.player_.cache_.selectedLanguage,s=0;s<n.length;s++){var a=n[s];o&&o.enabled&&o.language===a.language?a.kind===o.kind?i=a:i||(i=a):o&&!o.enabled?t=e=i=null:a.default&&("descriptions"!==a.kind||e?a.kind in r&&!t&&(t=a):e=a)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},t.toggleDisplay=function(){"DASH"!==this.player_.streamType&&"HLS"!==this.player_.streamType&&"EmpCast"!==this.player_.techName_?this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show():this.hide()},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){"function"==typeof d.WebVTT&&d.WebVTT.processCues(d,[],this.el_)},t.removeStyles=function(e){var t=G.getElementById(e);return t&&G.getElementsByTagName("head")[0].removeChild(t),t},t.writeStyles=function(e,t){var i=this.removeStyles(e);(i=G.createElement("style")).type="text/css",i.id=e,i.innerHTML=t,G.getElementsByTagName("head")[0].appendChild(i)},t.getStyle=function(e){var t,i,r,n,o,s,a,l,c,u;return e.color&&(t="color: "+e.color),e.textOpacity&&(t="color: "+ut(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(i="background-color: "+e.backgroundColor),e.backgroundOpacity&&(i="background-color: "+ut(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(u=e.windowOpacity?"outline: "+ut(e.windowColor,e.windowOpacity)+" solid 10px":"outline: "+e.windowColor+" solid 10px"),e.edgeStyle&&("dropshadow"===e.edgeStyle?r="text-shadow: 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, black 0.1em 0.1em 0.2em":"raised"===e.edgeStyle?r="text-shadow: 1px 1px #222, 2px 2px #222, 3px 3px "+lt:"depressed"===e.edgeStyle?r="text-shadow: 1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+lt:"uniform"===e.edgeStyle&&(r="text-shadow: 0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+lt)),e.fontPercent&&1!==e.fontPercent&&(n="font-size: "+e.fontPercent+"em",o="height: auto",s="top: auto",a="bottom: 2px"),e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?l="font-variant: small-caps":c="font-family: "+ct[e.fontFamily]),(t?t+"; ":"")+(i?i+"; ":"")+(r?r+"; ":"")+(n?n+"; ":"")+(o?o+"; ":"")+(s?s+"; ":"")+(a?a+"; ":"")+(l?l+"; ":"")+(c?c+"; ":"")+(u?u+"; ":"")},t.getSafariStyle=function(e){var t;return e.backgroundColor&&(t="background-color: "+e.backgroundColor),e.backgroundOpacity&&(t="background-color: "+ut(e.backgroundColor||"#000",e.backgroundOpacity)),t?"video::-webkit-media-text-track-display-backdrop {"+t+" !important;overflow: visible !important;}":""},t.updateDisplay=function(){if(this.player_.textTrackSettings){var e;e=this.player_.options_.textTrackStyle?this.player_.options_.textTrackStyle:this.player_.textTrackSettings.getValues();var t="styles_cue";if("DASH"===this.player_.streamType||"EmpHLS"===this.player_.techName_||"HLS"===this.player_.streamType){var i=this.getStyle(e);return"EmpHLS"===this.player_.techName_?this.writeStyles(t,"video::cue {"+i+"}\n"+this.getSafariStyle(e)):this.writeStyles(t,"video::cue {"+i+"}"),void this.clearDisplay()}this.removeStyles(t)}else this.writeStyles("style_no_texttrack_settings",".vjs-texttrack-settings {display: none;}")},t.updateForTrack=function(e){},e}(at);at.registerComponent("TextTrackDisplay",ht);var pt=p.getComponent("Component"),dt=p.getComponent("ModalDialog"),mt="vjs-text-track-settings",ft=["#000","Black"],gt=["#00F","Blue"],yt=["#0FF","Cyan"],vt=["#0F0","Green"],Tt=["#F0F","Magenta"],_t=["#F00","Red"],Et=["#FFF","White"],bt=["#FF0","Yellow"],St=["1","Opaque"],Ct=["0.5","Semi-Transparent"],At=["0","Transparent"],It={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ft,Et,_t,vt,gt,bt,Tt,yt]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[At,Ct,St]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Et,ft,_t,vt,gt,bt,Tt,yt]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]],default:4},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.25","25%"],["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["2.50","250%"]],default:3,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[St,Ct]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[At,Ct,St]}};function wt(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}It.windowColor.options=It.backgroundColor.options;var Pt=function(r){function e(e,t){var i;return t.temporary=!1,(i=r.call(this,e,t)||this).updateDisplay=w(u(i),i.updateDisplay),i.fill(),i.hasBeenOpened_=i.hasBeenFilled_=!0,i.endDialog=K("p",{className:"vjs-control-text",textContent:i.localize("End of dialog window.")}),i.el().appendChild(i.endDialog),i.setDefaults(),void 0===t.persistTextTrackSettings&&(i.options_.persistTextTrackSettings=i.options_.playerOptions.persistTextTrackSettings),i.on(i.$(".vjs-done-button"),"click",function(){i.saveSettings(),i.close()}),i.on(i.$(".vjs-default-button"),"click",function(){i.setDefaults(),i.updateDisplay()}),f(It,function(e){i.on(i.$(e.selector),"change",i.updateDisplay)}),i.options_.persistTextTrackSettings&&i.restoreSettings(),i}c(e,r);var t=e.prototype;return t.dispose=function(){this.endDialog=null,r.prototype.dispose.call(this)},t.createElSelect_=function(e,i,t){var r=this;void 0===i&&(i=""),void 0===t&&(t="label");var n=It[e],o=n.id.replace("%s",this.id_);return["<"+t+' id="'+o+'" class="'+("label"===t?"vjs-label":"")+'">',this.localize(n.label),"</"+t+">",'<select aria-labelledby="'+(""!==i?i+" ":"")+o+'">'].concat(n.options.map(function(e){var t=o+"-"+e[1];return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+(""!==i?i+" ":"")+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return K("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return K("div",{className:'vjs-track-settings-font">',innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var e=this.localize("restore all settings to the default values");return K("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return r.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var i,r,e,s=this;return r=function(e,t,i){var r,n,o=(r=s.$(t.selector),n=t.parser,wt(r.options[r.options.selectedIndex].value,n));return void 0!==o&&(e[i]=o),e},void 0===(e={})&&(e=0),m(i=It).reduce(function(e,t){return r(e,i[t],t)},e)},t.setValues=function(i){var r=this;f(It,function(e,t){!function(e,t,i){if(t)for(var r=0;r<e.options.length;r++)if(wt(e.options[r].value,i)===t){e.selectedIndex=r;break}}(r.$(e.selector),i[t],e.parser)})},t.setDefaults=function(){var i=this;f(It,function(e){var t=e.hasOwnProperty("default")?e.default:0;i.$(e.selector).selectedIndex=t})},t.restoreSettings=function(){var e;try{e=JSON.parse(d.localStorage.getItem(mt))}catch(e){L.warn(e)}e&&this.setValues(e)},t.saveSettings=function(){var e=this.getValues();if(this.player_.options_.textTrackStyle=void 0,"EmpCast"===this.player_.techName_&&this.player_.techCall_("sendTextTrackStyle",e),this.options_.persistTextTrackSettings)try{Object.keys(e).length?d.localStorage.setItem(mt,JSON.stringify(e)):d.localStorage.removeItem(mt)}catch(e){L.warn(e)}},t.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(G,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},e}(dt);pt.registerComponent("TextTrackSettings",Pt);var xt=p.getComponent("Component"),Ot=function(r){function e(e,t){var i;return(i=r.call(this,e,t)||this).assetMetadata=null,i.on(i.player(),x.ENDED,function(){i.hide(),i.clearEl(),i.assetMetadata=null}),i.on(i.player(),x.ABORT,function(){i.hide(),i.clearEl(),i.assetMetadata=null}),i.on(i.player(),x.CHROMECAST_CASTING,function(){i.hide(),i.clearEl(),i.assetMetadata=null}),i.on(i.player(),x.PLAYING,function(){if(i.show(),!i.assetMetadata){var e=i.player().options();e.mediaInfo&&i.updateMediaInformation_({title:e.mediaInfo.title,subtitle:e.mediaInfo.subtitle,images:e.mediaInfo.artworkUrl?[{url:e.mediaInfo.artworkUrl}]:[],channelInfo:{images:e.mediaInfo.logoUrl?[{url:e.mediaInfo.logoUrl}]:[]}})}}),i.on(i.player(),x.PROGRAM_CHANGED,function(e,t){(t&&t.program?t.program.programId:null)?(i.assetMetadata=i.player().programService().extractAssetMetadata(t.program.asset),i.assetMetadata.channelInfo=t.program.channelInfo,i.updateMediaInformation_(i.assetMetadata)):(i.hide(),i.clearEl(),i.assetMetadata=null)}),i.on(i.player(),x.ASSET_CHANGED,function(e,t){t&&t.asset?(i.assetMetadata=i.player().programService().extractAssetMetadata(t.asset),i.updateMediaInformation_(i.assetMetadata)):(i.hide(),i.clearEl(),i.assetMetadata=null)}),i.on(i.player(),x.DISPOSE,function(){i.hide(),i.clearEl()}),i.fillEl(),i}c(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"emp-mediainfo-bar "+r.prototype.buildCSSClass.call(this)},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"emp-mediainfo-bar"})},t.imageSelector=function(e,t){var i;0<e.length&&(i=e[0]);for(var r=0;r<e.length;r++)if(e[r].url&&e[r].type===t)return e[r];return i},t.updateMediaInformation_=function(e){if(this.el_&&(this.show(),this.player().options().mediaInfo)){this.fillEl();var t=this.el_.getElementsByClassName("emp-media-artwork"),i=this.el_.getElementsByClassName("emp-media-logo"),r=this.el_.getElementsByClassName("emp-media-title"),n=this.el_.getElementsByClassName("emp-media-subtitle"),o=t.length?t[0]:null,s=i.length?i[0]:null,a=r.length?r[0]:null,l=n.length?n[0]:null;if(a&&(a.innerHTML=e.title||""),l&&(l.innerHTML=e.subtitle||""),o&&e.images&&0<e.images.length){var c=this.imageSelector(e.images,"chromecast");o.style.backgroundImage='url("'+c.url+'")',o.style.display="block"}else o&&(o.style.display="none",o.style.backgroundImage="none");if(s&&e.channelInfo){var u=this.imageSelector(e.channelInfo.images,"thumbnail");u&&u.url?(s.style.backgroundImage='url("'+u.url+'")',s.style.display="block"):(s.style.display="none",s.style.backgroundImage="none")}this.player().userActive(!0)}},t.clearEl=function(){this.el_&&(this.el_.innerHTML="")},t.fillEl=function(){var e=this.player().options();if(e.mediaInfo){var t="";e.mediaInfo.artworkEnable&&(t+='<div class="emp-media-artwork"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+='<div class="emp-media-text">'),e.mediaInfo.titleEnable&&(t+='<div class="emp-media-title"></div>'),e.mediaInfo.subtitleEnable&&(t+='<div class="emp-media-subtitle"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+="</div>"),e.mediaInfo.logoEnable&&(t+='<div class="emp-media-logo"></div>'),this.el_.innerHTML=t}else this.el_.innerHTML=""},e}(xt);Ot.prototype.controlText_="MediaInfo",xt.registerComponent("EmpMediaInfoBar",Ot);var Dt=function(r){function e(e,t){var i;return i=r.call(this,e,t)||this,L("vttThumbnailsPlugin","create"),i.options_=t||{src:"sprites/sprites.vtt"},i.enabled_=!0,i.listenForDurationChange(),i.registeredEvents={},e.ready(function(){e.addClass("vjs-vtt-thumbnails")}),i.on(e,[x.FIRST_PLAY],function(){i.resetPlugin(),i.initializeThumbnails(),L("vttThumbnailsPlugin","FIRST_PLAY")}),i}c(e,r);var t=e.prototype;return t.src=function(e){this.resetPlugin(),this.options_.src=e,this.initializeThumbnails()},t.detach=function(){this.resetPlugin()},t.options=function(e){if(!e)return this.options_;this.options_=p.mergeOptions(this.options_,e)},t.resetPlugin=function(){this.thumbnailHolder&&this.thumbnailHolder.parentNode.removeChild(this.thumbnailHolder),this.progressBar&&(this.progressBar.removeEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.removeEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave),this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove)),delete this.registeredEvents.progressBarMouseEnter,delete this.registeredEvents.progressBarMouseLeave,delete this.registeredEvents.progressBarMouseMove,delete this.progressBar,delete this.vttData,delete this.thumbnailHolder,delete this.lastStyle},t.listenForDurationChange=function(){this.player.on("durationchange",function(){})},t.initializeThumbnails=function(){var t=this;if(this.options_.src&&this.enabled_&&this.player.currentSource()&&this.player.currentSource().src&&!this.player.currentSource().isDynamicCachupAsLive&&!this.player.currentSource().isStaticCachupAsLive){var e=this.getBaseUrl(),i=this.getFullyQualifiedUrl(this.options_.src,e);this.getVttFile(i).then(function(e){t.vttData=t.processVtt(e),t.setupThumbnailElement()})}},t.getBaseUrl=function(){var e=E(this.player.currentSource().src);return E(e=e.replace(/\/$/,""))},t.getVttFile=function(r){var n=this;return new Promise(function(e,t){var i=new XMLHttpRequest;i.data={resolve:e},i.addEventListener("load",n.vttFileLoaded),i.open("GET",r),i.send()})},t.vttFileLoaded=function(){this.data.resolve(this.responseText)},t.setupThumbnailElement=function(e){var t=this,i=this.player.$(".vjs-mouse-display");this.progressBar=this.player.$(".vjs-progress-control");var r=G.createElement("div");r.setAttribute("class","vjs-vtt-thumbnail-display"),this.progressBar.appendChild(r),this.thumbnailHolder=r,i&&i.classList.add("vjs-hidden"),this.registeredEvents.progressBarMouseEnter=function(){return t.onBarMouseenter()},this.registeredEvents.progressBarMouseLeave=function(){return t.onBarMouseleave()},this.progressBar.addEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.addEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave)},t.onBarMouseenter=function(){var t=this;this.mouseMoveCallback=function(e){t.onBarMousemove(e)},this.registeredEvents.progressBarMouseMove=this.mouseMoveCallback,this.progressBar.addEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.showThumbnailHolder()},t.onBarMouseleave=function(){this.registeredEvents.progressBarMouseMove&&this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.hideThumbnailHolder()},t.getXCoord=function(e,t){var i=e.getBoundingClientRect(),r=G.documentElement;return t-(i.left+(d.pageXOffset||r.scrollLeft||0))},t.onBarMousemove=function(e){this.updateThumbnailStyle(this.getXCoord(this.progressBar,e.clientX),this.progressBar.offsetWidth)},t.getStyleForTime=function(e){for(var t=0;t<this.vttData.length;++t){var i=this.vttData[t];if(e>=i.start&&e<i.end)return i.css}},t.showThumbnailHolder=function(){this.thumbnailHolder.style.opacity="1"},t.hideThumbnailHolder=function(){this.thumbnailHolder.style.opacity="0"},t.updateThumbnailStyle=function(e,t){var i=(1-(t-e)/t)*this.player.duration(),r=this.getStyleForTime(i);if(r){var n=(1-(t-e)/t)*t;if(this.thumbnailHolder.style.msTransform="translateX("+n+"px)",this.thumbnailHolder.style.webkitTransform="translateX("+n+"px)",this.thumbnailHolder.style.MozTransform="translateX("+n+"px)",this.thumbnailHolder.style.transform="translateX("+n+"px)",this.thumbnailHolder.style.marginLeft="-"+parseInt(r.width,10)/2+"px",!this.lastStyle||this.lastStyle!==r)for(var o in this.lastStyle=r)r.hasOwnProperty(o)&&(this.thumbnailHolder.style[o]=r[o])}else this.hideThumbnailHolder()},t.processVtt=function(e){var a=this,l=[];return e.split(/[\r\n][\r\n]/i).forEach(function(e){if(e.match(/([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?( ?--> ?)([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?[\r\n]{1}.*/gi)){var t=e.split(/[\r\n]/i),i=t[0].split(/ ?--> ?/i),r=i[0],n=i[1],o=t[1],s=a.getVttCss(o);l.push({start:a.getSecondsFromTimestamp(r),end:a.getSecondsFromTimestamp(n),css:s})}}),l},t.getFullyQualifiedUrl=function(e,t){return 0<=e.indexOf("//")?e:0===t.indexOf("//")?[t.replace(/\/$/gi,""),this.trim(e,"/")].join("/"):0<t.indexOf("//")?[this.trim(t,"/"),this.trim(e,"/")].join("/"):e},t.getPropsFromDef=function(e){var t=e.split(/#xywh=/i),i=t[0],r=t[1].match(/[0-9]+/gi);return{x:r[0],y:r[1],w:r[2],h:r[3],image:i}},t.getVttCss=function(e){var t,i={};if(t=0<=this.options_.src.indexOf("//")?this.options_.src.split(/([^\/]*)$/gi).shift():this.getBaseUrl()+this.options_.src.split(/([^\/]*)$/gi).shift(),!(e=this.getFullyQualifiedUrl(e,t)).match(/#xywh=/i))return i.background='url("'+e+'")',i;var r=this.getPropsFromDef(e);return i.background='url("'+r.image+'") no-repeat -'+r.x+"px -"+r.y+"px",i.width=r.w+"px",i.height=r.h+"px",i},t.doconstructTimestamp=function(e){var t=e.split("."),i=t[0].split(":");return{milliseconds:parseInt(t[1],10)||0,seconds:parseInt(i.pop(),10)||0,minutes:parseInt(i.pop(),10)||0,hours:parseInt(i.pop(),10)||0}},t.getSecondsFromTimestamp=function(e){var t=this.doconstructTimestamp(e);return parseInt(3600*t.hours+60*t.minutes+t.seconds+t.milliseconds/1e3,10)},t.trim=function(e,t){var i=[" ","\n","\r","\t","\f","\v"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join(""),r=0,n=0;for(e+="",t&&(i=(t+"").replace(/([[\]().?/*{}+$^:])/g,"$1")),r=e.length,n=0;n<r;n++)if(-1===i.indexOf(e.charAt(n))){e=e.substring(n);break}for(n=(r=e.length)-1;0<=n;n--)if(-1===i.indexOf(e.charAt(n))){e=e.substring(0,n+1);break}return-1===i.indexOf(e.charAt(0))?e:""},l(e,[{key:"enabled",get:function(){return this.enabled_},set:function(e){this.enabled_=e}}]),e}(p.getPlugin("plugin"));function kt(e){if(e instanceof kt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:y(e)&&("number"==typeof e.code&&(this.code=e.code),e.message&&(this.message=e.message),e.status&&(this.status=e.status),g(this,e)),this.message||(this.message=kt.defaultMessages[this.code]||"")}Dt.VERSION="2.1.103-344",p.getPlugin("vttThumbnails")?p.log.warn('A plugin named "vttThumbnails" already exists.'):p.registerPlugin("vttThumbnails",Dt),kt.prototype.code=0,kt.prototype.message="",kt.prototype.status=null,kt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],kt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Lt=0;Lt<kt.errorTypes.length;Lt++)kt[kt.errorTypes[Lt]]=Lt,kt.prototype[kt.errorTypes[Lt]]=Lt;var Rt=p.getComponent("Player"),Nt=p.getComponent("Tech"),Mt=p.getComponent("CaptionSettingsMenuItem");d.vttjs&&d.vttjs.restore();var Bt=function(a){function s(e,t,i){var r;void 0===t&&(t={}),void 0===i&&(i=function(){}),t.absoluteStartTime&&(t.startTime=0),"auto"===(t=g({children:["mediaLoader","PosterImage","textTrackDisplay","loadingSpinner","empMediaInfoBar","controlBar","errorDisplay","textTrackSettings","BigPlayButton"]},t)).techOrder||Array.isArray(t.techOrder)&&1===t.techOrder.length&&"auto"===t.techOrder[0]?t.techOrder=s.AutoTechArray("EmpShaka"):"auto-dashif"===t.techOrder||Array.isArray(t.techOrder)&&1===t.techOrder.length&&"auto-dashif"===t.techOrder[0]?t.techOrder=s.AutoTechArray("EmpDashif"):Array.isArray(t.techOrder)&&(t.techOrder=s.GetValidAutoTechOrder(t.techOrder));var n=s.getTagSettings(e);if((t=p.mergeOptions({"entitlement-engine":"EricssonExposure",sources:n.sources?n.sources:void 0,techOrder:n.techOrder?n.techOrder:s.AutoTechArray("EmpShaka"),maxBitrate:n.maxBitrate?n.maxBitrate:0,timeShiftDisabled:!!n.timeShiftDisabled&&n.timeShiftDisabled,useLastViewedOffset:!!n.useLastViewedOffset&&n.useLastViewedOffset,startTime:n.startTime?n.startTime:0,absoluteStartTime:n.absoluteStartTime?n.absoluteStartTime:void 0,persistTextTrackSettings:n.persistTextTrackSettings?n.persistTextTrackSettings:!Ee,textTrackSettings:n.textTrackSettings?n.textTrackSettings:!Ee},t)).sources)for(var o=0;o<t.sources.length;o++){t.sources[o]=v(t.sources[o],{licenseserver:"licenseServer",certificateserver:"certificateServer",playtoken:"playToken",keysystems:"keySystems"}),T(t.sources[o].keySystems)&&(t.sources[o].keySystems=JSON.parse(t.sources[o].keySystems))}return(r=a.call(this,e,t,i)||this).monkeyPatchingTextMenu_(),d.empPlayer&&L.islogToBrowserConsole&&d.empPlayer.setInstance(u(r)),r.previousAbsoluteStartTime_=void 0,r.castPlugin&&r.castPlugin(),r.eme&&r.eme(),t.enableThumbnails&&r.vttThumbnails&&r.vttThumbnails(),r.on(x.ENDED,function(){L("ENDED"),r.ended_=!0,r.sourceChanging_=!1,r.stopProgramService(),r.entitlementExpirationService&&r.entitlementExpirationService().stop(),"EmpCast"!==r.techName_&&r.loadNextSource(),r.yospace&&r.yospace().stop()}),r.on(x.DISPOSE,function(){r.loadNextSrc_=null,r.loadingSrc_&&(clearInterval(r.loadingSrc_),r.loadingSrc_=null),r.sourceChanging_=!1,r.clearResetAndReloadTimer_(),r.stopProgramService(),r.entitlementExpirationService&&r.entitlementExpirationService().stop()}),r.on(x.ERROR,function(){r.loadNextSrc_=null,r.loadingSrc_&&(clearInterval(r.loadingSrc_),r.loadingSrc_=null),r.sourceChanging_=!1,r.clearResetAndReloadTimer_(),r.stopProgramService(),r.entitlementExpirationService&&r.entitlementExpirationService().stop(),r.yospace&&r.yospace().stop()}),r.on(x.CAN_PLAY,function(){r.disableTimeShift(r.options_.timeShiftDisabled)}),r.on(x.LOADED_DATA,function(){r.addClass("vjs-has-started"),r.ended_=!1}),r.on(x.REPLAY,function(){r.cache_&&r.cache_.source&&r.cache_.source.yospaceUrl?r.src({src:r.cache_.source.yospaceUrl,type:"application/yospace"}):r.cache_&&r.cache_.source&&r.src(r.cache_.source)}),r.on(x.FIRST_PLAY,function(){L("FIRST_PLAY"),r.options_.startTime&&"Html5"===r.techName_&&r.currentTime(r.options_.startTime),r.options_.startTime=0}),r.initialSeekToAbsoluteStartTimeBind=r.initialSeekToAbsoluteStartTime_.bind(u(r)),r.isCreated=!0,r.trigger(x.PLAYER_CREATED),r.ended_=!1,r.sourceChanging_=!1,r}c(s,a);var e=s.prototype;return e.monkeyPatchingTextMenu_=function(){if(this.controlBar&&this.controlBar.subsCapsButton){var r=this.controlBar.subsCapsButton.createItems,n=this;this.controlBar.subsCapsButton.createItems=function(){for(var e=r.apply(this,arguments),t=[],i=0;i<e.length;i++)e[i].track&&""!==e[i].track.label&&t.push(e[i]);return t&&1<t.length&&"CaptionSettingsMenuItem"!==t[0].name()&&"EmpHLS"===n.techName_&&n.options_.textTrackSettings?(t.unshift(new Mt(this.player_,{kind:this.label_})),this.hideThreshold_+=1):t&&1<t.length&&"CaptionSettingsMenuItem"===t[0].name()&&"EmpDashif"===n.techName_&&(t.shift(),this.hideThreshold_-=1),t}}if(ge){var e=p.getComponent("TextTrackMenuItem");if(e){var t=e.prototype.handleClick,i=this;e.prototype.handleClick=function(){t.apply(this,arguments),i.trigger(x.TRACK_CHANGE),i.trigger(x.TEXT_TRACK_CHANGE)}}}},e.options=function(e){return e&&("auto"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto"===e.techOrder[0]?e.techOrder=s.AutoTechArray("EmpShaka"):"auto-dashif"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto-dashif"===e.techOrder[0]?e.techOrder=s.AutoTechArray("EmpDashif"):Array.isArray(e.techOrder)&&(e.techOrder=s.GetValidAutoTechOrder(e.techOrder)),void 0!==e.startTime&&(e.startTime=parseFloat(e.startTime)||0),void 0!==e.absoluteStartTime&&(e.startTime=0),this.vttThumbnails&&void 0!==e.enableThumbnails&&(this.vttThumbnails().enabled=e.enableThumbnails||!1),this.options_=p.mergeOptions(this.options_,e)),this.options_},e.getTechOptions_=function(){var e={};return g(e,this.options_[this.techName_.toLowerCase()]),g(e,{autoplay:this.options_.autoplay,muted:this.options_.muted,language:this.options_.language,maxBitrate:this.options_.maxBitrate,timeShiftDisabled:this.options_.timeShiftDisabled,useLastViewedOffset:this.options_.useLastViewedOffset,startTime:this.options_.startTime,absoluteStartTime:this.options_.absoluteStartTime,audioLanguage:this.options_.audioLanguage,subtitleLanguage:this.options_.subtitleLanguage,liveDelay:this.options_.liveDelay}),e},e.loadTech_=function(e,t){var i=this;a.prototype.loadTech_.call(this,e,t),this.on(this.tech_,x.RECOVERABLE_ASSET_ERROR,this.handleRecoverableError),this.on(this.tech_,x.ERROR,function(e,t){i.player_.error(t)}),this.on(this.tech_,x.TRACK_CHANGE,function(){L("TRACK_CHANGE"),i.player_.trigger(x.TRACK_CHANGE)}),this.on(this.tech_,x.DURATION_CHANGE,function(){i.player_.trigger(x.DURATION_CHANGE)})},e.loadNextSource=function(){if(!this.sourceChanging_)return this.sourceChanging_=!0,this.tech_&&void 0!==this.tech_.loadNextSource?(this.techCall_("loadNextSource"),!0):this.cache_.sources&&1<this.cache_.sources.length?(this.cache_.sources.shift(),this.src(this.cache_.sources),!0):this.sourceChanging_=!1;L("loadNextSource ignore sourceChanging")},e.setTextTrackStyle=function(e){"EmpCast"===this.techName_?this.techCall_("sendTextTrackStyle",e):(this.options_.textTrackStyle=e,this.trigger(x.TEXT_TRACK_CHANGE))},e.lineUpAsset=function(e,t,i,r){var n={assetId:e,programId:i,channelId:t};r&&this.options({playFrom:"beginning",absoluteStartTime:r}),this.lineupSource({type:"video/emp",src:JSON.stringify(n)})},e.lineupSource=function(e){this.tech_&&void 0!==this.tech_.lineupSource?this.techCall_("lineupSource",e):this.cache_.sources.push(e)},e.unloadTech_=function(){this.techName_=null,a.prototype.unloadTech_.call(this),this.textTracksJson_=[]},e.stop=function(e){this.analytics&&this.analytics().stop(),this.yospace&&this.yospace().stop(),Y.stop(this,e)},e.getAvalibleTechs_=function(r){return this.options_.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,Nt.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];if(i&&"Html5"!==t&&"EmpCast"!==t&&-1===r.indexOf(t))return i.isSupported()})},e.selectSource=function(e){var t=this,i=this.options_.techOrder;if(this.options_.excludeTechs&&0<this.options_.excludeTechs.length){var r=this.options_.techOrder.filter(function(e){if(-1===t.options_.excludeTechs.indexOf(e))return!0});this.options_.techOrder=r}var n=a.prototype.selectSource.call(this,e);return this.options_.techOrder=i,n},e.handleRecoverableError=function(e,t){var i=[];this.options_.excludeTechs&&(i=this.options_.excludeTechs.slice(0)),i.push(t.techName);var r,n=this.getAvalibleTechs_(i);if(t.source&&!t.source.licenseServer&&(!t.source.keySystems||(r=t.source.keySystems,0===m(r).length))&&!t.source.protection&&!ue&&0<n.length&&(6001!==t.error.code&&(L.error("handleRecoverableError",t.techName,t.message),this.analytics&&this.analytics().onError({code:t.error.code,message:t.message,stack:t.error.stack})),this.options_.excludeTechs||(this.options_.excludeTechs=[]),this.options_.excludeTechs.push(t.techName),this.options_.techOrder.length>this.options_.excludeTechs.length)){if(this.error(null),this.resetWithoutReload_(),this.hasStarted()&&(this.options_.autoplay=!0),this.autoplay(this.options_.autoplay),this.options_.absoluteStartTime=this.previousAbsoluteStartTime_,t.source.assetId){var o={assetId:t.source.assetId};return void a.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(o)})}if(t.source.channelId){var s={channelId:t.source.channelId,programId:t.source.programId};return void a.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(s)})}}t.error.code&&t.error.message?this.error(t.error):(t.message=t.message||this.localize("Tech error, can't recover"),this.error(new k(t.message,t.error.code))),this.resetWithoutReload_()},e.resetWithoutReload_=function(){this.tech_&&(this.techCall_("reset"),this.unloadTech_())},e.resetAndRestartFormPlayhead=function(){var e=this.getProgramDetails();e&&Y.currentAsset(this,e.assetId,e.programId,e.channelId);var t=this.getAbsoluteTime();L("resetAndRestartFormPlayhead",t),this.reset(),this.startResetAndReloadTimer_(),this.restart(null,t)},e.bitrates=function(){return Y.bitrates(this)},e.bitrate=function(e){return Y.bitrate(this,e)},e.getBitrate=function(){return Y.getBitrate(this)},e.selectAudioTrack=function(e,t){for(var i=this.audioTracks(),r=i.length;r--;){var n=i[r];if(n.language===e&&!n.enabled)return void(t&&n.kind!==t||(n.enabled=!0))}},e.getSelectedAudioTrack=function(){return Y.getSelectedAudioTrack(this)},e.getAudioTracksLanguages=function(){for(var e=[],t=this.audioTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},e.selectTextTrack=function(e,t){e=e&&"None"!==e?e:null;for(var i=this.textTracks(),r=i.length;r--;){var n=i[r];n.language===e?t&&n.kind!==t||(n.mode="showing"):"disabled"!==n.mode&&(n.mode="disabled")}"EmpHLS"===this.techName_&&ge&&(this.trigger(x.TRACK_CHANGE),this.trigger(x.TEXT_TRACK_CHANGE))},e.getSelectedTextTrack=function(){return Y.getSelectedTextTrack(this)},e.textTrackVisible=function(e){for(var t=this.textTracks(),i=t.length;i--;){var r=t[i];if(e){if("hidden"===r.mode)return void(r.mode="showing")}else"showing"===r.mode?r.mode="hidden":"disabled"!==r.mode&&(r.mode="disabled")}},e.isTextTrackVisible=function(){for(var e=this.textTracks(),t=e.length;t--;){if("showing"===e[t].mode)return!0}return!1},e.getTextTracksLanguages=function(){for(var e=[],t=this.textTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},e.canSeekTo=function(e){return Y.canSeekTo(this,e)},e.getRestrictions=function(){var e={},t=Y.getEntitlement(this);return t&&(e={minBitrate:t.minBitrate,maxBitrate:t.maxBitrate,maxResWidth:t.maxResWidth,maxResHeight:t.maxResHeight,rwEnabled:t.rwEnabled,ffEnabled:t.ffEnabled}),e},e.isPlaying=function(){return this.hasStarted()},e.isLive=function(){return Y.isLive(this)},e.techVersion=function(){return Y.techVersion(this)},e.baseCurrentTime=function(){return Y.baseCurrentTime(this)},e.baseDuration=function(e){if(void 0===e)return Y.baseDuration(this);a.prototype.duration.call(this,e)},e.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";if(this.isCreated){var i=function t(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){e=t(e),Array.isArray(e)?i=i.concat(e):y(e)&&i.push(e)}),e=i}else e="string"==typeof e&&e.trim()?[{src:e}]:y(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[e]:[];return e}(e);if(i.length){if(i.forEach(function(e){e.type||(e.type="video/emp")}),"video/emp"===i[0].type){if(this.loadingSrc_)return L("load src blocked",e),void(this.loadNextSrc_=e);this.loadingSrc_=setTimeout(function(){t.loadingSrc_=null,t.loadNextSrc_&&t.src(t.loadNextSrc_)},3e3)}return this.loadNextSrc_=null,L("load src OK"),this.yospace&&this.yospace().stop(),this.options_.excludeTechs=[],this.tech_||this.reset(),this.cache_.currentTime=0,this.cache_.duration=NaN,this.error(null),"video/emp"!==i[0].type&&this.stopProgramService(),this.isPlaying()&&(this.sourceChanging_=!0),Y.casting(this,i)?void 0:(i[0].options&&this.options(i[0].options),"video/emp"!==i[0].type&&(i[0].options=this.getTechOptions_()),this.off(x.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),this.one(x.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),"application/yospace"===i[0].type&&this.yospace?void this.yospace().start("VoD",i[0].src).then(function(e){L("yospace mediaLocator returned",e),t.options_.excludeTechs.push("EmpShaka"),t.options_.excludeTechs.push("EmpDashif"),i[0]={src:e,type:"application/x-mpegURL",yospaceUrl:i[0].src},a.prototype.src.call(t,i)}).catch(function(e){t.error(e)}):a.prototype.src.call(this,i))}this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)}else this.one(x.PLAYER_CREATED,function(){t.src(e)})},e.reset=function(){this.clearResetAndReloadTimer_(),this.hasStarted(!1),a.prototype.reset.call(this)},e.clearResetAndReloadTimer_=function(){this.resetAndReloadTimer_&&(L("clearResetAndReloadTimer"),clearInterval(this.resetAndReloadTimer_),this.resetAndReloadTimer_=null)},e.startResetAndReloadTimer_=function(){var e=this;if(!(ue&&this.hasStarted()||(this.clearResetAndReloadTimer_(),L("startResetAndReloadTimer"),!1===this.options_.resetAndReloadLive))){var t=120;t=this.options_.resetAndReloadLive?1<this.options_.resetAndReloadLive?this.options_.resetAndReloadLive:1:ue?120:360,this.resetAndReloadTimer_=this.setTimeout(function(){e.clearResetAndReloadTimer_(),e.isLive()&&"DASH"===e.streamType&&e.resetAndRestartFormPlayhead()},1e3*t*60)}},e.initialSeekToAbsoluteStartTime_=function(){var e=Y.getEntitlement(this);this.options_.absoluteStartTime&&this.timeShiftEnabled()?(this.setAbsoluteTime(new Date(this.options_.absoluteStartTime)),this.previousAbsoluteStartTime_=this.options_.absoluteStartTime,this.options_.absoluteStartTime=void 0):this.options_.useLastViewedOffset&&e&&!this.isLive()&&"DASH"===this.streamType&&e.lastViewedOffset&&this.currentTime(e.lastViewedOffset/1e3)},e.setMaxBitrate=function(e){this.options_.maxBitrate=e,this.tech_&&void 0!==this.tech_.setMaxBitrate&&this.techCall_("setMaxBitrate",e)},e.getMaxBitrate=function(){return this.tech_&&void 0!==this.tech_.getMaxBitrate?this.techGet_("getMaxBitrate"):0},e.disableTimeShift=function(e){if(!this.tech_||void 0===this.tech_.disableTimeShift)return!1;if(void 0===e)return!Y.timeShiftEnabled(this);if(!1===e&&!this.canEnableTimeshift())return!Y.timeShiftEnabled(this);this.techCall_("disableTimeShift",e);var t=Y.timeShiftEnabled(this);return this.options_.timeShiftDisabled=void 0===t?e:!t,this.trigger(x.TIMESHIFT_CHANGE,{timeShiftDisabled:this.options_.timeShiftDisabled}),this.options_.timeShiftDisabled},e.canEnableTimeshift=function(){var e=Y.getEntitlement(this);return!e||!1!==e.timeshiftEnabled},e.timeShiftEnabled=function(e){if(void 0===e)return Y.timeShiftEnabled(this);this.disableTimeShift(!e)},e.noEPG=function(){if(this.getProgramDetails())return!1;var e=Y.getEntitlement(this);return!e||e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)},e.canRestart=function(){return!Y.getEntitlement(this)||!this.noEPG()&&Y.canRestart(this)},e.restart=function(e,t){Y.restart(this,e,t)},e.error=function(e){return void 0===e?this.error_||null:null!==e?this.error_&&e&&4===e.code?this.error_:(e&&T(e)?e=new k(e):y(e)&&!e.code&&(e.code=D.UNKNOWN),y(e)&&this.cache_.sources&&1<this.cache_.sources.length?(L.error(e),this.loadNextSource(),e):this.videojsError_(e)):void a.prototype.error.call(this,e)},e.videojsError_=function(e){if(void 0===e)return this.error_||null;if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new kt(e),this.addClass("vjs-error");var t="";kt.errorTypes.hasOwnProperty(this.error_.code)&&(t=kt.errorTypes[this.error_.code]),L.error("(CODE:"+this.error_.code+" "+t+")",this.error_.message,this.error_),this.trigger({type:x.ERROR,bubbles:!0},this.error_)},e.getError=function(){return this.error_},e.setAbsoluteTime=function(e){Y.setAbsoluteTime(this,e)},e.getAbsoluteTime=function(){return Y.getAbsoluteTime(this)},e.playheadTime=function(e){if(void 0===e)return Y.getPlayheadTime(this);Y.setPlayheadTime(this,e)},e.setAnalyticsCustomAttribute=function(e,t){this.options_.analytics||(this.options_.analytics={}),this.options_.analytics.customAttributes||(this.options_.analytics.customAttributes=[]),this.options_.analytics.customAttributes.push({key:e,value:t})},e.loadAsset=function(e,t,i){if(void 0===i&&(i=function(){}),L.warn("loadAsset() has been deprecated with new US a/v pipe use startPlayback() or src() instead"),this.options({playFrom:void 0}),!e&&t)return L.error("loadAsset: with only programId is not supported"),void i();Y.loadAsset(this,t?void 0:e,t,t?e:void 0,i)},e.startPlaybackV2=function(e,t){this.startPlayback(e,"","",t)},e.startPlayback=function(e,t,i,r){if(r||(r={}),e||t||i)if(e||t||!i){r.playFrom||(r.playFrom="defaultBehaviour");var n={playFrom:r.playFrom,autoplay:!0};void 0!==r.autoplay&&(n.autoplay=r.autoplay),n.autoplay&&this.autoplay(n.autoplay),r.startTime&&"startTime"===r.playFrom?(n.absoluteStartTime=r.startTime,this.options_.useLastViewedOffset=!1):n.absoluteStartTime=void 0,void 0!==r.startOffset?n.startTime=r.startOffset/1e3:n.startTime=0,n.useLastViewedOffset="bookmark"===r.playFrom||!0===this.options_.useLastViewedOffset,this.options(n),Y.loadAsset(this,e,i,t)}else L.error("startPlayback: with only programId is not supported");else L.error("startPlayback: assetId or channelId or programId is undefined")},e.playEntitlement=function(e){e&&y(e)?(e.type="video/emp",a.prototype.src.call(this,e)):L.error("Call playEntitlement without entitlement")},e.timeBehindLive=function(){return Y.timeBehindLive(this)},e.liveDelay=function(){return Y.liveDelay(this)},e.startTimeLive=function(){return Y.startTimeLive(this)},e.driftingTime=function(){return Y.driftingTime(this)},e.getCurrentTechName=function(){return this.techName_},e.getExposure=function(){return this.programService?this.programService().exposure:null},e.syncServerTime=function(e){if(this.programService){var t=this.programService().exposure;if(t)return void t.syncServerTime(e)}var i="No programService or No exposure";L.error(i),e&&e(0,i)},e.stopProgramService=function(){this.programService&&this.programService().reset()},e.startProgramService=function(){this.programService&&this.programService().start()},e.supportsEpgProgramChange=function(){return void 0!==this.programService},e.getServerTime=function(){return Y.getServerTime(this)},e.getProgram=function(e){if(this.programService){var t=this.getProgramDetails();e(t,t?null:"No EPG for program")}},e.getProgramDetails=function(){return Y.supportsEpgProgramChange(this)?Y.program(this):this.programService?this.programService().currentProgram:void 0},e.getAssetDetails=function(){return this.tech_&&this.tech_.VOD?this.techGet_("VOD"):this.programService?this.programService().currentVOD:void 0},e.getSeekTimerange=function(){return Y.getSeekTimerange(this)},e.getBufferedTimerange=function(){return Y.getBufferedTimerange(this)},e.currentTime=function(e){var t=Y.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i){e<1&&-1<e&&(e=1);var r=new Date(i.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var n=t.streamInfo;if((e+=(r.getTime()-n.start.getTime())/1e3)<=0)return e=0,void Y.playPreviousProgram(this,!0)}else if(1e3*(e+=r.getTime()/1e3)<=t.streamInfo.start.getTime())return e=t.streamInfo.start.getTime()/1e3+1,void Y.playPreviousProgram(this,!0)}return e<0&&(e=0),void this.techCall_("setCurrentTime",e)}var o=this.techGet_("currentTime")||0,s=this.getProgramDetails();if(s&&1<o){var a=new Date(s.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var l=t.streamInfo;o-=(a.getTime()-l.start.getTime())/1e3}else o-=a.getTime()/1e3}else s||this.duration(1/0);return this.scrubbing()||(this.cache_.currentTime=o),this.cache_.currentTime}return void 0!==e?(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"===this.techName_||(e=e<0?0:e),void this.techCall_("setCurrentTime",e)):(this.scrubbing()||(this.cache_.currentTime=this.techGet_("currentTime")||0),this.cache_.currentTime)},e.duration=function(e){var t=Y.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i&&e!==1/0){var r=new Date(i.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var n=t.streamInfo;e-=(r.getTime()-n.start.getTime())/1e3}else e-=r.getTime()/1e3}return this.noEPG()&&(e=1/0,this.addClass("vjs-live")),void a.prototype.duration.call(this,e)}var o=this.techGet_("duration"),s=this.getProgramDetails();return s&&o!==1/0&&(o=s.duration/1e3),this.noEPG()&&(o=1/0,this.addClass("vjs-live")),this.cache_.duration=o}return a.prototype.duration.call(this,e),this.techGet_("duration")},e.seekable=function(){var e=a.prototype.seekable.call(this);return"EmpCast"!==this.techName_?this.getRange_(e):e},e.buffered=function(){var e=a.prototype.buffered.call(this);return"EmpCast"!==this.techName_?this.getRange_(e):e},e.getRange_=function(e){var t=Y.getEntitlement(this);if(this.seeking()||!e)return nt(0,0);if(0<e.length&&t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)){var i=this.getProgramDetails();if(i){var r=new Date(i.startTime),n=t.streamInfo,o=e.start(e.length-1),s=e.end(e.length-1);if(s)if(t.isStaticCachupAsLive||"HLS"===this.streamType)e=nt(0<(o-=(r.getTime()-n.start.getTime())/1e3)?o:0,(s-=(r.getTime()-n.start.getTime())/1e3)>this.duration()?this.duration():s);else if(t.isDynamicCachupAsLive){o-=r.getTime()/1e3,s-=r.getTime()/1e3;var a=this.getGrowingLiveDuration();e=nt(0<o?o:0,a<s?a:s)}}}return e},e.getGrowingLiveDuration=function(){var e=Y.getEntitlement(this),t=this.duration(),i=this.getProgramDetails();if(i&&t!==1/0&&e&&e.isDynamicCachupAsLive)if(this.getServerTime()<new Date(i.endTime).getTime()){if((t=this.techGet_("duration"))!==1/0){var r=e.streamInfo;t="HLS"===this.streamType?(r.start.getTime()+1e3*t-i.start.getTime())/1e3:(1e3*t-i.start.getTime())/1e3}}else t=i.duration/1e3;return t},e.remainingTime=function(){var e=Y.getEntitlement(this),t=0;if(e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){var i=this.duration();if(i===1/0||0===i)return 1/0;t=i-this.currentTime()}else t=Y.remainingTime(this);return t<0&&(t=0),Math.round(t)},e.gotoLive=function(){Y.gotoLive(this)},e.playPreviousProgram=function(i){var r=this;if(this.sourceChanging_)L("playPreviousProgram ignore sourceChanging");else if(this.tech_.playPreviousProgram)this.techCall_("playPreviousProgram",i);else{var e=Y.getEntitlement(this);this.programService&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.rwEnabled?this.programService().getPreviousProgram(function(e,t){t?L.warn("playPreviousProgram",t):i?r.playheadTime(e.end.getTime()-3e4):r.playheadTime(e.start.getTime()+1e3)}):Y.playPreviousProgram(this)}},e.playNextProgram=function(){if(this.sourceChanging_)L("playNextProgram ignore sourceChanging");else if(this.tech_.playNextProgram)this.techCall_("playNextProgram");else{var e=Y.getEntitlement(this),t=this.getProgramDetails();t&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.ffEnabled?this.playheadTime(t.end.getTime()+1e3):Y.playNextProgram(this)}},e.isProgramLive=function(){var e=this.getProgramDetails();return e?e.end.getTime()>this.getServerTime():this.isLive()},e.isProgramCatchup=function(){var e=Y.getEntitlement(this);return e?e.isStaticCachupAsLive||!this.isProgramLive()&&e.isDynamicCachupAsLive:!this.isLive()},e.currentAsset=function(){return Y.currentAsset(this)},e.ended=function(){return this.ended_},e.handleTechWaiting_=function(){var t=this;!this.hasStarted()||this.ended()||this.paused()||this.hasClass("vjs-waiting")||this.playheadMoving_(function(e){e||(t.addClass("vjs-waiting"),t.trigger(x.WAITING),t.removeWaitingClass_())})},e.removeWaitingClass_=function(){var e=this;this.one("timeupdate",function(){1<e.playheadTime()-e.prePlayheadTime_||e.playheadTime()-e.prePlayheadTime_<-1?(e.prePlayheadTime_=0,e.removeClass("vjs-waiting"),e.paused()?e.trigger(x.PAUSE):e.trigger(x.PLAYING)):e.removeWaitingClass_()})},e.playheadMoving_=function(e){this.playheadMovingTimer_&&(clearInterval(this.playheadMovingTimer_),this.playheadMovingTimer_=null),this.prePlayheadTime_=this.playheadTime(),this.playheadMovingTimer_=this.setTimeout(function(){e(200<this.playheadTime()-this.prePlayheadTime_||this.playheadTime()-this.prePlayheadTime_<-200)},2e3)},e.handleTechCanPlay_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(x.CAN_PLAY)},e.handleTechCanPlayThrough_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(x.CAN_PLAY_THROUGH)},e.handleTechPlaying_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.sourceChanging_=!1,this.trigger(x.PLAYING)},e.sourceChanging=function(){return this.sourceChanging_},e.isCasting=function(){return"EmpCast"===this.techName_},l(s,[{key:"version",get:function(){return"2.1.103-344"}},{key:"entitlement",get:function(){var e=Y.getEntitlement(this);return e&&((e=g({},e)).options=void 0),e}},{key:"streamType",get:function(){if(this.tech_)return this.tech_.streamType}}]),s}(Rt);Bt.AutoTechArray=function(e){var t=Nt.techs_.hasOwnProperty("EmpShaka"),i=Nt.techs_.hasOwnProperty("EmpDashif");t&&i||(e=t?"EmpShaka":"EmpDashif");var r=[e,"EmpHLS-MSE","EmpHLS","Html5"];return Bt.SupportFairplay()&&(r=["EmpHLS",e,"Html5"]),Bt.GetValidAutoTechOrder(r)},Bt.GetValidAutoTechOrder=function(e){for(var t=[],i=0;i<e.length;i++)Nt.techs_.hasOwnProperty(e[i])&&t.push(e[i]);return t},Bt.SupportFairplay=function(){var e=p.getTech("EmpHLS");return!!(void 0!==e&&e.isSupported()&&d.WebKitMediaKeys&&e.getKeySystem&&d.WebKitMediaKeys.isTypeSupported(e.getKeySystem(),"video/mp4"))},p.getComponent("Component").registerComponent("Player",Bt);var Ut=function(){function e(e,t,i){this.INITIAL_REFERENCE_TIME=1,this.player_=e,this.analytics_=t,this.sessionId_=null,this.customAttributes=i.analytics&&i.analytics.customAttributes,this.exposure=i.exposure,this.currentTimeTimer=null,this.onPlayBind=this.onPlay.bind(this),this.onResumedBind=this.onResume.bind(this),this.onPlayingBind=this.onPlaying.bind(this),this.onPauseBind=this.onPause.bind(this),this.onEndedBind=this.onEnded.bind(this),this.onErrorBind=this.onError.bind(this),this.onDrmSessionUpdateBind=this.onDrmSessionUpdate.bind(this),this.onEntitlementLoadStartBind=this.onEntitlementLoadStart.bind(this),this.onBitrateChangeBind=this.onBitrateChange.bind(this),this.onDisposeBind=this.onDispose.bind(this),this.onLoadStartBind=this.onLoadStart.bind(this),this.onSeekedBind=this.onSeeked.bind(this),this.onWaitingBind=this.onWaiting.bind(this),this.onChromeCastingStartBind=this.onChromeCastingStart.bind(this),this.onChromeCastingStopBind=this.onChromeCastingStop.bind(this),this.onProgramChangeBind=this.onProgramChange.bind(this),this.onWaitingEndedBind=this.onWaitingEnded.bind(this),this.onErrorBeforeAssetBind=this.onErrorBeforeAsset.bind(this),this.onEntitlementChangeBind=this.onEntitlementChange.bind(this),this.onWindowUnloadBind=this.onWindowUnload.bind(this),this.onPlayingAfterStartBind=this.onPlayingAfterStart.bind(this),this.allEvents_=Object.keys(x).map(function(e){return x[e]}),this.init(),this.createdSessions={},this.mem={}}var t=e.prototype;return t.SessionId=function(e){if(!(e||this.entitlement()&&this.entitlementLoaded_))return this.errorSessionId;var t=e||this.entitlement().playSessionId;return this.mem[t]||(this.mem[t]={pause:{},resume:{}}),t},t.hasSessionId=function(){return!(!this.entitlement()||!this.entitlementLoaded_)},t.sendCurrentTime=function(){var e=this.SessionId();e&&this.player_&&this.analytics_.getSessionState&&"PLAYING"===this.analytics_.getSessionState(e)&&this.analytics_.setCurrentTime(e,this.OffsetTime())},t.registerCurrentTimeTimer=function(){var t=this;this.clearTimers(),this.currentTimeTimer=setInterval(function(){t.sendCurrentTime();var e=t.SessionId();e&&t.analytics_&&t.analytics_.ok&&!1===t.analytics_.ok(e)&&(t.exposure?t.exposure.verifySession(null,function(){t.player_.el_&&(t.player_.trigger(x.ERROR,"401 INVALID_SESSION_TOKEN: The session token is no longer valid."),Y.stop(t.player_)),t.clearTimers()}):L.error("registerCurrentTimeTimer Exposure is undefined"))},1e3)},t.clearTimers=function(){this.currentTimeTimer&&clearInterval(this.currentTimeTimer),this.currentTimeTimer=null},t.init=function(){this.player_&&this.analytics_?(this._errorSessionId=null,this.disabled_=!1,this.entitlementLoaded_=!1,L("Initialization EmpAnalytics"),this.analytics_.init(),d.addEventListener("beforeunload",this.onWindowUnloadBind),this.player_.on(x.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.on(x.PAUSE,this.onPauseBind),this.player_.on(x.SEEKED,this.onSeekedBind),this.player_.on(x.ENDED,this.onEndedBind),this.player_.on(x.ERROR,this.onErrorBind),this.player_.on(x.DISPOSE,this.onDisposeBind),this.player_.on(x.STOPPED,this.onDisposeBind),this.player_.on(x.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.on(x.WAITING,this.onWaitingBind),this.player_.on(x.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.on(x.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.on(x.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.on(x.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)):L.warn("Warning: init failed . Possible causes: either player or analytics were not set.")},t.onWindowUnload=function(){var e=this;this.onGeneric("WindowClose",this.analytics_.dispose,function(){!0===e.hasSessionId()&&e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.analytics_.dispatchNow(!1),e.clearTimers()},!0)},t.onChromeCastingStart=function(){var t=this;this.onGeneric("StartCasting",this.analytics_.startCasting,function(){if(!1!==t.hasSessionId()){if(t.SessionId()){var e=t.getCachedCurrentTime();L("StartCasting",e),t.analytics_.startCasting(t.SessionId(),e)}t.clearTimers()}},!1),this.disabled_=!0},t.onChromeCastingStop=function(e){var t=this;this.disabled_=!1,e&&this.onGeneric("StopCasting",this.analytics_.stopCasting,function(){!1!==t.hasSessionId()&&t.analytics_.stopCasting(t.SessionId(),t.OffsetTime())},!1)},t.onProgramChange=function(e,t){var i=this,r=t?t.program:null;L("analytics","onProgramChange",r),r&&this.analytics_.programChanged&&this.player_.hasStarted()&&this.onGeneric("ProgramChange",this.analytics_.programChanged,function(){i.analytics_.programChanged(i.SessionId(),i.OffsetTime(),{programId:r.programId})},!0)},t.onEntitlementChange=function(e,t,r){var n=this;this.entitlementLoaded_=!0,this.player_.off(x.ERROR,this.onErrorBeforeAssetBind);var o=this.entitlement(t&&t.entitlement);this.onGeneric("HandShake",this.analytics_.handshake,function(){var e={};if(o&&o.assetId&&(e.assetId=o.assetId),o&&o.programId&&(e.programId=o.programId),!o){var t=Y.currentAsset(n.player_);t&&(e.assetId=t.assetId,e.channelId=t.channelId,e.programId=t.programId)}var i=o?o.playSessionId:r;n.analytics_.handshake(n.SessionId(i),e),n.onLoadStart(i)},!1)},t.onEntitlementLoadStart=function(){var e=this;this.entitlementLoaded_=!1,this.onGeneric("ExitOngoingSession",this.analytics_.exitOngoingSession,function(){return e.analytics_.exitOngoingSession(e.getCachedCurrentTime())}),this.player_.one(x.ERROR,this.onErrorBeforeAssetBind),this.player_.one(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},t.onLoadStart=function(e){var i=this,r=e||this.SessionId();r?this.sessionCreated(r)||(this.createdSessions[r]=!0,this.onGeneric("Created",this.analytics_.created,function(){var e=i.player_.options(),t={version:i.playerVersion};e&&e.autoplay&&(t.autoplay=e.autoplay),i.entitlement()&&i.entitlement().requestId&&(t.requestId=i.entitlement().requestId),i.analytics_.created(r,t)},!1),this.player_.off(x.PLAYING,this.onResumedBind),this.player_.off(x.PLAYING,this.onPlayingAfterStartBind),this.player_.one(x.PLAYING,this.onPlayingAfterStartBind)):L("onLoadStart called but not session available.")},t.onPlayingAfterStart=function(){this.onPlayBind(),this.onPlayingBind(),this.player_.on(x.PLAYING,this.onResumedBind)},t.onBitrateChange=function(){var t=this;this.onGeneric("BitrateChange",this.analytics_.bitrateChanged,function(){var e={bitrate:Math.max(0,Math.round(t.getBitrate()/1e3))};t.analytics_.bitrateChanged(t.SessionId(),t.OffsetTime(),e)},!0)},t.onWaiting=function(){var t=this;this.onGeneric("StartWaiting",this.analytics_.waiting,function(){t.player_.hasStarted()&&t.analytics_.waiting(t.SessionId(),t.OffsetTime()),t.allEvents_.map(function(e){e!==x.PLAY&&e!==x.PLAYING&&e!==x.ENDED&&e!==x.ERROR&&e!==x.DISPOSE&&e!==x.SEEKED&&e!==x.CHROMECAST_CASTING&&e!==x.CHROMECAST_STOPPED||t.player_.one(e,t.onWaitingEndedBind)})},!0)},t.OffsetTime=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)?Y.getPlayheadTime(this.player_)/1e3:Y.baseCurrentTime(this.player_)},t.startTimeLive=function(){return Y.startTimeLive(this.player_)},t.isLive=function(){return Y.isLive(this.player_)},t.getBitrate=function(){return Y.getBitrate(this.player_)},t.duration=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)&&this.player_.getProgramDetails&&this.player_.getProgramDetails()?this.player_.getProgramDetails().duration/1e3:Y.duration(this.player_)},t.entitlement=function(e){return void 0===e?Y.getEntitlement(this.player_)||this.entitlement_:this.entitlement_=e},t.onWaitingEnded=function(){var t=this;this.allEvents_.map(function(e){t.player_.off(e,t.onWaitingEndedBind)}),this.onGeneric("WaitingEnded",this.analytics_.waitingEnded,function(){t.analytics_.waitingEnded(t.SessionId(),t.OffsetTime())},!0)},t.onDispose=function(e,t){var i=this;this.onGeneric("Dispose",this.analytics_.dispose,function(){!1!==i.hasSessionId()&&(i.analytics_.dispose(i.SessionId(),i.getCachedCurrentTime()),i.clearTimers())},!0,!0)},t.getCachedCurrentTime=function(){if(this.player_){var e=this.player_.getCache().currentTime,t=this.OffsetTime();return t||e}},t.onEnded=function(){var e=this;this.onGeneric("End of Stream",this.analytics_.endOfStream,function(){e.analytics_.endOfStream(e.SessionId()),e.clearTimers()},!0,!0)},t.onPlay=function(){var i=this;this.onGeneric("Play",this.analytics_.play,function(){var e="Unknown";switch(i.player_.techName_){case"EmpShaka":e="Shaka";break;case"EmpDashif":e="DashIf";break;case"EmpHLS":e="NativeHLS";break;case"EmpHLS-MSE":e="HLS-MSE"}var t={techName:e,version:i.playerVersion,techVersion:i.techVersion};i.analytics_.play(i.SessionId(),i.OffsetTime(),t),i.registerCurrentTimeTimer()},!1)},t.onPlaying=function(){var t=this;this.onGeneric("Playing",this.analytics_.playing,function(){var e={};e.bitrate=Math.max(0,Math.round(t.getBitrate()/1024)),!0===t.isLive()?e.referenceTime=t.startTimeLive():e.duration=t.duration(),t.entitlement()&&t.entitlement().mediaLocator&&(e.mediaLocator=t.entitlement().mediaLocator),e.mediaLocator&&0<=e.mediaLocator.indexOf(".isml")&&(e.referenceTime=t.INITIAL_REFERENCE_TIME),t.analytics_.clearCustomAttributes(),(t.customAttributes||[]).map(function(e){t.analytics_.setCustomAttribute(e.key,e.value)}),t.analytics_.playing(t.SessionId(),t.OffsetTime(),e)},!1)},t.onSeeked=function(){var e=this;this.onGeneric("Seeked",this.analytics_.seek,function(){e.analytics_.seek(e.SessionId(),e.OffsetTime())},!0)},t.onPause=function(){var i=this;this.onGeneric("Pause",this.analytics_.paused,function(){if(!1!==i.player_.hasStarted()){var e=i.SessionId(),t=parseInt((new Date-0)/25,10);i.mem[e].pause[t]||(i.mem[e].pause[t]=!0,i.analytics_.paused(e,i.OffsetTime()))}},!0)},t.onResume=function(){var i=this;this.onGeneric("Resume",this.analytics_.resume,function(){var e=i.SessionId(),t=parseInt((new Date-0)/25,10);i.mem[e].resume[t]||(i.mem[e].resume[t]=!0,i.analytics_.resume(e,i.OffsetTime()))},!0)},t.onErrorBeforeAsset=function(){this.entitlementLoaded_=!1,this.onEntitlementChange(null,null,this.errorSessionId),this.onError(null,this.errorSessionId),this.clearTimers()},t.onError=function(o,s){var a=this;void 0===o&&(o=null),void 0===s&&(s=null),(s||this.entitlementLoaded_)&&this.onGeneric("Error",this.analytics_.error,function(){var e=a.player_.error(),t={};e&&e.code&&(t.errorCode=e.code),e&&e.message&&(t.errorMessage=e.message),e&&e.status&&(t.errorDetails=e.status+""),e&&e.stack&&(t.errorDetails=t.errorDetails?t.errorDetails+"\n"+e.stack.toString():e.stack.toString());var i=a.player_.options();if(a.player_.tech_){var r="EmpShaka"===a.player_.techName_&&i&&i.empshaka?i.empshaka.streamType:"";t.errorInfo=a.player_.techName_+(r?"-"+r:"")}else t.errorInfo="Unknown tech, techOrder: "+i.techOrder.toString();!e&&o&&(t.errorCode=o.code,t.errorMessage=o.message?o.message:"Browser Error",o.status&&(t.errorDetails=o.status+""),o.stack&&(t.errorDetails=t.errorDetails?t.errorDetails+"\n"+o.stack.toString():o.stack.toString()));var n=a.SessionId();(n||s)&&a.analytics_.error(n||s,a.OffsetTime(),t),a.clearTimers()},!1)},t.onDrmSessionUpdate=function(e,t){var i=this;L("onDrmSessionUpdate",e,t),this.onGeneric("DrmSessionUpdate",this.analytics_.drmSessionUpdate,function(){i.analytics_.drmSessionUpdate(i.SessionId(),{message:t.messageType,code:t.code,info:t.info})},!0)},t.onGeneric=function(e,t,i,r,n){void 0===n&&(n=!1),!this.disabled_||n?r&&!this.sessionCreated(this.SessionId())?L(e+" was discarded."):t&&i&&i():L(e+" not delivered: analytics disabled.")},t.sessionCreated=function(e){return e&&this.createdSessions[e]},t.dispose=function(){this.clearTimers(),this.analytics_&&(this.analytics_.exitOngoingSession(this.getCachedCurrentTime()),this.analytics_.dispatchNow(!1)),d.removeEventListener("beforeunload",this.onWindowUnloadBind),this.player_.off(x.PLAY,this.onPlayBind),this.player_.off(x.PLAYING,this.onPlayingBind),this.player_.off(x.PLAYING,this.onResumedBind),this.player_.off(x.PAUSE,this.onPauseBind),this.player_.off(x.SEEKED,this.onSeekedBind),this.player_.off(x.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.off(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player_.off(x.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.off(x.ENDED,this.onEndedBind),this.player_.off(x.DISPOSE,this.onDisposeBind),this.player_.off(x.STOPPED,this.onDisposeBind),this.player_.off(x.ERROR,this.onErrorBind),this.player_.off(x.ERROR,this.onErrorBeforeAssetBind),this.player_.off(x.WAITING,this.onWaitingBind),this.player_.off(x.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.off(x.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.off(x.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.off(x.PLAYING,this.onPlayingAfterStartBind),this.player_.off(x.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},l(e,[{key:"techVersion",get:function(){return Y.techVersion(this.player_)}},{key:"playerVersion",get:function(){return this.player_.version?this.player_.version:d.videojs?d.videojs.VERSION:"2.x.x"}},{key:"errorSessionId",get:function(){return this._errorSessionId||(this._errorSessionId="error-"+Math.random().toString().split(".")[1]),this._errorSessionId}}]),e}(),Ft=e(i(function(e,t){e.exports=function o(s,a,l){function c(i,e){if(!a[i]){if(!s[i]){var t=h;if(!e&&t)return t(i,!0);if(u)return u(i,!0);var r=new Error("Cannot find module '"+i+"'");throw r.code="MODULE_NOT_FOUND",r}var n=a[i]={exports:{}};s[i][0].call(n.exports,function(e){var t=s[i][1][e];return c(t||e)},n,n.exports,o,s,a,l)}return a[i].exports}for(var u=h,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,i,t){(function(e){var t;t="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},i.exports=t}).call(this,void 0!==a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){var r,n;r=this,n=function(e,t){var i=new Blob(['!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,r){"use strict";r.r(t);r(1)},function(e,t,r){!function(){"use strict";var w=new Map,T=new Map,b=function(e,t){var r,n;if("performance"in self){var o=performance.now(),i=Math.max(0,o-t);r=o,n=e-i}else r=Date.now(),n=e;var a=r+n;return{expected:a,remainingDelay:n}},M=function e(t,r,n,o){var i="performance"in self?performance.now():Date.now();n<i?postMessage({id:null,method:"call",params:{timerId:r,timerType:o}}):t.set(r,setTimeout(e,n-i,t,r,n,o))};addEventListener("message",function(e){var t,r,n,o,i,a,u,s,c=e.data;try{if("clear"===c.method){var l=c.id,d=c.params,f=d.timerId,p=d.timerType;if("interval"===p)!function(e){var t=w.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),w.delete(e)}(f),postMessage({error:null,id:l});else{if("timeout"!==p)throw new Error(\'The given type "\'.concat(p,\'" is not supported\'));!function(e){var t=T.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),T.delete(e)}(f),postMessage({error:null,id:l})}}else{if("set"!==c.method)throw new Error(\'The given method "\'.concat(c.method,\'" is not supported\'));var m=c.params,v=m.delay,h=m.now,g=m.timerId,y=m.timerType;if("interval"===y)i=g,a=b(v,h),u=a.expected,s=a.remainingDelay,w.set(i,setTimeout(M,s,w,i,u,"interval"));else{if("timeout"!==y)throw new Error(\'The given type "\'.concat(y,\'" is not supported\'));t=g,r=b(v,h),n=r.expected,o=r.remainingDelay,T.set(t,setTimeout(M,o,T,t,n,"timeout"))}}}catch(e){postMessage({error:{message:e.message},id:c.id,result:null})}})}()}]);'],{type:"application/javascript; charset=utf-8"}),r=URL.createObjectURL(i),n=t.load(r),o=n.clearInterval,s=n.clearTimeout,a=n.setInterval,l=n.setTimeout;URL.revokeObjectURL(r),e.clearInterval=o,e.clearTimeout=s,e.setInterval=a,e.setTimeout=l,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof i&&void 0!==t?n(i,e("worker-timers-broker")):n(r.workerTimers={},r.workerTimersBroker)},{"worker-timers-broker":3}],3:[function(e,t,i){var r,n;r=this,n=function(e,n){e.load=function(e){var g=new Map,y=new Map,v=new Map,r=new Worker(e);return r.addEventListener("message",function(e){var t,i,r=e.data;if(void 0!==(i=r).method&&"call"===i.method){var n=r.params,o=n.timerId,s=n.timerType;if("interval"===s){var a=g.get(o);if("number"==typeof a){var l=v.get(a);if(void 0===l||l.timerId!==o||l.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===a)throw new Error("The timer is in an undefined state.");a()}}else if("timeout"===s){var c=y.get(o);if("number"==typeof c){var u=v.get(c);if(void 0===u||u.timerId!==o||u.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===c)throw new Error("The timer is in an undefined state.");c(),y.delete(o)}}}else{if(null!==(t=r).error||"number"!=typeof t.id){var h=r.error.message;throw new Error(h)}var p=r.id,d=v.get(p);if(void 0===d)throw new Error("The timer is in an undefined state.");var m=d.timerId,f=d.timerType;v.delete(p),"interval"===f?g.delete(m):y.delete(m)}}),{clearInterval:function(e){var t=n.generateUniqueNumber(v);v.set(t,{timerId:e,timerType:"interval"}),g.set(e,t),r.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=n.generateUniqueNumber(v);v.set(t,{timerId:e,timerType:"timeout"}),y.set(e,t),r.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,t){var i=n.generateUniqueNumber(g);return g.set(i,function(){e(),"function"==typeof g.get(i)&&r.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}})}),r.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}}),i},setTimeout:function(e,t){var i=n.generateUniqueNumber(y);return y.set(i,e),r.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"timeout"}}),i}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof i&&void 0!==t?n(i,e("fast-unique-numbers")):n(r.workerTimersBroker={},r.fastUniqueNumbers)},{"fast-unique-numbers":4}],4:[function(e,t,i){var r,n,o,s,a,l;r=this,n="object"==typeof i&&void 0!==t?i:r.fastUniqueNumbers={},o=new WeakMap,s=Number.MAX_SAFE_INTEGER||9007199254740991,a=function(e,t){return o.set(e,t),t},l=function(e){var t=o.get(e),i=void 0===t?e.size:2147483648<t?0:t+1;if(!e.has(i))return a(e,i);if(e.size<1073741824){for(;e.has(i);)i=Math.floor(2147483648*Math.random());return a(e,i)}if(e.size>s)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(i);)i=Math.floor(Math.random()*s);return a(e,i)},n.addUniqueNumber=function(e){var t=l(e);return e.add(t),t},n.generateUniqueNumber=l,Object.defineProperty(n,"__esModule",{value:!0})},{}],5:[function(e,t,i){function r(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0;var n=function(){function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}}(),o=e("global/window"),s=r(o),a=e("./platform"),l=r(a),c=e("worker-timers"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(c),h=function(){function a(e,t,i,r,n){var o=arguments.length<=5||void 0===arguments[5]?{}:arguments[5],s=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.CYCLE_TIME=1e3,this.EVENT_PURGE_TIME_DEFAULT=3*this.CYCLE_TIME,this.TIME_WITHOUT_BEAT_DEFAULT=60*this.CYCLE_TIME,this.SERVER_URL_DEFAULT="",this.CUSTOMER_DEFAULT="",this.BUSINESS_UNIT_DEFAULT="",this.INCLUDE_DEVICE_METRICS_DEFAULT=!0,this.SESSION_TOKEN_DEFAULT="",this.SESSION_ID_DEFAULT="",this.DEBUG_DEFAULT=!1,this.MAX_RETRIES=20,this.DEVICE_CLOCK_CHECK_THRESHOLD=3e5,this.eventsSkeleton=this.initEventSkeleton(),this.customer_=t,this.businessUnit_=i,this.sessionToken_=r,this.serverURL_=e,this.includeDeviceMetrics_=!1,this.userId_=n,this.deviceInfoData_=o,this.props_=s||{},this.pendingRequest_=!1}return a.prototype.init=function(){var e=this;this.cycleTimer&&("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?u.clearInterval(this.cycleTimer):clearInterval(this.cycleTimer)),"undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?this.cycleTimer=u.setInterval(function(){return e.cycle()},this.CYCLE_TIME):this.cycleTimer=setInterval(function(){return e.cycle()},this.CYCLE_TIME),this.communicationCurrentTime=0,this.lastCommunicationTime=0,this.eventPool={}},a.prototype.clear=function(){this.eventPool={}},a.prototype.ok=function(e){var t=this.eventPool[e];return!!t&&!1===t.forbidden&&t.retries<this.MAX_RETRIES},a.prototype.created=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.addEventToPool(e,{type:"Created"},t)},a.prototype.play=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"PlayerReady",currentTime:t};this.deviceAppInfo&&(i.deviceAppInfo=this.deviceAppInfo),this.addEventToPool(e,r,i)},a.prototype.playing=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"Started",currentTime:t};if(this.customAttributes){var n=Object.keys(this.customAttributes);n.length&&0<n.length&&(i.attributes=this.customAttributes)}this.addEventToPool(e,r,i),this.changeSessionState(e,"PLAYING")},a.prototype.paused=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"Paused",currentTime:t};this.addEventToPool(e,r,i,!0)},a.prototype.seek=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"ScrubbedTo",currentTime:t};this.addEventToPool(e,r,i,!0)},a.prototype.programChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"ProgramChanged",currentTime:t};this.addEventToPool(e,r,i,!0)},a.prototype.startCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"StartCasting",currentTime:t};this.addEventToPool(e,r,i,!0),this.changeSessionState(e,"FINISHED")},a.prototype.stopCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"StopCasting",currentTime:t};this.addEventToPool(e,r,i,!0),this.changeSessionState(e,"FINISHED")},a.prototype.setCurrentTime=function(e,t){this.eventPool[e]&&(this.eventPool[e].currentTime=t)},a.prototype.handshake=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.addEventToPool(e,{type:"HandshakeStarted"},t)},a.prototype.resume=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"Resumed",currentTime:t};this.addEventToPool(e,r,i,!0)},a.prototype.bitrateChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"BitrateChanged",currentTime:t};this.addEventToPool(e,r,i,!0)},a.prototype.drmSessionUpdate=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.addEventToPool(e,{type:"DRM"},t,!0)},a.prototype.endOfStream=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.addEventToPool(e,{type:"Completed"},t,!0),this.changeSessionState(e,"FINISHED")},a.prototype.error=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"Error",currentTime:t};this.addEventToPool(e,r,i),this.changeSessionState(e,"FINISHED")},a.prototype.dispose=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.eventPool[e];if(r&&"FINISHED"!==r.currentState){var n={type:"Aborted"};t&&(n.currentTime=t),this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")}},a.prototype.waiting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"BufferingStarted",currentTime:t};this.addEventToPool(e,r,i)},a.prototype.waitingEnded=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r={type:"BufferingEnded",currentTime:t};this.addEventToPool(e,r,i)},a.prototype.getSessionState=function(e){return this.eventPool[e]&&this.eventPool[e].currentState||"IDLE"},a.prototype.dispatchNow=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.cycle(e,!0)},a.prototype.exitOngoingSession=function(t){var i=this,e=Object.keys(this.eventPool);e.map(function(e){i.eventPool[e]&&i.dispose(e,t)})},a.prototype.setCustomAttribute=function(e,t){this.customAttributes||this.resetAnalyticsCustomAttributes(),this.customAttributes[e]=t},a.prototype.clearCustomAttributes=function(){this.customAttributes={}},a.prototype.removeSession=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!0===t)delete this.eventPool[e];else{var i=this.eventPool[e];i&&(i.currentState="REMOVED")}},a.prototype.hasDataToSend=function(){for(var e=Object.keys(this.eventPool),t=0;t<e.length;++t)if(0<this.eventPool[e[t]].events.length)return!0;return!1},a.prototype.sendData=function(){var o=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0],i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!this.pendingRequest_){var s=!1;this.pendingRequest_=!0;var a=void 0;a="undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?u.setTimeout(function(){o.pendingRequest_=!1,a=void 0},2*this.EVENT_PURGE_TIME_DEFAULT):setTimeout(function(){o.pendingRequest_=!1,a=void 0},2*this.EVENT_PURGE_TIME_DEFAULT);var e=Object.keys(this.eventPool);e.map(function(r){var n=o.eventPool[r];if(n){if(!r)return n.events=[],void o.removeSession(r,!0);if("PLAYING"===n.currentState&&0===n.events.length&&i&&n.events.push({EventType:"Playback.Heartbeat",Timestamp:(new Date).getTime(),OffsetTime:Math.floor(1e3*n.currentTime)}),"IDLE"!==n.currentState&&"REMOVED"!==n.currentState){if(0===n.events.length)return void("FINISHED"===n.currentState&&o.removeSession(r));var e={DispatchTime:(new Date).getTime(),Customer:o.customer_,BusinessUnit:o.businessUnit_,Payload:n.events,SessionId:r,ClockOffset:n.clockOffset};if(o.debugLog("Sending analytics - sessionId: "+r+" and params: ",e),n.retries>o.MAX_RETRIES||!0===n.forbidden)return void(n.events=[]);Math.abs(o.communicationCurrentDate-o.lastCommunicationDate)>o.DEVICE_CLOCK_CHECK_THRESHOLD&&o.initRequest(r).then(function(){}),s=!0,o.sendRequest(t,e,function(e,t){if(a)try{a="undefined"!=typeof Worker&&!0!==o.props_.disableWebWorkers?void u.clearTimeout(a):void clearTimeout(a)}catch(e){}o.pendingRequest_=!1;var i=e&&e.httpCode?e.httpCode:200;void 0!==t||200!==i?(401===i&&(n.forbidden=!0),o.debugLog("Error sending request to backend",t),n.retries++):(n.events=[],n.retries=0,"FINISHED"===n.currentState&&o.removeSession(r))})}}}),s||(this.pendingRequest_=!1)}},a.prototype.cycle=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.communicationCurrentDate=new Date,this.communicationCurrentTime+=this.CYCLE_TIME,this.hasDataToSend()?(t||this.lastCommunicationTime+this.EVENT_PURGE_TIME_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate):(t||this.lastCommunicationTime+this.TIME_WITHOUT_BEAT_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e,!0),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate)},a.prototype.sendRequest=function(e,t,i){var r=new XMLHttpRequest;r.open("POST",this.serverURL_+"/eventsink/send",!0),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("Authorization","Bearer "+this.sessionToken_),r.onload=function(){var e=JSON.parse(this.responseText);i(e)},r.onerror=function(e){i(null,e)},r.send(JSON.stringify(t))},a.prototype.initRequest=function(o){var s=this;return new Promise(function(i,t){var r=(new Date).getTime(),n=new XMLHttpRequest;n.open("POST",s.serverURL_+"/eventsink/init",!0),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Authorization","Bearer "+s.sessionToken_),n.onload=function(){var e=(new Date).getTime(),t=JSON.parse(n.responseText);s.determineClockOffset(o,t,r,e),t&&t.settings&&(t.settings,t.settings.includeDeviceMetrics&&(s.includeDeviceMetrics_=!!t.settings.includeDeviceMetrics)),i()},n.onerror=function(e){s.debugLog("Unable to init. Aborting."),t(e)};var e={Customer:s.customer_,BusinessUnit:s.businessUnit_,SessionId:o};n.send(JSON.stringify(e))})},a.prototype.debugLog=function(e,t){t=t||"",this.debug_},a.prototype.addDeviceInfoEvent=function(e){var t=this.eventPool[e];if(this.includeDeviceMetrics_&&t&&t.events&&t.events.length){var i={Timestamp:(new Date).getTime(),EventType:"Device.Info",DeviceModel:this.deviceInfoData_.deviceModel||"Desktop",UserAgent:this.deviceInfoData_.userAgent||s.default.navigator.userAgent,Height:this.deviceInfoData_.screenHeight||s.default.screen.height,Width:this.deviceInfoData_.screenWidth||s.default.screen.width,Model:this.deviceInfoData_.model||s.default.navigator.appName,Name:this.deviceInfoData_.deviceName||s.default.navigator.product,OS:this.deviceInfoData_.deviceOS||l.default.os.family,OSVersion:this.deviceInfoData_.deviceOSVersion||l.default.os.version,Type:this.deviceInfoData_.type||"WEB"};(this.deviceInfoData_.deviceManufacturer||l.default.manufacturer)&&(i.Manufacturer=this.deviceInfoData_.deviceManufacturer||l.default.manufacturer),this.deviceInfoData_.deviceId&&(i.DeviceId=this.deviceInfoData_.deviceId),t.events.push(i)}},a.prototype.determineClockOffset=function(e,t,i,r){var n=this.eventPool[e];n&&(n.clockOffset=Math.floor((r-t.repliedTime+i-t.receivedTime)/2))},a.prototype.createPool=function(i){var r=this;return new Promise(function(e,t){r.eventPool[i]={currentState:"IDLE",currentTime:0,clockOffset:0,events:[],retries:0,forbidden:!1},r.initRequest(i).then(function(){r.addDeviceInfoEvent(i),e()}).catch(function(e){t(e)})})},a.prototype.addEventToPool=function(e,t,i){var r,n=this,o=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];o&&this.eventPool[e]&&("FINISHED"===this.eventPool[e].currentState||"REMOVED"===this.eventPool[e].currentState)||(this.eventPool[e]||(r=this.createPool(e)),r?r.then(function(){n.internalAddEventToPool(e,t,i)}):this.internalAddEventToPool(e,t,i))},a.prototype.internalAddEventToPool=function(e,t,i){var r=this.eventsSkeleton[t.type];if(r){var n={Timestamp:(new Date).getTime(),EventType:"Playback."+r.event};r.includeOffset&&(n.OffsetTime=Math.floor(1e3*t.currentTime)),r.attributes&&"function"==typeof r.attributes&&(n=this.objectAssign(n,r.attributes(i))),this.eventPool[e].events.push(n),this.debugLog("added "+r.event+" to queue")}else this.debugLog("Unknown playback event: ",t)},a.prototype.changeSessionState=function(e,t){var i,r=this;this.eventPool[e]||(i=this.createPool(e)),i?i.then(function(){r.eventPool[e].currentState=t}):this.eventPool[e].currentState=t},a.prototype.initEventSkeleton=function(){var e={Completed:{event:"Completed",autoListener:!1}};return e.PlayerReady={event:"PlayerReady",autoListener:!1,attributes:function(e){var t={Technology:e.techName,PlayerVersion:e.version};return e.techVersion&&(t.TechVersion=e.techVersion),t.AnalyticsVersion=a.VERSION,e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.Resumed={event:"Resumed",autoListener:!1,includeOffset:!0},e.BufferingStarted={event:"BufferingStarted",includeOffset:!0},e.BufferingEnded={event:"BufferingEnded",includeOffset:!0},e.ScrubbedTo={event:"ScrubbedTo",includeOffset:!0},e.Created={event:"Created",attributes:function(e){var t={};return void 0!==e.autoplay&&(t.AutoPlay=e.autoplay),e.techName&&(t.Technology=e.techName),e.player&&(t.Player=e.player),e.version&&(t.Version=e.version),e.requestId&&(t.RequestId=e.requestId),e.techVersion&&(t.TechVersion=e.techVersion),e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.StartCasting={event:"StartCasting",includeOffset:!0},e.StopCasting={event:"StopCasting",includeOffset:!0},e.Paused={event:"Paused",includeOffset:!0},e.BitrateChanged={event:"BitrateChanged",includeOffset:!0,attributes:function(e){return{Bitrate:e.bitrate}}},e.DRM={event:"DRM",includeOffset:!1,attributes:function(e){var t={};return e.message&&(t.Message=e.message),e.code&&(t.Code=e.code),e.info&&(t.Info=e.info),t}},e.Error={event:"Error",includeOffset:!0,attributes:function(e){var t={};return e.errorCode&&(t.Code=e.errorCode),e.errorMessage?t.Message=e.errorMessage:t.Message="Unknown Error",e.errorInfo&&(t.Info=e.errorInfo),e.errorDetails&&(t.Details=e.errorDetails),t}},e.HandshakeStarted={event:"HandshakeStarted",autoListener:!1,attributes:function(e){if(!e.assetId)return{};var t={AssetId:e.assetId};return e.programId&&(t.ProgramId=e.programId),t}},e.ProgramChanged={event:"ProgramChanged",includeOffset:!0,autoListener:!1,attributes:function(e){return e.programId?{ProgramId:e.programId}:{}}},e.Aborted={event:"Aborted",autoListener:!1,includeOffset:!0},e.Started={event:"Started",autoListener:!1,includeOffset:!0,attributes:function(e){var t={};return e.bitrate&&(t.Bitrate=e.bitrate),e.duration&&(t.VideoLength=1e3*e.duration),e.mediaLocator&&(t.MediaLocator=e.mediaLocator),e.attributes&&(t.Attributes=e.attributes),e.referenceTime&&(t.ReferenceTime=e.referenceTime),e.playMode&&(t.PlayMode=e.playMode),t}},e},a.prototype.objectAssign=function(e,t){for(var i,r,n=1;n<arguments.length;++n)for(i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},n(a,[{key:"debug",get:function(){return this.debug_},set:function(e){this.debug_=e}},{key:"deviceAppInfo",get:function(){return this.deviceInfoData_?this.deviceInfoData_.deviceAppInfo:null}}]),a}();h.VERSION="2.0.93-7",i.default=h,t.exports=i.default},{"./platform":6,"global/window":1,"worker-timers":2}],6:[function(e,c,u){(function(l){(function(){function t(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function R(e){return e=H(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:t(e)}function N(e,t){for(var i in e)a.call(e,i)&&t(e[i],i,e)}function M(e){return null==e?t(e):q.call(e).slice(8,-1)}function B(e,t){var i=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!e[t])}function U(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function F(i,r){var n=null;return function(e,t){var i=-1,r=e?e.length:0;if("number"==typeof r&&-1<r&&r<=o)for(;++i<r;)t(e[i],i,e);else N(e,t)}(i,function(e,t){n=r(n,e,t,i)}),n}function H(e){return String(e).replace(/^ +| +$/g,"")}function j(a){function e(e){return F(e,function(e,t){var i=t.pattern||U(t);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(a)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(a))&&((e=String(t.label&&!RegExp(i,"i").test(t.label)?t.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),t=t.label||t,e=R(e[0].replace(RegExp(i,"i"),t).replace(RegExp("; *(?:"+t+"[_-])?","i")," ").replace(RegExp("("+t+")[-_.]?(\\w)","i"),"$1 $2"))),e})}var t=G,i=a&&"object"==typeof a&&"String"!=M(a);i&&(t=a,a=null);var r=t.navigator||{},n=r.userAgent||"";a||(a=n);var o,s,l,c=i||W==V,u=i?!!r.likeChrome:/\bChrome\b/.test(a)&&!/internal|\n/i.test(q.toString()),h="Object",p=i?h:"ScriptBridgingProxyObject",d=i?h:"Environment",m=i&&t.java?"JavaPackage":M(t.java),f=i?h:"RuntimeObject",g=/\bJava/.test(m)&&t.java,y=g&&M(t.environment)==d,v=g?"a":"α",T=g?"b":"β",_=t.document||{},E=t.operamini||t.opera,b=$.test(b=i&&E?E["[[Class]]"]:M(E))?b:E=null,S=a,C=[],A=null,I=a==n,w=I&&E&&"function"==typeof E.version&&E.version(),P=F([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,t){return e||RegExp("\\b"+(t.pattern||U(t))+"\\b","i").exec(a)&&(t.label||t)}),x=F(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox Mobile",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,t){return e||RegExp("\\b"+(t.pattern||U(t))+"\\b","i").exec(a)&&(t.label||t)}),O=e([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),D=F({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}},function(e,t,i){return e||(t[O]||t[/^[a-z]+(?: +[a-z]+\b)*/i.exec(O)]||RegExp("\\b"+U(i)+"(?:\\b|\\w*\\d)","i").exec(a))&&i}),k=F(["Windows Phone ","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,t){var i,r,n,o,s=t.pattern||U(t);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(a))&&(i=e,r=s,n=t.label||t,o={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"7 / Server 2008 R2","6.0":"Vista / Server 2008",5.2:"XP 64-bit / Server 2003",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},r&&n&&/^Win/i.test(i)&&!/^Windows Phone /i.test(i)&&(o=o[/[\d.]+$/.exec(i)])&&(i="Windows "+o),i=String(i),r&&n&&(i=i.replace(RegExp(r,"i"),n)),e=i=R(i.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});if(P&&(P=[P]),D&&!O&&(O=e([D])),(o=/\bGoogle TV\b/.exec(O))&&(O=o[0]),/\bSimulator\b/i.test(a)&&(O=(O?O+" ":"")+"Simulator"),"Opera Mini"==x&&/\bOPiOS\b/.test(a)&&C.push("running in Turbo/Uncompressed mode"),/^iP/.test(O)?(x||(x="Safari"),k="iOS"+((o=/ OS ([\d_]+)/i.exec(a))?" "+o[1].replace(/_/g,"."):"")):"Konqueror"!=x||/buntu/i.test(k)?D&&"Google"!=D&&(/Chrome/.test(x)&&!/\bMobile Safari\b/i.test(a)||/\bVita\b/.test(O))?(x="Android Browser",k=/\bAndroid\b/.test(k)?k:"Android"):"Silk"==x?(/\bMobi/i.test(a)||(k="Android",C.unshift("desktop mode")),/Accelerated *= *true/i.test(a)&&C.unshift("accelerated")):"PaleMoon"==x&&(o=/\bFirefox\/([\d.]+)\b/.exec(a))?C.push("identifying as Firefox "+o[1]):"Firefox"==x&&(o=/\b(Mobile|Tablet|TV)\b/i.exec(a))?(k||(k="Firefox OS"),O||(O=o[1])):x&&!(o=!/\bMinefield\b/i.test(a)&&/\b(?:Firefox|Safari)\b/.exec(x))||(x&&!O&&/[\/,]|^[^(]+?\)/.test(a.slice(a.indexOf(o+"/")+8))&&(x=null),(o=O||D||k)&&(O||D||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(k))&&(x=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(k)?k:o)+" Browser")):k="Kubuntu",w||(l=["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",U(x),"(?:Firefox|Minefield|NetFront)"],w=F(l,function(e,t){return e||(RegExp(t+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(a)||0)[1]||null})),(o=("iCab"==P&&3<parseFloat(w)?"WebKit":/\bOpera\b/.test(x)&&(/\bOPR\b/.test(a)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(a)&&!/^(?:Trident|EdgeHTML)$/.test(P)&&"WebKit"||!P&&/\bMSIE\b/i.test(a)&&("Mac OS"==k?"Tasman":"Trident")||"WebKit"==P&&/\bPlayStation\b(?! Vita\b)/i.test(x)&&"NetFront")&&(P=[o]),"IE"==x&&(o=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(a)||0)[1])?(x+=" Mobile",k="Windows Phone "+(/\+$/.test(o)?o:o+".x"),C.unshift("desktop mode")):/\bWPDesktop\b/i.test(a)?(x="IE Mobile",k="Windows Phone 8.x",C.unshift("desktop mode"),w||(w=(/\brv:([\d.]+)/.exec(a)||0)[1])):"IE"!=x&&"Trident"==P&&(o=/\brv:([\d.]+)/.exec(a))&&(x&&C.push("identifying as "+x+(w?" "+w:"")),x="IE",w=o[1]),I){if(B(t,"global"))if(g&&(o=g.lang.System,S=o.getProperty("os.arch"),k=k||o.getProperty("os.name")+" "+o.getProperty("os.version")),c&&B(t,"system")&&(o=[t.system])[0]){k||(k=o[0].os||null);try{o[1]=t.require("ringo/engine").version,w=o[1].join("."),x="RingoJS"}catch(e){o[0].global.system==t.system&&(x="Narwhal")}}else"object"==typeof t.process&&(o=t.process)?(x="Node.js",S=o.arch,k=o.platform,w=/[\d.]+/.exec(o.version)[0]):y&&(x="Rhino");else M(o=t.runtime)==p?(x="Adobe AIR",k=o.flash.system.Capabilities.os):M(o=t.phantom)==f?(x="PhantomJS",w=(o=o.version||null)&&o.major+"."+o.minor+"."+o.patch):"number"==typeof _.documentMode&&(o=/\bTrident\/(\d+)/i.exec(a))&&(w=[w,_.documentMode],(o=+o[1]+4)!=w[1]&&(C.push("IE "+w[1]+" mode"),P&&(P[1]=""),w[1]=o),w="IE"==x?String(w[1].toFixed(1)):w[0]);k=k&&R(k)}w&&(o=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(w)||/(?:alpha|beta)(?: ?\d)?/i.exec(a+";"+(I&&r.appMinorVersion))||/\bMinefield\b/i.test(a)&&"a")&&(A=/b/i.test(o)?"beta":"alpha",w=w.replace(RegExp(o+"\\+?$"),"")+("beta"==A?T:v)+(/\d+\+?/.exec(o)||"")),"Fennec"==x||"Firefox"==x&&/\b(?:Android|Firefox OS)\b/.test(k)?x="Firefox Mobile":"Maxthon"==x&&w?w=w.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(O)?(k=null,"Xbox 360"==O&&/\bIEMobile\b/.test(a)&&C.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(x)&&(!x||O||/Browser|Mobi/.test(x))||"Windows CE"!=k&&!/Mobi/i.test(a)?"IE"==x&&I&&null===t.external?C.unshift("platform preview"):(/\bBlackBerry\b/.test(O)||/\bBB10\b/.test(a))&&(o=(RegExp(O.replace(/ +/g," *")+"/([.\\d]+)","i").exec(a)||0)[1]||w)?(o=[o,/BB10/.test(a)],k=(o[1]?(O=null,D="BlackBerry"):"Device Software")+" "+o[0],w=null):this!=N&&"Wii"!=O&&(I&&E||/Opera/.test(x)&&/\b(?:MSIE|Firefox)\b/i.test(a)||"Firefox"==x&&/\bOS X (?:\d+\.){2,}/.test(k)||"IE"==x&&(k&&!/^Win/.test(k)&&5.5<w||/\bWindows XP\b/.test(k)&&8<w||8==w&&!/\bTrident\b/.test(a)))&&!$.test(o=j.call(N,a.replace($,"")+";"))&&o.name&&(o="ing as "+o.name+((o=o.version)?" "+o:""),$.test(x)?(/\bIE\b/.test(o)&&"Mac OS"==k&&(k=null),o="identify"+o):(o="mask"+o,x=b?R(b.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(o)&&(k=null),I||(w=null)),P=["Presto"],C.push(o)):x+=" Mobile",(o=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(a)||0)[1])&&(o=[parseFloat(o.replace(/\.(\d)$/,".0$1")),o],"Safari"==x&&"+"==o[1].slice(-1)?(x="WebKit Nightly",A="alpha",w=o[1].slice(0,-1)):w!=o[1]&&w!=(o[2]=(/\bSafari\/([\d.]+\+?)/i.exec(a)||0)[1])||(w=null),o[1]=(/\bChrome\/([\d.]+)/i.exec(a)||0)[1],537.36==o[0]&&537.36==o[2]&&28<=parseFloat(o[1])&&"WebKit"==P&&(P=["Blink"]),o=I&&(u||o[1])?(P&&(P[1]="like Chrome"),o[1]||((o=o[0])<530?1:o<532?2:o<532.05?3:o<533?4:o<534.03?5:o<534.07?6:o<534.1?7:o<534.13?8:o<534.16?9:o<534.24?10:o<534.3?11:o<535.01?12:o<535.02?"13+":o<535.07?15:o<535.11?16:o<535.19?17:o<536.05?18:o<536.1?19:o<537.01?20:o<537.11?"21+":o<537.13?23:o<537.18?24:o<537.24?25:o<537.36?26:"Blink"!=P?"27":"28")):(P&&(P[1]="like Safari"),(o=o[0])<400?1:o<500?2:o<526?3:o<533?4:o<534?"4+":o<535?5:o<537?6:o<538?7:o<601?8:"8"),P&&(P[1]+=" "+(o+="number"==typeof o?".x":/[.+]/.test(o)?"":"+")),"Safari"==x&&(!w||45<parseInt(w))&&(w=o)),"Opera"==x&&(o=/\bzbov|zvav$/.exec(k))?(x+=" ",C.unshift("desktop mode"),"zvav"==o?(x+="Mini",w=null):x+="Mobile",k=k.replace(RegExp(" *"+o+"$"),"")):"Safari"==x&&/\bChrome\b/.exec(P&&P[1])&&(C.unshift("desktop mode"),x="Chrome Mobile",w=null,k=/\bOS X\b/.test(k)?(D="Apple","iOS 4.3+"):null),w&&0==w.indexOf(o=/[\d.]+$/.exec(k))&&-1<a.indexOf("/"+o+"-")&&(k=H(k.replace(o,""))),P&&!/\b(?:Avant|Nook)\b/.test(x)&&(/Browser|Lunascape|Maxthon/.test(x)||"Safari"!=x&&/^iOS/.test(k)&&/\bSafari\b/.test(P[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(x)&&P[1])&&(o=P[P.length-1])&&C.push(o),C.length&&(C=["("+C.join("; ")+")"]),D&&O&&O.indexOf(D)<0&&C.push("on "+D),O&&C.push((/^on /.test(C[C.length-1])?"":"on ")+O),k&&(o=/ ([\d.+]+)$/.exec(k)||(s=/^[a-z]+ ([\d.+]+) \//i.exec(k)),k={architecture:32,family:o&&!s?k.replace(o[0],""):k,version:o?o[1]:null,toString:function(){var e=this.version;return this.family+(e&&!s?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(o=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(S))&&!/\bi686\b/i.test(S)&&(k&&(k.architecture=64,k.family=k.family.replace(RegExp(" *"+o),"")),x&&(/\bWOW64\b/i.test(a)||I&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(a))&&C.unshift("32-bit")),a||(a=null);var L={};return L.description=a,L.layout=P&&P[0],L.manufacturer=D,L.name=x,L.prerelease=A,L.product=O,L.ua=a,L.version=x&&w,L.os=k||{architecture:null,family:null,version:null,toString:function(){return"null"}},L.parse=j,L.toString=function(){return this.description||""},L.version&&C.unshift(w),L.name&&C.unshift(x),k&&x&&(k!=String(k).split(" ")[0]||k!=x.split(" ")[0]&&!O)&&C.push(O?"("+k+")":"on "+k),C.length&&(L.description=C.join(" ")),L}var e={function:!0,object:!0},G=e[typeof window]&&window||this,V=G,i=e[typeof u]&&u,r=e[typeof c]&&c&&!c.nodeType&&c,n=i&&r&&"object"==typeof l&&l;!n||n.global!==n&&n.window!==n&&n.self!==n||(G=n);var o=Math.pow(2,53)-1,$=/\bOpera/,W=this,s=Object.prototype,a=s.hasOwnProperty,q=s.toString;i&&r?N(j(),function(e,t){i[t]=e}):G.platform=j()}).call(void 0)}).call(this,void 0!==a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[5])(5)})),Ht=d.empAnalytics?d.empAnalytics:Ft,jt=function(n){function e(e,t){var i;i=n.call(this,e,t)||this,L("AnalyticsPlugin","create"),i.analyticsConnector_=null,i.options_=t,i.onLoadStartBind=i.onLoadStart_.bind(u(i)),i.player.on(x.LOAD_START,i.onLoadStartBind);var r=function(){var e,t=d.navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([0-9.]+)/i)||[];if(/trident/i.test(i[1]))return{name:"Explorer",version:(e=/\brv[ :]+([0-9.]+)/g.exec(t)||[])[1]||""};if("Chrome"!==i[1]||null===(e=t.match(/\b(OPR|Edge)\/([0-9.]+)/)))return i=i[2]?[i[1],i[2]]:[d.navigator.appName,d.navigator.appVersion,"-?"],null!==(e=t.match(/version\/([0-9.]+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]};var r=e.slice(1).toString().split(",");return{name:r[0].replace("OPR","Opera"),version:r[1]}}();return i.options_=i.options_?i.options_:{},i.options_.analytics=i.options_.analytics?i.options_.analytics:{},i.options_.analytics.deviceInfo=i.options_.analytics.deviceInfo?i.options_.analytics.deviceInfo:{},i.options_.analytics.deviceInfo=p.mergeOptions({deviceName:r.name,model:r.version},i.options_.analytics.deviceInfo),i}c(e,n);var t=e.prototype;return t.stop=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.dispose(),this.analyticsConnector_=null)},t.stopCasting=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.onChromeCastingStop(!0),this.analyticsConnector_=null)},t.dispose=function(){L("AnalyticsPlugin","dispose"),this.player.off(x.LOAD_START,this.onLoadStartBind),this.stop(),n.prototype.dispose.call(this)},t.options=function(e){if(!e)return this.options_;this.options_=p.mergeOptions(this.options_,e)},t.newAnalytics=function(e){L("new EMPAnalytics");var t=new Ht(e.exposureApiURL,e.customer,e.businessUnit,e.sessionToken,e.userId,this.options_.analytics&&this.options_.analytics.deviceInfo);this.stop(),L("new EMPAnalyticsConnector"),this.analyticsConnector_=new Ut(this.player,t,this.options_)},t.onEntitlementLoadStart=function(){this.analyticsConnector_&&this.analyticsConnector_.onEntitlementLoadStart()},t.onError=function(e){this.analyticsConnector_&&this.analyticsConnector_.onError(e)},t.onWindowUnload=function(){this.analyticsConnector_&&this.analyticsConnector_.onWindowUnload()},t.onLoadStart_=function(e){Y.getEntitlement(this.player)||this.stop()},t.version=function(){return Ht?Ht.VERSION:n.prototype.version.call(this)},l(e,[{key:"connector",get:function(){return this.analyticsConnector_}}]),e}(p.getPlugin("plugin"));jt.VERSION="2.1.103-344",p.getPlugin("analytics")?p.log.warn('A plugin named "analytics" already exists.'):p.registerPlugin("analytics",jt);var Gt=function(o){function e(e){var t,i;void 0===e&&(e={});var r=!0,n=D.ENTITLEMENT2;return"string"==typeof e?i=e:e instanceof Object&&(i=e.message,!1===e.fatal&&(r=e.fatal),e.code&&(n=e.code)),(t=o.call(this,i)||this).fatal=r,t.code=n,t}return c(e,o),l(e,[{key:"fatal",get:function(){return!!this.fatal_},set:function(e){this.fatal_=e}}]),e}(e(i(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,i){for(var r=!0;r;){var n=e,o=t,s=i;r=!1,null===n&&(n=Function.prototype);var a=Object.getOwnPropertyDescriptor(n,o);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(s)}var c=Object.getPrototypeOf(n);if(null===c)return;e=c,t=o,i=s,r=!0,a=c=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),Object.defineProperty(this,"message",{enumerable:!1,value:e,writable:!0}),Object.defineProperty(this,"name",{enumerable:!1,value:this.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):Object.defineProperty(this,"stack",{enumerable:!1,value:new Error(e).stack,writable:!0})}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=i,e.exports=t.default}))),Vt=function(){function r(e){void 0===e&&(e={}),this.options_=e}var e=r.prototype;return e.getEntitlement=function(e,t,i){throw new Gt("EntitlementEngine: getEntitlement should be implemented in subclass.")},e.getV2Entitlement=function(e,t,i,r){throw new Gt("EntitlementEngine: getV2Entitlement should be implemented in subclass.")},e.getV2Asset_=function(e,t,i,r){throw void 0===r&&(r=function(){}),new Gt("EntitlementEngine: getV2Asset_ should be implemented in subclass.")},e.getServerTime=function(e){throw new Gt("EntitlementEngine: getServerTime should be implemented in subclass.")},e.syncServerTime=function(i){this.getServerTime(function(e,t){t&&(L.error("getServerTime",t),e=new Date),r.ServerTimeDiff_=e-new Date,L("serverDiff",r.ServerTimeDiff_),i&&i(r.ServerTimeDiff_,t)})},e.getCachedServerTime=function(){return void 0!==r.ServerTimeDiff_?Date.now()+r.ServerTimeDiff_:Date.now()},e.getPreferences=function(e){throw new Gt("EntitlementEngine: getPreferences should be implemented in subclass.")},e.savePreferences=function(e,t){throw new Gt("EntitlementEngine: savePreferences should be implemented in subclass.")},e.getProgramInfo=function(e,t,i,r){throw new Gt("EntitlementEngine: getProgramInfo should be implemented in subclass.")},e.getEPG=function(e,t,i,r){throw new Gt("EntitlementEngine: getEPG should be implemented in subclass.")},e.getAssetInfo=function(e,t){throw new Gt("EntitlementEngine: getAssetInfo should be implemented in subclass.")},e.getChannelInfo=function(e,t){throw new Gt("EntitlementEngine: getChannelInfo should be implemented in subclass.")},e.verifySession=function(e,t){throw new Gt("EntitlementEngine: verifySession should be implemented in subclass.")},e.verifyEntitlement=function(e,t,i){throw new Gt("EntitlementEngine: verifyEntitlement should be implemented in subclass.")},e.login=function(e,t,i,r){throw new Gt("EntitlementEngine: login should be implemented in subclass.")},e.logout=function(e){throw new Gt("EntitlementEngine: logout should be implemented in subclass.")},e.fetchPreferences=function(e){throw new Gt("EntitlementEngine: fetchPreferences should be implemented in subclass.")},e.savePreferences=function(e,t){throw new Gt("EntitlementEngine: savePreferences should be implemented in subclass.")},r.isEntitlementEngine=function(e){return e.prototype instanceof r||e instanceof r||e===r},r.registerEntitlementEngine=function(e,t){if(r.engines_||(r.engines_={}),!r.isEntitlementEngine(t))throw new Gt("EntitlementEngine "+e+" must be a EntitlementEngine");return r.engines_[e]=t},r.getEntitlementEngine=function(e){return e=e||"EricssonExposure",r.engines_&&r.engines_[e]?r.engines_[e]:null},r}();Vt.ServerTimeDiff_=void 0;var $t=function(){function e(){this.channelId=0,this.assetId=void 0,this.programId=void 0,this.productId="",this.mimeType="",this.playRequest=null,this.requestId="",this.edrmConfig=null,this.live=!1,this.playSessionId="",this.analyticsConfig=null,this.lastViewedOffset=null,this.lastViewedTime=null,this.liveTime=null,this.entitlementType="",this.licenseExpiration=null,this.licenseExpirationReason="",this.minBitrate=0,this.maxBitrate=0,this.maxResWidth=0,this.maxResHeight=0,this.rwEnabled=!0,this.ffEnabled=!0,this.airplayBlocked=!1,this.mdnRequestRouterUrl="",this.timeshiftEnabled=!0,this.formats=null,this.mediaLocator="",this.src="",this.adMediaLocator="",this.streamInfo=null,this.playToken="",this.playTokenExpiration="",this.protection=void 0,this.certificateServer=void 0,this.keySystems=void 0}var t=e.prototype;return t.commonInitiate=function(e){this.edrmConfig=e.edrmConfig||null,this.playSessionId=e.playSessionId||"",this.analyticsConfig=e.analyticsConfig||null,this.entitlementType=e.entitlementType||"",this.mdnRequestRouterUrl=e.mdnRequestRouterUrl||"",this.playToken=e.playToken||"",this.playTokenExpiration=e.playTokenExpiration||""},t.initiateV1=function(e,t){this.commonInitiate(e),this.minBitrate=e.minBitrate||0,this.maxBitrate=e.maxBitrate||0,this.maxResWidth=e.maxResWidth||0,this.maxResHeight=e.maxResHeight||0,this.rwEnabled=void 0===e.rwEnabled||e.rwEnabled,this.ffEnabled=void 0===e.ffEnabled||e.ffEnabled,this.airplayBlocked=void 0!==e.airplayBlocked&&e.airplayBlocked,this.timeshiftEnabled=e.timeshiftEnabled||!0,this.lastViewedOffset=e.lastViewedOffset||null,this.lastViewedTime=e.lastViewedTime||null,this.liveTime=e.liveTime||null,this.live=e.live||!1;var i=Date.parse(e.licenseExpiration||null);!1===isNaN(i)&&(this.licenseExpiration=new Date(i)),this.licenseExpirationReason=e.licenseExpirationReason||"",this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===d.location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"",e.streamInfo?this.streamInfo=e.streamInfo:this.setupStreamInfo(t),e.fairplayConfig&&(this.protection={},this.protection.certificateUrl=e.fairplayConfig.certificateUrl||"",this.protection.licenseUrl=e.fairplayConfig.licenseAcquisitionUrl||"",e.fairplayConfig.secondaryMediaLocator?this.protection.version="mrr":this.protection.version="irdeto",this.keySystems={"com.apple.fps.1_0":{certificateUri:e.fairplayConfig.certificateUrl||"",licenseUri:e.fairplayConfig.licenseAcquisitionUrl||""}}),e.widevineConfig&&(this.certificateServer=e.widevineConfig.certificateUrl||""),e.cencConfig&&(this.keySystems=e.cencConfig)},t.initiateV2=function(e){if(this.commonInitiate(e),this.formats=e.formats||null,e.contractRestrictions){var t=e.contractRestrictions;this.minBitrate=t.minBitrate||0,this.maxBitrate=t.maxBitrate||0,this.maxResWidth=t.maxResWidth||0,this.maxResHeight=t.maxResHeight||0,this.rwEnabled=void 0===t.rwEnabled||t.rwEnabled,this.ffEnabled=void 0===t.ffEnabled||t.ffEnabled,this.airplayBlocked=void 0===t.airplayEnabled||!t.airplayEnabled,this.timeshiftEnabled=t.timeshiftEnabled||!0}if(e.bookmarks){var i=e.bookmarks;this.lastViewedOffset=i.lastViewedOffset||null,this.lastViewedTime=i.lastViewedTime||null,this.liveTime=i.liveTime||null}if(e.streamInfo){var r=e.streamInfo;this.streamInfo={referenceTime:0},this.live=r.live||!1,this.streamInfo.live=r.live||!1,this.channelId=r.channelId||void 0,this.programId=r.programId||void 0,this.streamInfo.channelId=r.channelId||void 0,this.streamInfo.programId=r.programId||void 0,this.streamInfo.static=r.static||!1,this.isDynamicCachupAsLive=!r.static&&void 0!==r.start,this.isStaticCachupAsLive=r.static&&void 0!==r.end,r.start&&(this.streamInfo.start=new Date(1e3*r.start),this.streamInfo.startTime=this.streamInfo.start.getTime()),r.end&&(this.streamInfo.end=new Date(1e3*r.end),this.streamInfo.endTime=this.streamInfo.end.getTime())}},t.setupMediaLocator=function(e){this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===d.location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"";var t=Date.parse(e.licenseExpiration||null);!1===isNaN(t)&&(this.licenseExpiration=new Date(t)),this.licenseExpirationReason=e.licenseExpirationReason||""},t.selectFormat=function(e){var t,i=this;switch(this.mediaLocator="",this.src="",this.playRequest=e,this.mimeType=e.type,e.format){case"DASH":if(0<(t=this.formats.filter(function(e){return"DASH"===e.format})).length){var r=t[0];this.setupMediaLocator(r),r.drm&&(this.keySystems=r.drm,r.drm["com.widevine.alpha"]&&(this.certificateServer=r.drm["com.widevine.alpha"].certificateUrl),this.keySystems={},Object.keys(r.drm).forEach(function(e){i.keySystems[e]=r.drm[e].licenseServerUrl}))}break;case"HLS":if(0<(t=this.formats.filter(function(e){return"HLS"===e.format})).length){var n=t[0];this.setupMediaLocator(n),n.drm&&n.drm["com.apple.fps"]&&(this.protection={},this.protection.certificateUrl=n.drm["com.apple.fps"].certificateUrl||"",this.protection.licenseUrl=n.drm["com.apple.fps"].licenseServerUrl||"",this.protection.version="irdeto",this.keySystems={"com.apple.fps.1_0":{certificateUri:n.drm["com.apple.fps"].certificateUrl||"",licenseUri:n.drm["com.apple.fps"].licenseServerUrl||""}})}}},t.setupStreamInfo=function(e){if(this.streamInfo={referenceTime:0},this.isDynamicCachupAsLive=!1,this.isStaticCachupAsLive=!1,this.mediaLocator){var t=_("t",this.mediaLocator);if(!t){var i=_("dvr_window_length",this.mediaLocator);if(i){var r=e?new Date(e):new Date;t=new Date(r.getTime()-1e3*i).toISOString().replace(/Z/g,"")}else if(this.live){var n=e?new Date(e):new Date;t=new Date(n.getTime()-72e5).toISOString().replace(/Z/g,"")}}if(t)try{t&&47===t.length?(this.streamInfo.start=new Date(t.slice(0,23)+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime(),this.streamInfo.end=new Date(t.slice(24)+"Z"),this.streamInfo.endTime=this.streamInfo.end.getTime()):t&&23===t.length&&(this.streamInfo.start=new Date(t+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime()),this.isDynamicCachupAsLive=void 0!==this.streamInfo.start&&void 0===this.streamInfo.end,this.isStaticCachupAsLive=void 0!==this.streamInfo.start&&void 0!==this.streamInfo.end}catch(e){L.warn("timeParams",e)}}},l(e,null,[{key:"Type",get:function(){return{DASH:"DASH",HLS:"HLS"}}}]),e}(),Wt=function(e){var t=qt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},qt=Object.prototype.toString;var Kt,Yt=Array.prototype.slice,Xt=Object.prototype.toString,zt=Function.prototype.bind||function(t){var i=this;if("function"!=typeof i||"[object Function]"!==Xt.call(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var r,n=Yt.call(arguments,1),e=Math.max(0,i.length-n.length),o=[],s=0;s<e;s++)o.push("$"+s);if(r=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var e=i.apply(this,n.concat(Yt.call(arguments)));return Object(e)===e?e:this}return i.apply(t,n.concat(Yt.call(arguments)))}),i.prototype){var a=function(){};a.prototype=i.prototype,r.prototype=new a,a.prototype=null}return r},Jt=Object.prototype.toString,Zt=function(e){var t=Jt.call(e),i="[object Arguments]"===t;return i||(i="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===Jt.call(e.callee)),i};if(!Object.keys){var Qt=Object.prototype.hasOwnProperty,ei=Object.prototype.toString,ti=Zt,ii=Object.prototype.propertyIsEnumerable,ri=!ii.call({toString:null},"toString"),ni=ii.call(function(){},"prototype"),oi=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],si=function(e){var t=e.constructor;return t&&t.prototype===e},ai={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},li=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!ai["$"+e]&&Qt.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{si(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();Kt=function(e){var t=null!==e&&"object"==typeof e,i="[object Function]"===ei.call(e),r=ti(e),n=t&&"[object String]"===ei.call(e),o=[];if(!t&&!i&&!r)throw new TypeError("Object.keys called on a non-object");var s=ni&&i;if(n&&0<e.length&&!Qt.call(e,0))for(var a=0;a<e.length;++a)o.push(String(a));if(r&&0<e.length)for(var l=0;l<e.length;++l)o.push(String(l));else for(var c in e)s&&"prototype"===c||!Qt.call(e,c)||o.push(String(c));if(ri)for(var u=function(e){if("undefined"==typeof window||!li)return si(e);try{return si(e)}catch(e){return!1}}(e),h=0;h<oi.length;++h)u&&"constructor"===oi[h]||!Qt.call(e,oi[h])||o.push(oi[h]);return o}}var ci=Kt,ui=Array.prototype.slice,hi=Object.keys,pi=hi?function(e){return hi(e)}:ci,di=Object.keys;pi.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return Zt(e)?di(ui.call(e)):di(e)}):Object.keys=pi;return Object.keys||pi};var mi=pi,fi="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),gi=Object.prototype.toString,yi=Array.prototype.concat,vi=Object.defineProperty,Ti=vi&&function(){var e={};try{for(var t in vi(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),_i=function(e,t,i,r){var n;t in e&&("function"!=typeof(n=r)||"[object Function]"!==gi.call(n)||!r())||(Ti?vi(e,t,{configurable:!0,enumerable:!1,value:i,writable:!0}):e[t]=i)},Ei=function(e,t){var i=2<arguments.length?arguments[2]:{},r=mi(t);fi&&(r=yi.call(r,Object.getOwnPropertySymbols(t)));for(var n=0;n<r.length;n+=1)_i(e,r[n],t[r[n]],i[r[n]])};Ei.supportsDescriptors=!!Ti;var bi,Si=Ei,Ci=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,Ii=Object.getPrototypeOf||function(e){return e.__proto__},wi="undefined"==typeof Uint8Array?bi:Ii(Uint8Array),Pi={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?bi:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?bi:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Ai?Ii([][Symbol.iterator]()):bi,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":bi,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":bi,"$ %AsyncGenerator%":bi,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":bi,"$ %AsyncIteratorPrototype%":bi,"$ %Atomics%":"undefined"==typeof Atomics?bi:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?bi:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?bi:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?bi:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?bi:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?bi:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?bi:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":bi,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":bi,"$ %Int8Array%":"undefined"==typeof Int8Array?bi:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?bi:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?bi:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?bi:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?bi:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?bi:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Ai?Ii(Ii([][Symbol.iterator]())):bi,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?bi:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&Ai?Ii((new Map)[Symbol.iterator]()):bi,"$ %MapPrototype%":"undefined"==typeof Map?bi:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?bi:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?bi:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?bi:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?bi:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?bi:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?bi:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?bi:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?bi:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?bi:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&Ai?Ii((new Set)[Symbol.iterator]()):bi,"$ %SetPrototype%":"undefined"==typeof Set?bi:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?bi:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?bi:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Ai?Ii(""[Symbol.iterator]()):bi,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Ai?Symbol:bi,"$ %SymbolPrototype%":Ai?Symbol.prototype:bi,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":Ci,"$ %TypedArray%":wi,"$ %TypedArrayPrototype%":wi?wi.prototype:bi,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?bi:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?bi:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?bi:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?bi:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?bi:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?bi:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?bi:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?bi:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?bi:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?bi:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?bi:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?bi:WeakSet.prototype},xi=function(e,t){if(1<arguments.length&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var i="$ "+e;if(!(i in Pi))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===Pi[i]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return Pi[i]},Oi=zt.call(Function.call,Object.prototype.hasOwnProperty),Di=xi("%TypeError%"),ki=xi("%SyntaxError%"),Li={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(Oi(t,r)&&!i[r])return!1;var n=Oi(t,"[[Value]]"),o=Oi(t,"[[Get]]")||Oi(t,"[[Set]]");if(n&&o)throw new Di("Property Descriptors may not be both accessor and data descriptors");return!0}},Ri=function(e,t,i,r){var n=Li[t];if("function"!=typeof n)throw new ki("unknown record type: "+t);if(!n(e,r))throw new Di(i+" must be a "+t);console.log(n(e,r),r)},Ni=Number.isNaN||function(e){return e!=e},Mi=Number.isNaN||function(e){return e!=e},Bi=Number.isFinite||function(e){return"number"==typeof e&&!Mi(e)&&e!==1/0&&e!==-1/0},Ui=function(e){return 0<=e?1:-1},Fi=Function.prototype.toString,Hi=/^\s*class\b/,ji=function(e){try{var t=Fi.call(e);return Hi.test(t)}catch(e){return!1}},Gi=Object.prototype.toString,Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,$i=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(Vi)return function(e){try{return!ji(e)&&(Fi.call(e),!0)}catch(e){return!1}}(e);if(ji(e))return!1;var t=Gi.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},Wi=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e},qi=Object.prototype.toString,Ki=function(e){var t;if((t=1<arguments.length?arguments[1]:"[object Date]"===qi.call(e)?String:Number)!==String&&t!==Number)throw new TypeError("invalid [[DefaultValue]] hint supplied");var i,r,n=t===String?["toString","valueOf"]:["valueOf","toString"];for(r=0;r<n.length;++r)if($i(e[n[r]])&&(i=e[n[r]](),Wi(i)))return i;throw new TypeError("No default value")},Yi=xi("%Object%"),Xi=xi("%TypeError%"),zi=xi("%String%"),Ji={ToPrimitive:function(e){return Wi(e)?e:1<arguments.length?Ki(e,arguments[1]):Ki(e)},ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return Ni(t)?0:0!==t&&Bi(t)?Ui(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);if(Ni(t)||0===t||!Bi(t))return 0;var i,r,n=Ui(t)*Math.floor(Math.abs(t));return r=n%(i=65536),Math.floor(0<=r?r:r+i)},ToString:function(e){return zi(e)},ToObject:function(e){return this.CheckObjectCoercible(e),Yi(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new Xi(t||"Cannot call method on "+e);return e},IsCallable:$i,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:Ni(e)&&Ni(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var i in e)if(Oi(e,i)&&!t[i])return!1;var r=Oi(e,"[[Value]]"),n=Oi(e,"[[Get]]")||Oi(e,"[[Set]]");if(r&&n)throw new Xi("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(Ri(this,"Property Descriptor","Desc",e),!(!Oi(e,"[[Get]]")&&!Oi(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(Ri(this,"Property Descriptor","Desc",e),!(!Oi(e,"[[Value]]")&&!Oi(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(Ri(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(Ri(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new Xi("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new Xi("ToPropertyDescriptor requires an object");var t={};if(Oi(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),Oi(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),Oi(e,"value")&&(t["[[Value]]"]=e.value),Oi(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),Oi(e,"get")){var i=e.get;if(void 0!==i&&!this.IsCallable(i))throw new TypeError("getter must be a function");t["[[Get]]"]=i}if(Oi(e,"set")){var r=e.set;if(void 0!==r&&!this.IsCallable(r))throw new Xi("setter must be a function");t["[[Set]]"]=r}if((Oi(t,"[[Get]]")||Oi(t,"[[Set]]"))&&(Oi(t,"[[Value]]")||Oi(t,"[[Writable]]")))throw new Xi("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},Zi=zt.call(Function.call,String.prototype.replace),Qi=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,er=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,tr=function(){var e=Ji.ToString(Ji.CheckObjectCoercible(this));return Zi(Zi(e,Qi,""),er,"")},ir=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:tr},rr=zt.call(Function.call,ir());Si(rr,{getPolyfill:ir,implementation:tr,shim:function(){var e=ir();return Si(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var nr=rr,or=Object.prototype.toString,sr=Object.prototype.hasOwnProperty,ar=function(e,t,i){if(!$i(t))throw new TypeError("iterator must be a function");var r;3<=arguments.length&&(r=i),"[object Array]"===or.call(e)?function(e,t,i){for(var r=0,n=e.length;r<n;r++)sr.call(e,r)&&(null==i?t(e[r],r,e):t.call(i,e[r],r,e))}(e,t,r):"string"==typeof e?function(e,t,i){for(var r=0,n=e.length;r<n;r++)null==i?t(e.charAt(r),r,e):t.call(i,e.charAt(r),r,e)}(e,t,r):function(e,t,i){for(var r in e)sr.call(e,r)&&(null==i?t(e[r],r,e):t.call(i,e[r],r,e))}(e,t,r)},lr=function(e){if(!e)return{};var o={};return ar(nr(e).split("\n"),function(e){var t,i=e.indexOf(":"),r=nr(e.slice(0,i)).toLowerCase(),n=nr(e.slice(i+1));void 0===o[r]?o[r]=n:(t=o[r],"[object Array]"===Object.prototype.toString.call(t)?o[r].push(n):o[r]=[o[r],n])}),o},cr=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var r in i)ur.call(i,r)&&(e[r]=i[r])}return e},ur=Object.prototype.hasOwnProperty;var hr=dr;function pr(e,t,i){var r=e;return Wt(t)?(i=t,"string"==typeof e&&(r={uri:e})):r=cr(t,{uri:e}),r.callback=i,r}function dr(e,t,i){return mr(t=pr(e,t,i))}function mr(r){if(void 0===r.callback)throw new Error("callback argument missing");var n=!1,o=function(e,t,i){n||(n=!0,r.callback(e,t,i))};function t(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,o(e,f)}function e(){if(!s){var e;clearTimeout(l),e=r.useXDR&&void 0===a.status?200:1223===a.status?204:a.status;var t=f,i=null;return 0!==e?(t={body:function(){var e=void 0;if(e=a.response?a.response:a.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(a),m)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:e,method:u,headers:{},url:c,rawRequest:a},a.getAllResponseHeaders&&(t.headers=lr(a.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),o(i,t,t.body)}}var i,s,a=r.xhr||null;a||(a=r.cors||r.useXDR?new dr.XDomainRequest:new dr.XMLHttpRequest);var l,c=a.url=r.uri||r.url,u=a.method=r.method||"GET",h=r.body||r.data,p=a.headers=r.headers||{},d=!!r.sync,m=!1,f={body:void 0,headers:{},statusCode:0,method:u,url:c,rawRequest:a};if("json"in r&&!1!==r.json&&(m=!0,p.accept||p.Accept||(p.Accept="application/json"),"GET"!==u&&"HEAD"!==u&&(p["content-type"]||p["Content-Type"]||(p["Content-Type"]="application/json"),h=JSON.stringify(!0===r.json?h:r.json))),a.onreadystatechange=function(){4===a.readyState&&setTimeout(e,0)},a.onload=e,a.onerror=t,a.onprogress=function(){},a.onabort=function(){s=!0},a.ontimeout=t,a.open(u,c,!d,r.username,r.password),d||(a.withCredentials=!!r.withCredentials),!d&&0<r.timeout&&(l=setTimeout(function(){if(!s){s=!0,a.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},r.timeout)),a.setRequestHeader)for(i in p)p.hasOwnProperty(i)&&a.setRequestHeader(i,p[i]);else if(r.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(r.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in r&&(a.responseType=r.responseType),"beforeSend"in r&&"function"==typeof r.beforeSend&&r.beforeSend(a),a.send(h||null),a}dr.XMLHttpRequest=d.XMLHttpRequest||function(){},dr.XDomainRequest="withCredentials"in new dr.XMLHttpRequest?dr.XMLHttpRequest:d.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(r){dr["delete"===r?"del":r]=function(e,t,i){return(t=pr(e,t,i)).method=r.toUpperCase(),mr(t)}});var fr=function(){function e(){}return e.getBaseUrl=function(r,n){var o=new XMLHttpRequest;o.open("GET",r.mdnRequestRouterUrl),o.onreadystatechange=function(e){if(4===o.readyState)if(200===o.status){L("getBaseUrl OK");var t=o.responseXML;try{var i=t.firstChild.getElementsByTagName("baseURL")[0].textContent;i?r.baseUrl=i:L.error("getBaseUrl Error can not find baseURL"),n(r)}catch(e){L.error("getBaseUrl Error",e),n(r)}}else L.error("getBaseUrl Error",o.statusText),n(r)},o.send(null)},e}(),gr=function(i){function e(e){var t;return void 0===e&&(e={}),e=g({exposureApiURL:"https://exposure.emps.ebsd.ericsson.net",exposureApiVersion:"v1"},e),(t=i.call(this,e)||this).errorMap={400:{INVALID_JSON:{message:"Invalid json.",fatal:!1}},401:{NO_SESSION_TOKEN:{message:"The session token is missing.",fatal:!0},INVALID_SESSION_TOKEN:{message:"The session token is not valid.",fatal:!0}},403:{FORBIDDEN:{message:"The business unit has been configured to require server to server authentication, but it is not valid.",fatal:!0},NOT_ENTITLED:{message:"The user is not entitled.",fatal:!0},DEVICE_BLOCKED:{message:"The device is not allowed to play the asset.",fatal:!0},GEO_BLOCKED:{message:"Not allowed from this region.",fatal:!0},LICENSE_EXPIRED:{message:"Asset has been expired.",fatal:!0},NOT_AVAILABLE_IN_FORMAT:{message:"The media is not available in the requested format.",fatal:!1},NOT_ENABLED:{message:"The media is not enabled.",fatal:!0},CONCURRENT_STREAMS_LIMIT_REACHED:{message:"You have reached the maximum number of concurrent streams you are allowed to watch.",fatal:!0},NO_MEDIA_ON_CHANNEL:{message:"The media is not available on the channel.",fatal:!1},NO_MEDIA_FOR_PROGRAM:{message:"No media available for this program.",fatal:!1}},404:{UNKNOWN_BUSINESS_UNIT:{message:"The business unit cannot be found.",fatal:!0},UNKNOWN_ASSET:{message:"The asset cannot be found.",fatal:!1}},0:{NETWORK_ERROR:{message:"Network error.",fatal:!1}}},void 0===Vt.ServerTimeDiff_&&t.getServerTime(function(e,t){t&&(L.error("getServerTime",t),e=new Date),Vt.ServerTimeDiff_=e-new Date,L("serverDiff",Vt.ServerTimeDiff_)}),t}c(e,i);var t=e.prototype;return t.login=function(e,t,r,i){var n=this;if(!r)throw new Gt("callback is mandantory for login");var o=!1;i&&(o=!0);var s=""===e,a=new Date(this.getCachedServerTime());if(a.setTime(a.getTime()+864e5),this.options_.apiKey){var l={"EMP-Auth":this.options_.apiKey},c=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/auth/session",u={accountId:e,userId:e,deviceId:"WEB_"+be(),device:{height:d.screen.height,width:d.screen.width,model:d.navigator.appName,name:d.navigator.product,os:d.navigator.platform,osVersion:d.navigator.appVersion,manufacturer:d.navigator.vendor,type:"WEB"},expiration:a.toISOString(),anonymous:!1};hr.post(c,{json:u,headers:l},function(e,t,i){n.checkForError(e,t,function(e,t){r({success:!1,expiration:0,message:t.message})})||(n.sessionToken=i.sessionToken,r({success:!0,expiration:864e5,session:i}))})}else{var h=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit;h+=!0===s?"/auth/anonymous":!0===o?"/auth/twofactorlogin":"/auth/login";var p={deviceId:"WEB_"+be(),device:{height:d.screen.height,width:d.screen.width,model:d.navigator.appName,name:d.navigator.product,os:d.navigator.platform,osVersion:d.navigator.appVersion,manufacturer:d.navigator.vendor,type:"WEB"},rememberMe:!1,username:e,password:t,totp:!0===o?i:void 0};hr.post(h,{json:p},function(e,t,i){n.checkForError(e,t,function(e,t){r({success:!1,expiration:0,message:t.message})})||(n.sessionToken=i.sessionToken,r({success:!0,expiration:i.expirationDateTime?new Date(i.expirationDateTime)-new Date(n.getCachedServerTime()):864e5,session:i}))})}},t.logout=function(r,e){var n=this;void 0===r&&(r=function(){});var t=this.customer,i=this.businessUnit;if(!t)throw new Gt("Customer was not provided.");if(!i)throw new Gt("Business unit was not provided.");var o=this.requestHeaders;e&&(o={Authorization:"Bearer "+e});var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/auth/session";hr.del(s,{headers:o},function(e,t,i){n.checkForError(e,t,r)||(n.sessionToken=null,void 0!==typeof r&&r(!0))})},t.getV2Entitlement=function(e,t,i,r){if(void 0===e)throw new Gt("No request specified.");if(void 0===t)throw new Gt("Media not found.");if(!t.drm||!t.format)throw new Gt("Invalid playrequest specified.");!e.assetId&&e.programId?this.getProgram_(e.channelId,e.programId,t,i):this.getV2Asset_(e,t,r,i)},t.getEntitlement=function(e,t,i){if(void 0===e)throw new Gt("No request specified.");if(void 0===t)throw new Gt("Media not found.");if(!t.drm||!t.format)throw new Gt("Invalid playrequest specified.");null!==e.programId||e.channelId?this.getProgram_(e.channelId,e.programId,t,i):this.getAsset_(e.assetId,t,i)},t.getErrorForResponse=function(t){if(!t)return null;var e=t.statusCode,i="";if(!(200<=e&&e<=299))if(t.body&&t.body.message)i=t.body.message;else if(t.body)try{i=JSON.parse(t.body).message}catch(e){i=t.body}var r=this.errorMap[e];if(r){var n=e+" "+i,o=r[i];return o&&(n+=": "+o.message),new Gt(o?{message:n,fatal:!!o.fatal}:n)}return 200<=e&&e<=299?null:new Gt(e+" "+i)},t.checkForError=function(e,t,i){var r=e;return e||(r=this.getErrorForResponse(t)),r?(i&&i(null,r),r):null},t.getV2Asset_=function(a,l,e,c){var u=this;if(void 0===c&&(c=function(){}),!this.customer)throw new Gt("getV2Asset_: Customer was not provided.");if(!this.businessUnit)throw new Gt("getV2Asset_: Business unit was not provided.");var h=a.assetId?a.assetId:a.channelId;if(!h)throw new Gt("getV2Asset_: No assetId or channelId specified.");if(e&&e.formats)if(e.selectFormat(l),e.mediaLocator)c(e,null);else{var t=new Gt(l.format+" not avalible");t.fatal=!1,c(e,t)}else{var i=this.options_.exposureApiURL+"/v2/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/entitlement/"+h+"/play";hr.get(i,{headers:this.requestHeaders},function(e,t,i){if(e)return L.warn("Fallback to Entitlement request v1",e),void u.getEntitlement(a,l,c);if(e=u.checkForError(e,t))return L.warn("Fallback to Entitlement request v1",e.message),void u.getEntitlement(a,l,c);var r=JSON.parse(i),n=new $t;n.initiateV2(r),n.selectFormat(l),n.assetId=h,(n.channelId||n.programId)&&u.setStreamReferenceTime_(n);var o=t.headers["x-request-id"];if(n.requestId=o||"",n.mediaLocator)c(n,null);else{var s=new Gt(l.format+" not avalible");s.fatal=!1,c(n,s)}})}},t.getAsset_=function(o,s,a){var l=this;void 0===a&&(a=function(){});var e=this.customer,t=this.businessUnit;if(!e)throw new Gt("getAsset_: Customer was not provided.");if(!t)throw new Gt("getAsset_: Business unit was not provided.");if(!o)throw new Gt("getAsset_: assetId was not provided.");var i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/entitlement/"+o+"/play";hr.post(i,{json:s,headers:this.requestHeaders},function(e,t,i){if(!l.checkForError(e,t,a)){var r=new $t;r.initiateV1(i,t.headers.date),r.assetId=o,r.playRequest=s,r.mimeType=s.type;var n=t.headers["x-request-id"];r.requestId=n||"",r.mdnRequestRouterUrl?fr.getBaseUrl(r,a):a(r)}})},t.setStreamReferenceTime_=function(e){(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&("application/dash+xml"===e.mimeType?e.isStaticCachupAsLive?e.streamInfo.referenceTime=e.streamInfo.startTime:e.streamInfo.referenceTime=0:"application/x-mpegurl"===e.mimeType&&(e.streamInfo.referenceTime=e.streamInfo.startTime))},t.getAssetMetadata_=function(e,n){var o=this;if(!this.customer)throw new Gt("getAssetMetadata_: Customer was not provided.");if(!this.businessUnit)throw new Gt("getAssetMetadata_: Business unit was not provided.");if(!e)throw new Gt("getAssetMetadata_: assetId was not provided.");var t=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/content/asset/"+e;hr.get(t,null,function(e,t,i){if(!o.checkForError(e,t,n)){var r=JSON.parse(i);n(r)}})},t.getProgram_=function(o,s,a,l){var c=this;void 0===l&&(l=function(){});var e=this.customer,t=this.businessUnit;if(!e)throw new Gt("getProgram_: Customer was not provided.");if(!t)throw new Gt("getProgram_: Business unit was not provided.");if(!o&&!s)throw new Gt("getProgram_: channelId or programId was not provided.");var i="";s&&(i="/program/"+s);var r="";o&&(r="/channel/"+o);var n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/entitlement"+r+i+"/play";hr.post(n,{json:a,headers:this.requestHeaders},function(e,t,i){if(!c.checkForError(e,t,l)){var r=new $t;r.initiateV1(i,t.headers.date),o&&(r.assetId=o,r.channelId=o),s&&(r.programId=s),r.playRequest=a,r.mimeType=a.type,c.setStreamReferenceTime_(r);var n=t.headers["x-request-id"];r.requestId=n||"",r.mdnRequestRouterUrl?fr.getBaseUrl(r,l):l(r)}})},t.getServerTime=function(o){var s=this,e=this.customer,t=this.businessUnit;if(!e||!t)return L.warn("getServerTime no customer or businessUnit"),void o(new Date);if(!1===d.navigator.onLine)return L("getServerTime offline"),void o(new Date);var i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/time";hr.get(i,null,function(e,t,i){if(e)o(null,e);else if(e=s.checkForError(e,t))o(null,e);else{var r=JSON.parse(i),n=new Date(r.iso8601);o(n)}})},t.getPreferences=function(n){var o=this,e=this.customer,t=this.businessUnit,i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/preferences";hr.get(i,{headers:this.requestHeaders},function(e,t,i){if(!o.checkForError(e,t,n)){var r=JSON.parse(i);n(r)}})},t.savePreferences=function(e,r){var n=this,t=this.customer,i=this.businessUnit;if(e){var o={preferences:e},s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/preferences";hr.post(s,{json:o,headers:this.requestHeaders},function(e,t,i){n.checkForError(e,t,r)||r(!0)})}else L.error("Preferences was not provided.")},t.getEPG=function(e,t,i,n){var o=this,r=this.customer,s=this.businessUnit,a=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+s+"/epg/"+e;a+="?from="+t+"&to="+i,hr.get(a,null,function(e,t,i){if(!o.checkForError(e,t,n)){var r=JSON.parse(i);n(r)}})},t.getProgramInfo=function(e,t,o,i){var r=this.customer,n=this.businessUnit,s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+n+"/epg/"+e;i?s=s+"/program/"+i:s+="?from="+t.getTime()+"&to="+t.getTime(),hr.get(s,null,function(e,t,i){if(e)o(null,e);else{var r,n=JSON.parse(i);if(n.programs&&0<n.programs.length)r=n.programs[0];else{if(!n.programId)return void o(null,"No programs found.");r=n}r.start=new Date(r.startTime),r.end=new Date(r.endTime),r.duration=new Date(r.endTime)-new Date(r.startTime),o(r)}})},t.getChannelInfo=function(e,t){void 0===t&&(t=function(){}),this.getAssetInfo(e,t)},t.getAssetInfo=function(e,n){var o=this,t=this.customer,i=this.businessUnit,r=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/content/asset/"+e;hr.get(r,null,function(e,t,i){if(e)n(null,e);else if(!o.checkForError(e,t,n)){var r=JSON.parse(i);n(r)}})},t.verifyEntitlement=function(e,t,r){var n=this;void 0===r&&(r=function(){});var i=this.customer,o=this.businessUnit;if(!i)throw new Gt("verifyEntitlement: Customer was not provided.");if(!o)throw new Gt("verifyEntitlement: Business unit was not provided.");if(!e)throw new Gt("verifyEntitlement: assetId was not provided.");if(!t)throw new Gt("verifyEntitlement: playRequest was not provided.");var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+i+"/businessunit/"+o+"/entitlement/"+e+"?drm="+t.drm+"&format="+t.format;hr.get(s,{headers:this.requestHeaders},function(e,t,i){n.checkForError(e,t,r)||void 0!==typeof r&&r(JSON.parse(i))})},t.verifySession=function(r,n){var o=this,e=this.customer,t=this.businessUnit,i=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+e+"/businessunit/"+t+"/auth/session";hr.get(i,{headers:this.requestHeaders},function(e,t,i){o.checkForError(e,t)?n&&n():r&&r()})},l(e,[{key:"requestHeaders",get:function(){var e={Authorization:"Bearer "+this.sessionToken};return this.options_.apiKey&&(e=g({"EMP-Auth":this.options_.apiKey},e)),e}},{key:"customer",get:function(){return this.customer_||this.options_.customer||null},set:function(e){this.customer_=e}},{key:"businessUnit",get:function(){return this.businessUnit_||this.options_.businessUnit||null},set:function(e){this.businessUnit_=e}},{key:"sessionToken",get:function(){return this.options_.sessionToken||null},set:function(e){this.options_.sessionToken=e}}]),e}(Vt);Vt.registerEntitlementEngine("EricssonExposure",gr);var yr=function(){function e(e){this.assetId=e.assetId||null,this.programId=e.programId||null,this.channelId=e.channelId||null}return l(e,[{key:"assetId",get:function(){return this.assetId_},set:function(e){this.assetId_=e}},{key:"programId",get:function(){return this.programId_},set:function(e){this.programId_=e}},{key:"channelId",get:function(){return this.channelId_},set:function(e){this.channelId_=e}}]),e}(),vr=function(r){function e(e,t){var i;return i=r.call(this,e,t)||this,L("ProgramService","create"),i.MIN_PROGRAM_CHECK_TIMEOUT=1e3,i.checkForProgramChangeBind=i.checkForProgramChange_.bind(u(i)),i.onEntitlementChangeBind=i.onEntitlementChange.bind(u(i)),i.clearProgramChangeTimeoutBind=i.clearProgramChangeTimeout_.bind(u(i)),i.options_=t||{},i.programChangeTimeout_=null,i.programChangeCheckTimestamp_=0,i.player.on(x.ENTITLEMENT_CHANGE,i.onEntitlementChangeBind),i}c(e,r);var t=e.prototype;return t.entitlement=function(e){return void 0===e?this.entitlement_:this.entitlement_=e},t.options=function(e){if(!e)return this.options_;this.options_=e},t.onEntitlementChange=function(e,t){var i=t&&t.entitlement;i&&(i instanceof $t||(this.stop(),i=g(new $t({}),i)),this.entitlement(i)),Y.supportsEpgProgramChange(this.player)||(this.player.off(x.PLAYING,this.checkForProgramChangeBind),this.player.one(x.PLAYING,this.checkForProgramChangeBind))},t.start=function(){L("ProgramService","start"),this.entitlement()&&this.checkForProgramChange_({type:"startplayback"})},t.stop=function(){L("ProgramService stop"),this.clearProgramChangeTimeout_(),this.player&&(this.player.off(x.SEEKED,this.checkForProgramChangeBind),this.player.off(x.PLAYING,this.checkForProgramChangeBind),this.player.off(x.PAUSE,this.clearProgramChangeTimeoutBind),this.player.off(x.PLAY,this.checkForProgramChangeBind)),this.currentProgram_=null,this.currentVOD_=null},t.reset=function(){this.stop(),this.currentProgram_=null,this.currentVOD_=null,this.entitlement_=null},t.clearProgramChangeTimeout_=function(e,t){this.programChangeTimeout_&&(e&&L("clearProgramChangeTimeout",e.type),clearTimeout(this.programChangeTimeout_),this.programChangeTimeout_=null)},t.running=function(){return!!this.programChangeTimeout_&&(L("ProgramService:running",this.programChangeCheckTimestamp_?new Date(this.programChangeCheckTimestamp_):0),!0)},t.dispose=function(){L("ProgramService","dispose"),this.player.off(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.stop(),r.prototype.dispose.call(this)},t.checkForProgramChange_=function(i,e){var r=this;if(i){if(L("checkForProgramChange",i.type),(this.entitlement().live||this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive||i.type!==x.SEEKED)&&this.player&&this.player.options_)if(this.player.options_.absoluteStartTime&&i.type===x.SEEKED)L("checkForProgramChange","ignore livepoint");else{if(this.clearProgramChangeTimeout_(),Y.supportsEpgProgramChange(this.player))if(Y.program(this.player))return void L("updateCurrentProgram from player");var t=this.entitlement().channelId,n=this.entitlement().live,o=this.entitlement().programId;if(n||o){var s;if(n&&!o){var a=new Date(this.exposure.getCachedServerTime()),l="startplayback"===i.type?15:Y.timeBehindLive(this.player);if(a.setSeconds(a.getSeconds()-l),s=a,L("checkForProgramChange","Live",l),this.currentProgram&&this.currentProgram.channelId===this.entitlement().channelId&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return L("checkForProgramChange","Same"),s=null,void this.updateCurrentProgram_(this.currentProgram,!1)}else if("startplayback"!==i.type&&(this.entitlement().isDynamicCachupAsLive||this.entitlement().isStaticCachupAsLive)){var c=Y.getPlayheadTime(this.player);if(c){if(s=new Date(c),this.currentProgram&&this.entitlement().isStaticCachupAsLive&&s.getTime()+2e3>=this.entitlement().streamInfo.end.getTime())return void(this.player.lineUpAsset&&s.getTime()+2e3<this.currentProgram.end.getTime()?(L("checkForProgramChange","Load next stream",s),this.player.lineUpAsset(null,this.currentProgram.channelId,this.currentProgram.programId,s.getTime())):(L("checkForProgramChange","playNextProgram",s),this.player.playNextProgram()));if(this.currentProgram&&s.getTime()+2e3>=this.currentProgram.end.getTime())L("checkForProgramChange","Next",s),s.setSeconds(s.getSeconds()+2);else{if(this.currentProgram&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return L("checkForProgramChange","Same",s),s=null,void this.updateCurrentProgram_(this.currentProgram,!1);L("checkForProgramChange","Prev",s)}}}this.exposure.getProgramInfo(t,s,function(e,t){if(r.currentVOD_=null,t)return L("getProgramInfo","No EPG found.",t),void r.pollingForEPG_();r.updateCurrentProgram_(e,"startplayback"===i.type)},s?null:o)}else this.updateVOD_(this.entitlement().assetId)}}else L.error("checkForProgramChange","event was not provided.")},t.updateChannelInfo_=function(i,r){var n=this;return i&&i.channelId?this.currentChannelAsset_&&this.currentChannelAsset_.assetId===i.channelId?(i.channelInfo=this.extractAssetMetadata(this.currentChannelAsset_),void r()):void this.exposure.getChannelInfo(i.channelId,function(e,t){if(t)return L.warn("updateChannelInfo","No ChannelInfo found.",t),void r();L("updateChannelInfo",i.channelId),n.currentChannelAsset_=e,i.channelInfo=n.extractAssetMetadata(n.currentChannelAsset_),r()}):(L.error("updateChannelInfo","program or channelId empty"),void r())},t.updateVOD_=function(e){var i=this;this.exposure.getAssetInfo(e,function(e,t){if(i.currentProgram_=null,i.player)return t?(L.warn("No AssetInfo found.",t),i.currentVOD_=null,void i.player.trigger(x.ASSET_CHANGED,{asset:null})):void(i.currentVOD_&&i.currentVOD_.assetId===e.assetId||(i.currentVOD_=e,Y.setTechVOD(i.player,e),L("ASSET_CHANGED"),i.player.trigger(x.ASSET_CHANGED,{asset:e})))})},t.updateCurrentProgram_=function(e,t){var i=this;if(L("updateCurrentProgram",e,t),this.clearProgramChangeTimeout_(),this.player)if(this.currentProgram_&&this.currentProgram_.programId===e.programId||(this.currentVOD_=null,this.currentProgram_=e,t||this.verifyEntitlement(),this.updateChannelInfo_(e,function(){i.player&&(Y.currentAsset(i.player,e.assetId,e.programId,e.channelId),i.entitlement_&&(i.entitlement_.channelId=e.channelId,i.entitlement_.assetId=e.assetId,i.entitlement_.programId=e.programId),Y.setTechProgram(i.player,e),i.player.removeClass("vjs-live"),i.player.trigger(x.PROGRAM_CHANGED,{program:e}),i.player.trigger(x.DURATION_CHANGE))})),t)L("updateCurrentProgram","startplayback");else{if(this.entitlement().isDynamicCachupAsLive||this.entitlement().live||this.entitlement().isStaticCachupAsLive){var r;if(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive){var n=Y.getPlayheadTime(this.player);if(!n)return void L("updateCurrentProgram","no playHeadTime",n);r=new Date(n)}else{var o=Y.timeBehindLive(this.player);(r=new Date(this.exposure.getCachedServerTime())).setSeconds(r.getSeconds()-o)}var s=new Date(e.start.getTime()+e.duration),a=this.entitlement().streamInfo.end;a&&s.getTime()>a.getTime()&&(s=a);var l=s.getTime()-r.getTime();(!l||l<this.MIN_PROGRAM_CHECK_TIMEOUT)&&(L("updateCurrentProgram","timediff is below minimum",l),l=this.MIN_PROGRAM_CHECK_TIMEOUT),this.programChangeCheckTimestamp_=Date.now()+l,L("updateCurrentProgram","programChangeTimeout",new Date(this.programChangeCheckTimestamp_)),this.programChangeTimeout_=setTimeout(function(){i.checkForProgramChange_({type:"programend"}),i.programChangeTimeout_=null},2147483647<l?2147483647:l)}this.player.off(x.SEEKED,this.checkForProgramChangeBind),this.player.one(x.SEEKED,this.checkForProgramChangeBind),this.player.off(x.PLAY,this.checkForProgramChangeBind),this.player.one(x.PLAY,this.checkForProgramChangeBind),this.player.off(x.PAUSE,this.clearProgramChangeTimeoutBind),this.player.one(x.PAUSE,this.clearProgramChangeTimeoutBind)}},t.pollingForEPG_=function(){var e=this;this.currentProgram_=null,this.player.trigger(x.PROGRAM_CHANGED,{program:null}),this.player.trigger(x.DURATION_CHANGE),this.player.addClass("vjs-live");this.programChangeCheckTimestamp_=Date.now()+12e4,this.programChangeTimeout_=setTimeout(function(){e.checkForProgramChange_({type:"pollingforepg"}),e.programChangeTimeout_=null},12e4)},t.getNextProgram=function(i){if(this.currentProgram||!i)if(this.exposure.getCachedServerTime()<this.currentProgram.end.getTime())i(this.currentProgram);else{var e=new Date(this.currentProgram.endTime);e.setSeconds(e.getSeconds()+15),this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,t){t?i(null,t):i(e)},null)}else i(null,{message:"getNextProgram No Current Program"})},t.getPreviousProgram=function(i){if(this.currentProgram||!i){var e=new Date(this.currentProgram.startTime);e.setSeconds(e.getSeconds()-15),this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,t){t?i(null,t):i(e)},null)}else i(null,{message:"getPreviousProgram No Current Program"})},t.getProgram=function(e,i){this.currentProgram||!i?this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,t){t?i(null,t):i(e)},null):i(null,{message:"getProgram No Current Program"})},t.verifyEntitlement=function(){var i=this;this.currentProgram&&this.exposure.verifyEntitlement(this.currentProgram.assetId,this.entitlement().playRequest,function(e,t){return t?(i.player.error("verifyEntitlement "+t.message),void Y.stop(i.player)):e&&"SUCCESS"===e.status?void L("verifyEntitlement",e.status):(i.player.error(e?e.status:"verifyEntitlement no status"),void Y.stop(i.player))})},t.getAssetMetadata=function(e,i){var r=this,t=this.currentProgram?this.currentProgram.asset:this.currentVOD;t&&t.assetId===e?i(this.extractAssetMetadata(t)):this.exposure.getAssetMetadata_(e,function(e,t){if(t)return L.warn("getAssetMetadata","No data found.",t),void i(null,t);i(r.extractAssetMetadata(e))})},t.extractAssetMetadata=function(e){var t=null,i=null,r=null;return e&&e.localized&&0<e.localized.length&&(e.localized[0].title&&(t=e.localized[0].title),e.localized[0].shortDescription&&(i=e.localized[0].shortDescription),e.localized[0].images&&0<e.localized[0].images.length&&e.localized[0].images[0].url&&(r=e.localized[0].images)),{title:t||"",subtitle:i||"",images:r||[]}},l(e,[{key:"exposure",get:function(){if(!this.options_.exposure){var e=this.player.options_["entitlement-engine"];e||(e=this.player.options_["exposure-service"]?this.player.options_["exposure-service"]:"EricssonExposure");var t=this.player.options_[e.toLowerCase()];if(!t)return null;var i=Vt.getEntitlementEngine(e);this.options_.exposure=new i(t)}return this.options_.exposure}},{key:"currentProgram",get:function(){return Y.supportsEpgProgramChange(this.player)?Y.program(this.player):this.currentProgram_}},{key:"currentChannelAsset",get:function(){return this.currentChannelAsset_}},{key:"currentVOD",get:function(){return this.currentVOD_}}]),e}(p.getPlugin("plugin"));vr.VERSION="2.1.103-344",p.getPlugin("programService")?p.log.warn('A plugin named "programService" already exists.'):p.registerPlugin("programService",vr);var Tr=function(r){function e(e,t){var i;return i=r.call(this,e,t)||this,L("EntitlementExpirationService","create"),i.options_=t,i.onEntitlementChangeBind=i.onEntitlementChange.bind(u(i)),i}c(e,r);var t=e.prototype;return t.dispose=function(){L("EntitlementExpirationService","dispose"),this.stop(),r.prototype.dispose.call(this)},t.stop=function(){L("EntitlementExpirationService","stop"),this.player.off(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null)},t.start=function(){L("EntitlementExpirationService","start"),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.player.off(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player.on(x.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},t.entitlement=function(e){return void 0===e?this.entitlement_:this.entitlement_=e},t.onEntitlementChange=function(e,t){this.entitlement(t&&t.entitlement),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.checkForExpiration()},t.options=function(e){if(!e)return this.options_;this.options_=e},t.checkForExpiration=function(){var e=this,t=this.entitlement();if(L("EntitlementExpirationService","checkForExpiration",t.licenseExpiration),this.hasLicenseExpiration(t)){var i=t.licenseExpiration.getTime()-this.exposure.getCachedServerTime();if(i<=0)return this.player.error(this.errorForReason(t.licenseExpirationReason)),void Y.stop(this.player);i<2147483647?this.expirationTimeout_=setTimeout(function(){e.expirationTimeout_=null,L("EntitlementExpirationService","license expired"),e.refreshEntitlement()},i):setTimeout(function(){return e.checkForExpiration()},1073741823)}},t.refreshEntitlement=function(){Y.restart(this.player,!0)},t.errorForReason=function(e){switch(e){case"GEO_BLOCKED":return this.player.localize("Not allowed from this region.");case"NOT_ENTITLED":return this.player.localize("The user is not entitled.");case"GAP_IN_EPG":return this.player.localize("Asset temporarily not available");case"EPG_PLAY_MAX_HOURS":default:return this.player.localize("Asset exceeded maximum playback time")}},t.hasLicenseExpiration=function(e){return!!e.licenseExpiration},l(e,[{key:"exposure",get:function(){return this.options_&&this.options_.exposure}}]),e}(p.getPlugin("plugin"));Tr.VERSION="2.1.103-344",p.getPlugin("entitlementExpirationService")?p.log.warn('A plugin named "entitlementExpirationService" already exists.'):p.registerPlugin("entitlementExpirationService",Tr);var _r=p.getComponent("Tech"),Er=function A(I){function w(e,t,i,r){I.options_.absoluteStartTime&&I.options_.absoluteStartTime>t.getCachedServerTime()?I.options_.absoluteStartTime=t.getCachedServerTime()-1e4:I.options_.startTime&&I.options_.startTime>t.getCachedServerTime()/1e3&&(I.options_.startTime=(t.getCachedServerTime()-1e4)/1e3);if(I.programService&&(!e.programService||!e.programService.disable)){if(I.programService().options({exposure:t}),i.isDynamicCachupAsLive&&e.playFrom)if("beginning"===e.playFrom||!i.live&&!I.options_.absoluteStartTime&&!I.options_.startTime){var n=i.streamInfo.start.getTime()+100;"application/dash+xml"===i.mimeType?(L("SET startTime",n),I.options({startTime:n/1e3}),i.options.startTime=n/1e3):(L("SET startTime",.1),I.options({startTime:.1}),i.options.startTime=.1)}else if(I.options_.absoluteStartTime){I.options_.absoluteStartTime<i.streamInfo.start.getTime()&&(I.options_.absoluteStartTime=i.streamInfo.start.getTime());var o=I.options_.absoluteStartTime;"HLS"===I.streamType&&(o=I.options_.absoluteStartTime-i.streamInfo.start.getTime()),L("absoluteStartTime SET startTime",o=o||.1),I.options({startTime:o/1e3}),i.options.startTime=o/1e3,I.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0}else I.options_.startTime&&(i.options.startTime=I.options_.startTime,I.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0);else if(i.isStaticCachupAsLive&&I.options_.absoluteStartTime){I.options_.absoluteStartTime<i.streamInfo.start.getTime()&&(I.options_.absoluteStartTime=i.streamInfo.start.getTime());var s=I.options_.absoluteStartTime-i.streamInfo.start.getTime();L("absoluteStartTime SET startTime",s),I.options({startTime:s/1e3}),i.options.startTime=s/1e3,I.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0}else i.isStaticCachupAsLive&&I.options_.startTime&&(i.options.startTime=I.options_.startTime,I.options_.absoluteStartTime=void 0,i.options.absoluteStartTime=void 0);I.programService().start()}r()}function P(e,t,i){if(e){!0===i.useLastViewedOffset&&((e.isStaticCachupAsLive||e.isDynamicCachupAsLive||e.live)&&(e.lastViewedTime||e.liveTime)?e.liveTime&&(L("liveTime",new Date(e.liveTime),e.liveTime),I.options({absoluteStartTime:e.liveTime})):e.lastViewedOffset&&(L("lastViewedOffset",e.lastViewedOffset/1e3),"DASH"!==I.streamType&&I.options({startTime:e.lastViewedOffset/1e3}))),!1===e.timeshiftEnabled&&I.options({timeShiftDisabled:!0}),I.trigger(x.ENTITLEMENT_CHANGE,{entitlement:e}),(e=g(new $t({}),e)).type=e.mimeType;var r={autoplay:I.options_.autoplay,muted:I.options_.muted,language:I.options_.language,maxBitrate:I.options_.maxBitrate,timeShiftDisabled:I.options_.timeShiftDisabled,useLastViewedOffset:I.options_.useLastViewedOffset,startTime:I.options_.startTime,absoluteStartTime:I.options_.absoluteStartTime,audioLanguage:I.options_.audioLanguage,subtitleLanguage:I.options_.subtitleLanguage,liveDelay:I.options_.liveDelay};return t?g(t,r):t=r,e.options=t,e.options.source=e,I.entitlementExpirationService().start(),e}L.error("setupEntitlement_ no entitlement")}return{setSource:function(e,s){var t,a=I.options(),l=null,c=null,u=null;if(I.programService&&I.programService().stop(),(t=I.currentSource())&&t.playSessionId&&t.playToken&&t.mediaLocator)l=I.currentSource();else{var i=O(e.src);u=new yr(i),I.trigger(x.ENTITLEMENT_LOAD_START,u)}var r=a["entitlement-engine"];r||(r=a["exposure-service"]?a["exposure-service"]:"EricssonExposure");var n=a[r.toLowerCase()];if(!n){var o=new k("Missing entitlementOptions in player options",D.ENTITLEMENT);return I.error(o),void s(o)}var h=A.getExposure(n,r);if(n.sessionToken){var p,d,m,f;a.analytics&&a.analytics.disable||(d=n,m=h,(f=(p=a).analyticsDeviceInfo)&&(L.warn("options.analyticsDeviceInfo is deprecated. Use options.analytics.deviceInfo."),p.analytics||(p.analytics={}),p.analytics.deviceInfo=f),I.analytics&&(I.analytics().options({exposure:m,analytics:p.analytics}),I.analytics().newAnalytics({exposureApiURL:d.exposureApiURL,customer:d.customer,businessUnit:d.businessUnit,sessionToken:d.sessionToken}),I.analytics().onEntitlementLoadStart())),I.entitlementExpirationService().options({exposure:h});var g,y,v,T,_,E,b,S=a.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,_r.getTech(e)]}).filter(function(e){e[0];var t=e[1];if(t&&t.entitlementPlayRequest)return t.isSupported()});if(0===S.length){var C=new k("Unable to load asset: None of the playback technologies are supported",D.ENTITLEMENT);return I.error(C),void s(C)}y=S.length,v=function(i){var r=i.iteration();if(a.excludeTechs&&-1!==a.excludeTechs.indexOf(S[r][0]))i.next();else{var e=S[r][1],n=a[S[r][0].toLowerCase()];I.tech_&&I.techName_!==S[r][0]&&(I.techCall_("reset"),I.unloadTech_());try{if(l)return l=P(l,n,a),w(a,h,l,function(){s(null,l)}),void i.break();var o=n&&n.streamType&&e.entitlementPlayRequests?e.entitlementPlayRequests[n.streamType]:e.entitlementPlayRequest;h.getV2Entitlement(u,o,function(e,t){if(t){if(I.options_.excludeTechs||(I.options_.excludeTechs=[]),I.options_.excludeTechs.push(S[r][0]),g=new k(t.message+"  "+JSON.stringify(o)+JSON.stringify(u),t.code,t.stack),t.fatal)return I.error(g),Y.stop(I),void s(g);c=e,i.next()}else l=P(e,n,a),Y.currentAsset(I,e.assetId,e.programId,e.channelId),l.adMediaLocator&&I.yospace?(L("play adMediaLocator with yospace",l.adMediaLocator),I.yospace().start("VoD",l.adMediaLocator).then(function(e){L("yospace mediaLocator returned",e),l.mediaLocator=e,l.src=e,w(a,h,l,function(){s(null,l)}),i.break()}).catch(function(e){g=new k(e,D.ENTITLEMENT),I.error(g),Y.stop(I),l=null})):(w(a,h,l,function(){s(null,l)}),i.break())},c)}catch(e){return L.warn("error try next tech",new k(e,D.ENTITLEMENT)),void i.next()}}},_=0,E=!(T=function(){if(null===l)return g||(g=new k("Unable to load asset: None of the playback technologies are supported",D.ENTITLEMENT)),I.error(g),Y.stop(I),void s(g)}),(b={next:function(){E||(_<y?(_++,v(b)):(E=!0,T()))},iteration:function(){return _-1},break:function(){E=!0,T()}}).next()}else h.login("","",function(e){if(e.success)n.sessionToken=e.session.sessionToken,I.trigger(x.REPLAY);else{L.error("Anonymous login fail",e.message);var t=new k("Anonymous login fail",D.ENTITLEMENT);I.error(t)}},"")}}};Er.isExposure=function(e){return Vt.isEntitlementEngine(e)},Er.EntitlementClass=$t,Er.getExposure=function(e,t){if(e)return new(Vt.getEntitlementEngine(t))(e);throw new k("Missing exposureOptions",D.ENTITLEMENT)},Er.registerExposure=function(e,t){return Vt.registerEntitlementEngine(e,t)},Er.getLog=function(){return L},Er.getEntitlementEngine=Vt.getEntitlementEngine,Er.registerEntitlementEngine=Vt.registerEntitlementEngine,Er.isEntitlementEngine=Vt.isEntitlementEngine,Er.VERSION="2.1.103-344",p.EntitlementMiddleware?p.log.warn("EntitlementMiddleware already exists."):(p.use("video/emp",Er),p.EntitlementMiddleware=Er);var br=d.empEntitlement?d.empEntitlement:Er,Sr=p;return Sr.canPlayUnencrypted=function(){var e=p.getTech("EmpShaka");if(void 0!==e&&e.isSupported())return Promise.resolve(!0);var t=p.getTech("EmpDashif");if(void 0!==t&&t.isSupported())return Promise.resolve(!0);var i=p.getTech("EmpHLS");if(void 0!==i&&i.isSupported())return Promise.resolve(!0);var r=p.getTech("EmpHLS-MSE");return void 0!==r&&r.isSupported()?Promise.resolve(!0):Promise.resolve(!1)},Sr.canPlayEncrypted=function(){var e=[];if("function"==typeof d.navigator.requestMediaKeySystemAccess){var i=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:!0==(-1!==d.navigator.userAgent.indexOf("Android"))?"SW_SECURE_DECODE":"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}],t=p.getTech("EmpShaka"),r=p.getTech("EmpDashif");(void 0!==t&&t.isSupported()||void 0!==r&&r.isSupported())&&(e.push(new Promise(function(e,t){d.navigator.requestMediaKeySystemAccess("com.microsoft.playready",i).then(function(){e(!0)},function(){e(!1)})})),e.push(new Promise(function(e,t){d.navigator.requestMediaKeySystemAccess("com.widevine.alpha",i).then(function(){e(!0)},function(){e(!1)})})))}else{var n=p.getTech("EmpShaka"),o=p.getTech("EmpDashif");(void 0!==n&&n.isSupported()||void 0!==o&&o.isSupported())&&11===ve&&d.MSMediaKeys&&d.MSMediaKeys.isTypeSupported("com.microsoft.playready","video/mp4")&&e.push(!0)}var s=p.getTech("EmpHLS");return void 0!==s&&s.isSupported()&&d.WebKitMediaKeys&&s.getKeySystem&&d.WebKitMediaKeys.isTypeSupported(s.getKeySystem(),"video/mp4")&&e.push(!0),0===e.length&&e.push(!1),Promise.all(e).then(function(e){return-1!==e.indexOf(!0)},function(e){return!1})},Sr.getExposure=br.getExposure,Sr.getEntitlementEngine=br.getEntitlementEngine,Sr.registerEntitlementEngine=br.registerEntitlementEngine,Sr.isEntitlementEngine=br.isEntitlementEngine,Sr.EntitlementClass=br.EntitlementClass,Sr.log=L,Sr.plugin=p.plugin,Sr.videojs=p,Sr.EntitlementMiddleware=br,Sr.extend=p.extend,Sr.Events=x,Sr.VERSION="2.1.103-344","function"==typeof define&&define.amd?define("empPlayer",[],function(){return Sr}):"object"==typeof exports&&"object"==typeof module&&(module.exports=Sr),Sr});
