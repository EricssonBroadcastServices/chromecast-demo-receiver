!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.empPlayer=t()}(this,function(){"use strict";function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function s(e,t,i){return s=o()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var o=Function.bind.apply(e,n),s=new o;return i&&r(s,i.prototype),s},s.apply(null,arguments)}function a(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){function i(){return s(e,arguments,n(this).constructor)}if(null===e||!a(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return t||(t=e.slice(0)),e.raw=t,e}function h(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function p(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function d(e,t){return t={exports:{}},e(t,t.exports),t.exports}function m(e,t){de(e).forEach(function(i){return t(e[i],i)})}function f(e,t,i){return void 0===i&&(i=0),de(e).reduce(function(i,n){return t(i,e[n],n)},i)}function g(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Object.assign?Object.assign.apply(Object,[e].concat(i)):(i.forEach(function(t){t&&m(t,function(t,i){e[i]=t})}),e)}function v(e){return!!e&&"object"==typeof e}function y(e){return 0===de(e).length}function T(e){return"string"==typeof e||!!e&&"object"==typeof e&&"[object String]"===Object.prototype.toString.call(e)}function _(e){var t={assetId:void 0,programId:void 0,channelId:void 0};try{t=JSON.parse(e)}catch(i){t.assetId=e}return t}function E(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){e=E(e),Array.isArray(e)?t=t.concat(e):v(e)&&t.push(e)}),e=t}else e="string"==typeof e&&e.trim()?[{src:e}]:v(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[e]:[];return e}function S(e,t){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function b(e,t){var i=Array.prototype.slice.call(t),n=function(){},r=le.console||{log:n,warn:n,error:n,trace:n};e?i.unshift(e.toUpperCase()+":"):e="log",i.unshift("EMPPlayer:"),r[e].apply?r[e].apply(r,i):r[e](i.join(" "))}function C(){return Ee++}function A(e){return e.replace(/\n\r?\s*/g,"")}function I(e,t){if(!e||!t)return"";if("function"==typeof le.getComputedStyle){var i=le.getComputedStyle(e);return i?i[t]:""}return e.currentStyle[t]||""}function w(){var e=u(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return w=function(){return e},e}function P(){return Ie===le.document&&void 0!==Ie.createElement}function x(e){return v(e)&&1===e.nodeType}function D(e,t,i,n){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===i&&(i={});var r=Ie.createElement(e);return Object.getOwnPropertyNames(t).forEach(function(e){var i=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(ye.warn(Le(w(),e,i)),r.setAttribute(e,i)):"textContent"===e?O(r,i):r[e]=i}),Object.getOwnPropertyNames(i).forEach(function(e){r.setAttribute(e,i[e])}),n&&N(r,n),r}function O(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function k(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(I(e,"height"))),i.width||(i.width=parseFloat(I(e,"width"))),i}}function L(e){return v(e)&&3===e.nodeType}function R(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),x(e)||L(e)?e:"string"==typeof e&&/\S/.test(e)?Ie.createTextNode(e):void 0}).filter(function(e){return e})}function N(e,t){return R(t).forEach(function(t){return e.appendChild(t)}),e}function M(e,t){void 0===t&&(t=e),e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),o=Math.floor(t/60%60),s=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=n=i="-"),r=r>0||s>0?r+":":"",n=((r||o>=10)&&n<10?"0"+n:n)+":",i=i<10?"0"+i:i,r+n+i}function B(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([0-9.]+)/i)||[];if(/trident/i.test(i[1]))return e=/\brv[ :]+([0-9.]+)/g.exec(t)||[],{name:"Explorer",version:e[1]||""};if("Chrome"===i[1]&&null!=(e=t.match(/\b(OPR|Edge)\/([0-9.]+)/))){var n=e.slice(1).toString().split(",");return{name:n[0].replace("OPR","Opera"),version:n[1]}}return i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([0-9.]+)/i))&&i.splice(1,1,e[1]),{name:i[0],version:i[1]}}function U(e){return void 0!==e&&"function"==typeof e.then}function H(e){U(e)&&e.then(null,function(e){})}function G(e,t){return Array.isArray(e)?F(e):void 0===e||void 0===t?F():F([[e,t]])}function F(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:j.bind(null,"start",0,e),end:j.bind(null,"end",1,e)}}function j(e,t,i,n){return void 0===n&&(log.warn("DEPRECATED: Function '"+e+"' on 'TimeRanges' called without an index argument."),n=0),V(e,n,i.length-1),i[n][t]}function V(e,t,i){if(t<0||t>i)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is greater than or equal to the maximum bound ("+i+").")}function W(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}function q(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}function K(e,t){return q(e.options[e.options.selectedIndex].value,t)}function Y(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(q(e.options[n].value,i)===t){e.selectedIndex=n;break}}function z(e){if(e instanceof z)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:v(e)&&("number"==typeof e.code&&(this.code=e.code),e.message&&(this.message=e.message),e.status&&(this.status=e.status),g(this,e)),this.message||(this.message=z.defaultMessages[this.code]||"")}function X(){var e=ue.getTech("EmpShaka");if(void 0!==e&&e.isSupported())return Promise.resolve(!0);var t=ue.getTech("EmpDashif");if(void 0!==t&&t.isSupported())return Promise.resolve(!0);var i=ue.getTech("EmpHLS");if(void 0!==i&&i.isSupported())return Promise.resolve(!0);var n=ue.getTech("EmpHLS-MSE");return void 0!==n&&n.isSupported()?Promise.resolve(!0):Promise.resolve(!1)}function $(){var e=[];if("function"==typeof le.navigator.requestMediaKeySystemAccess){var t=-1!==le.navigator.userAgent.indexOf("Android"),i=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:!0===t?"SW_SECURE_DECODE":"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}],n=ue.getTech("EmpShaka"),r=ue.getTech("EmpDashif");(void 0!==n&&n.isSupported()||void 0!==r&&r.isSupported())&&(e.push(new Promise(function(e,t){le.navigator.requestMediaKeySystemAccess("com.microsoft.playready",i).then(function(){e(!0)},function(){e(!1)})})),e.push(new Promise(function(e,t){le.navigator.requestMediaKeySystemAccess("com.widevine.alpha",i).then(function(){e(!0)},function(){e(!1)})})))}else{var o=ue.getTech("EmpShaka"),s=ue.getTech("EmpDashif");(void 0!==o&&o.isSupported()||void 0!==s&&s.isSupported())&&11===et&&le.MSMediaKeys&&le.MSMediaKeys.isTypeSupported("com.microsoft.playready","video/mp4")&&e.push(!0)}var a=ue.getTech("EmpHLS");return void 0!==a&&a.isSupported()&&le.WebKitMediaKeys&&a.getKeySystem&&le.WebKitMediaKeys.isTypeSupported(a.getKeySystem(),"video/mp4")&&e.push(!0),0===e.length&&e.push(!1),Promise.all(e).then(function(e){return-1!==e.indexOf(!0)},function(e){return!1})}function J(e){var t=Ei.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}function Z(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var n in i)Gi.call(i,n)&&(e[n]=i[n])}return e}function Q(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function ee(e,t,i){var n=e;return _i(t)?(i=t,"string"==typeof e&&(n={uri:e})):n=Hi(t,{uri:e}),n.callback=i,n}function te(e,t,i){return t=ee(e,t,i),ie(t)}function ie(e){function t(){4===a.readyState&&setTimeout(r,0)}function i(){var e=void 0;if(e=a.response?a.response:a.responseText||ne(a),g)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(u),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,s(e,v)}function r(){if(!c){var t;clearTimeout(u),t=e.useXDR&&void 0===a.status?200:1223===a.status?204:a.status;var n=v,r=null;return 0!==t?(n={body:i(),statusCode:t,method:p,headers:{},url:h,rawRequest:a},a.getAllResponseHeaders&&(n.headers=Ui(a.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),s(r,n,n.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var o=!1,s=function(t,i,n){o||(o=!0,e.callback(t,i,n))},a=e.xhr||null;a||(a=e.cors||e.useXDR?new te.XDomainRequest:new te.XMLHttpRequest);var l,c,u,h=a.url=e.uri||e.url,p=a.method=e.method||"GET",d=e.body||e.data,m=a.headers=e.headers||{},f=!!e.sync,g=!1,v={body:void 0,headers:{},statusCode:0,method:p,url:h,rawRequest:a};if("json"in e&&!1!==e.json&&(g=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),a.onreadystatechange=t,a.onload=r,a.onerror=n,a.onprogress=function(){},a.onabort=function(){c=!0},a.ontimeout=n,a.open(p,h,!f,e.username,e.password),f||(a.withCredentials=!!e.withCredentials),!f&&e.timeout>0&&(u=setTimeout(function(){if(!c){c=!0,a.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),a.setRequestHeader)for(l in m)m.hasOwnProperty(l)&&a.setRequestHeader(l,m[l]);else if(e.headers&&!Q(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(a.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(a),a.send(d||null),a}function ne(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function re(){}function oe(e,t,i){var n=0,r=!1,o={next:function(){r||(n<e?(n++,t(o)):(r=!0,i()))},iteration:function(){return n-1},break:function(){r=!0,i()}};return o.next(),o}var se,ae="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};se="undefined"!=typeof window?window:void 0!==ae?ae:"undefined"!=typeof self?self:{};var le=se,ce=le.videojs,ue=ce,he=function(){this.ENDED="ended",this.ERROR="error",this.LOADED_DATA="loadeddata",this.TIMESHIFT_CHANGE="timeshiftchange",this.DURATION_CHANGE="durationchange",this.LOADED_METADATA="loadedmetadata",this.SEEKING="seeking",this.TIME_UPDATE="timeupdate",this.USER_ACTIVE="useractive",this.USERIN_ACTIVE="userinactive",this.VOLUME_CHANGE="volumechange",this.LOAD_START="loadstart",this.CAN_PLAY="canplay",this.PLAYING="playing",this.WAITING="waiting",this.SEEKED="seeked",this.ABORT="abort",this.PLAY="play",this.PAUSE="pause",this.DISPOSE="dispose",this.MODE_CHANGE="modechange",this.CHANGE="change",this.ADD_TRACK="addtrack",this.REMOVE_TRACK="removetrack",this.METRIC_CHANGED="metricchanged",this.RECOVERABLE_ASSET_ERROR="recoverableasseterror",this.BITRATE_CHANGED="bitratechanged",this.CLOSE="close",this.READY="ready",this.RESIZE="resize",this.TAP="tap",this.CLICK="click",this.FOCUS="focus",this.BLUR="blur",this.BEFORE_MODAL_OPEN="beforemodalopen",this.MODAL_OPEN="modalopen",this.BEFORE_MODAL_CLOSE="beforemodalclose",this.MODAL_CLOSE="modalclose",this.BEFORE_MODAL_FILL="beforemodalfill",this.MODAL_FILL="modalfill",this.BEFORE_MODAL_EMPTY="beforemodalempty",this.MODAL_EMPTY="modalempty",this.CAN_PLAY_THROUGH="canplaythrough",this.FIRST_PLAY="firstplay",this.PROGRESS="progress",this.SUSPEND="suspend",this.EMPTIED="emptied",this.STALLED="stalled",this.RATE_CHANGE="ratechange",this.TEXT_TRACK_CHANGE="texttrackchange",this.TRACK_CHANGE="trackchanged",this.POSTER_CHANGE="posterchange",this.KEY_DOWN="keydown",this.KEY_UP="keyup",this.MOUSE_DOWN="mousedown",this.MOUSE_MOVE="mousemove",this.MOUSE_UP="mouseup",this.TOUCH_START="touchstart",this.TOUCH_MOVE="touchmove",this.TOUCH_END="touchend",this.TOUCH_LEAVE="touchleave",this.TOUCH_CANCEL="touchcancel",this.FULLSCREEN_CHANGE="fullscreenchange",this.ENTER_FULL_WINDOW="enterFullWindow",this.EXIT_FULL_WINDOW="exitFullWindow",this.CONTROLS_ENABLED="controlsenabled",this.CONTROLS_DISABLED="controlsdisabled",this.USING_NATIVE_CONTROLS="usingnativecontrols",this.USING_CUSTOM_CONTROLS="usingcustomcontrols",this.SLIDER_ACTIVE="slideractive",this.SLIDER_INACTIVE="sliderinactive",this.ENTITLEMENT_CHANGE="entitlementchange",this.ENTITLEMENT_LOAD_START="entitlementloadstart",this.PLAYER_CREATED="playercreated",this.RESTARTING="restarting",this.AD_TIMELINE_CHANGED="adtimelinechanged",this.CHROMECAST_CASTING="chromecastcasting",this.CHROMECAST_STOPPED="chromecaststopped",this.STOPPED="stopped",this.READY_TO_PLAY="readytoplay",this.PROGRAM_CHANGED="programchanged",this.ASSET_CHANGED="assetchanged",this.SEGMENT_MISSING="segmentmissing",this.AIRPLAY_START="airplayStart",this.REPLAY="replay",this.DOWNLOAD_PROGRESS="downloadprogress",this.DRM_SESSION_UPDATE="drmsessionupdate"},pe=new he,de=function(e){return v(e)?Object.keys(e):[]},me={UNKNOWN:100,LOAD_ASSET:101,ENTITLEMENT:102,ENTITLEMENT2:103,SHAKA_TECH:200,HLS_TECH:300,FLASH_TECH:400,CHROMECAST_TECH:500,HLS_MSE_TECH:1e4,DASHIF_TECH:2e4},fe=function(e){function n(t,i,r){var o;return void 0===i&&(i=me.UNKNOWN),void 0===r&&(r=null),o=e.call(this)||this,o.code=i,T(t)?o.message=t:t.message&&(o.message=t.message),o.status=r,Error.captureStackTrace&&Error.captureStackTrace(c(c(o)),n),o}return i(n,e),t(n,[{key:"codes",get:function(){return me}}]),n}(l(Error)),ge=!1,ve=function(){ge&&b(null,arguments)};le.EMP_DEBUG_LOG&&(ve=le.console&&le.console.log&&console.log.bind(console)||function(){});var ye=ve;if(ye.history=[],ye.error=function(){b("error",arguments)},ye.warn=function(){b("warn",arguments)},ye.debug=function(){b("debug",arguments)},le.EMP_DEBUG_LOG){var Te=function(){};ye.debug=le.console&&le.console.debug&&console.debug.bind(console)||Te,ye.warn=le.WARN=le.console&&le.console.warn&&console.warn.bind(console)||Te,ye.error=le.ERROR=le.console&&le.console.error&&console.error.bind(console)||Te}ye.setLogToBrowserConsole=function(e){void 0===e&&(e=!1),ge=e};var _e,Ee=1,Se=function(e,t,i){t.guid||(t.guid=C());var n=function(){return t.apply(e,arguments)};return n.guid=i?i+"_"+t.guid:t.guid,n},be=function(e,t){var i=Date.now();return function(){var n=Date.now();n-i>=t&&(e.apply(void 0,arguments),i=n)}},Ce={},Ae=void 0!==ae?ae:"undefined"!=typeof window?window:{};"undefined"!=typeof document?_e=document:(_e=Ae["__GLOBAL_DOCUMENT_CACHE@4"])||(_e=Ae["__GLOBAL_DOCUMENT_CACHE@4"]=Ce);var Ie=_e,we=ue.getComponent("MenuItem"),Pe=ue.getComponent("Component"),xe=function(e){function t(t,i){var n,r=i.bitrate;return i.label=0===r?"auto":Math.max(0,Math.round(r/1e3))+" kbps",i.selected=0===r,n=e.call(this,t,i)||this,n.bitrate=r,n.player_.on(pe.BITRATE_CHANGED,function(e,t){n.el()&&(0===n.bitrate?n.selected(t.auto):n.selected(!t.auto&&t.bitrate===n.bitrate))}),n}return i(t,e),t.prototype.handleClick=function(e){this.player_.bitrate(this.bitrate)},t}(we);Pe.registerComponent("BitrateMenuItem",xe);var De=ue.getComponent("MenuButton"),Oe=ue.getComponent("Component"),ke=function(e){function t(t,i){var n;n=e.call(this,t,i)||this,n.el_.setAttribute("aria-label","Bitrate menu");n.player_.bitrates();n.hide();var r=Se(c(c(n)),n.update);return n.player_.on(pe.LOADED_DATA,r),n.player_.on(pe.CHROMECAST_CASTING,r),n.player_.on(pe.ENDED,function(){return n.hide()}),n.player_.on(pe.PLAYING,function(){n.items&&n.items.length>1&&"EmpHLS"!==n.player_.techName_&&n.show()}),n.player_.on(pe.DISPOSE,function(){this.player_.on(pe.LOADED_DATA,r)}),n}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-bitrate-button "+e.prototype.buildCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]);var t=this.player_.bitrates();if(!t||1===t.length||"EmpHLS"===this.player_.techName_)return this.hide(),e;t.length>0&&e.push(new xe(this.player_,{selectable:!0,bitrate:0}));for(var i=0;i<t.length;i++){var n=t[i];e.push(new xe(this.player_,{selectable:!0,bitrate:n}))}return this.show(),e},t}(De);ke.prototype.controlText_="Bitrate",Oe.registerComponent("BitrateButton",ke);var Le=function(e){for(var t="",i=0;i<arguments.length;i++)t+=A(e[i])+(arguments[i+1]||"");return t},Re={bitrates:function(e){return e.tech_&&void 0!==e.tech_.bitrates?e.techGet_("bitrates"):[]},bitrate:function(e,t){return e.tech_&&void 0!==e.tech_.bitrate?(void 0!==t&&e.techCall_("bitrate",t),e.techGet_("bitrate")):0},canRestart:function(e){return!e.tech_||void 0===e.tech_.canRestart||e.techGet_("canRestart")},restart:function(e,t,i){e.currentSource()&&(e.options_.startTime=0,e.options_.absoluteStartTime=void 0,e.previousAbsoluteStartTime=void 0,e.options_.autoplay||(e.options_.autoplay=!0,e.one("play",function(){e.options_.autoplay=!1})),e.trigger(pe.RESTARTING),i?(e.options_.absoluteStartTime=i,e.options_.useLastViewedOffset=!1):e.options_.useLastViewedOffset=t,e.trigger(pe.REPLAY))},getSelectedAudioTrack:function(e){for(var t=e.audioTracks(),i=t.length;i--;){var n=t[i];if(n.enabled)return n.language}return null},getSelectedTextTrack:function(e){for(var t=e.textTracks(),i=t.length;i--;){var n=t[i];if("showing"===n.mode)return n.language}return null},loadAsset:function(e,t,i,n,r){void 0===r&&(r=function(){});var o={assetId:t,programId:i,channelId:n};e.one(pe.LOADED_DATA,function(){r(e.entitlement)}),e.startResetAndReloadTimer_&&e.startResetAndReloadTimer_(),e.src({type:"video/emp",src:JSON.stringify(o)})},currentAsset:function(e,t,i,n){if(!t&&!i&&!n){var r=e.cache_.source;if(r&&r.src&&"video/emp"===r.type){return _(r.src)}return r&&r.assetId?{assetId:r.assetId,programId:r.programId,channelId:r.channelId}:null}if(ye("Update currentAsset",t,i,n),e.cache_.source&&"video/emp"===e.cache_.source.type)e.cache_.source.src=JSON.stringify({assetId:t,programId:i,channelId:n});else if(e.cache_.source&&e.cache_.source.assetId)e.cache_.source.assetId=t,e.cache_.source.programId=i,e.cache_.source.channelId=n;else{var o={assetId:t,programId:i,channelId:n};e.cache_.source={type:"video/emp",src:JSON.stringify(o)}}e.cache_.sources=[e.cache_.source]},getAbsoluteTime:function(e){if(!e.tech_||void 0===e.tech_.getAbsoluteTime)return new Date(0);var t=this.getServerTime(e),i=e.tech_.getAbsoluteTime(t);if("EmpCast"!==e.techName_){var n=this.getEntitlement(e);i&&n&&n.isStaticCachupAsLive?i=new Date(i.getTime()+n.streamInfo.start.getTime()):n&&n.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=new Date(1e3*e.tech_.baseCurrentTime()+n.streamInfo.start.getTime()))}return i&&i.getTime?i:new Date(0)},getPlayheadTime:function(e){var t=this.getAbsoluteTime(e);return t?t.getTime():0},timeBehindLive:function(e){if(!e.tech_||void 0===e.tech_.timeBehindLive)return 0;var t=0,i=this.getServerTime(e),n=this.getEntitlement(e);return t=n&&n.isStaticCachupAsLive?(i-this.getPlayheadTime(e))/1e3:e.tech_.timeBehindLive(i),t!==1/0&&t?Math.round(t):0},liveDelay:function(e){var t=0;return this.isLive(e)&&(t=e.tech_&&void 0!==e.tech_.liveDelay?e.tech_.liveDelay():(this.getServerTime(e)-this.getSeekTimerange(e).end)/1e3),Math.round(t)},stop:function(e,t){e.stopProgramService&&e.stopProgramService(),e.sourceChanging_=!1,e.cache_.sources=[],e.tech_&&void 0!==e.tech_.stop?(e.techCall_("stop",t),e.techCall_("stopTrackingCurrentTime")):(e.techCall_("stopTrackingCurrentTime"),t&&t())},timeShiftEnabled:function(e){return!e.tech_||void 0===e.tech_.timeShiftEnabled||e.techGet_("timeShiftEnabled")},baseCurrentTime:function(e){return e.tech_&&void 0!==e.tech_.baseCurrentTime?e.techGet_("baseCurrentTime"):e.currentTime()},baseDuration:function(e){return e.tech_&&void 0!==e.tech_.duration?e.techGet_("duration"):0},startTimeLive:function(e){if(!e.tech_||void 0===e.tech_.startTimeLive)return 0;var t=this.getServerTime(e),i=e.tech_.startTimeLive(t),n=this.getEntitlement(e);return n&&n.isDynamicCachupAsLive&&"HLS"===e.streamType&&(i=n.streamInfo.referenceTime),n&&n.isStaticCachupAsLive&&"EmpCast"!==e.techName_&&(i=n.streamInfo.referenceTime),i},isLive:function(e){return!(!e.tech_||void 0===e.tech_.live)&&e.techGet_("live")},isCatchupAsLive:function(e){var t=this.getEntitlement(e);return!this.isLive(e)&&t&&t.live},getBitrate:function(e){return e.tech_&&void 0!==e.tech_.getBitrate?e.techGet_("getBitrate"):0},duration:function(e,t){return e.tech_&&void 0!==e.tech_.duration?(e.duration(t),e.techGet_("duration")):e.duration(t)},techVersion:function(e){return e.tech_&&void 0!==e.tech_.techVersion?e.techGet_("techVersion"):"2.x.x"},canSeekTo:function(e,t){if(!1===this.timeShiftEnabled(e)||!e.hasStarted())return!1;var i=this.getEntitlement(e);return!(i&&e.cache_&&!1===i.ffEnabled&&e.cache_.currentTime<=t)&&!(i&&e.cache_&&!1===i.rwEnabled&&e.cache_.currentTime>=t)},remainingTime:function(e){if(!e.tech_||void 0===e.tech_.remainingTime){var t=e.duration();return t===1/0||0===t?1/0:t-e.currentTime()}return e.techGet_("remainingTime")},casting:function(e,t){return!(!e.castPlugin||!e.castPlugin().canOverride("Cast"))&&(e.cache_.sources=t,e.cache_.source=t[0],e.castPlugin().cast(),!0)},setAbsoluteTime:function(e,t){if(!e.tech_||void 0===e.tech_.setAbsoluteTime){var i=(t.getTime()-new Date(0))/1e3;return void e.currentTime(i)}var n=this.getServerTime(e);if("EmpCast"!==e.techName_){var r=this.getEntitlement(e);if(r&&r.isStaticCachupAsLive){if(t.getTime()<r.streamInfo.start.getTime())ye("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),t=0;else{if(t.getTime()>=r.streamInfo.end.getTime())return ye("setAbsoluteTime","playNextProgram"),void this.playProgram(e,t);t=t.getTime()-r.streamInfo.start.getTime()}return void e.techCall_("setCurrentTime",t/1e3)}if(r&&r.isDynamicCachupAsLive)if(t.getTime()<r.streamInfo.start.getTime()){if(ye("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),"HLS"===e.streamType)return void e.techCall_("setCurrentTime",0);t=new Date(r.streamInfo.start.getTime())}else if("HLS"===e.streamType)return t-=r.streamInfo.start.getTime(),void e.techCall_("setCurrentTime",t/1e3)}e.techCall_("setAbsoluteTime",{date:t,nowDate:n})},gotoLive:function(e){if(e.sourceChanging_)return void ye("gotoLive ignore sourceChanging");if(e.tech_.gotoLive)e.techCall_("gotoLive");else{var t=this.getEntitlement(e);if(t&&t.isDynamicCachupAsLive)this.setAbsoluteTime(e,new Date(e.getServerTime()));else if(t&&t.isStaticCachupAsLive){var i=this.currentAsset(e);i&&i.channelId&&e.startPlayback(null,i.channelId,null)}else if(this.isLive(e)){var n=e.duration();e.currentTime(n)}else ye.warn("Not suppoted for VOD")}},setPlayheadTime:function(e,t){this.setAbsoluteTime(e,new Date(t))},supportsEpgProgramChange:function(e){if(e.tech_&&void 0!==e.tech_.supportsEpgProgramChange)return e.techGet_("supportsEpgProgramChange")},program:function(e){return e.tech_&&void 0!==e.tech_.program?e.techGet_("program"):null},playPreviousProgram:function(e,t){if(e.sourceChanging_)return void ye("playPreviousProgram ignore sourceChanging");e.programService&&(e.sourceChanging_=!0,e.programService().getPreviousProgram(function(i,n){if(n)e.sourceChanging_=!1,ye.warn("playPreviousProgram",n);else{var r={};if(t){r.playFrom="startTime";var o=new Date(i.endTime);o.setSeconds(o.getSeconds()-30),r.startTime=o}else r.playFrom="beginning";e.startPlayback(i.assetId,i.channelId,i.programId,r)}}))},playNextProgram:function(e){if(e.sourceChanging_)return void ye("playNextProgram ignore sourceChanging");e.programService&&e.programService().currentProgram&&this.getServerTime(e)>e.programService().currentProgram.end.getTime()&&(e.sourceChanging_=!0,e.programService().getNextProgram(function(t,i){if(i)e.sourceChanging_=!1,ye.warn("playNextProgram",i);else{var n={};n.playFrom="beginning",e.startPlayback(t.assetId,t.channelId,t.programId,n)}}))},playProgram:function(e,t){if(e.sourceChanging_)return void ye("playProgram ignore sourceChanging");e.programService&&(e.sourceChanging_=!0,e.programService().getProgram(t,function(i,n){if(n)e.sourceChanging_=!1,ye.warn("getProgram",n);else{var r={};r.playFrom="startTime",r.startTime=t,e.startPlayback(i.assetId,i.channelId,i.programId,r)}}))},getServerTime:function(e){return e.programService&&e.programService()&&e.programService().exposure?e.programService().exposure.getCachedServerTime():Date.now()},getEntitlement:function(e){if(e.programService)return e.programService().entitlement();if(e.tech_){var t=e.tech_.options_;if(t&&t.source&&t.source.playSessionId)return t.source}return null},getSeekTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.seekable||e.seeking())return t;var i=e.techGet_("seekable");if(i&&i.length>0&&(t.start=1e3*(i.start(i.length-1)+this.startTimeLive(e)/1e3),t.end=1e3*(i.end(i.length-1)+this.startTimeLive(e)/1e3),"EmpCast"===e.techName_)){var n=this.liveDelay(e);t.end>this.getServerTime(e)-1e3*n&&(t.end=this.getServerTime(e)-1e3*n)}return t},getBufferedTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.buffered||e.seeking())return t;var i=e.techGet_("buffered");return i&&i.length>0&&(t.start=Math.round(1e3*(i.start(i.length-1)+this.startTimeLive(e)/1e3)),t.end=Math.round(1e3*(i.end(i.length-1)+this.startTimeLive(e)/1e3))),t},setTechProgram:function(e,t){(e.tech_||void 0!==e.tech_.program)&&e.techCall_("program",t)}},Ne=ue.getComponent("Button"),Me=ue.getComponent("Component"),Be=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,n.updateShowing(),n.on(n.player(),pe.PLAYING,function(){return n.updateShowing()}),n.on(n.player(),pe.DURATION_CHANGE,function(){return n.updateShowing()}),n.on(n.player(),pe.TIME_UPDATE,function(){return n.timeUpdate()}),n.on(n.player(),pe.ENDED,function(){return n.hide()}),n}i(n,e);var r=n.prototype;return r.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"emp-live-control vjs-control"});return this.contentEl_=D("div",{className:"emp-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},r.updateShowing=function(){this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive?this.show():this.hide()},r.timeUpdate=function(){if(this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive){var e=(this.player().currentTime(),this.player().duration(),this.player().timeBehindLive());this.player().isLive()&&e<20?this.addClass("emp-live-edge"):this.removeClass("emp-live-edge")}},r.handleClick=function(){this.player().gotoLive()},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(Ne);Me.registerComponent("EmpLiveDisplay",Be);var Ue=ue.getComponent("Component"),He=function(e){function t(t,i){var n;return n=e.call(this,t,i)||this,n.on(n.player(),pe.PLAYING,function(){return n.updateVisibility()}),n.on(n.player(),pe.DURATION_CHANGE,function(){return n.updateVisibility()}),n.on(n.player(),pe.SEEKED,function(){return n.updateVisibility()}),n.addClass("vjs-hidden"),n}i(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"emp-ad-marker"})},n.buildCSSClass=function(){return"emp-ad-marker "+e.prototype.buildCSSClass.call(this)},n.updateVisibility=function(){if(this.player_.duration()){var e=this.options_.element;e.offset+e.duration<this.player_.currentTime()?this.addClass("emp-ad-past"):this.removeClass("emp-ad-past");var t=e.offset/this.player_.duration();t>=1&&(t=1);var i=e.duration/this.player_.duration();i>=1&&(i=1),this.el_.style.left=(100*t).toFixed(2)+"%",this.el_.style.width=(100*i).toFixed(2)+"%",this.show()}},n.dispose=function(){e.prototype.dispose.call(this)},t}(Ue);Ue.registerComponent("EmpMarker",He);var Ge=ue.getComponent("Component"),Fe=ue.getComponent("MouseTimeDisplay"),je=function(e){function t(t,i){return e.call(this,t,i)||this}return i(t,e),t.prototype.update=function(e,t){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var n,r=i.player_.duration();n=M(t*r,r),i.el_.style.left=e.width*t+"px",i.getChild("timeTooltip").update(e,t,n)})},t}(Fe);Ge.registerComponent("MouseTimeDisplay",je);var Ve=le.navigator&&le.navigator.userAgent||"",We=/AppleWebKit\/([\d.]+)/i.exec(Ve),qe=(We&&parseFloat(We.pop()),/iPad/i.test(Ve)),Ke=le.navigator.userAgent.indexOf("CrKey")>=0,Ye=/iPhone/i.test(Ve)&&!qe,ze=/iPod/i.test(Ve),Xe=Ye||qe||ze,$e=(function(){var e=Ve.match(/OS (\d+)_/i);e&&e[1]&&e[1]}(),/Android/i.test(Ve)),Je=function(){var e=Ve.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),Ze=($e&&/webkit/i.test(Ve),/Firefox/i.test(Ve),/Edge/i.test(Ve)),Qe=!Ze&&/Chrome/i.test(Ve),et=(function(){var e=Ve.match(/Chrome\/(\d+)/);e&&e[1]&&parseFloat(e[1])}(),/MSIE\s8\.0/.test(Ve),function(){var e=/MSIE\s(\d+)\.\d/.exec(Ve),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Ve)&&/rv:11.0/.test(Ve)&&(t=11),t}()),tt=(/Safari/i.test(Ve),Ze||null!==et),it=(P()&&("ontouchstart"in le||le.DocumentTouch&&(le.document,le.DocumentTouch)),P()&&le.document.createElement("video").style,ue.getComponent("Component")),nt=ue.getComponent("Slider"),rt=(ue.getComponent("LoadProgressBar"),ue.getComponent("PlayProgressBar"),Ke||le.EMP_DEBUG_CHROMECAST?1e3:30),ot=function(e){function t(t,i){var n;return n=e.call(this,t,i)||this,n.markers=[],n.update=be(Se(c(c(n)),n.update),rt),n.on(t,pe.TIME_UPDATE,n.update),n.on(t,pe.ENDED,n.handleEnded),n.on(t,pe.AD_TIMELINE_CHANGED,n.updateMarkers),n.updateInterval=null,n.on(t,["playing"],function(){n.updateInterval&&(n.clearInterval(n.updateInterval),n.updateInterval=null),Ke||le.EMP_DEBUG_CHROMECAST||(n.updateInterval=n.setInterval(function(){n.requestAnimationFrame(function(){n.update()})},rt))}),n.on(t,["ended","pause","waiting"],function(){n.updateInterval&&(n.clearInterval(n.updateInterval),n.updateInterval=null)}),n.on(t,["timeupdate","ended"],n.update),n}i(t,e);var n=t.prototype
;return n.updateMarkers=function(e,t){for(var i=this.markers,n=Array.isArray(i),r=0,i=n?i:i[Symbol.iterator]();;){var o;if(n){if(r>=i.length)break;o=i[r++]}else{if(r=i.next(),r.done)break;o=r.value}var s=o;this.removeChild(s)}if(t&&t.timeline)for(var a=t.timeline.getAllElements(),l=Array.isArray(a),c=0,a=l?a:a[Symbol.iterator]();;){var u;if(l){if(c>=a.length)break;u=a[c++]}else{if(c=a.next(),c.done)break;u=c.value}var h=u;if("advert"===h.type){var p=new He(this.player_,{element:h});this.markers.push(p),this.addChild(p),p.updateVisibility()}}},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update_=function(e,t){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[M(e,i),M(i,i)],"{1} of {2}")),Ke||le.EMP_DEBUG_CHROMECAST||this.bar.update(k(this.el_),t)},n.update=function(t,i){var n=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n},n.getCurrentTime_=function(){return this.player_.scrubbing()?(this.player_.getCache().currentTime,this.player_.getCache().currentTime):(this.player_.getCache().currentTime=this.player_.currentTime(),this.player_.currentTime())},n.handleEnded=function(e){this.update_(this.player_.duration(),1);for(var t=this.markers,i=Array.isArray(t),n=0,t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var o=r;this.removeChild(o)}},n.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return e>=1?1:e},n.handleMouseDown=function(t){this.player_.scrubbing(!0),e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.setCurrentTime(t)},n.setCurrentTime=function(e){var t=this.player_.src()?this.player_.src():"",i=0===t.indexOf("offline:"),n=this.player_.buffered().start(0),r=this.player_.buffered().end(0);i||e>=n&&e<=r?(this.player_.currentTime(e),this.player_.getCache().currentTime=e):this.player_.scrubbing()?(this.player_.getCache().currentTime=e,this.player_.getCache().currentTime=e):(this.player_.currentTime(e),this.player_.getCache().currentTime=e)},n.throttleSetCurrentTime=function(e){null!=this.seekTimeoutId_&&le.clearTimeout(this.seekTimeoutId_);var t=this.player_.buffered().start(0),i=this.player_.buffered().end(0);e>=t&&e<=i?(this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e):(this.player_.scrubbing(!0),this.player_.getCache().currentTime=e,this.seekTimeoutId_=le.setTimeout(this.onSeekInputTimeout_.bind(this,e),1e3))},n.onSeekInputTimeout_=function(e){this.seekTimeoutId_=null,this.player_.scrubbing(!1),this.player_.currentTime(e),this.player_.getCache().currentTime=e},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),this.player_.scrubbing(!1),this.setCurrentTime(this.player_.getCache().currentTime)},n.stepForward=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime+5)},n.stepBack=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime-5)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyPress=function(t){32===t.which||13===t.which?(t.preventDefault(),this.handleAction(t)):e.prototype.handleKeyPress&&e.prototype.handleKeyPress.call(this,t)},t}(nt);ot.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},et&&!(et>8)||Xe||$e||ot.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),ot.prototype.playerEvent="timeupdate",it.registerComponent("SeekBar",ot);var st=ue.getComponent("Button"),at=ue.getComponent("Component"),lt=function(e){function t(t,i){var n;return n=e.call(this,t,i)||this,n.shouldRestart_=!0,n.updateShowing(),n.on(n.player(),pe.LOADED_METADATA,n.updateShowing),n.on(n.player(),pe.PLAYING,function(){n.shouldRestart_=!1,n.updateShowing()}),n.on(n.player(),pe.ERROR,function(){return n.shouldRestart_=!0}),n}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"emp-restart-control "+e.prototype.buildCSSClass.call(this)},n.updateShowing=function(){this.player().canRestart()?this.show():this.hide()},n.handleClick=function(){if(!0===this.shouldRestart_)return void this.player_.restart();this.player_.scrubbing(!0);var e=!this.player_.paused();this.player_.pause(),this.player_.currentTime(0),this.player_.scrubbing(!1),e&&H(this.player_.play())},t}(st);lt.prototype.controlText_="Restart",at.registerComponent("EmpRestartButton",lt);var ct=ue.getComponent("Button"),ut=ue.getComponent("Component"),ht=function(e){function n(t,i){var n;return i=g({seconds:30},i),n=e.call(this,t,i)||this,n.controlText("Forward "+i.seconds+"s"),t.on(pe.TIMESHIFT_CHANGE,function(){return n.onTimeshift()}),t.on(pe.PROGRAM_CHANGED,function(e,t){return n.updateEnabled(t&&t.program)}),t.on(pe.DURATION_CHANGE,function(){return n.updateEnabled()}),n.updateEnabled(),n}i(n,e);var r=n.prototype;return r.updateEnabled=function(e){this.entitlement&&!this.entitlement.ffEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Forward restricted")):(this.enable(),this.show(),this.controlText("Forward "+this.options_.seconds+"s"))},r.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},r.buildCSSClass=function(){return"emp-forward-control "+e.prototype.buildCSSClass.call(this)},r.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()+this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(ct);ht.prototype.controlText_="Forward",ut.registerComponent("EmpForwardButton",ht);var pt=ue.getComponent("Button"),dt=ue.getComponent("Component"),mt=function(e){function n(t,i){var n;return i=g({seconds:30},i),n=e.call(this,t,i)||this,n.controlText("Rewind "+i.seconds+"s"),t.on(pe.TIMESHIFT_CHANGE,function(){return n.onTimeshift()}),t.on(pe.PROGRAM_CHANGED,function(e,t){return n.updateEnabled(t&&t.program)}),t.on(pe.DURATION_CHANGE,function(){return n.updateEnabled()}),n.updateEnabled(),n}i(n,e);var r=n.prototype;return r.updateEnabled=function(e){this.entitlement&&!this.entitlement.rwEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Rewind restricted")):(this.enable(),this.show(),this.controlText("Rewind "+this.options_.seconds+"s"))},r.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},r.buildCSSClass=function(){return"emp-rewind-control "+e.prototype.buildCSSClass.call(this)},r.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()-this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(pt);mt.prototype.controlText_="Rewind",dt.registerComponent("EmpRewindButton",mt);var ft=ue.getComponent("Button"),gt=ue.getComponent("Component"),vt=function(e){function t(t,i){return e.call(this,t,i)||this}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"emp-reload-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(){this.player_.restart()},t}(ft);vt.prototype.controlText_="Reload",gt.registerComponent("EmpReloadButton",vt);var yt=(ue.getComponent("RemainingTimeDisplay"),ue.getComponent("Component")),Tt=Ke||window.EMP_DEBUG_CHROMECAST?1e3:30,_t=function(e){function t(t,i){var n;return n=e.call(this,t,i)||this,n.mode_=i.mode||"remainingTime",n.throttledUpdateContent=be(Se(c(c(n)),n.updateContent),Tt),n.on(t,pe.TIME_UPDATE,n.throttledUpdateContent),n.on(t,pe.DURATION_CHANGE,n.updateContent),t.on(pe.ENDED,function(){n.hide()}),t.on(pe.PLAYING,function(){n.show()}),n}i(t,e);var n=t.prototype;return n.createEl=function(){var t="emp-time vjs-time-control vjs-remaining-time vjs-control";this.options_&&"remainingTime"==this.options_.mode?t+=" emp-remaining-time":t+=" emp-currentTime-time";var i=e.prototype.createEl.call(this,"div",{className:t});return this.contentEl_=D("div",{className:"emp-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span>0:00"},{"aria-live":"off"}),i.appendChild(this.contentEl_),i},n.updateContent=function(){if("currentTime"===this.mode_){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),t=this.localize("Current Time"),i=M(e,this.player_.duration());i!==this.formattedTime_&&(this.formattedTime_=i,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span>"+i)}else{var n=this.player_.duration();if(n){var r,o=this.localize("Remaining Time");if(n>4294967295)(r="")!==this.formattedTime_&&(this.formattedTime_=r,this.contentEl_.innerHTML='<span class="vjs-control-text">'+o+"</span>"+r);else{var s=this.player_.remainingTime();s<0&&(s=0),r=M(s),r!==this.formattedTime_&&(this.formattedTime_=r,this.contentEl_.innerHTML='<span class="vjs-control-text">'+o+"</span>"+r)}}}},t}(yt);yt.registerComponent("EmpTimeDisplay",_t),yt.registerComponent("EmpTimeDisplay2",_t);var Et=ue.getComponent("Button"),St=ue.getComponent("Component"),bt=function(e){function t(t,i,n){var r;return r=e.call(this,t,i,n)||this,r.el_.setAttribute("aria-label","Stop Playback"),t.on(pe.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),t.on(pe.PLAYING,function(){return r.onTimeshift()}),t.on(pe.ENDED,function(){return r.hide()}),r}i(t,e);var n=t.prototype;return n.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.hide():this.show())},n.handleClick=function(e){this.player()&&this.player().stop()},n.buildCSSClass=function(){return"emp-stop-control vjs-icon-square "+e.prototype.buildCSSClass.call(this)},t}(Et);bt.prototype.kind_="stop",bt.prototype.controlText_="stop",St.registerComponent("EmpStopButton",bt);var Ct=ue.getComponent("PlayToggle"),At=ue.getComponent("Component"),It=function(e){function t(t,i,n){var r;return r=e.call(this,t,i,n)||this,r.el_.setAttribute("aria-label","Play Toggle"),t.on(pe.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),t.on(pe.PLAYING,function(){return r.onTimeshift()}),r}i(t,e);var n=t.prototype;return n.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},n.handleClick=function(t){e.prototype.handleClick.call(this,t)},n.buildCSSClass=function(){return""+e.prototype.buildCSSClass.call(this)},t}(Ct);It.prototype.kind_="playToggle",It.prototype.controlText_="playToggle",At.registerComponent("EmpPlayToggle",It);var wt=(ue.getComponent("Component"),ue.getComponent("Button")),Pt=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,n.addClass("vjs-hidden"),t.ready(function(){n.initAirPlay()}),n}i(n,e);var r=n.prototype;return r.initAirPlay=function(){var e=this.player();if(window.WebKitPlaybackTargetAvailabilityEvent){e.el().getElementsByTagName("video")[0].addEventListener("webkitplaybacktargetavailabilitychanged",function(t){switch(t.availability){case"available":ye("Airplay available"),e.on("loadeddata",function(){e.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")&&(this.entitlement&&this.entitlement.airplayBlocked?e.controlBar.airplayToggle.hide():e.controlBar.airplayToggle.show())});break;case"not-available":ye("Airplay not-available")}})}},r.buildCSSClass=function(){return"vjs-airplay-control "+e.prototype.buildCSSClass.call(this)},r.handleClick=function(){this.entitlement&&this.entitlement.airplayBlocked?ye("Airplay Blocked"):(this.player().el().getElementsByTagName("video")[0].webkitShowPlaybackTargetPicker(),this.player().trigger(pe.AIRPLAY_START))},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(wt);Pt.prototype.controlText_="Airplay",ue.registerComponent("AirplayToggle",Pt);var xt=ue.getComponent("Button"),Dt=ue.getComponent("Component"),Ot=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,n.controlText("Next program"),n.updateShowing(),n.on(n.player(),pe.PLAYING,function(){return n.updateShowing()}),n.on(n.player(),pe.DURATION_CHANGE,function(){return n.updateShowing()}),n.on(n.player(),pe.PROGRAM_CHANGED,function(e,t){return n.updateShowing(t&&t.program)}),n}i(n,e);var r=n.prototype;return r.updateShowing=function(e){e=e||this.player().getProgramDetails(),!this.player().noEPG()&&this.entitlement&&e?(this.show(),this.enable()):this.hide(),e&&Date.now()<e.end.getTime()&&this.disable(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},r.buildCSSClass=function(){return"emp-next-control "+e.prototype.buildCSSClass.call(this)},r.handleClick=function(){this.player().ended()||this.player().playNextProgram()},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(xt);Ot.prototype.controlText_="Next",Dt.registerComponent("EmpNextButton",Ot);var kt=ue.getComponent("Button"),Lt=ue.getComponent("Component"),Rt=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,n.controlText("Previous Program"),n.updateShowing(),n.on(n.player(),pe.PLAYING,function(){return n.updateShowing()}),n.on(n.player(),pe.DURATION_CHANGE,function(){return n.updateShowing()}),n.on(n.player(),pe.PROGRAM_CHANGED,function(){return n.updateShowing()}),n}i(n,e);var r=n.prototype;return r.updateShowing=function(){var e=this.player().getProgramDetails();!this.player().noEPG()&&this.entitlement&&e?this.show():this.hide(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},r.buildCSSClass=function(){return"emp-previous-control "+e.prototype.buildCSSClass.call(this)},r.handleClick=function(){this.player().ended()||this.player().playPreviousProgram()},t(n,[{key:"entitlement",get:function(){return Re.getEntitlement(this.player())}}]),n}(kt);Rt.prototype.controlText_="Previous",Lt.registerComponent("EmpPreviousButton",Rt);var Nt=ue.getComponent("ControlBar"),Mt=ue.getComponent("Component"),Bt=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(Nt);Bt.prototype.options_={loadEvent:"play",children:{empPlayToggle:{},empReloadButton:{},empStopButton:{},empPreviousButton:{},empRewindButton:{},empForwardButton:{},empNextButton:{},volumePanel:{inline:!1},empTimeDisplay:{mode:"currentTime"},timeDivider:{},durationDisplay:{},empLiveDisplay:{},progressControl:{},empTimeDisplay2:{mode:"remainingTime"},customControlSpacer:{},empRestartButton:{},playbackRateMenuButton:{},chaptersButton:{},bitrateButton:{},audioTrackButton:{},subsCapsButton:{},airplayToggle:{},fullscreenToggle:{}}},Mt.registerComponent("ControlBar",Bt);var Ut=ue.getComponent("Component"),Ht={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},Gt=function(e){function t(t,i,n){var r;return r=e.call(this,t,i,n)||this,t.on("loadstart",Se(c(c(r)),r.toggleDisplay)),t.on("texttrackchange",Se(c(c(r)),r.updateDisplay)),t.on("loadstart",Se(c(c(r)),r.preselectTrack)),t.ready(Se(c(c(r)),function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)return void this.hide();if("DASH"===t.streamType||"HLS"===t.streamType||"EmpCast"===t.techName_)return void this.hide();t.on("fullscreenchange",Se(this,this.updateDisplay));for(var e=this.options_.playerOptions.tracks||[],i=0;i<e.length;i++)this.player_.addRemoteTextTrack(e[i],!0);this.preselectTrack()})),r}i(t,e);var n=t.prototype;return n.preselectTrack=function(){for(var e,t,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),o=this.player_.cache_.selectedLanguage,s=0;s<r.length;s++){var a=r[s];o&&o.enabled&&o.language===a.language?a.kind===o.kind?i=a:i||(i=a):o&&!o.enabled?(i=null,e=null,t=null):a.default&&("descriptions"!==a.kind||e?a.kind in n&&!t&&(t=a):e=a)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},n.toggleDisplay=function(){if("DASH"===this.player_.streamType||"HLS"===this.player_.streamType||"EmpCast"===this.player_.techName_)return void this.hide();this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},n.clearDisplay=function(){"function"==typeof le.WebVTT&&le.WebVTT.processCues(le,[],this.el_)},n.removeStyles=function(e){var t=Ie.getElementById(e);return t&&Ie.getElementsByTagName("head")[0].removeChild(t),t},n.writeStyles=function(e,t){var i=this.removeStyles(e);i=Ie.createElement("style"),i.type="text/css",i.id=e,i.innerHTML=t,Ie.getElementsByTagName("head")[0].appendChild(i)},n.getStyle=function(e){var t,i,n,r,o,s,a,l,c,u;return e.color&&(t="color: "+e.color),e.textOpacity&&(t="color: "+W(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(i="background-color: "+e.backgroundColor),e.backgroundOpacity&&(i="background-color: "+W(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(u=e.windowOpacity?"outline: "+W(e.windowColor,e.windowOpacity)+" solid 10px":"outline: "+e.windowColor+" solid 10px"),e.edgeStyle&&("dropshadow"===e.edgeStyle?n="text-shadow: 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, black 0.1em 0.1em 0.2em":"raised"===e.edgeStyle?n="text-shadow: 1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===e.edgeStyle?n="text-shadow: 1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===e.edgeStyle&&(n="text-shadow: 0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),e.fontPercent&&1!==e.fontPercent&&(r="font-size: "+e.fontPercent+"em",o="height: auto",s="top: auto",a="bottom: 2px"),e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?l="font-variant: small-caps":c="font-family: "+Ht[e.fontFamily]),(t?t+"; ":"")+(i?i+"; ":"")+(n?n+"; ":"")+(r?r+"; ":"")+(o?o+"; ":"")+(s?s+"; ":"")+(a?a+"; ":"")+(l?l+"; ":"")+(c?c+"; ":"")+(u?u+"; ":"")},n.getSafariStyle=function(e){var t;return e.backgroundColor&&(t="background-color: "+e.backgroundColor),e.backgroundOpacity&&(t="background-color: "+W(e.backgroundColor||"#000",e.backgroundOpacity)),t?"video::-webkit-media-text-track-display-backdrop {"+t+" !important;overflow: visible !important;}":""},n.updateDisplay=function(){if(this.player_.textTrackSettings){var e;e=this.player_.options_.textTrackStyle?this.player_.options_.textTrackStyle:this.player_.textTrackSettings.getValues();if("DASH"===this.player_.streamType||"EmpHLS"===this.player_.techName_||"HLS"===this.player_.streamType){var t=this.getStyle(e);return"EmpHLS"===this.player_.techName_?this.writeStyles("styles_cue","video::cue {"+t+"}\n"+this.getSafariStyle(e)):this.writeStyles("styles_cue","video::cue {"+t+"}"),void this.clearDisplay()}this.removeStyles("styles_cue")}else this.writeStyles("style_no_texttrack_settings",".vjs-texttrack-settings {display: none;}");return},n.updateForTrack=function(e){return},t}(Ut);Ut.registerComponent("TextTrackDisplay",Gt);var Ft=ue.getComponent("Component"),jt=ue.getComponent("ModalDialog"),Vt=["#000","Black"],Wt=["#00F","Blue"],qt=["#0FF","Cyan"],Kt=["#0F0","Green"],Yt=["#F0F","Magenta"],zt=["#F00","Red"],Xt=["#FFF","White"],$t=["#FF0","Yellow"],Jt=["1","Opaque"],Zt=["0.5","Semi-Transparent"],Qt=["0","Transparent"],ei={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Vt,Xt,zt,Kt,Wt,$t,Yt,qt]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Qt,Zt,Jt]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Xt,Vt,zt,Kt,Wt,$t,Yt,qt]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]],default:4},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.25","25%"],["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["2.50","250%"]],default:3,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Jt,Zt]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Qt,Zt,Jt]}};ei.windowColor.options=ei.backgroundColor.options;var ti=function(e){function t(t,i){var n;return i.temporary=!1,n=e.call(this,t,i)||this,n.updateDisplay=Se(c(c(n)),n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=D("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),void 0===i.persistTextTrackSettings&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),m(ei,function(e){n.on(n.$(e.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}i(t,e);var n=t.prototype;return n.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},n.createElSelect_=function(e,t,i){var n=this;void 0===t&&(t=""),void 0===i&&(i="label");var r=ei[e],o=r.id.replace("%s",this.id_);return["<"+i+' id="'+o+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(r.label),"</"+i+">",'<select aria-labelledby="'+(""!==t?t+" ":"")+o+'">'].concat(r.options.map(function(e){var i=o+"-"+e[1];return['<option id="'+i+'" value="'+e[0]+'" ','aria-labelledby="'+(""!==t?t+" ":"")+o+" "+i+'">',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},n.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},n.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},n.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},n.createElColors_=function(){return D("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},n.createElFont_=function(){return D("div",{className:'vjs-track-settings-font">',innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},n.createElControls_=function(){var e=this.localize("restore all settings to the default values");return D("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},n.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.label=function(){return this.localize("Caption Settings Dialog")},n.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.getValues=function(){var e=this;return f(ei,function(t,i,n){var r=K(e.$(i.selector),i.parser);return void 0!==r&&(t[n]=r),t},{})},n.setValues=function(e){var t=this;m(ei,function(i,n){Y(t.$(i.selector),e[n],i.parser)})},n.setDefaults=function(){var e=this;m(ei,function(t){var i=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=i})},n.restoreSettings=function(){var e;try{e=JSON.parse(le.localStorage.getItem("vjs-text-track-settings"))}catch(e){ye.warn(e)}e&&this.setValues(e)},n.saveSettings=function(){var e=this.getValues();if(this.player_.options_.textTrackStyle=void 0,"EmpCast"===this.player_.techName_&&this.player_.techCall_("sendTextTrackStyle",e),this.options_.persistTextTrackSettings)try{Object.keys(e).length?le.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):le.localStorage.removeItem("vjs-text-track-settings")}catch(e){ye.warn(e)}},n.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(Ie,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},t}(jt);Ft.registerComponent("TextTrackSettings",ti);var ii=ue.getComponent("Component"),ni=function(e){function t(t,i){var n;return n=e.call(this,t,i)||this,n.assetMetadata=null,n.on(n.player(),pe.ENDED,function(){n.hide(),n.clearEl(),n.assetMetadata=null}),n.on(n.player(),pe.ABORT,function(){n.hide(),n.clearEl(),n.assetMetadata=null}),n.on(n.player(),pe.CHROMECAST_CASTING,function(){n.hide(),n.clearEl(),n.assetMetadata=null}),n.on(n.player(),pe.PLAYING,function(){if(n.show(),!n.assetMetadata){var e=n.player().options();e.mediaInfo&&n.updateMediaInformation_({title:e.mediaInfo.title,subtitle:e.mediaInfo.subtitle,images:e.mediaInfo.artworkUrl?[{url:e.mediaInfo.artworkUrl}]:[],channelInfo:{images:e.mediaInfo.logoUrl?[{url:e.mediaInfo.logoUrl}]:[]}})}}),n.on(n.player(),pe.PROGRAM_CHANGED,function(e,t){(t&&t.program?t.program.programId:null)?(n.assetMetadata=n.player().programService().extractAssetMetadata(t.program.asset),n.assetMetadata.channelInfo=t.program.channelInfo,n.updateMediaInformation_(n.assetMetadata)):(n.hide(),n.clearEl(),n.assetMetadata=null)}),n.on(n.player(),pe.ASSET_CHANGED,function(e,t){t&&t.asset?(n.assetMetadata=n.player().programService().extractAssetMetadata(t.asset),n.updateMediaInformation_(n.assetMetadata)):(n.hide(),n.clearEl(),n.assetMetadata=null)}),n.on(n.player(),pe.DISPOSE,function(){n.hide(),n.clearEl()}),n.fillEl(),n}i(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"emp-mediainfo-bar "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"emp-mediainfo-bar"})},n.imageSelector=function(e,t){var i;e.length>0&&(i=e[0]);for(var n=0;n<e.length;n++)if(e[n].url&&e[n].type===t)return e[n];return i},n.updateMediaInformation_=function(e){if(this.el_){this.show();if(this.player().options().mediaInfo){this.fillEl();var t=this.el_.getElementsByClassName("emp-media-artwork"),i=this.el_.getElementsByClassName("emp-media-logo"),n=this.el_.getElementsByClassName("emp-media-title"),r=this.el_.getElementsByClassName("emp-media-subtitle"),o=t.length?t[0]:null,s=i.length?i[0]:null,a=n.length?n[0]:null,l=r.length?r[0]:null;if(a&&(a.innerHTML=e.title||""),l&&(l.innerHTML=e.subtitle||""),o&&e.images&&e.images.length>0){var c=this.imageSelector(e.images,"chromecast");o.style.backgroundImage='url("'+c.url+'")',o.style.display="block"}else o&&(o.style.display="none",o.style.backgroundImage="none");if(s&&e.channelInfo){var u=this.imageSelector(e.channelInfo.images,"thumbnail");u&&u.url?(s.style.backgroundImage='url("'+u.url+'")',s.style.display="block"):(s.style.display="none",s.style.backgroundImage="none")}this.player().userActive(!0)}}},n.clearEl=function(){this.el_&&(this.el_.innerHTML="")},n.fillEl=function(){var e=this.player().options();if(e.mediaInfo){var t="";e.mediaInfo.artworkEnable&&(t+='<div class="emp-media-artwork"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+='<div class="emp-media-text">'),e.mediaInfo.titleEnable&&(t+='<div class="emp-media-title"></div>'),e.mediaInfo.subtitleEnable&&(t+='<div class="emp-media-subtitle"></div>'),(e.mediaInfo.titleEnable||e.mediaInfo.subtitleEnable)&&(t+="</div>"),e.mediaInfo.logoEnable&&(t+='<div class="emp-media-logo"></div>'),this.el_.innerHTML=t}else this.el_.innerHTML=""},t}(ii);ni.prototype.controlText_="MediaInfo",ii.registerComponent("EmpMediaInfoBar",ni),z.prototype.code=0,z.prototype.message="",z.prototype.status=null,z.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],z.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var ri=0;ri<z.errorTypes.length;ri++)z[z.errorTypes[ri]]=ri,z.prototype[z.errorTypes[ri]]=ri;var oi=ue.getComponent("Player"),si=ue.getComponent("Tech"),ai=ue.getComponent("CaptionSettingsMenuItem");le.vttjs&&le.vttjs.restore();var li=function(e){function n(t,i,r){var o;void 0===i&&(i={}),void 0===r&&(r=function(){}),i.absoluteStartTime&&(i.startTime=0),i=g({children:["mediaLoader","PosterImage","textTrackDisplay","loadingSpinner","empMediaInfoBar","controlBar","errorDisplay","textTrackSettings","BigPlayButton"]},i),
"auto"===i.techOrder||Array.isArray(i.techOrder)&&1===i.techOrder.length&&"auto"===i.techOrder[0]?i.techOrder=n.AutoTechArray("EmpShaka"):"auto-dashif"===i.techOrder||Array.isArray(i.techOrder)&&1===i.techOrder.length&&"auto-dashif"===i.techOrder[0]?i.techOrder=n.AutoTechArray("EmpDashif"):Array.isArray(i.techOrder)&&(i.techOrder=n.GetValidAutoTechOrder(i.techOrder));var s=n.getTagSettings(t);return i=ue.mergeOptions({"entitlement-engine":"EricssonExposure",techOrder:s.techOrder?s.techOrder:n.AutoTechArray("EmpShaka"),maxBitrate:s.maxBitrate?s.maxBitrate:0,timeShiftDisabled:!!s.timeShiftDisabled&&s.timeShiftDisabled,useLastViewedOffset:!!s.useLastViewedOffset&&s.useLastViewedOffset,startTime:s.startTime?s.startTime:0,absoluteStartTime:s.absoluteStartTime?s.absoluteStartTime:void 0,persistTextTrackSettings:s.persistTextTrackSettings?s.persistTextTrackSettings:!tt,textTrackSettings:s.textTrackSettings?s.textTrackSettings:!tt},i),o=e.call(this,t,i,r)||this,o.monkeyPatchingTextMenu_(),le.empPlayer&&ye.islogToBrowserConsole&&le.empPlayer.setInstance(c(c(o))),o.previousAbsoluteStartTime_=void 0,o.castPlugin&&o.castPlugin(),o.on(pe.ENDED,function(){ye("ENDED"),o.ended_=!0,o.sourceChanging_=!1,o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop(),"EmpCast"!==o.techName_&&o.loadNextSource(),o.yospace&&o.yospace().stop()}),o.on(pe.DISPOSE,function(){o.loadNextSrc_=null,o.loadingSrc_&&(clearInterval(o.loadingSrc_),o.loadingSrc_=null),o.sourceChanging_=!1,o.clearResetAndReloadTimer_(),o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop()}),o.on(pe.ERROR,function(){o.loadNextSrc_=null,o.loadingSrc_&&(clearInterval(o.loadingSrc_),o.loadingSrc_=null),o.sourceChanging_=!1,o.clearResetAndReloadTimer_(),o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop(),o.yospace&&o.yospace().stop()}),o.on(pe.CAN_PLAY,function(){o.disableTimeShift(o.options_.timeShiftDisabled)}),o.on(pe.LOADED_DATA,function(){if(o.addClass("vjs-has-started"),o.ended_=!1,o.programService){var e=o.programService().entitlement();e&&(e.streamInfo.referenceTime=o.startTimeLive())}}),o.on(pe.REPLAY,function(){o.cache_&&o.cache_.source&&o.cache_.source.yospaceUrl?o.src({src:o.cache_.source.yospaceUrl,type:"application/yospace"}):o.cache_&&o.cache_.source&&o.src(o.cache_.source)}),o.on(pe.FIRST_PLAY,function(){ye("FIRST_PLAY"),o.options_.startTime&&"Html5"===o.techName_&&o.currentTime(o.options_.startTime),o.options_.startTime=0}),o.initialSeekToAbsoluteStartTimeBind=o.initialSeekToAbsoluteStartTime_.bind(c(c(o))),o.isCreated=!0,o.trigger(pe.PLAYER_CREATED),o.ended_=!1,o.sourceChanging_=!1,o}i(n,e);var r=n.prototype;return r.monkeyPatchingTextMenu_=function(){if(this.controlBar&&this.controlBar.subsCapsButton){var e=this.controlBar.subsCapsButton.createItems,t=this;this.controlBar.subsCapsButton.createItems=function(){for(var i=e.apply(this,arguments),n=[],r=0;r<i.length;r++)i[r].track&&""!==i[r].track.label&&n.push(i[r]);return n&&n.length>1&&"CaptionSettingsMenuItem"!==n[0].name()&&"EmpHLS"===t.techName_&&t.options_.textTrackSettings?(n.unshift(new ai(this.player_,{kind:this.label_})),this.hideThreshold_+=1):n&&n.length>1&&"CaptionSettingsMenuItem"===n[0].name()&&"EmpDashif"===t.techName_&&(n.shift(),this.hideThreshold_-=1),n}}if(Ze){var i=ue.getComponent("TextTrackMenuItem");if(i){var n=i.prototype.handleClick,t=this;i.prototype.handleClick=function(){n.apply(this,arguments),t.trigger(pe.TRACK_CHANGE),t.trigger(pe.TEXT_TRACK_CHANGE)}}}},r.options=function(e){return e?("auto"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto"===e.techOrder[0]?e.techOrder=n.AutoTechArray("EmpShaka"):"auto-dashif"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto-dashif"===e.techOrder[0]?e.techOrder=n.AutoTechArray("EmpDashif"):Array.isArray(e.techOrder)&&(e.techOrder=n.GetValidAutoTechOrder(e.techOrder)),void 0!==e.startTime&&(e.startTime=parseFloat(e.startTime)||0),void 0!==e.absoluteStartTime&&(e.startTime=0),this.options_=ue.mergeOptions(this.options_,e),this.options_):this.options_},r.getTechOptions_=function(){return{autoplay:this.options_.autoplay,muted:this.options_.muted,language:this.options_.language,maxBitrate:this.options_.maxBitrate,timeShiftDisabled:this.options_.timeShiftDisabled,useLastViewedOffset:this.options_.useLastViewedOffset,startTime:this.options_.startTime,absoluteStartTime:this.options_.absoluteStartTime,audioLanguage:this.options_.audioLanguage,subtitleLanguage:this.options_.subtitleLanguage,liveDelay:this.options_.liveDelay}},r.loadTech_=function(t,i){var n=this;e.prototype.loadTech_.call(this,t,i),this.on(this.tech_,pe.RECOVERABLE_ASSET_ERROR,this.handleRecoverableError),this.on(this.tech_,pe.ERROR,function(e,t){n.player_.error(t)}),this.on(this.tech_,pe.TRACK_CHANGE,function(){ye("TRACK_CHANGE"),n.player_.trigger(pe.TRACK_CHANGE)}),this.on(this.tech_,pe.DURATION_CHANGE,function(){n.player_.trigger(pe.DURATION_CHANGE)})},r.loadNextSource=function(){return this.sourceChanging_?void ye("loadNextSource ignore sourceChanging"):(this.sourceChanging_=!0,this.tech_&&void 0!==this.tech_.loadNextSource?(this.techCall_("loadNextSource"),!0):this.cache_.sources&&this.cache_.sources.length>1?(this.cache_.sources.shift(),this.src(this.cache_.sources),!0):(this.sourceChanging_=!1,!1))},r.setTextTrackStyle=function(e){"EmpCast"===this.techName_?this.techCall_("sendTextTrackStyle",e):(this.options_.textTrackStyle=e,this.trigger(pe.TEXT_TRACK_CHANGE))},r.lineUpAsset=function(e,t,i,n){var r={assetId:e,programId:i,channelId:t};n&&this.options({playFrom:"beginning",absoluteStartTime:n}),this.lineupSource({type:"video/emp",src:JSON.stringify(r)})},r.lineupSource=function(e){if(this.tech_&&void 0!==this.tech_.lineupSource)return void this.techCall_("lineupSource",e);this.cache_.sources.push(e)},r.unloadTech_=function(){this.techName_=null,e.prototype.unloadTech_.call(this),this.textTracksJson_=[]},r.stop=function(e){this.analytics&&this.analytics().stop(),this.yospace&&this.yospace().stop(),Re.stop(this,e)},r.getAvalibleTechs_=function(e){return this.options_.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,si.getTech(e)]}).filter(function(t){var i=t[0],n=t[1];if(n&&"Html5"!==i&&"EmpCast"!==i&&-1===e.indexOf(i))return n.isSupported()})},r.selectSource=function(t){var i=this,n=this.options_.techOrder;if(this.options_.excludeTechs&&this.options_.excludeTechs.length>0){var r=this.options_.techOrder.filter(function(e){if(-1===i.options_.excludeTechs.indexOf(e))return!0});this.options_.techOrder=r}var o=e.prototype.selectSource.call(this,t);return this.options_.techOrder=n,o},r.handleRecoverableError=function(t,i){var n=[];this.options_.excludeTechs&&(n=this.options_.excludeTechs.slice(0)),n.push(i.techName);var r=this.getAvalibleTechs_(n);if(i.source&&!i.source.licenseServer&&(!i.source.licenseServers||y(i.source.licenseServers))&&!i.source.protection&&!Ke&&r.length>0&&(6001!==i.error.code&&(ye.error("handleRecoverableError",i.techName,i.message),this.analytics&&this.analytics().onError({code:i.error.code,message:i.message,stack:i.error.stack})),this.options_.excludeTechs||(this.options_.excludeTechs=[]),this.options_.excludeTechs.push(i.techName),this.options_.techOrder.length>this.options_.excludeTechs.length)){if(this.error(null),this.resetWithoutReload_(),this.hasStarted()&&(this.options_.autoplay=!0),this.autoplay(this.options_.autoplay),this.options_.absoluteStartTime=this.previousAbsoluteStartTime_,i.source.assetId){var o={assetId:i.source.assetId};return void e.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(o)})}if(i.source.channelId){var s={channelId:i.source.channelId,programId:i.source.programId};return void e.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(s)})}}i.error.code&&i.error.message?this.error(i.error):(i.message=i.message||this.localize("Tech error, can't recover"),this.error(new fe(i.message,i.error.code))),this.resetWithoutReload_()},r.resetWithoutReload_=function(){this.tech_&&(this.techCall_("reset"),this.unloadTech_())},r.resetAndRestartFormPlayhead=function(){var e=this.getProgramDetails();e&&Re.currentAsset(this,e.assetId,e.programId,e.channelId);var t=this.getAbsoluteTime();ye("resetAndRestartFormPlayhead",t),this.reset(),this.startResetAndReloadTimer_(),this.restart(null,t)},r.bitrates=function(){return Re.bitrates(this)},r.bitrate=function(e){return Re.bitrate(this,e)},r.getBitrate=function(){return Re.getBitrate(this)},r.selectAudioTrack=function(e,t){for(var i=this.audioTracks(),n=i.length;n--;){var r=i[n];if(r.language===e&&!r.enabled)return void(t&&r.kind!==t||(r.enabled=!0))}},r.getSelectedAudioTrack=function(){return Re.getSelectedAudioTrack(this)},r.getAudioTracksLanguages=function(){for(var e=[],t=this.audioTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},r.selectTextTrack=function(e,t){e=e&&"None"!==e?e:null;for(var i=this.textTracks(),n=i.length;n--;){var r=i[n];r.language===e?t&&r.kind!==t||(r.mode="showing"):"disabled"!==r.mode&&(r.mode="disabled")}"EmpHLS"===this.techName_&&Ze&&(this.trigger(pe.TRACK_CHANGE),this.trigger(pe.TEXT_TRACK_CHANGE))},r.getSelectedTextTrack=function(){return Re.getSelectedTextTrack(this)},r.textTrackVisible=function(e){for(var t=this.textTracks(),i=t.length;i--;){var n=t[i];if(e){if("hidden"===n.mode)return void(n.mode="showing")}else"showing"===n.mode?n.mode="hidden":"disabled"!==n.mode&&(n.mode="disabled")}},r.isTextTrackVisible=function(){for(var e=this.textTracks(),t=e.length;t--;){if("showing"===e[t].mode)return!0}return!1},r.getTextTracksLanguages=function(){for(var e=[],t=this.textTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},r.canSeekTo=function(e){return Re.canSeekTo(this,e)},r.getRestrictions=function(){var e={},t=Re.getEntitlement(this);return t&&(e={minBitrate:t.minBitrate,maxBitrate:t.maxBitrate,maxResWidth:t.maxResWidth,maxResHeight:t.maxResHeight,rwEnabled:t.rwEnabled,ffEnabled:t.ffEnabled}),e},r.isPlaying=function(){return this.hasStarted()},r.isLive=function(){return Re.isLive(this)},r.techVersion=function(){return Re.techVersion(this)},r.baseCurrentTime=function(){return Re.baseCurrentTime(this)},r.baseDuration=function(t){if(void 0===t)return Re.baseDuration(this);e.prototype.duration.call(this,t)},r.src=function(t){var i=this;if(void 0===t)return this.cache_.src||"";if(!this.isCreated)return void this.one(pe.PLAYER_CREATED,function(){i.src(t)});var n=E(t);if(!n.length)return void this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);if(n[0].type||(n[0].type="video/emp"),"video/emp"===n[0].type){if(this.loadingSrc_)return ye("load src blocked",t),void(this.loadNextSrc_=t);this.loadingSrc_=setTimeout(function(){i.loadingSrc_=null,i.loadNextSrc_&&i.src(i.loadNextSrc_)},3e3)}return this.loadNextSrc_=null,ye("load src OK"),this.yospace&&this.yospace().stop(),this.options_.excludeTechs=[],this.tech_||this.reset(),this.cache_.currentTime=0,this.cache_.duration=NaN,this.error(null),"video/emp"!==n[0].type&&this.stopProgramService(),this.isPlaying()&&(this.sourceChanging_=!0),Re.casting(this,n)?void 0:(n[0].options&&this.options(n[0].options),"video/emp"!==n[0].type&&(n[0].options=this.getTechOptions_()),this.off(pe.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),this.one(pe.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),"application/yospace"===n[0].type&&this.yospace?void this.yospace().start("VoD",n[0].src).then(function(t){ye("yospace mediaLocator returned",t),i.options_.excludeTechs.push("EmpShaka"),i.options_.excludeTechs.push("EmpDashif"),n[0]={src:t,type:"application/x-mpegURL",yospaceUrl:n[0].src},e.prototype.src.call(i,n)}).catch(function(e){i.error(e)}):e.prototype.src.call(this,n))},r.reset=function(){this.clearResetAndReloadTimer_(),this.hasStarted(!1),e.prototype.reset.call(this)},r.clearResetAndReloadTimer_=function(){this.resetAndReloadTimer_&&(ye("clearResetAndReloadTimer"),clearInterval(this.resetAndReloadTimer_),this.resetAndReloadTimer_=null)},r.startResetAndReloadTimer_=function(){var e=this;if(!(Ke&&this.hasStarted()||(this.clearResetAndReloadTimer_(),ye("startResetAndReloadTimer"),!1===this.options_.resetAndReloadLive))){var t=120;t=this.options_.resetAndReloadLive?this.options_.resetAndReloadLive>1?this.options_.resetAndReloadLive:1:Ke?120:360,this.resetAndReloadTimer_=this.setTimeout(function(){e.clearResetAndReloadTimer_(),e.isLive()&&"DASH"===e.streamType&&e.resetAndRestartFormPlayhead()},1e3*t*60)}},r.initialSeekToAbsoluteStartTime_=function(){var e=Re.getEntitlement(this);this.options_.absoluteStartTime&&this.timeShiftEnabled()?(this.setAbsoluteTime(new Date(this.options_.absoluteStartTime)),this.previousAbsoluteStartTime_=this.options_.absoluteStartTime,this.options_.absoluteStartTime=void 0):this.options_.useLastViewedOffset&&e&&!this.isLive()&&"DASH"===this.streamType&&e.lastViewedOffset&&this.currentTime(e.lastViewedOffset/1e3)},r.setMaxBitrate=function(e){this.options_.maxBitrate=e,this.tech_&&void 0!==this.tech_.setMaxBitrate&&this.techCall_("setMaxBitrate",e)},r.getMaxBitrate=function(){return this.tech_&&void 0!==this.tech_.getMaxBitrate?this.techGet_("getMaxBitrate"):0},r.disableTimeShift=function(e){if(!this.tech_||void 0===this.tech_.disableTimeShift)return!1;if(void 0!==e){if(!1===e&&!this.canEnableTimeshift())return!Re.timeShiftEnabled(this);this.techCall_("disableTimeShift",e);var t=Re.timeShiftEnabled(this);return this.options_.timeShiftDisabled=void 0===t?e:!t,this.trigger(pe.TIMESHIFT_CHANGE,{timeShiftDisabled:this.options_.timeShiftDisabled}),this.options_.timeShiftDisabled}return!Re.timeShiftEnabled(this)},r.canEnableTimeshift=function(){var e=Re.getEntitlement(this);return!e||!1!==e.timeshiftEnabled},r.timeShiftEnabled=function(e){if(void 0===e)return Re.timeShiftEnabled(this);this.disableTimeShift(!e)},r.noEPG=function(){if(!this.getProgramDetails()){var e=Re.getEntitlement(this);return!e||e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)}return!1},r.canRestart=function(){return!Re.getEntitlement(this)||!this.noEPG()&&Re.canRestart(this)},r.restart=function(e,t){Re.restart(this,e,t)},r.error=function(t){return void 0===t?this.error_||null:null===t?void e.prototype.error.call(this,t):this.error_&&t&&4===t.code?this.error_:(t&&T(t)?t=new fe(t):t&&!t.code&&(t.code=me.UNKNOWN),t&&this.cache_.sources&&this.cache_.sources.length>1?(ye.error(t),this.loadNextSource(),t):this.videojsError_(t))},r.videojsError_=function(e){if(void 0===e)return this.error_||null;if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new z(e),this.addClass("vjs-error");var t="";z.errorTypes.hasOwnProperty(this.error_.code)&&(t=z.errorTypes[this.error_.code]),ye.error("(CODE:"+this.error_.code+" "+t+")",this.error_.message,this.error_),this.trigger({type:pe.ERROR,bubbles:!0},this.error_)},r.getError=function(){return this.error_},r.setAbsoluteTime=function(e){Re.setAbsoluteTime(this,e)},r.getAbsoluteTime=function(){return Re.getAbsoluteTime(this)},r.playheadTime=function(e){if(void 0===e)return Re.getPlayheadTime(this);Re.setPlayheadTime(this,e)},r.setAnalyticsCustomAttribute=function(e,t){this.options_.analytics||(this.options_.analytics={}),this.options_.analytics.customAttributes||(this.options_.analytics.customAttributes=[]),this.options_.analytics.customAttributes.push({key:e,value:t})},r.loadAsset=function(e,t,i){if(void 0===i&&(i=function(){}),ye.warn("loadAsset() has been deprecated with new US a/v pipe use startPlayback() or src() instead"),this.options({playFrom:void 0}),!e&&t)return ye.error("loadAsset: with only programId is not supported"),void i();Re.loadAsset(this,t?void 0:e,t,t?e:void 0,i)},r.startPlaybackV2=function(e,t){this.startPlayback(e,"","",t)},r.startPlayback=function(e,t,i,n){if(n||(n={}),!e&&!t&&!i)return void ye.error("startPlayback: assetId or channelId or programId is undefined");if(!e&&!t&&i)return void ye.error("startPlayback: with only programId is not supported");n.playFrom||(n.playFrom="defaultBehaviour");var r={playFrom:n.playFrom,autoplay:!0};void 0!==n.autoplay&&(r.autoplay=n.autoplay),r.autoplay&&this.autoplay(r.autoplay),n.startTime&&"startTime"===n.playFrom?(r.absoluteStartTime=n.startTime,this.options_.useLastViewedOffset=!1):r.absoluteStartTime=void 0,void 0!==n.startOffset?r.startTime=n.startOffset/1e3:r.startTime=0,r.useLastViewedOffset="bookmark"===n.playFrom||!0===this.options_.useLastViewedOffset,this.options(r),Re.loadAsset(this,e,i,t)},r.playEntitlement=function(t){t&&v(t)?(t.type="video/emp",e.prototype.src.call(this,t)):ye.error("Call playEntitlement without entitlement")},r.timeBehindLive=function(){return Re.timeBehindLive(this)},r.liveDelay=function(){return Re.liveDelay(this)},r.startTimeLive=function(){return Re.startTimeLive(this)},r.getCurrentTechName=function(){return this.techName_},r.getExposure=function(){return this.programService?this.programService().exposure:null},r.syncServerTime=function(e){if(this.programService&&(exposure=this.programService().exposure,exposure))return void exposure.syncServerTime(e);var t="No programService or No exposure";ye.error(t),e&&e(0,t)},r.stopProgramService=function(){this.programService&&this.programService().reset()},r.startProgramService=function(){this.programService&&this.programService().start()},r.supportsEpgProgramChange=function(){return void 0!==this.programService},r.getServerTime=function(){return Re.getServerTime(this)},r.getProgram=function(e){if(this.programService){var t=this.getProgramDetails();e(t,t?null:"No EPG for program")}},r.getProgramDetails=function(){return Re.supportsEpgProgramChange(this)?Re.program(this):this.programService?this.programService().currentProgram:void 0},r.getAssetDetails=function(){return this.tech_&&this.tech_.VOD?this.techGet_("VOD"):this.programService?this.programService().currentVOD:void 0},r.getSeekTimerange=function(){return Re.getSeekTimerange(this)},r.getBufferedTimerange=function(){return Re.getBufferedTimerange(this)},r.currentTime=function(e){var t=Re.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i){e<1&&e>-1&&(e=1);var n=new Date(i.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var r=t.streamInfo;if((e+=(n.getTime()-r.start.getTime())/1e3)<=0)return e=0,void Re.playPreviousProgram(this,!0)}else if(1e3*(e+=n.getTime()/1e3)<=t.streamInfo.start.getTime())return e=t.streamInfo.start.getTime()/1e3+1,void Re.playPreviousProgram(this,!0)}return e<0&&(e=0),void this.techCall_("setCurrentTime",e)}var o=this.techGet_("currentTime")||0,s=this.getProgramDetails();if(s&&o>1){var a=new Date(s.startTime);if(t.isStaticCachupAsLive||"HLS"===this.streamType){var l=t.streamInfo;o-=(a.getTime()-l.start.getTime())/1e3}else o-=a.getTime()/1e3}else s||this.duration(1/0);return this.scrubbing()||(this.cache_.currentTime=o),this.cache_.currentTime}return void 0!==e?(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"===this.techName_||(e=e<0?0:e),void this.techCall_("setCurrentTime",e)):(this.scrubbing()||(this.cache_.currentTime=this.techGet_("currentTime")||0),this.cache_.currentTime)},r.duration=function(t){var i=Re.getEntitlement(this);if(i&&(i.isDynamicCachupAsLive||i.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==t){var n=this.getProgramDetails();if(n&&t!==1/0){var r=new Date(n.startTime);if(i.isStaticCachupAsLive||"HLS"===this.streamType){var o=i.streamInfo;t-=(r.getTime()-o.start.getTime())/1e3}else t-=r.getTime()/1e3}return this.noEPG()&&(t=1/0,this.addClass("vjs-live")),void e.prototype.duration.call(this,t)}var s=this.techGet_("duration"),a=this.getProgramDetails();return a&&s!==1/0&&(s=a.duration/1e3),this.noEPG()&&(s=1/0,this.addClass("vjs-live")),this.cache_.duration=s,s}return e.prototype.duration.call(this,t),this.techGet_("duration")},r.seekable=function(){var t=e.prototype.seekable.call(this);return"EmpCast"!==this.techName_?this.getRange_(t):t},r.buffered=function(){var t=e.prototype.buffered.call(this);return"EmpCast"!==this.techName_?this.getRange_(t):t},r.getRange_=function(e){var t=Re.getEntitlement(this);if(this.seeking()||!e)return G(0,0);if(e.length>0&&t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)){var i=this.getProgramDetails();if(i){var n=new Date(i.startTime),r=t.streamInfo,o=e.start(e.length-1),s=e.end(e.length-1);if(s)if(t.isStaticCachupAsLive||"HLS"===this.streamType)o-=(n.getTime()-r.start.getTime())/1e3,s-=(n.getTime()-r.start.getTime())/1e3,e=G(o>0?o:0,s>this.duration()?this.duration():s);else if(t.isDynamicCachupAsLive){o-=n.getTime()/1e3,s-=n.getTime()/1e3;var a=this.getGrowingLiveDuration();e=G(o>0?o:0,s>a?a:s)}}}return e},r.getGrowingLiveDuration=function(){var e=Re.getEntitlement(this),t=this.duration(),i=this.getProgramDetails();if(i&&t!==1/0&&e&&e.isDynamicCachupAsLive){if(this.getServerTime()<new Date(i.endTime).getTime()){if((t=this.techGet_("duration"))!==1/0){var n=e.streamInfo;t="HLS"===this.streamType?(n.start.getTime()+1e3*t-i.start.getTime())/1e3:(1e3*t-i.start.getTime())/1e3}}else t=i.duration/1e3}return t},r.remainingTime=function(){var e=Re.getEntitlement(this),t=0;if(e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){var i=this.duration();if(i===1/0||0===i)return 1/0;t=i-this.currentTime()}else t=Re.remainingTime(this);return t<0&&(t=0),Math.round(t)},r.gotoLive=function(){Re.gotoLive(this)},r.playPreviousProgram=function(e){var t=this;if(this.sourceChanging_)return void ye("playPreviousProgram ignore sourceChanging");if(this.tech_.playPreviousProgram)this.techCall_("playPreviousProgram",e);else{var i=Re.getEntitlement(this);this.programService&&(i.isStaticCachupAsLive||i.isDynamicCachupAsLive)&&i.rwEnabled?this.programService().getPreviousProgram(function(i,n){if(n)ye.warn("playPreviousProgram",n);else{new Date(i.startTime);e?t.playheadTime(i.end.getTime()-3e4):t.playheadTime(i.start.getTime()+1e3)}}):Re.playPreviousProgram(this)}},r.playNextProgram=function(){if(this.sourceChanging_)return void ye("playNextProgram ignore sourceChanging");if(this.tech_.playNextProgram)this.techCall_("playNextProgram");else{var e=Re.getEntitlement(this),t=this.getProgramDetails();t&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.ffEnabled?this.playheadTime(t.end.getTime()+1e3):Re.playNextProgram(this)}},r.isProgramLive=function(){var e=this.getProgramDetails();return e?e.end.getTime()>this.getServerTime():this.isLive()},r.isProgramCatchup=function(){var e=Re.getEntitlement(this);return e?e.isStaticCachupAsLive||!this.isProgramLive()&&e.isDynamicCachupAsLive:!this.isLive()},r.currentAsset=function(){return Re.currentAsset(this)},r.ended=function(){return this.ended_},r.handleTechWaiting_=function(){var e=this;!this.hasStarted()||this.ended()||this.paused()||this.hasClass("vjs-waiting")||this.playheadMoving_(function(t){t||(e.addClass("vjs-waiting"),e.trigger(pe.WAITING),e.removeWaitingClass_())})},r.removeWaitingClass_=function(){var e=this;this.one("timeupdate",function(){e.playheadTime()-e.prePlayheadTime_>1||e.playheadTime()-e.prePlayheadTime_<-1?(e.prePlayheadTime_=0,e.removeClass("vjs-waiting"),e.paused()?e.trigger(pe.PAUSE):e.trigger(pe.PLAYING)):e.removeWaitingClass_()})},r.playheadMoving_=function(e){this.playheadMovingTimer_&&(clearInterval(this.playheadMovingTimer_),this.playheadMovingTimer_=null),this.prePlayheadTime_=this.playheadTime(),this.playheadMovingTimer_=this.setTimeout(function(){e(this.playheadTime()-this.prePlayheadTime_>200||this.playheadTime()-this.prePlayheadTime_<-200)},2e3)},r.handleTechCanPlay_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(pe.CAN_PLAY)},r.handleTechCanPlayThrough_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(pe.CAN_PLAY_THROUGH)},r.handleTechPlaying_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.sourceChanging_=!1,this.trigger(pe.PLAYING)},r.sourceChanging=function(){return this.sourceChanging_},r.isCasting=function(){return"EmpCast"===this.techName_},t(n,[{key:"version",get:function(){return"2.1.100-291"}},{key:"entitlement",get:function(){var e=Re.getEntitlement(this);return e&&(e=g({},e),e.options=void 0),e}},{key:"streamType",get:function(){return this.tech_?this.tech_.streamType:void 0}}]),n}(oi);li.AutoTechArray=function(e){var t=si.techs_.hasOwnProperty("EmpShaka"),i=si.techs_.hasOwnProperty("EmpDashif");t&&i||(e=t?"EmpShaka":"EmpDashif");var n=[e,"EmpHLS-MSE","EmpHLS","Html5"];return li.SupportFairplay_()&&(n=["EmpHLS",e,"Html5"]),li.GetValidAutoTechOrder(n)},li.GetValidAutoTechOrder=function(e){for(var t=[],i=0;i<e.length;i++)si.techs_.hasOwnProperty(e[i])&&t.push(e[i]);return t},li.SupportFairplay_=function(){var e=ue.getTech("EmpHLS");return!!(void 0!==e&&e.isSupported()&&le.WebKitMediaKeys&&e.getKeySystem&&le.WebKitMediaKeys.isTypeSupported(e.getKeySystem(),"video/mp4"))},ue.getComponent("Component").registerComponent("player",li);var ci=(le.empPlayer,function(){function e(e,t,i){this.INITIAL_REFERENCE_TIME=1,this.player_=e,this.analytics_=t,this.sessionId_=null,this.customAttributes=i.analytics&&i.analytics.customAttributes,this.exposure=i.exposure,this.currentTimeTimer=null,this.onPlayBind=this.onPlay.bind(this),this.onResumedBind=this.onResume.bind(this),this.onPlayingBind=this.onPlaying.bind(this),this.onPauseBind=this.onPause.bind(this),this.onEndedBind=this.onEnded.bind(this),this.onErrorBind=this.onError.bind(this),this.onDrmSessionUpdateBind=this.onDrmSessionUpdate.bind(this),this.onEntitlementLoadStartBind=this.onEntitlementLoadStart.bind(this),this.onBitrateChangeBind=this.onBitrateChange.bind(this),this.onDisposeBind=this.onDispose.bind(this),this.onLoadStartBind=this.onLoadStart.bind(this),this.onSeekedBind=this.onSeeked.bind(this),this.onWaitingBind=this.onWaiting.bind(this),this.onChromeCastingStartBind=this.onChromeCastingStart.bind(this),this.onChromeCastingStopBind=this.onChromeCastingStop.bind(this),this.onProgramChangeBind=this.onProgramChange.bind(this),this.onWaitingEndedBind=this.onWaitingEnded.bind(this),this.onErrorBeforeAssetBind=this.onErrorBeforeAsset.bind(this),this.onEntitlementChangeBind=this.onEntitlementChange.bind(this),this.onWindowUnloadBind=this.onWindowUnload.bind(this),this.onPlayingAfterStartBind=this.onPlayingAfterStart.bind(this),this.allEvents_=Object.keys(pe).map(function(e){return pe[e]}),this.init(),this.createdSessions={},this.mem={}}var i=e.prototype;return i.SessionId=function(e){if(!(e||this.entitlement()&&this.entitlementLoaded_))return this.errorSessionId;var t=e||this.entitlement().playSessionId;return this.mem[t]||(this.mem[t]={pause:{},resume:{}}),t},i.hasSessionId=function(){return!(!this.entitlement()||!this.entitlementLoaded_)},i.sendCurrentTime=function(){var e=this.SessionId();e&&this.player_&&this.analytics_.getSessionState&&"PLAYING"===this.analytics_.getSessionState(e)&&this.analytics_.setCurrentTime(e,this.OffsetTime())},i.registerCurrentTimeTimer=function(){var e=this;this.clearTimers(),this.currentTimeTimer=setInterval(function(){e.sendCurrentTime();var t=e.SessionId();t&&e.analytics_&&e.analytics_.ok&&!1===e.analytics_.ok(t)&&(e.exposure?e.exposure.verifySession(null,function(){e.player_.el_&&(e.player_.trigger(pe.ERROR,"401 INVALID_SESSION_TOKEN: The session token is no longer valid."),Re.stop(e.player_)),e.clearTimers()}):ye.error("registerCurrentTimeTimer Exposure is undefined"))},1e3)},i.clearTimers=function(){this.currentTimeTimer&&clearInterval(this.currentTimeTimer),this.currentTimeTimer=null},i.init=function(){if(!this.player_||!this.analytics_)return void ye.warn("Warning: init failed . Possible causes: either player or analytics were not set.");this._errorSessionId=null,this.disabled_=!1,this.entitlementLoaded_=!1,ye("Initialization EmpAnalytics"),this.analytics_.init(),le.addEventListener("beforeunload",this.onWindowUnloadBind),this.player_.on(pe.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.on(pe.PAUSE,this.onPauseBind),this.player_.on(pe.SEEKED,this.onSeekedBind),this.player_.on(pe.ENDED,this.onEndedBind),this.player_.on(pe.ERROR,this.onErrorBind),this.player_.on(pe.DISPOSE,this.onDisposeBind),this.player_.on(pe.STOPPED,this.onDisposeBind),this.player_.on(pe.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.on(pe.WAITING,this.onWaitingBind),this.player_.on(pe.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.on(pe.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.on(pe.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.on(pe.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},i.onWindowUnload=function(){var e=this;this.onGeneric("WindowClose",this.analytics_.dispose,function(){!0===e.hasSessionId()&&e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.analytics_.dispatchNow(!1),e.clearTimers()},!0)},i.onChromeCastingStart=function(){var e=this;this.onGeneric("StartCasting",this.analytics_.startCasting,function(){if(!1!==e.hasSessionId()){if(e.SessionId()){var t=e.getCachedCurrentTime();ye("StartCasting",t),e.analytics_.startCasting(e.SessionId(),t)}e.clearTimers()}},!1),this.disabled_=!0},i.onChromeCastingStop=function(e){var t=this;this.disabled_=!1,e&&this.onGeneric("StopCasting",this.analytics_.stopCasting,function(){!1!==t.hasSessionId()&&t.analytics_.stopCasting(t.SessionId(),t.OffsetTime())},!1)},i.onProgramChange=function(e,t){var i=this,n=t?t.program:null;ye("analytics","onProgramChange",n),n&&this.analytics_.programChanged&&this.player_.hasStarted()&&this.onGeneric("ProgramChange",this.analytics_.programChanged,function(){i.analytics_.programChanged(i.SessionId(),i.OffsetTime(),{programId:n.programId})},!0)},i.onEntitlementChange=function(e,t,i){var n=this;this.entitlementLoaded_=!0,this.player_.off(pe.ERROR,this.onErrorBeforeAssetBind);var r=this.entitlement(t&&t.entitlement);this.onGeneric("HandShake",this.analytics_.handshake,function(){var e={};if(r&&r.assetId&&(e.assetId=r.assetId),r&&r.programId&&(e.programId=r.programId),!r){var t=Re.currentAsset(n.player_);t&&(e.assetId=t.assetId,e.channelId=t.channelId,e.programId=t.programId)}var o=r?r.playSessionId:i;n.analytics_.handshake(n.SessionId(o),e),n.onLoadStart(o)},!1)},i.onEntitlementLoadStart=function(){var e=this;this.entitlementLoaded_=!1,this.onGeneric("ExitOngoingSession",this.analytics_.exitOngoingSession,function(){return e.analytics_.exitOngoingSession(e.getCachedCurrentTime())}),this.player_.one(pe.ERROR,this.onErrorBeforeAssetBind),this.player_.one(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},i.onLoadStart=function(e){var t=this,i=e||this.SessionId();if(!i)return void ye("onLoadStart called but not session available.");this.sessionCreated(i)||(this.createdSessions[i]=!0,this.onGeneric("Created",this.analytics_.created,function(){var e=t.player_.options(),n={version:t.playerVersion};e&&e.autoplay&&(n.autoplay=e.autoplay),t.entitlement()&&t.entitlement().requestId&&(n.requestId=t.entitlement().requestId),t.analytics_.created(i,n)},!1),this.player_.off(pe.PLAYING,this.onResumedBind),this.player_.off(pe.PLAYING,this.onPlayingAfterStartBind),this.player_.one(pe.PLAYING,this.onPlayingAfterStartBind))},i.onPlayingAfterStart=function(){this.onPlayBind(),this.onPlayingBind(),this.player_.on(pe.PLAYING,this.onResumedBind)},i.onBitrateChange=function(){var e=this;this.onGeneric("BitrateChange",this.analytics_.bitrateChanged,function(){var t={bitrate:Math.max(0,Math.round(e.getBitrate()/1e3))};e.analytics_.bitrateChanged(e.SessionId(),e.OffsetTime(),t)},!0)},i.onWaiting=function(){var e=this;this.onGeneric("StartWaiting",this.analytics_.waiting,function(){e.player_.hasStarted()&&e.analytics_.waiting(e.SessionId(),e.OffsetTime()),e.allEvents_.map(function(t){
t!==pe.PLAY&&t!==pe.PLAYING&&t!==pe.ENDED&&t!==pe.ERROR&&t!==pe.DISPOSE&&t!==pe.SEEKED&&t!==pe.CHROMECAST_CASTING&&t!==pe.CHROMECAST_STOPPED||e.player_.one(t,e.onWaitingEndedBind)})},!0)},i.OffsetTime=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)?Re.getPlayheadTime(this.player_)/1e3:Re.baseCurrentTime(this.player_)},i.startTimeLive=function(){return Re.startTimeLive(this.player_)},i.isLive=function(){return Re.isLive(this.player_)},i.getBitrate=function(){return Re.getBitrate(this.player_)},i.duration=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)&&this.player_.getProgramDetails&&this.player_.getProgramDetails()?this.player_.getProgramDetails().duration/1e3:Re.duration(this.player_)},i.entitlement=function(e){return void 0===e?Re.getEntitlement(this.player_)||this.entitlement_:(this.entitlement_=e,e)},i.onWaitingEnded=function(){var e=this;this.allEvents_.map(function(t){e.player_.off(t,e.onWaitingEndedBind)}),this.onGeneric("WaitingEnded",this.analytics_.waitingEnded,function(){e.analytics_.waitingEnded(e.SessionId(),e.OffsetTime())},!0)},i.onDispose=function(e,t){var i=this;this.onGeneric("Dispose",this.analytics_.dispose,function(){!1!==i.hasSessionId()&&(i.analytics_.dispose(i.SessionId(),i.getCachedCurrentTime()),i.clearTimers())},!0,!0)},i.getCachedCurrentTime=function(){if(this.player_){var e=this.player_.getCache().currentTime,t=this.OffsetTime();return t||e}},i.onEnded=function(){var e=this;this.onGeneric("End of Stream",this.analytics_.endOfStream,function(){e.analytics_.endOfStream(e.SessionId()),e.clearTimers()},!0,!0)},i.onPlay=function(){var e=this;this.onGeneric("Play",this.analytics_.play,function(){var t=e.player_.techName_,i="Unknown";switch(t){case"EmpShaka":i="Shaka";break;case"EmpDashif":i="DashIf";break;case"EmpFlash":i="Flash";break;case"EmpHLS":i="NativeHLS";break;case"EmpHLS-MSE":i="HLS-MSE"}var n={techName:i,version:e.playerVersion,techVersion:e.techVersion};e.analytics_.play(e.SessionId(),e.OffsetTime(),n),e.registerCurrentTimeTimer()},!1)},i.onPlaying=function(){var e=this;this.onGeneric("Playing",this.analytics_.playing,function(){var t={};t.bitrate=Math.max(0,Math.round(e.getBitrate()/1024)),!0===e.isLive()?t.referenceTime=e.startTimeLive():t.duration=e.duration(),e.entitlement()&&e.entitlement().mediaLocator&&(t.mediaLocator=e.entitlement().mediaLocator),t.mediaLocator&&t.mediaLocator.indexOf(".isml")>=0&&(t.referenceTime=e.INITIAL_REFERENCE_TIME),e.analytics_.clearCustomAttributes(),(e.customAttributes||[]).map(function(t){e.analytics_.setCustomAttribute(t.key,t.value)}),e.analytics_.playing(e.SessionId(),e.OffsetTime(),t)},!1)},i.onSeeked=function(){var e=this;this.onGeneric("Seeked",this.analytics_.seek,function(){e.analytics_.seek(e.SessionId(),e.OffsetTime())},!0)},i.onPause=function(){var e=this;this.onGeneric("Pause",this.analytics_.paused,function(){if(!1!==e.player_.hasStarted()){var t=e.SessionId(),i=parseInt((new Date-0)/25);e.mem[t].pause[i]||(e.mem[t].pause[i]=!0,e.analytics_.paused(t,e.OffsetTime()))}},!0)},i.onResume=function(){var e=this;this.onGeneric("Resume",this.analytics_.resume,function(){var t=e.SessionId(),i=parseInt((new Date-0)/25);e.mem[t].resume[i]||(e.mem[t].resume[i]=!0,e.analytics_.resume(t,e.OffsetTime()))},!0)},i.onErrorBeforeAsset=function(){this.entitlementLoaded_=!1,this.onEntitlementChange(null,null,this.errorSessionId),this.onError(null,this.errorSessionId),this.clearTimers()},i.onError=function(e,t){var i=this;void 0===e&&(e=null),void 0===t&&(t=null),(t||this.entitlementLoaded_)&&this.onGeneric("Error",this.analytics_.error,function(){var n=i.player_.error(),r={};n&&n.code&&(r.errorCode=n.code),n&&n.message&&(r.errorMessage=n.message),n&&n.status&&(r.errorDetails=n.status+""),n&&n.stack&&(r.errorDetails=r.errorDetails?r.errorDetails+"\n"+n.stack.toString():n.stack.toString());var o=i.player_.options();if(i.player_.tech_){var s="EmpShaka"===i.player_.techName_&&o&&o.empshaka?o.empshaka.streamType:"";r.errorInfo=i.player_.techName_+(s?"-"+s:"")}else r.errorInfo="Unknown tech, techOrder: "+o.techOrder.toString();!n&&e&&(r.errorCode=e.code,r.errorMessage=e.message?e.message:"Browser Error",e.status&&(r.errorDetails=e.status+""),e.stack&&(r.errorDetails=r.errorDetails?r.errorDetails+"\n"+e.stack.toString():e.stack.toString()));var a=i.SessionId();(a||t)&&i.analytics_.error(a||t,i.OffsetTime(),r),i.clearTimers()},!1)},i.onDrmSessionUpdate=function(e,t){var i=this;ye("onDrmSessionUpdate",e,t),this.onGeneric("DrmSessionUpdate",this.analytics_.drmSessionUpdate,function(){i.analytics_.drmSessionUpdate(i.SessionId(),{message:t.messageType,code:t.code,info:t.info})},!0)},i.onGeneric=function(e,t,i,n,r){if(void 0===r&&(r=!1),this.disabled_&&!r)return void ye(e+" not delivered: analytics disabled.");n&&!this.sessionCreated(this.SessionId())?ye(e+" was discarded."):t&&i&&i()},i.sessionCreated=function(e){return e&&this.createdSessions[e]},i.dispose=function(){this.clearTimers(),this.analytics_&&(this.analytics_.exitOngoingSession(this.getCachedCurrentTime()),this.analytics_.dispatchNow(!1)),le.removeEventListener("beforeunload",this.onWindowUnloadBind),this.player_.off(pe.PLAY,this.onPlayBind),this.player_.off(pe.PLAYING,this.onPlayingBind),this.player_.off(pe.PLAYING,this.onResumedBind),this.player_.off(pe.PAUSE,this.onPauseBind),this.player_.off(pe.SEEKED,this.onSeekedBind),this.player_.off(pe.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.off(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player_.off(pe.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.off(pe.ENDED,this.onEndedBind),this.player_.off(pe.DISPOSE,this.onDisposeBind),this.player_.off(pe.STOPPED,this.onDisposeBind),this.player_.off(pe.ERROR,this.onErrorBind),this.player_.off(pe.ERROR,this.onErrorBeforeAssetBind),this.player_.off(pe.WAITING,this.onWaitingBind),this.player_.off(pe.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.off(pe.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.off(pe.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.off(pe.PLAYING,this.onPlayingAfterStartBind),this.player_.off(pe.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},t(e,[{key:"techVersion",get:function(){return Re.techVersion(this.player_)}},{key:"playerVersion",get:function(){return this.player_.version?this.player_.version:le.videojs?le.videojs.VERSION:"2.x.x"}},{key:"errorSessionId",get:function(){return this._errorSessionId||(this._errorSessionId="error-"+Math.random().toString().split(".")[1]),this._errorSessionId}}]),e}()),ui=d(function(e,t){!function(t){e.exports=function(){return function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var l="function"==typeof h&&h;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){var i=t[s][1][e];return r(i||e)},u,u.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof h&&h,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){(function(e){var i;i="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=i}).call(this,void 0!==ae?ae:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){!function(n,r){"object"==typeof i&&void 0!==t?r(i,e("worker-timers-broker")):r(n.workerTimers={},n.workerTimersBroker)}(this,function(e,t){var i=new Blob(['!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,r){"use strict";r.r(t);r(1)},function(e,t,r){!function(){"use strict";var w=new Map,T=new Map,b=function(e,t){var r,n;if("performance"in self){var o=performance.now(),i=Math.max(0,o-t);r=o,n=e-i}else r=Date.now(),n=e;var a=r+n;return{expected:a,remainingDelay:n}},M=function e(t,r,n,o){var i="performance"in self?performance.now():Date.now();n<i?postMessage({id:null,method:"call",params:{timerId:r,timerType:o}}):t.set(r,setTimeout(e,n-i,t,r,n,o))};addEventListener("message",function(e){var t,r,n,o,i,a,u,s,c=e.data;try{if("clear"===c.method){var l=c.id,d=c.params,f=d.timerId,p=d.timerType;if("interval"===p)!function(e){var t=w.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),w.delete(e)}(f),postMessage({error:null,id:l});else{if("timeout"!==p)throw new Error(\'The given type "\'.concat(p,\'" is not supported\'));!function(e){var t=T.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),T.delete(e)}(f),postMessage({error:null,id:l})}}else{if("set"!==c.method)throw new Error(\'The given method "\'.concat(c.method,\'" is not supported\'));var m=c.params,v=m.delay,h=m.now,g=m.timerId,y=m.timerType;if("interval"===y)i=g,a=b(v,h),u=a.expected,s=a.remainingDelay,w.set(i,setTimeout(M,s,w,i,u,"interval"));else{if("timeout"!==y)throw new Error(\'The given type "\'.concat(y,\'" is not supported\'));t=g,r=b(v,h),n=r.expected,o=r.remainingDelay,T.set(t,setTimeout(M,o,T,t,n,"timeout"))}}}catch(e){postMessage({error:{message:e.message},id:c.id,result:null})}})}()}]);'],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(i),r=t.load(n),o=r.clearInterval,s=r.clearTimeout,a=r.setInterval,l=r.setTimeout;URL.revokeObjectURL(n),e.clearInterval=o,e.clearTimeout=s,e.setInterval=a,e.setTimeout=l,Object.defineProperty(e,"__esModule",{value:!0})})},{"worker-timers-broker":3}],3:[function(e,t,i){!function(n,r){"object"==typeof i&&void 0!==t?r(i,e("fast-unique-numbers")):r(n.workerTimersBroker={},n.fastUniqueNumbers)}(this,function(e,t){var i=function(e){return void 0!==e.method&&"call"===e.method},n=function(e){return null===e.error&&"number"==typeof e.id},r=function(e){var r=new Map,o=new Map,s=new Map,a=new Worker(e);return a.addEventListener("message",function(e){var t=e.data;if(i(t)){var a=t.params,l=a.timerId,c=a.timerType;if("interval"===c){var u=r.get(l);if("number"==typeof u){var h=s.get(u);if(void 0===h||h.timerId!==l||h.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===u)throw new Error("The timer is in an undefined state.");u()}}else if("timeout"===c){var p=o.get(l);if("number"==typeof p){var d=s.get(p);if(void 0===d||d.timerId!==l||d.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===p)throw new Error("The timer is in an undefined state.");p(),o.delete(l)}}}else{if(!n(t)){var m=t.error.message;throw new Error(m)}var f=t.id,g=s.get(f);if(void 0===g)throw new Error("The timer is in an undefined state.");var v=g.timerId,y=g.timerType;s.delete(f),"interval"===y?r.delete(v):o.delete(v)}}),{clearInterval:function(e){var i=t.generateUniqueNumber(s);s.set(i,{timerId:e,timerType:"interval"}),r.set(e,i),a.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var i=t.generateUniqueNumber(s);s.set(i,{timerId:e,timerType:"timeout"}),o.set(e,i),a.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,i){var n=t.generateUniqueNumber(r);return r.set(n,function(){e(),"function"==typeof r.get(n)&&a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:n,timerType:"interval"}})}),a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:n,timerType:"interval"}}),n},setTimeout:function(e,i){var n=t.generateUniqueNumber(o);return o.set(n,e),a.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:n,timerType:"timeout"}}),n}}};e.load=r,Object.defineProperty(e,"__esModule",{value:!0})})},{"fast-unique-numbers":4}],4:[function(e,t,i){!function(e,n){n("object"==typeof i&&void 0!==t?i:e.fastUniqueNumbers={})}(this,function(e){var t=new WeakMap,i=Number.MAX_SAFE_INTEGER||9007199254740991,n=function(e,i){return t.set(e,i),i},r=function(e){var r=t.get(e),o=void 0===r?e.size:r>2147483648?0:r+1;if(!e.has(o))return n(e,o);if(e.size<1073741824){for(;e.has(o);)o=Math.floor(2147483648*Math.random());return n(e,o)}if(e.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(o);)o=Math.floor(Math.random()*i);return n(e,o)},o=function(e){var t=r(e);return e.add(t),t};e.addUniqueNumber=o,e.generateUniqueNumber=r,Object.defineProperty(e,"__esModule",{value:!0})})},{}],5:[function(e,t,i){function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("global/window"),a=n(s),l=e("./platform"),c=n(l),u=e("worker-timers"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(u),p=function(){function e(t,i,n,o,s){var a=arguments.length<=5||void 0===arguments[5]?{}:arguments[5],l=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];r(this,e),this.CYCLE_TIME=1e3,this.EVENT_PURGE_TIME_DEFAULT=3*this.CYCLE_TIME,this.TIME_WITHOUT_BEAT_DEFAULT=60*this.CYCLE_TIME,this.SERVER_URL_DEFAULT="",this.CUSTOMER_DEFAULT="",this.BUSINESS_UNIT_DEFAULT="",this.INCLUDE_DEVICE_METRICS_DEFAULT=!0,this.SESSION_TOKEN_DEFAULT="",this.SESSION_ID_DEFAULT="",this.DEBUG_DEFAULT=!1,this.MAX_RETRIES=20,this.DEVICE_CLOCK_CHECK_THRESHOLD=3e5,this.eventsSkeleton=this.initEventSkeleton(),this.customer_=i,this.businessUnit_=n,this.sessionToken_=o,this.serverURL_=t,this.includeDeviceMetrics_=!1,this.userId_=s,this.deviceInfoData_=a,this.props_=l||{},this.pendingRequest_=!1}return e.prototype.init=function(){var e=this;this.cycleTimer&&("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?h.clearInterval(this.cycleTimer):clearInterval(this.cycleTimer)),"undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?this.cycleTimer=h.setInterval(function(){return e.cycle()},this.CYCLE_TIME):this.cycleTimer=setInterval(function(){return e.cycle()},this.CYCLE_TIME),this.communicationCurrentTime=0,this.lastCommunicationTime=0,this.eventPool={}},e.prototype.clear=function(){this.eventPool={}},e.prototype.ok=function(e){var t=this.eventPool[e];return!!t&&!1===t.forbidden&&t.retries<this.MAX_RETRIES},e.prototype.created=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"Created"};this.addEventToPool(e,i,t)},e.prototype.play=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"PlayerReady",currentTime:t};this.deviceAppInfo&&(i.deviceAppInfo=this.deviceAppInfo),this.addEventToPool(e,n,i)},e.prototype.playing=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Started",currentTime:t};if(this.customAttributes){var r=Object.keys(this.customAttributes);r.length&&r.length>0&&(i.attributes=this.customAttributes)}this.addEventToPool(e,n,i),this.changeSessionState(e,"PLAYING")},e.prototype.paused=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Paused",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.seek=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"ScrubbedTo",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.programChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"ProgramChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.startCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"StartCasting",currentTime:t};this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")},e.prototype.stopCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"StopCasting",currentTime:t};this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")},e.prototype.setCurrentTime=function(e,t){this.eventPool[e]&&(this.eventPool[e].currentTime=t)},e.prototype.handshake=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"HandshakeStarted"};this.addEventToPool(e,i,t)},e.prototype.resume=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Resumed",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.bitrateChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BitrateChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.drmSessionUpdate=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"DRM"};this.addEventToPool(e,i,t,!0)},e.prototype.endOfStream=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"Completed"};this.addEventToPool(e,i,t,!0),this.changeSessionState(e,"FINISHED")},e.prototype.error=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Error",currentTime:t};this.addEventToPool(e,n,i),this.changeSessionState(e,"FINISHED")},e.prototype.dispose=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=this.eventPool[e];if(n&&"FINISHED"!==n.currentState){var r={type:"Aborted"};t&&(r.currentTime=t),this.addEventToPool(e,r,i,!0),this.changeSessionState(e,"FINISHED")}},e.prototype.waiting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BufferingStarted",currentTime:t};this.addEventToPool(e,n,i)},e.prototype.waitingEnded=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BufferingEnded",currentTime:t};this.addEventToPool(e,n,i)},e.prototype.getSessionState=function(e){return this.eventPool[e]?this.eventPool[e].currentState||"IDLE":"IDLE"},e.prototype.dispatchNow=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.cycle(e,!0)},e.prototype.exitOngoingSession=function(e){var t=this;Object.keys(this.eventPool).map(function(i){t.eventPool[i]&&t.dispose(i,e)})},e.prototype.setCustomAttribute=function(e,t){this.customAttributes||this.resetAnalyticsCustomAttributes(),this.customAttributes[e]=t},e.prototype.clearCustomAttributes=function(){this.customAttributes={}},e.prototype.removeSession=function(e){if(!0===(!(arguments.length<=1||void 0===arguments[1])&&arguments[1]))delete this.eventPool[e];else{var t=this.eventPool[e];t&&(t.currentState="REMOVED")}},e.prototype.hasDataToSend=function(){for(var e=Object.keys(this.eventPool),t=0;t<e.length;++t)if(this.eventPool[e[t]].events.length>0)return!0;return!1},e.prototype.sendData=function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0],i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!this.pendingRequest_){var n=!1;this.pendingRequest_=!0;var r=void 0;r="undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?h.setTimeout(function(){e.pendingRequest_=!1,r=void 0},2*this.EVENT_PURGE_TIME_DEFAULT):setTimeout(function(){e.pendingRequest_=!1,r=void 0},2*this.EVENT_PURGE_TIME_DEFAULT);Object.keys(this.eventPool).map(function(o){var s=e.eventPool[o];if(s){if(!o)return s.events=[],void e.removeSession(o,!0);if("PLAYING"===s.currentState&&0===s.events.length&&i&&s.events.push({EventType:"Playback.Heartbeat",Timestamp:(new Date).getTime(),OffsetTime:Math.floor(1e3*s.currentTime)}),"IDLE"!==s.currentState&&"REMOVED"!==s.currentState){if(0===s.events.length)return void("FINISHED"===s.currentState&&e.removeSession(o));var a={DispatchTime:(new Date).getTime(),Customer:e.customer_,BusinessUnit:e.businessUnit_,Payload:s.events,SessionId:o,ClockOffset:s.clockOffset};if(e.debugLog("Sending analytics - sessionId: "+o+" and params: ",a),s.retries>e.MAX_RETRIES||!0===s.forbidden)return void(s.events=[]);Math.abs(e.communicationCurrentDate-e.lastCommunicationDate)>e.DEVICE_CLOCK_CHECK_THRESHOLD&&e.initRequest(o).then(function(){}),n=!0,e.sendRequest(t,a,function(t,i){if(r)try{"undefined"!=typeof Worker&&!0!==e.props_.disableWebWorkers?(h.clearTimeout(r),r=void 0):(clearTimeout(r),r=void 0)}catch(e){}e.pendingRequest_=!1;var n=t&&t.httpCode?t.httpCode:200;void 0!==i||200!==n?(401===n&&(s.forbidden=!0),e.debugLog("Error sending request to backend",i),s.retries++):(s.events=[],s.retries=0,"FINISHED"===s.currentState&&e.removeSession(o))})}}}),n||(this.pendingRequest_=!1)}},e.prototype.cycle=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.communicationCurrentDate=new Date,this.communicationCurrentTime+=this.CYCLE_TIME,this.hasDataToSend()?(t||this.lastCommunicationTime+this.EVENT_PURGE_TIME_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate):(t||this.lastCommunicationTime+this.TIME_WITHOUT_BEAT_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e,!0),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate)},e.prototype.sendRequest=function(e,t,i){var n=new XMLHttpRequest;n.open("POST",this.serverURL_+"/eventsink/send",!0),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Authorization","Bearer "+this.sessionToken_),n.onload=function(){var e=JSON.parse(this.responseText);i(e)},n.onerror=function(e){i(null,e)},n.send(JSON.stringify(t))},e.prototype.initRequest=function(e){var t=this;return new Promise(function(i,n){var r=(new Date).getTime(),o=new XMLHttpRequest;o.open("POST",t.serverURL_+"/eventsink/init",!0),o.setRequestHeader("Content-type","application/json"),o.setRequestHeader("Authorization","Bearer "+t.sessionToken_),o.onload=function(){var n=(new Date).getTime(),s=JSON.parse(o.responseText);t.determineClockOffset(e,s,r,n),s&&s.settings&&(s.settings,s.settings.includeDeviceMetrics&&(t.includeDeviceMetrics_=!!s.settings.includeDeviceMetrics)),i()},o.onerror=function(e){t.debugLog("Unable to init. Aborting."),n(e)};var s={Customer:t.customer_,BusinessUnit:t.businessUnit_,SessionId:e};o.send(JSON.stringify(s))})},e.prototype.debugLog=function(e,t){t=t||"",this.debug_},e.prototype.addDeviceInfoEvent=function(e){var t=this.eventPool[e];if(this.includeDeviceMetrics_&&t&&t.events&&t.events.length){var i={Timestamp:(new Date).getTime(),EventType:"Device.Info",DeviceModel:this.deviceInfoData_.deviceModel||"Desktop",UserAgent:this.deviceInfoData_.userAgent||a.default.navigator.userAgent,Height:this.deviceInfoData_.screenHeight||a.default.screen.height,Width:this.deviceInfoData_.screenWidth||a.default.screen.width,Model:this.deviceInfoData_.model||a.default.navigator.appName,Name:this.deviceInfoData_.deviceName||a.default.navigator.product,OS:this.deviceInfoData_.deviceOS||c.default.os.family,OSVersion:this.deviceInfoData_.deviceOSVersion||c.default.os.version,Type:this.deviceInfoData_.type||"WEB"};(this.deviceInfoData_.deviceManufacturer||c.default.manufacturer)&&(i.Manufacturer=this.deviceInfoData_.deviceManufacturer||c.default.manufacturer),this.deviceInfoData_.deviceId&&(i.DeviceId=this.deviceInfoData_.deviceId),t.events.push(i)}},e.prototype.determineClockOffset=function(e,t,i,n){var r=this.eventPool[e];r&&(r.clockOffset=Math.floor((n-t.repliedTime+i-t.receivedTime)/2))},e.prototype.createPool=function(e){var t=this;return new Promise(function(i,n){t.eventPool[e]={currentState:"IDLE",currentTime:0,clockOffset:0,events:[],retries:0,forbidden:!1},t.initRequest(e).then(function(){t.addDeviceInfoEvent(e),i()}).catch(function(e){n(e)})})},e.prototype.addEventToPool=function(e,t,i){var n=this;if(arguments.length<=3||void 0===arguments[3]||!arguments[3]||!this.eventPool[e]||"FINISHED"!==this.eventPool[e].currentState&&"REMOVED"!==this.eventPool[e].currentState){var r;this.eventPool[e]||(r=this.createPool(e)),r?r.then(function(){n.internalAddEventToPool(e,t,i)}):this.internalAddEventToPool(e,t,i)}},e.prototype.internalAddEventToPool=function(e,t,i){var n=this.eventsSkeleton[t.type];if(!n)return void this.debugLog("Unknown playback event: ",t);var r={Timestamp:(new Date).getTime(),EventType:"Playback."+n.event};n.includeOffset&&(r.OffsetTime=Math.floor(1e3*t.currentTime)),n.attributes&&"function"==typeof n.attributes&&(r=this.objectAssign(r,n.attributes(i))),this.eventPool[e].events.push(r),this.debugLog("added "+n.event+" to queue")},e.prototype.changeSessionState=function(e,t){var i,n=this;this.eventPool[e]||(i=this.createPool(e)),i?i.then(function(){n.eventPool[e].currentState=t}):this.eventPool[e].currentState=t},e.prototype.initEventSkeleton=function(){var t={};return t.Completed={event:"Completed",autoListener:!1},t.PlayerReady={event:"PlayerReady",autoListener:!1,attributes:function(t){var i={Technology:t.techName,PlayerVersion:t.version};return t.techVersion&&(i.TechVersion=t.techVersion),i.AnalyticsVersion=e.VERSION,t.deviceAppInfo&&(i.DeviceAppInfo=t.deviceAppInfo),t.playMode&&(i.PlayMode=t.playMode),i}},t.Resumed={event:"Resumed",autoListener:!1,includeOffset:!0},t.BufferingStarted={event:"BufferingStarted",includeOffset:!0},t.BufferingEnded={event:"BufferingEnded",includeOffset:!0},t.ScrubbedTo={event:"ScrubbedTo",includeOffset:!0},t.Created={event:"Created",attributes:function(e){var t={};return void 0!==e.autoplay&&(t.AutoPlay=e.autoplay),e.techName&&(t.Technology=e.techName),e.player&&(t.Player=e.player),e.version&&(t.Version=e.version),e.requestId&&(t.RequestId=e.requestId),e.techVersion&&(t.TechVersion=e.techVersion),e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},t.StartCasting={event:"StartCasting",includeOffset:!0},t.StopCasting={event:"StopCasting",includeOffset:!0},t.Paused={event:"Paused",includeOffset:!0},t.BitrateChanged={event:"BitrateChanged",includeOffset:!0,attributes:function(e){return{Bitrate:e.bitrate}}},t.DRM={event:"DRM",includeOffset:!1,attributes:function(e){var t={};return e.message&&(t.Message=e.message),e.code&&(t.Code=e.code),e.info&&(t.Info=e.info),t}},t.Error={event:"Error",includeOffset:!0,attributes:function(e){var t={};return e.errorCode&&(t.Code=e.errorCode),e.errorMessage?t.Message=e.errorMessage:t.Message="Unknown Error",e.errorInfo&&(t.Info=e.errorInfo),e.errorDetails&&(t.Details=e.errorDetails),t}},t.HandshakeStarted={event:"HandshakeStarted",autoListener:!1,attributes:function(e){if(!e.assetId)return{};var t={AssetId:e.assetId};return e.programId&&(t.ProgramId=e.programId),t}},t.ProgramChanged={event:"ProgramChanged",includeOffset:!0,autoListener:!1,attributes:function(e){return e.programId?{ProgramId:e.programId}:{}}},t.Aborted={event:"Aborted",autoListener:!1,includeOffset:!0},t.Started={event:"Started",autoListener:!1,includeOffset:!0,attributes:function(e){var t={};return e.bitrate&&(t.Bitrate=e.bitrate),e.duration&&(t.VideoLength=1e3*e.duration),e.mediaLocator&&(t.MediaLocator=e.mediaLocator),e.attributes&&(t.Attributes=e.attributes),e.referenceTime&&(t.ReferenceTime=e.referenceTime),e.playMode&&(t.PlayMode=e.playMode),t}},t},e.prototype.objectAssign=function(e,t){for(var i,n,r=1;r<arguments.length;++r){n=arguments[r];for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o(e,[{key:"debug",get:function(){return this.debug_},set:function(e){this.debug_=e}},{key:"deviceAppInfo",get:function(){return this.deviceInfoData_?this.deviceInfoData_.deviceAppInfo:null}}]),e}();p.VERSION="2.0.93-7",i.default=p,t.exports=i.default},{"./platform":6,"global/window":1,"worker-timers":2}],6:[function(e,t,i){(function(e){(function(){function n(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function r(e,t,i){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"7 / Server 2008 R2","6.0":"Vista / Server 2008",5.2:"XP 64-bit / Server 2003",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&i&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&i&&(e=e.replace(RegExp(t,"i"),i)),e=s(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function o(e,t){var i=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=_)for(;++i<n;)t(e[i],i,e);else a(e,t)}function s(e){return e=p(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:n(e)}function a(e,t){for(var i in e)C.call(e,i)&&t(e[i],i,e)}function l(e){return null==e?n(e):A.call(e).slice(8,-1)}function c(e,t){var i=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!e[t])}function u(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function h(e,t){var i=null;return o(e,function(n,r){i=t(i,n,r,e)}),i}function p(e){return String(e).replace(/^ +| +$/g,"")}function d(e){function t(t){return h(t,function(t,i){var n=i.pattern||u(i);return!t&&(t=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(n,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=s(t[0].replace(RegExp(n,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function i(){return this.description||""}var n=f,o=e&&"object"==typeof e&&"String"!=l(e);o&&(n=e,e=null);var m=n.navigator||{},v=m.userAgent||"";e||(e=v);var y,T,_=o||S==g,b=o?!!m.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(A.toString()),C="Object",I=o?C:"ScriptBridgingProxyObject",w=o?C:"Environment",P=o&&n.java?"JavaPackage":l(n.java),x=o?C:"RuntimeObject",D=/\bJava/.test(P)&&n.java,O=D&&l(n.environment)==w,k=D?"a":"",L=D?"b":"",R=n.document||{},N=n.operamini||n.opera,M=E.test(M=o&&N?N["[[Class]]"]:l(N))?M:N=null,B=e,U=[],H=null,G=e==v,F=G&&N&&"function"==typeof N.version&&N.version(),j=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||u(i))+"\\b","i").exec(e)&&(i.label||i)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),V=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||u(i))+"\\b","i").exec(e)&&(i.label||i)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{
label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox Mobile",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),W=t([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),q=function(t){return h(t,function(t,i,n){return t||(i[W]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(W)]||RegExp("\\b"+u(n)+"(?:\\b|\\w*\\d)","i").exec(e))&&n})}({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),K=function(t){return h(t,function(t,i){var n=i.pattern||u(i);return!t&&(t=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=r(t,n,i.label||i)),t})}(["Windows Phone ","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(j&&(j=[j]),q&&!W&&(W=t([q])),(y=/\bGoogle TV\b/.exec(W))&&(W=y[0]),/\bSimulator\b/i.test(e)&&(W=(W?W+" ":"")+"Simulator"),"Opera Mini"==V&&/\bOPiOS\b/.test(e)&&U.push("running in Turbo/Uncompressed mode"),/^iP/.test(W)?(V||(V="Safari"),K="iOS"+((y=/ OS ([\d_]+)/i.exec(e))?" "+y[1].replace(/_/g,"."):"")):"Konqueror"!=V||/buntu/i.test(K)?q&&"Google"!=q&&(/Chrome/.test(V)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(W))?(V="Android Browser",K=/\bAndroid\b/.test(K)?K:"Android"):"Silk"==V?(/\bMobi/i.test(e)||(K="Android",U.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&U.unshift("accelerated")):"PaleMoon"==V&&(y=/\bFirefox\/([\d.]+)\b/.exec(e))?U.push("identifying as Firefox "+y[1]):"Firefox"==V&&(y=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(K||(K="Firefox OS"),W||(W=y[1])):V&&!(y=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(V))||(V&&!W&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(y+"/")+8))&&(V=null),(y=W||q||K)&&(W||q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(K))&&(V=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(K)?K:y)+" Browser")):K="Kubuntu",F||(F=function(t){return h(t,function(t,i){return t||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",u(V),"(?:Firefox|Minefield|NetFront)"])),(y="iCab"==j&&parseFloat(F)>3&&"WebKit"||/\bOpera\b/.test(V)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(j)&&"WebKit"||!j&&/\bMSIE\b/i.test(e)&&("Mac OS"==K?"Tasman":"Trident")||"WebKit"==j&&/\bPlayStation\b(?! Vita\b)/i.test(V)&&"NetFront")&&(j=[y]),"IE"==V&&(y=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(V+=" Mobile",K="Windows Phone "+(/\+$/.test(y)?y:y+".x"),U.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(V="IE Mobile",K="Windows Phone 8.x",U.unshift("desktop mode"),F||(F=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=V&&"Trident"==j&&(y=/\brv:([\d.]+)/.exec(e))&&(V&&U.push("identifying as "+V+(F?" "+F:"")),V="IE",F=y[1]),G){if(c(n,"global"))if(D&&(y=D.lang.System,B=y.getProperty("os.arch"),K=K||y.getProperty("os.name")+" "+y.getProperty("os.version")),_&&c(n,"system")&&(y=[n.system])[0]){K||(K=y[0].os||null);try{y[1]=n.require("ringo/engine").version,F=y[1].join("."),V="RingoJS"}catch(e){y[0].global.system==n.system&&(V="Narwhal")}}else"object"==typeof n.process&&(y=n.process)?(V="Node.js",B=y.arch,K=y.platform,F=/[\d.]+/.exec(y.version)[0]):O&&(V="Rhino");else l(y=n.runtime)==I?(V="Adobe AIR",K=y.flash.system.Capabilities.os):l(y=n.phantom)==x?(V="PhantomJS",F=(y=y.version||null)&&y.major+"."+y.minor+"."+y.patch):"number"==typeof R.documentMode&&(y=/\bTrident\/(\d+)/i.exec(e))&&(F=[F,R.documentMode],(y=+y[1]+4)!=F[1]&&(U.push("IE "+F[1]+" mode"),j&&(j[1]=""),F[1]=y),F="IE"==V?String(F[1].toFixed(1)):F[0]);K=K&&s(K)}F&&(y=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(F)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(G&&m.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(H=/b/i.test(y)?"beta":"alpha",F=F.replace(RegExp(y+"\\+?$"),"")+("beta"==H?L:k)+(/\d+\+?/.exec(y)||"")),"Fennec"==V||"Firefox"==V&&/\b(?:Android|Firefox OS)\b/.test(K)?V="Firefox Mobile":"Maxthon"==V&&F?F=F.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(W)?(K=null,"Xbox 360"==W&&/\bIEMobile\b/.test(e)&&U.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(V)&&(!V||W||/Browser|Mobi/.test(V))||"Windows CE"!=K&&!/Mobi/i.test(e)?"IE"==V&&G&&null===n.external?U.unshift("platform preview"):(/\bBlackBerry\b/.test(W)||/\bBB10\b/.test(e))&&(y=(RegExp(W.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||F)?(y=[y,/BB10/.test(e)],K=(y[1]?(W=null,q="BlackBerry"):"Device Software")+" "+y[0],F=null):this!=a&&"Wii"!=W&&(G&&N||/Opera/.test(V)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==V&&/\bOS X (?:\d+\.){2,}/.test(K)||"IE"==V&&(K&&!/^Win/.test(K)&&F>5.5||/\bWindows XP\b/.test(K)&&F>8||8==F&&!/\bTrident\b/.test(e)))&&!E.test(y=d.call(a,e.replace(E,"")+";"))&&y.name&&(y="ing as "+y.name+((y=y.version)?" "+y:""),E.test(V)?(/\bIE\b/.test(y)&&"Mac OS"==K&&(K=null),y="identify"+y):(y="mask"+y,V=M?s(M.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(y)&&(K=null),G||(F=null)),j=["Presto"],U.push(y)):V+=" Mobile",(y=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(y=[parseFloat(y.replace(/\.(\d)$/,".0$1")),y],"Safari"==V&&"+"==y[1].slice(-1)?(V="WebKit Nightly",H="alpha",F=y[1].slice(0,-1)):F!=y[1]&&F!=(y[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(F=null),y[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==y[0]&&537.36==y[2]&&parseFloat(y[1])>=28&&"WebKit"==j&&(j=["Blink"]),G&&(b||y[1])?(j&&(j[1]="like Chrome"),y=y[1]||(y=y[0],y<530?1:y<532?2:y<532.05?3:y<533?4:y<534.03?5:y<534.07?6:y<534.1?7:y<534.13?8:y<534.16?9:y<534.24?10:y<534.3?11:y<535.01?12:y<535.02?"13+":y<535.07?15:y<535.11?16:y<535.19?17:y<536.05?18:y<536.1?19:y<537.01?20:y<537.11?"21+":y<537.13?23:y<537.18?24:y<537.24?25:y<537.36?26:"Blink"!=j?"27":"28")):(j&&(j[1]="like Safari"),y=y[0],y=y<400?1:y<500?2:y<526?3:y<533?4:y<534?"4+":y<535?5:y<537?6:y<538?7:y<601?8:"8"),j&&(j[1]+=" "+(y+="number"==typeof y?".x":/[.+]/.test(y)?"":"+")),"Safari"==V&&(!F||parseInt(F)>45)&&(F=y)),"Opera"==V&&(y=/\bzbov|zvav$/.exec(K))?(V+=" ",U.unshift("desktop mode"),"zvav"==y?(V+="Mini",F=null):V+="Mobile",K=K.replace(RegExp(" *"+y+"$"),"")):"Safari"==V&&/\bChrome\b/.exec(j&&j[1])&&(U.unshift("desktop mode"),V="Chrome Mobile",F=null,/\bOS X\b/.test(K)?(q="Apple",K="iOS 4.3+"):K=null),F&&0==F.indexOf(y=/[\d.]+$/.exec(K))&&e.indexOf("/"+y+"-")>-1&&(K=p(K.replace(y,""))),j&&!/\b(?:Avant|Nook)\b/.test(V)&&(/Browser|Lunascape|Maxthon/.test(V)||"Safari"!=V&&/^iOS/.test(K)&&/\bSafari\b/.test(j[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(V)&&j[1])&&(y=j[j.length-1])&&U.push(y),U.length&&(U=["("+U.join("; ")+")"]),q&&W&&W.indexOf(q)<0&&U.push("on "+q),W&&U.push((/^on /.test(U[U.length-1])?"":"on ")+W),K&&(y=/ ([\d.+]+)$/.exec(K)||(T=/^[a-z]+ ([\d.+]+) \//i.exec(K)),K={architecture:32,family:y&&!T?K.replace(y[0],""):K,version:y?y[1]:null,toString:function(){var e=this.version;return this.family+(e&&!T?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(y=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(B))&&!/\bi686\b/i.test(B)&&(K&&(K.architecture=64,K.family=K.family.replace(RegExp(" *"+y),"")),V&&(/\bWOW64\b/i.test(e)||G&&/\w(?:86|32)$/.test(m.cpuClass||m.platform)&&!/\bWin64; x64\b/i.test(e))&&U.unshift("32-bit")),e||(e=null);var Y={};return Y.description=e,Y.layout=j&&j[0],Y.manufacturer=q,Y.name=V,Y.prerelease=H,Y.product=W,Y.ua=e,Y.version=V&&F,Y.os=K||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=d,Y.toString=i,Y.version&&U.unshift(F),Y.name&&U.unshift(V),K&&V&&(K!=String(K).split(" ")[0]||K!=V.split(" ")[0]&&!W)&&U.push(W?"("+K+")":"on "+K),U.length&&(Y.description=U.join(" ")),Y}var m={function:!0,object:!0},f=m[typeof window]&&window||this,g=f,v=m[typeof i]&&i,y=m[typeof t]&&t&&!t.nodeType&&t,T=v&&y&&"object"==typeof e&&e;!T||T.global!==T&&T.window!==T&&T.self!==T||(f=T);var _=Math.pow(2,53)-1,E=/\bOpera/,S=this,b=Object.prototype,C=b.hasOwnProperty,A=b.toString;v&&y?a(d(),function(e,t){v[t]=e}):f.platform=d()}).call(void 0)}).call(this,void 0!==ae?ae:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[5])(5)}()}()}),hi=p(ui),pi=le.empAnalytics?le.empAnalytics:hi,di=ue.getPlugin("plugin"),mi=function(e){function n(t,i){var n;n=e.call(this,t,i)||this,ye("AnalyticsPlugin","create"),n.analyticsConnector_=null,n.options_=i,n.onLoadStartBind=n.onLoadStart_.bind(c(c(n))),n.player.on(pe.LOAD_START,n.onLoadStartBind);var r=B();return n.options_=n.options_?n.options_:{},n.options_.analytics=n.options_.analytics?n.options_.analytics:{},n.options_.analytics.deviceInfo=n.options_.analytics.deviceInfo?n.options_.analytics.deviceInfo:{},n.options_.analytics.deviceInfo=ue.mergeOptions({deviceName:r.name,model:r.version},n.options_.analytics.deviceInfo),n}i(n,e);var r=n.prototype;return r.stop=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.dispose(),this.analyticsConnector_=null)},r.stopCasting=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.onChromeCastingStop(!0),this.analyticsConnector_=null)},r.dispose=function(){ye("AnalyticsPlugin","dispose"),this.player.off(pe.LOAD_START,this.onLoadStartBind),this.stop(),e.prototype.dispose.call(this)},r.options=function(e){if(!e)return this.options_;this.options_=ue.mergeOptions(this.options_,e)},r.newAnalytics=function(e){ye("new EMPAnalytics");var t=new pi(e.exposureApiURL,e.customer,e.businessUnit,e.sessionToken,e.userId,this.options_.analytics&&this.options_.analytics.deviceInfo);this.stop(),ye("new EMPAnalyticsConnector"),this.analyticsConnector_=new ci(this.player,t,this.options_)},r.onEntitlementLoadStart=function(){this.analyticsConnector_&&this.analyticsConnector_.onEntitlementLoadStart()},r.onError=function(e){this.analyticsConnector_&&this.analyticsConnector_.onError(e)},r.onWindowUnload=function(){this.analyticsConnector_&&this.analyticsConnector_.onWindowUnload()},r.onLoadStart_=function(e){Re.getEntitlement(this.player)||this.stop()},r.version=function(){return pi?pi.VERSION:e.prototype.version.call(this)},t(n,[{key:"connector",get:function(){return this.analyticsConnector_}}]),n}(di);mi.VERSION="2.1.100-291",ue.getPlugin("analytics")?ue.log.warn('A plugin named "analytics" already exists.'):ue.registerPlugin("analytics",mi);var fi=function(){function e(){this.channelId=0,this.assetId,this.programId,this.productId="",this.mimeType="",this.playRequest=null,this.requestId="",this.edrmConfig=null,this.live=!1,this.playSessionId="",this.analyticsConfig=null,this.lastViewedOffset=null,this.lastViewedTime=null,this.liveTime=null,this.entitlementType="",this.licenseExpiration=null,this.licenseExpirationReason="",this.minBitrate=0,this.maxBitrate=0,this.maxResWidth=0,this.maxResHeight=0,this.rwEnabled=!0,this.ffEnabled=!0,this.airplayBlocked=!1,this.mdnRequestRouterUrl="",this.timeshiftEnabled=!0,this.formats=null,this.mediaLocator="",this.src="",this.adMediaLocator="",this.streamInfo=null,this.playToken="",this.playTokenExpiration="",this.protection=void 0,this.certificateServer=void 0,this.licenseServers=void 0}var i=e.prototype;return i.commonInitiate=function(e){this.edrmConfig=e.edrmConfig||null,this.playSessionId=e.playSessionId||"",this.analyticsConfig=e.analyticsConfig||null,this.entitlementType=e.entitlementType||"",this.mdnRequestRouterUrl=e.mdnRequestRouterUrl||"",this.playToken=e.playToken||"",this.playTokenExpiration=e.playTokenExpiration||""},i.initiateV1=function(e,t){this.commonInitiate(e),this.minBitrate=e.minBitrate||0,this.maxBitrate=e.maxBitrate||0,this.maxResWidth=e.maxResWidth||0,this.maxResHeight=e.maxResHeight||0,this.rwEnabled=void 0===e.rwEnabled||e.rwEnabled,this.ffEnabled=void 0===e.ffEnabled||e.ffEnabled,this.airplayBlocked=void 0!==e.airplayBlocked&&e.airplayBlocked,this.timeshiftEnabled=e.timeshiftEnabled||!0,this.lastViewedOffset=e.lastViewedOffset||null,this.lastViewedTime=e.lastViewedTime||null,this.liveTime=e.liveTime||null,this.live=e.live||!1;var i=Date.parse(e.licenseExpiration||null);!1===isNaN(i)&&(this.licenseExpiration=new Date(i)),this.licenseExpirationReason=e.licenseExpirationReason||"",this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"",e.streamInfo?this.streamInfo=e.streamInfo:this.setupStreamInfo(t),e.fairplayConfig&&(this.protection={},this.protection.certificateUrl=e.fairplayConfig.certificateUrl||"",this.protection.licenseUrl=e.fairplayConfig.licenseAcquisitionUrl||"",e.fairplayConfig.secondaryMediaLocator?this.protection.version="mrr":this.protection.version="irdeto"),e.widevineConfig&&(this.certificateServer=e.widevineConfig.certificateUrl||""),e.cencConfig&&(this.licenseServers=e.cencConfig)},i.initiateV2=function(e){if(this.commonInitiate(e),this.formats=e.formats||null,e.contractRestrictions){var t=e.contractRestrictions;this.minBitrate=t.minBitrate||0,this.maxBitrate=t.maxBitrate||0,this.maxResWidth=t.maxResWidth||0,this.maxResHeight=t.maxResHeight||0,this.rwEnabled=void 0===t.rwEnabled||t.rwEnabled,this.ffEnabled=void 0===t.ffEnabled||t.ffEnabled,this.airplayBlocked=void 0===t.airplayEnabled||!t.airplayEnabled,this.timeshiftEnabled=t.timeshiftEnabled||!0}if(e.bookmarks){var i=e.bookmarks;this.lastViewedOffset=i.lastViewedOffset||null,this.lastViewedTime=i.lastViewedTime||null,this.liveTime=i.liveTime||null}if(e.streamInfo){var n=e.streamInfo;this.streamInfo={referenceTime:0},this.live=n.live||!1,this.streamInfo.live=n.live||!1,this.channelId=n.channelId||void 0,this.programId=n.programId||void 0,this.streamInfo.channelId=n.channelId||void 0,this.streamInfo.programId=n.programId||void 0,this.streamInfo.static=n.static||!1,this.isDynamicCachupAsLive=!n.static&&void 0!==n.start,this.isStaticCachupAsLive=n.static&&void 0!==n.end,n.start&&(this.streamInfo.start=new Date(1e3*n.start),this.streamInfo.startTime=this.streamInfo.start.getTime()),n.end&&(this.streamInfo.end=new Date(1e3*n.end),this.streamInfo.endTime=this.streamInfo.end.getTime())}},i.setupMediaLocator=function(e){this.mediaLocator=e.mediaLocator||"",this.mediaLocator&&("localhost"===location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=e.adMediaLocator||"";var t=Date.parse(e.licenseExpiration||null);!1===isNaN(t)&&(this.licenseExpiration=new Date(t)),this.licenseExpirationReason=e.licenseExpirationReason||""},i.selectFormat=function(e){var t,i=this;switch(this.mediaLocator="",this.src="",this.playRequest=e,this.mimeType=e.type,e.format){case"DASH":if(t=this.formats.filter(function(e){return"DASH"===e.format}),t.length>0){var n=t[0];this.setupMediaLocator(n),n.drm&&(this.licenseServers=n.drm,n.drm["com.widevine.alpha"]&&(this.certificateServer=n.drm["com.widevine.alpha"].certificateUrl),this.licenseServers={},Object.keys(n.drm).forEach(function(e){i.licenseServers[e]=n.drm[e].licenseServerUrl}))}break;case"HLS":if(t=this.formats.filter(function(e){return"HLS"===e.format}),t.length>0){var r=t[0];this.setupMediaLocator(r),r.drm&&r.drm["com.apple.fps"]&&(this.protection={},this.protection.certificateUrl=r.drm["com.apple.fps"].certificateUrl||"",this.protection.licenseUrl=r.drm["com.apple.fps"].licenseServerUrl||"",this.protection.version="irdeto")}}},i.setupStreamInfo=function(e){if(this.streamInfo={referenceTime:0},this.isDynamicCachupAsLive=!1,this.isStaticCachupAsLive=!1,this.mediaLocator){var t=S("t",this.mediaLocator);if(!t){var i=S("dvr_window_length",this.mediaLocator);if(i){var n=e?new Date(e):new Date;t=new Date(n.getTime()-1e3*i).toISOString().replace(/Z/g,"")}else if(this.live){var r=e?new Date(e):new Date;t=new Date(r.getTime()-72e5).toISOString().replace(/Z/g,"")}}if(t)try{t&&47===t.length?(this.streamInfo.start=new Date(t.slice(0,23)+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime(),this.streamInfo.end=new Date(t.slice(24)+"Z"),this.streamInfo.endTime=this.streamInfo.end.getTime()):t&&23===t.length&&(this.streamInfo.start=new Date(t+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime()),this.isDynamicCachupAsLive=void 0!==this.streamInfo.start&&void 0===this.streamInfo.end,this.isStaticCachupAsLive=void 0!==this.streamInfo.start&&void 0!==this.streamInfo.end}catch(e){ye.warn("timeParams",e)}}},t(e,null,[{key:"Type",get:function(){return{DASH:"DASH",FLASH:"FLASH",HLS:"HLS"}}}]),e}(),gi=d(function(e,t){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,i){for(var n=!0;n;){var r=e,o=t,s=i;n=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(s)}var c=Object.getPrototypeOf(r);if(null===c)return;e=c,t=o,i=s,n=!0,a=c=void 0}},o=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];if(i(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),Object.defineProperty(this,"message",{enumerable:!1,value:e,writable:!0}),Object.defineProperty(this,"name",{enumerable:!1,value:this.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace"))return void Error.captureStackTrace(this,this.constructor);Object.defineProperty(this,"stack",{enumerable:!1,value:new Error(e).stack,writable:!0})}return n(t,e),t}(Error);t.default=o,e.exports=t.default}),vi=p(gi),yi=function(e){function n(t){var i;void 0===t&&(t={});var n,r=!0,o=me.ENTITLEMENT2;return"string"==typeof t?n=t:t instanceof Object&&(n=t.message,!1===t.fatal&&(r=t.fatal),t.code&&(o=t.code)),i=e.call(this,n)||this,i.fatal=r,i.code=o,i}return i(n,e),t(n,[{key:"fatal",get:function(){return!!this.fatal_},set:function(e){this.fatal_=e}}]),n}(vi),Ti=function(){function e(e){void 0===e&&(e={}),this.options_=e}var t=e.prototype;return t.getEntitlement=function(e,t,i){throw new yi("EntitlementEngine: getEntitlement should be implemented in subclass.")},t.getV2Entitlement=function(e,t,i,n){throw new yi("EntitlementEngine: getV2Entitlement should be implemented in subclass.")},t.getV2Asset_=function(e,t,i,n){throw void 0===n&&(n=function(){}),new yi("EntitlementEngine: getV2Asset_ should be implemented in subclass.")},t.getServerTime=function(e){throw new yi("EntitlementEngine: getServerTime should be implemented in subclass.")},t.syncServerTime=function(t){this.getServerTime(function(i,n){n&&(ye.error("getServerTime",n),i=new Date),e.ServerTimeDiff_=i-new Date,ye("serverDiff",e.ServerTimeDiff_),t&&t(e.ServerTimeDiff_,n)})},t.getCachedServerTime=function(){return void 0!==e.ServerTimeDiff_?Date.now()+e.ServerTimeDiff_:Date.now()},t.getPreferences=function(e){throw new yi("EntitlementEngine: getPreferences should be implemented in subclass.")},t.savePreferences=function(e,t){throw new yi("EntitlementEngine: savePreferences should be implemented in subclass.")},t.getProgramInfo=function(e,t,i,n){throw new yi("EntitlementEngine: getProgramInfo should be implemented in subclass.")},t.getEPG=function(e,t,i,n){throw new yi("EntitlementEngine: getEPG should be implemented in subclass.")},t.getAssetInfo=function(e,t){throw new yi("EntitlementEngine: getAssetInfo should be implemented in subclass.")},t.getChannelInfo=function(e,t){throw new yi("EntitlementEngine: getChannelInfo should be implemented in subclass.")},t.verifySession=function(e,t){throw new yi("EntitlementEngine: verifySession should be implemented in subclass.")},t.verifyEntitlement=function(e,t,i){throw new yi("EntitlementEngine: verifyEntitlement should be implemented in subclass.")},t.login=function(e,t,i,n){throw new yi("EntitlementEngine: login should be implemented in subclass.")},t.logout=function(e){throw new yi("EntitlementEngine: logout should be implemented in subclass.")},t.fetchPreferences=function(e){throw new yi("EntitlementEngine: fetchPreferences should be implemented in subclass.")},t.savePreferences=function(e,t){throw new yi("EntitlementEngine: savePreferences should be implemented in subclass.")},e.isEntitlementEngine=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerEntitlementEngine=function(t,i){if(e.engines_||(e.engines_={}),!e.isEntitlementEngine(i))throw new yi("EntitlementEngine "+t+" must be a EntitlementEngine");return e.engines_[t]=i,i},e.getEntitlementEngine=function(t){return t=t||"EricssonExposure",e.engines_&&e.engines_[t]?e.engines_[t]:null},e}();Ti.ServerTimeDiff_=void 0;var _i=J,Ei=Object.prototype.toString,Si=d(function(e,t){function i(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=i,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),bi=(Si.left,Si.right,Function.prototype.toString),Ci=/^\s*class\b/,Ai=function(e){try{var t=bi.call(e);return Ci.test(t)}catch(e){return!1}},Ii=function(e){try{return!Ai(e)&&(bi.call(e),!0)}catch(e){return!1}},wi=Object.prototype.toString,Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,xi=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(Pi)return Ii(e);if(Ai(e))return!1;var t=wi.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t},Di=Object.prototype.toString,Oi=Object.prototype.hasOwnProperty,ki=function(e,t,i){for(var n=0,r=e.length;n<r;n++)Oi.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))},Li=function(e,t,i){for(var n=0,r=e.length;n<r;n++)null==i?t(e.charAt(n),n,e):t.call(i,e.charAt(n),n,e)},Ri=function(e,t,i){for(var n in e)Oi.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))},Ni=function(e,t,i){if(!xi(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=i),"[object Array]"===Di.call(e)?ki(e,t,n):"string"==typeof e?Li(e,t,n):Ri(e,t,n)},Mi=Ni,Bi=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ui=function(e){if(!e)return{};var t={};return Mi(Si(e).split("\n"),function(e){var i=e.indexOf(":"),n=Si(e.slice(0,i)).toLowerCase(),r=Si(e.slice(i+1));void 0===t[n]?t[n]=r:Bi(t[n])?t[n].push(r):t[n]=[t[n],r]}),t},Hi=Z,Gi=Object.prototype.hasOwnProperty,Fi=te;te.XMLHttpRequest=le.XMLHttpRequest||re,te.XDomainRequest="withCredentials"in new te.XMLHttpRequest?te.XMLHttpRequest:le.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(e){te["delete"===e?"del":e]=function(t,i,n){return i=ee(t,i,n),i.method=e.toUpperCase(),ie(i)}});var ji=function(){function e(){}return e.getBaseUrl=function(e,t){var i=new XMLHttpRequest;i.open("GET",e.mdnRequestRouterUrl),i.onreadystatechange=function(n){if(4===i.readyState)if(200===i.status){ye("getBaseUrl OK");var r=i.responseXML;try{var o=r.firstChild.getElementsByTagName("baseURL")[0].textContent;o?e.baseUrl=o:ye.error("getBaseUrl Error can not find baseURL"),t(e)}catch(i){ye.error("getBaseUrl Error",i),t(e)}}else ye.error("getBaseUrl Error",i.statusText),t(e)},i.send(null)},e}(),Vi=function(e){function n(t){var i;return void 0===t&&(t={}),t=g({exposureApiURL:"https://exposure.emps.ebsd.ericsson.net",exposureApiVersion:"v1"},t),i=e.call(this,t)||this,i.errorMap={400:{INVALID_JSON:{message:"Invalid json.",fatal:!1}},401:{NO_SESSION_TOKEN:{message:"The session token is missing.",fatal:!0},INVALID_SESSION_TOKEN:{message:"The session token is not valid.",fatal:!0}},403:{FORBIDDEN:{message:"The business unit has been configured to require server to server authentication, but it is not valid.",fatal:!0},NOT_ENTITLED:{message:"The user is not entitled.",fatal:!0},DEVICE_BLOCKED:{message:"The device is not allowed to play the asset.",fatal:!0},GEO_BLOCKED:{message:"Not allowed from this region.",fatal:!0},LICENSE_EXPIRED:{message:"Asset has been expired.",fatal:!0},NOT_AVAILABLE_IN_FORMAT:{message:"The media is not available in the requested format.",fatal:!1},NOT_ENABLED:{message:"The media is not enabled.",fatal:!0},CONCURRENT_STREAMS_LIMIT_REACHED:{message:"You have reached the maximum number of concurrent streams you are allowed to watch.",fatal:!0},NO_MEDIA_ON_CHANNEL:{message:"The media is not available on the channel.",fatal:!1},NO_MEDIA_FOR_PROGRAM:{message:"No media available for this program.",fatal:!1}},404:{UNKNOWN_BUSINESS_UNIT:{message:"The business unit cannot be found.",fatal:!0},UNKNOWN_ASSET:{message:"The asset cannot be found.",fatal:!1}},0:{NETWORK_ERROR:{message:"Network error.",fatal:!1}}},void 0===Ti.ServerTimeDiff_&&i.getServerTime(function(e,t){t&&(ye.error("getServerTime",t),e=new Date),Ti.ServerTimeDiff_=e-new Date,ye("serverDiff",Ti.ServerTimeDiff_)}),i}i(n,e);var r=n.prototype;return r.login=function(e,t,i,n){var r=this;if(!i)throw"callback is mandantory for login";var o=!1;n&&(o=!0);var s=""===e,a=new Date(this.getCachedServerTime());if(a.setTime(a.getTime()+864e5),this.options_.apiKey){var l={"EMP-Auth":this.options_.apiKey},c=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/auth/session",u={accountId:e,userId:e,deviceId:"WEB_"+e,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},expiration:a.toISOString(),anonymous:!1};Fi.post(c,{json:u,headers:l},function(e,t,n){r.checkForError(e,t,function(e,t){i({success:!1,expiration:0,message:t.message})})||(r.sessionToken=n.sessionToken,i({success:!0,expiration:864e5,session:n}))})}else{var h=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit;h+=!0===s?"/auth/anonymous":!0===o?"/auth/twofactorlogin":"/auth/login";var p={deviceId:"WEB_"+e,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},rememberMe:!1,username:e,password:t,totp:!0===o?n:void 0};Fi.post(h,{json:p},function(e,t,n){r.checkForError(e,t,function(e,t){i({success:!1,expiration:0,message:t.message})})||(r.sessionToken=n.sessionToken,i({success:!0,expiration:n.expirationDateTime?new Date(n.expirationDateTime)-new Date(r.getCachedServerTime()):864e5,session:n}))})}},r.logout=function(e,t){var i=this;void 0===e&&(e=function(){});var n=this.customer,r=this.businessUnit;if(!n)throw new yi("Customer was not provided.");if(!r)throw new yi("Business unit was not provided.");var o=this.requestHeaders;t&&(o={Authorization:"Bearer "+t});var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/auth/session";return Fi.del(s,{headers:o},function(t,n,r){i.checkForError(t,n,e)||(i.sessionToken=null,void 0!==typeof e&&e(!0))})},r.getV2Entitlement=function(e,t,i,n){if(void 0===e)throw new yi("No request specified.");if(void 0===t)throw new yi("Media not found.");if(!t.drm||!t.format)throw new yi("Invalid playrequest specified.");!e.assetId&&e.programId?this.getProgram_(e.channelId,e.programId,t,i):this.getV2Asset_(e,t,n,i)},r.getEntitlement=function(e,t,i){if(void 0===e)throw new yi("No request specified.");if(void 0===t)throw new yi("Media not found.");if(!t.drm||!t.format)throw new yi("Invalid playrequest specified.");null!==e.programId||e.channelId?this.getProgram_(e.channelId,e.programId,t,i):this.getAsset_(e.assetId,t,i)},r.getErrorForResponse=function(e){if(!e)return null;var t=e.statusCode,i="";if(!(t>=200&&t<=299))if(e.body&&e.body.message)i=e.body.message;else if(e.body)try{i=JSON.parse(e.body).message}catch(t){i=e.body}var n=this.errorMap[t];if(n){var r=t+" "+i,o=n[i];return o&&(r+=": "+o.message),new yi(o?{message:r,fatal:!!o.fatal}:r)}if(!(t>=200&&t<=299)){return new yi(t+" "+i)}return null},r.checkForError=function(e,t,i){var n=e;return e||(n=this.getErrorForResponse(t)),n?(i&&i(null,n),n):null},r.getV2Asset_=function(e,t,i,n){var r=this;if(void 0===n&&(n=function(){}),!this.customer)throw new yi("getV2Asset_: Customer was not provided.");if(!this.businessUnit)throw new yi("getV2Asset_: Business unit was not provided.");var o=e.assetId?e.assetId:e.channelId;if(!o)throw new yi("getV2Asset_: No assetId or channelId specified.");if(!i||!i.formats){var s=this.options_.exposureApiURL+"/v2/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/entitlement/"+o+"/play";return Fi.get(s,{headers:this.requestHeaders},function(i,s,a){if(i)return ye.warn("Fallback to Entitlement request v1",i),void r.getEntitlement(e,t,n);if(i=r.checkForError(i,s))return ye.warn("Fallback to Entitlement request v1",i.message),void r.getEntitlement(e,t,n);var l=JSON.parse(a),c=new fi;c.initiateV2(l),c.selectFormat(t),c.assetId=o,(c.channelId||c.programId)&&r.setStreamReferenceTime_(c);var u=s.headers["x-request-id"];if(c.requestId=u||"",c.mediaLocator)n(c,null);else{var h=new yi(t.format+" not avalible");h.fatal=!1,n(c,h)}})}if(i.selectFormat(t),i.mediaLocator)n(i,null);else{var a=new yi(t.format+" not avalible");a.fatal=!1,n(i,a)}},r.getAsset_=function(e,t,i){var n=this;void 0===i&&(i=function(){});var r=this.customer,o=this.businessUnit;if(!r)throw new yi("getAsset_: Customer was not provided.");if(!o)throw new yi("getAsset_: Business unit was not provided.");if(!e)throw new yi("getAsset_: assetId was not provided.");var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/entitlement/"+e+"/play";return Fi.post(s,{json:t,headers:this.requestHeaders},function(r,o,s){if(!n.checkForError(r,o,i)){var a=new fi;a.initiateV1(s,o.headers.date),a.assetId=e,a.playRequest=t,a.mimeType=t.type;var l=o.headers["x-request-id"];a.requestId=l||"",a.mdnRequestRouterUrl?ji.getBaseUrl(a,i):i(a)}})},r.setStreamReferenceTime_=function(e){(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&("application/dash+xml"===e.mimeType?e.isStaticCachupAsLive?e.streamInfo.referenceTime=e.streamInfo.startTime:e.streamInfo.referenceTime=0:"application/x-mpegurl"===e.mimeType&&(e.streamInfo.referenceTime=e.streamInfo.startTime))},r.getAssetMetadata_=function(e,t){var i=this;if(!this.customer)throw new yi("getAssetMetadata_: Customer was not provided.");if(!this.businessUnit)throw new yi("getAssetMetadata_: Business unit was not provided.");if(!e)throw new yi("getAssetMetadata_: assetId was not provided.")
;var n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/content/asset/"+e;return Fi.get(n,null,function(e,n,r){if(!i.checkForError(e,n,t)){var o=JSON.parse(r);t(o)}})},r.getProgram_=function(e,t,i,n){var r=this;void 0===n&&(n=function(){});var o=this.customer,s=this.businessUnit;if(!o)throw new yi("getProgram_: Customer was not provided.");if(!s)throw new yi("getProgram_: Business unit was not provided.");if(!e&&!t)throw new yi("getProgram_: channelId or programId was not provided.");var a="";t&&(a="/program/"+t);var l="";e&&(l="/channel/"+e);var c=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+o+"/businessunit/"+s+"/entitlement"+l+a+"/play";return Fi.post(c,{json:i,headers:this.requestHeaders},function(o,s,a){if(!r.checkForError(o,s,n)){var l=new fi;l.initiateV1(a,s.headers.date),e&&(l.assetId=e,l.channelId=e),t&&(l.programId=t),l.playRequest=i,l.mimeType=i.type,r.setStreamReferenceTime_(l);var c=s.headers["x-request-id"];l.requestId=c||"",l.mdnRequestRouterUrl?ji.getBaseUrl(l,n):n(l)}})},r.getServerTime=function(e){var t=this.customer,i=this.businessUnit;if(!t||!i)return ye.warn("getServerTime no customer or businessUnit"),void e(new Date);if(!1===window.navigator.onLine)return ye("getServerTime offline"),void e(new Date);var n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/time";return Fi.get(n,null,function(t,i,n){if(t)return void e(null,t);var r=JSON.parse(n),o=new Date(r.iso8601);e(o)})},r.getPreferences=function(e){var t=this,i=this.customer,n=this.businessUnit,r=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+i+"/businessunit/"+n+"/preferences";return Fi.get(r,{headers:this.requestHeaders},function(i,n,r){if(!t.checkForError(i,n,e)){var o=JSON.parse(r);e(o)}})},r.savePreferences=function(e,t){var i=this,n=this.customer,r=this.businessUnit;if(!e)return void ye.error("Preferences was not provided.");var o={preferences:e},s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/preferences";return Fi.post(s,{json:o,headers:this.requestHeaders},function(e,n,r){i.checkForError(e,n,t)||t(!0)})},r.getEPG=function(e,t,i,n){var r=this,o=this.customer,s=this.businessUnit,a=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+o+"/businessunit/"+s+"/epg/"+e;return a+="?from="+t+"&to="+i,Fi.get(a,null,function(e,t,i){if(!r.checkForError(e,t,n)){var o=JSON.parse(i);n(o)}})},r.getProgramInfo=function(e,t,i,n){var r=this.customer,o=this.businessUnit,s=null,a=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/epg/"+e;return n?a=a+"/program/"+n:(s={from:t.getTime(),to:t.getTime()},a+="?from="+s.from+"&to="+s.to),Fi.get(a,null,function(e,t,n){if(e)return void i(null,e);var r,o=JSON.parse(n);if(o.programs&&o.programs.length>0)r=o.programs[0];else{if(!o.programId)return void i(null,"No programs found.");r=o}r.start=new Date(r.startTime),r.end=new Date(r.endTime),r.duration=new Date(r.endTime)-new Date(r.startTime),i(r)})},r.getChannelInfo=function(e,t){void 0===t&&(t=function(){}),this.getAssetInfo(e,t)},r.getAssetInfo=function(e,t){var i=this,n=this.customer,r=this.businessUnit,o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/content/asset/"+e;return Fi.get(o,null,function(e,n,r){if(e)return void t(null,e);if(!i.checkForError(e,n,t)){var o=JSON.parse(r);t(o)}})},r.verifyEntitlement=function(e,t,i){var n=this;void 0===i&&(i=function(){});var r=this.customer,o=this.businessUnit;if(!r)throw new yi("verifyEntitlement: Customer was not provided.");if(!o)throw new yi("verifyEntitlement: Business unit was not provided.");if(!e)throw new yi("verifyEntitlement: assetId was not provided.");if(!t)throw new yi("verifyEntitlement: playRequest was not provided.");var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/entitlement/"+e+"?drm="+t.drm+"&format="+t.format;return Fi.get(s,{headers:this.requestHeaders},function(e,t,r){n.checkForError(e,t,i)||void 0!==typeof i&&i(JSON.parse(r))})},r.verifySession=function(e,t){var i=this,n=this.customer,r=this.businessUnit,o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/auth/session";return Fi.get(o,{headers:this.requestHeaders},function(n,r,o){if(i.checkForError(n,r))return void(t&&t());e&&e()})},t(n,[{key:"requestHeaders",get:function(){var e={Authorization:"Bearer "+this.sessionToken};return this.options_.apiKey&&(e=g({"EMP-Auth":this.options_.apiKey},e)),e}},{key:"customer",get:function(){return this.customer_||this.options_.customer||null},set:function(e){this.customer_=e}},{key:"businessUnit",get:function(){return this.businessUnit_||this.options_.businessUnit||null},set:function(e){this.businessUnit_=e}},{key:"sessionToken",get:function(){return this.options_.sessionToken||null},set:function(e){this.options_.sessionToken=e}}]),n}(Ti);Ti.registerEntitlementEngine("EricssonExposure",Vi);var Wi=function(){function e(e){this.assetId=e.assetId||null,this.programId=e.programId||null,this.channelId=e.channelId||null}return t(e,[{key:"assetId",get:function(){return this.assetId_},set:function(e){this.assetId_=e}},{key:"programId",get:function(){return this.programId_},set:function(e){this.programId_=e}},{key:"channelId",get:function(){return this.channelId_},set:function(e){this.channelId_=e}}]),e}(),qi=videojs.getPlugin("plugin"),Ki=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,ye("ProgramService","create"),n.MIN_PROGRAM_CHECK_TIMEOUT=1e3,n.checkForProgramChangeBind=n.checkForProgramChange_.bind(c(c(n))),n.onEntitlementChangeBind=n.onEntitlementChange.bind(c(c(n))),n.clearProgramChangeTimeoutBind=n.clearProgramChangeTimeout_.bind(c(c(n))),n.options_=i||{},n.programChangeTimeout_=null,n.programChangeCheckTimestamp_=0,n.player.on(pe.ENTITLEMENT_CHANGE,n.onEntitlementChangeBind),n}i(n,e);var r=n.prototype;return r.entitlement=function(e){return void 0===e?this.entitlement_:(this.entitlement_=e,e)},r.options=function(e){if(!e)return this.options_;this.options_=e},r.onEntitlementChange=function(e,t){var i=t&&t.entitlement;i&&(i instanceof fi||(this.stop(),i=g(new fi({}),i)),this.entitlement(i)),Re.supportsEpgProgramChange(this.player)||(this.player.off(pe.PLAYING,this.checkForProgramChangeBind),this.player.one(pe.PLAYING,this.checkForProgramChangeBind))},r.start=function(){ye("ProgramService","start"),this.entitlement()&&this.checkForProgramChange_({type:"startplayback"})},r.stop=function(){ye("ProgramService stop"),this.clearProgramChangeTimeout_(),this.player&&(this.player.off(pe.SEEKED,this.checkForProgramChangeBind),this.player.off(pe.PLAYING,this.checkForProgramChangeBind),this.player.off(pe.PAUSE,this.clearProgramChangeTimeoutBind),this.player.off(pe.PLAY,this.checkForProgramChangeBind)),this.currentProgram_=null,this.currentVOD_=null},r.reset=function(){this.stop(),this.currentProgram_=null,this.currentVOD_=null,this.entitlement_=null},r.clearProgramChangeTimeout_=function(e,t){this.programChangeTimeout_&&(e&&ye("clearProgramChangeTimeout",e.type),clearTimeout(this.programChangeTimeout_),this.programChangeTimeout_=null)},r.running=function(){return!!this.programChangeTimeout_&&(ye("ProgramService:running",this.programChangeCheckTimestamp_?new Date(this.programChangeCheckTimestamp_):0),!0)},r.dispose=function(){ye("ProgramService","dispose"),this.player.off(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.stop(),e.prototype.dispose.call(this)},r.checkForProgramChange_=function(e,t){var i=this;if(!e)return void ye.error("checkForProgramChange","event was not provided.");if(ye("checkForProgramChange",e.type),(this.entitlement().live||this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive||e.type!==pe.SEEKED)&&this.player&&this.player.options_){if(this.player.options_.absoluteStartTime&&e.type===pe.SEEKED)return void ye("checkForProgramChange","ignore livepoint");if(this.clearProgramChangeTimeout_(),Re.supportsEpgProgramChange(this.player)){if(Re.program(this.player))return void ye("updateCurrentProgram from player")}var n=this.entitlement().channelId,r=this.entitlement().live,o=this.entitlement().programId;if(!r&&!o)return void this.updateVOD_(this.entitlement().assetId);var s;if(r&&!o){var a=new Date(this.exposure.getCachedServerTime()),l="startplayback"===e.type?15:Re.timeBehindLive(this.player);if(a.setSeconds(a.getSeconds()-l),s=a,ye("checkForProgramChange","Live",l),this.currentProgram&&this.currentProgram.channelId===this.entitlement().channelId&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return ye("checkForProgramChange","Same"),s=null,void this.updateCurrentProgram_(this.currentProgram,!1)}else if("startplayback"!==e.type&&(this.entitlement().isDynamicCachupAsLive||this.entitlement().isStaticCachupAsLive)){var c=Re.getPlayheadTime(this.player);if(c){s=new Date(c);new Date(this.exposure.getCachedServerTime());if(this.currentProgram&&this.entitlement().isStaticCachupAsLive&&s.getTime()+2e3>=this.entitlement().streamInfo.end.getTime())return void(this.player.lineUpAsset&&s.getTime()+2e3<this.currentProgram.end.getTime()?(ye("checkForProgramChange","Load next stream",s),this.player.lineUpAsset(null,this.currentProgram.channelId,this.currentProgram.programId,s.getTime())):(ye("checkForProgramChange","playNextProgram",s),this.player.playNextProgram()));if(this.currentProgram&&s.getTime()+2e3>=this.currentProgram.end.getTime())ye("checkForProgramChange","Next",s),s.setSeconds(s.getSeconds()+2);else{if(this.currentProgram&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return ye("checkForProgramChange","Same",s),s=null,void this.updateCurrentProgram_(this.currentProgram,!1);ye("checkForProgramChange","Prev",s)}}}this.exposure.getProgramInfo(n,s,function(t,n){if(i.currentVOD_=null,n)return ye("getProgramInfo","No EPG found.",n),void i.pollingForEPG_();i.updateCurrentProgram_(t,"startplayback"===e.type)},s?null:o)}},r.updateChannelInfo_=function(e,t){var i=this;return e&&e.channelId?this.currentChannelAsset_&&this.currentChannelAsset_.assetId===e.channelId?(e.channelInfo=this.extractAssetMetadata(this.currentChannelAsset_),void t()):void this.exposure.getChannelInfo(e.channelId,function(n,r){if(r)return ye.warn("updateChannelInfo","No ChannelInfo found.",r),void t();ye("updateChannelInfo",e.channelId),i.currentChannelAsset_=n,e.channelInfo=i.extractAssetMetadata(i.currentChannelAsset_),t()}):(ye.error("updateChannelInfo","program or channelId empty"),void t())},r.updateVOD_=function(e){var t=this;this.exposure.getAssetInfo(e,function(e,i){if(t.currentProgram_=null,t.player)return i?(ye.warn("No AssetInfo found.",i),t.currentVOD_=null,void t.player.trigger(pe.ASSET_CHANGED,{asset:null})):void(t.currentVOD_&&t.currentVOD_.assetId===e.assetId||(t.currentVOD_=e,ye("ASSET_CHANGED"),t.player.trigger(pe.ASSET_CHANGED,{asset:e})))})},r.updateCurrentProgram_=function(e,t){var i=this;if(ye("updateCurrentProgram",e,t),this.clearProgramChangeTimeout_(),this.player){if(this.currentProgram_&&this.currentProgram_.programId===e.programId||(this.currentVOD_=null,this.currentProgram_=e,t||this.verifyEntitlement(),this.updateChannelInfo_(e,function(){i.player&&(Re.currentAsset(i.player,e.assetId,e.programId,e.channelId),i.entitlement_&&(i.entitlement_.channelId=e.channelId,i.entitlement_.assetId=e.assetId,i.entitlement_.programId=e.programId),Re.setTechProgram(i.player,e),i.player.removeClass("vjs-live"),i.player.trigger(pe.PROGRAM_CHANGED,{program:e}),i.player.trigger(pe.DURATION_CHANGE))})),t)return void ye("updateCurrentProgram","startplayback");if(this.entitlement().isDynamicCachupAsLive||this.entitlement().live||this.entitlement().isStaticCachupAsLive){var n;if(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive){var r=Re.getPlayheadTime(this.player);if(!r)return void ye("updateCurrentProgram","no playHeadTime",r);n=new Date(r)}else{var o=Re.timeBehindLive(this.player);n=new Date(this.exposure.getCachedServerTime()),n.setSeconds(n.getSeconds()-o)}var s=new Date(e.start.getTime()+e.duration),a=this.entitlement().streamInfo.end;a&&s.getTime()>a.getTime()&&(s=a);var l=s.getTime()-n.getTime();(!l||l<this.MIN_PROGRAM_CHECK_TIMEOUT)&&(ye("updateCurrentProgram","timediff is below minimum",l),l=this.MIN_PROGRAM_CHECK_TIMEOUT),this.programChangeCheckTimestamp_=Date.now()+l,ye("updateCurrentProgram","programChangeTimeout",new Date(this.programChangeCheckTimestamp_)),this.programChangeTimeout_=setTimeout(function(){i.checkForProgramChange_({type:"programend"}),i.programChangeTimeout_=null},l>2147483647?2147483647:l)}this.player.off(pe.SEEKED,this.checkForProgramChangeBind),this.player.one(pe.SEEKED,this.checkForProgramChangeBind),this.player.off(pe.PLAY,this.checkForProgramChangeBind),this.player.one(pe.PLAY,this.checkForProgramChangeBind),this.player.off(pe.PAUSE,this.clearProgramChangeTimeoutBind),this.player.one(pe.PAUSE,this.clearProgramChangeTimeoutBind)}},r.pollingForEPG_=function(){var e=this;this.currentProgram_;this.currentProgram_=null,this.player.trigger(pe.PROGRAM_CHANGED,{program:null}),this.player.trigger(pe.DURATION_CHANGE),this.player.addClass("vjs-live");this.programChangeCheckTimestamp_=Date.now()+12e4,this.programChangeTimeout_=setTimeout(function(){e.checkForProgramChange_({type:"pollingforepg"}),e.programChangeTimeout_=null},12e4)},r.getNextProgram=function(e){if(!this.currentProgram&&e)return void e(null,{message:"getNextProgram No Current Program"});if(this.exposure.getCachedServerTime()<this.currentProgram.end.getTime())return void e(this.currentProgram);var t=new Date(this.currentProgram.endTime);t.setSeconds(t.getSeconds()+15),this.exposure.getProgramInfo(this.currentProgram.channelId,t,function(t,i){i?e(null,i):e(t)},null)},r.getPreviousProgram=function(e){if(!this.currentProgram&&e)return void e(null,{message:"getPreviousProgram No Current Program"});var t=new Date(this.currentProgram.startTime);t.setSeconds(t.getSeconds()-15),this.exposure.getProgramInfo(this.currentProgram.channelId,t,function(t,i){i?e(null,i):e(t)},null)},r.getProgram=function(e,t){if(!this.currentProgram&&t)return void t(null,{message:"getProgram No Current Program"});this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,i){i?t(null,i):t(e)},null)},r.verifyEntitlement=function(){var e=this;this.currentProgram&&this.exposure.verifyEntitlement(this.currentProgram.assetId,this.entitlement().playRequest,function(t,i){return i?(e.player.error("verifyEntitlement "+i.message),void Re.stop(e.player)):t&&"SUCCESS"===t.status?void ye("verifyEntitlement",t.status):(e.player.error(t?t.status:"verifyEntitlement no status"),void Re.stop(e.player))})},r.getAssetMetadata=function(e,t){var i=this,n=this.currentProgram?this.currentProgram.asset:this.currentVOD;n&&n.assetId==e?t(this.extractAssetMetadata(n)):this.exposure.getAssetMetadata_(e,function(e,n){return n?(ye.warn("getAssetMetadata","No data found.",n),void t(null,n)):void t(i.extractAssetMetadata(e))})},r.extractAssetMetadata=function(e){var t=null,i=null,n=null;return e&&e.localized&&e.localized.length>0&&(e.localized[0].title&&(t=e.localized[0].title),e.localized[0].shortDescription&&(i=e.localized[0].shortDescription),e.localized[0].images&&e.localized[0].images.length>0&&e.localized[0].images[0].url&&(n=e.localized[0].images)),{title:t||"",subtitle:i||"",images:n||[]}},t(n,[{key:"exposure",get:function(){if(!this.options_.exposure){var e=this.player.options_["entitlement-engine"];e||(e=this.player.options_["exposure-service"]?this.player.options_["exposure-service"]:"EricssonExposure");var t=this.player.options_[e.toLowerCase()];if(!t)return null;var i=Ti.getEntitlementEngine(e);this.options_.exposure=new i(t)}return this.options_.exposure}},{key:"currentProgram",get:function(){if(Re.supportsEpgProgramChange(this.player)){return Re.program(this.player)}return this.currentProgram_}},{key:"currentChannelAsset",get:function(){return this.currentChannelAsset_}},{key:"currentVOD",get:function(){return this.currentVOD_}}]),n}(qi);Ki.VERSION="2.1.100-291",videojs.getPlugin("programService")?videojs.log.warn('A plugin named "programService" already exists.'):videojs.registerPlugin("programService",Ki);var Yi=videojs.getPlugin("plugin"),zi=function(e){function n(t,i){var n;return n=e.call(this,t,i)||this,ye("EntitlementExpirationService","create"),n.options_=i,n.onEntitlementChangeBind=n.onEntitlementChange.bind(c(c(n))),n}i(n,e);var r=n.prototype;return r.dispose=function(){ye("EntitlementExpirationService","dispose"),this.stop(),e.prototype.dispose.call(this)},r.stop=function(){ye("EntitlementExpirationService","stop"),this.player.off(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null)},r.start=function(){ye("EntitlementExpirationService","start"),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.player.off(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player.on(pe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},r.entitlement=function(e){return void 0===e?this.entitlement_:(this.entitlement_=e,e)},r.onEntitlementChange=function(e,t){this.entitlement(t&&t.entitlement),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.checkForExpiration()},r.options=function(e){if(!e)return this.options_;this.options_=e},r.checkForExpiration=function(){var e=this,t=this.entitlement();if(ye("EntitlementExpirationService","checkForExpiration",t.licenseExpiration),this.hasLicenseExpiration(t)){var i=t.licenseExpiration.getTime()-this.exposure.getCachedServerTime();if(i<=0)return this.player.error(this.errorForReason(t.licenseExpirationReason)),void Re.stop(this.player);i<2147483647?this.expirationTimeout_=setTimeout(function(){e.expirationTimeout_=null,ye("EntitlementExpirationService","license expired"),e.refreshEntitlement()},i):setTimeout(function(){return e.checkForExpiration()},1073741823)}},r.refreshEntitlement=function(){Re.restart(this.player,!0)},r.errorForReason=function(e){switch(e){case"GEO_BLOCKED":return this.player.localize("Not allowed from this region.");case"NOT_ENTITLED":return this.player.localize("The user is not entitled.");case"GAP_IN_EPG":return this.player.localize("Asset temporarily not available");case"EPG_PLAY_MAX_HOURS":default:return this.player.localize("Asset exceeded maximum playback time")}},r.hasLicenseExpiration=function(e){return!!e.licenseExpiration},t(n,[{key:"exposure",get:function(){return this.options_&&this.options_.exposure}}]),n}(Yi);zi.VERSION="2.1.100-291",videojs.getPlugin("entitlementExpirationService")?videojs.log.warn('A plugin named "entitlementExpirationService" already exists.'):videojs.registerPlugin("entitlementExpirationService",zi);var Xi=ue.getComponent("Tech"),$i=function e(t){return{setSource:function(i,n){function r(e,t,i,n,r){e.options_.absoluteStartTime&&e.options_.absoluteStartTime>i.getCachedServerTime()?e.options_.absoluteStartTime=i.getCachedServerTime()-1e4:e.options_.startTime&&e.options_.startTime>i.getCachedServerTime()/1e3&&(e.options_.startTime=(i.getCachedServerTime()-1e4)/1e3);if(e.programService&&(!t.programService||!t.programService.disable)){if(e.programService().options({exposure:i}),n.isDynamicCachupAsLive&&t.playFrom)if("beginning"===t.playFrom||!n.live&&!e.options_.absoluteStartTime&&!e.options_.startTime){var o=n.streamInfo.start.getTime()+100;"application/dash+xml"===n.mimeType?(ye("SET startTime",o),e.options({startTime:o/1e3}),n.options.startTime=o/1e3):(ye("SET startTime",.1),e.options({startTime:.1}),n.options.startTime=.1)}else if(e.options_.absoluteStartTime){e.options_.absoluteStartTime<n.streamInfo.start.getTime()&&(e.options_.absoluteStartTime=n.streamInfo.start.getTime());var s=e.options_.absoluteStartTime;"HLS"===e.streamType&&(s=e.options_.absoluteStartTime-n.streamInfo.start.getTime()),s=s||.1,ye("absoluteStartTime SET startTime",s),e.options({startTime:s/1e3}),n.options.startTime=s/1e3,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0}else e.options_.startTime&&(n.options.startTime=e.options_.startTime,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0);else if(n.isStaticCachupAsLive&&e.options_.absoluteStartTime){e.options_.absoluteStartTime<n.streamInfo.start.getTime()&&(e.options_.absoluteStartTime=n.streamInfo.start.getTime());var a=e.options_.absoluteStartTime-n.streamInfo.start.getTime();ye("absoluteStartTime SET startTime",a),e.options({startTime:a/1e3}),n.options.startTime=a/1e3,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0}else n.isStaticCachupAsLive&&e.options_.startTime&&(n.options.startTime=e.options_.startTime,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0);e.programService().start()}r()}function o(e,i){if(!e)return void ye.error("setupEntitlement no entitlement");!0===s.useLastViewedOffset&&((e.isStaticCachupAsLive||e.isDynamicCachupAsLive||e.live)&&(e.lastViewedTime||e.liveTime)?e.liveTime&&(ye("liveTime",new Date(e.liveTime),e.liveTime),t.options({absoluteStartTime:e.liveTime})):e.lastViewedOffset&&(ye("lastViewedOffset",e.lastViewedOffset/1e3),"DASH"!==t.streamType&&t.options({startTime:e.lastViewedOffset/1e3}))),!1===e.timeshiftEnabled&&t.options({timeShiftDisabled:!0}),t.trigger(pe.ENTITLEMENT_CHANGE,{entitlement:e}),e=g(new fi({}),e),e.type=e.mimeType;var n={autoplay:t.options_.autoplay,muted:t.options_.muted,language:t.options_.language,maxBitrate:t.options_.maxBitrate,timeShiftDisabled:t.options_.timeShiftDisabled,useLastViewedOffset:t.options_.useLastViewedOffset,startTime:t.options_.startTime,absoluteStartTime:t.options_.absoluteStartTime,audioLanguage:t.options_.audioLanguage,subtitleLanguage:t.options_.subtitleLanguage,liveDelay:t.options_.liveDelay};return e.options=n,e.options.source=e,t.entitlementExpirationService().start(),e}var s=t.options(),a=null,l=null,c=null;if(t.programService&&t.programService().stop(),function(e){return e&&e.playSessionId&&e.playToken&&e.mediaLocator}(t.currentSource()))a=t.currentSource();else{var u=_(i.src);c=new Wi(u),t.trigger(pe.ENTITLEMENT_LOAD_START,c)}var h=s["entitlement-engine"];h||(h=s["exposure-service"]?s["exposure-service"]:"EricssonExposure");var p=s[h.toLowerCase()];if(!p){var d=new fe("Missing entitlementOptions in player options",me.ENTITLEMENT);return t.error(d),void n(d)}var m=e.getExposure(p,h);if(!p.sessionToken)return void m.login("","",function(e){if(e.success)p.sessionToken=e.session.sessionToken,t.trigger(pe.REPLAY);else{ye.error("Anonymous login fail",e.message);var i=new fe("Anonymous login fail",me.ENTITLEMENT);t.error(i)}},"");s.analytics&&s.analytics.disable||function(e,t,i,n){var r=t.analyticsDeviceInfo;r&&(ye.warn("options.analyticsDeviceInfo is deprecated. Use options.analytics.deviceInfo."),t.analytics||(t.analytics={}),t.analytics.deviceInfo=r),e.analytics&&(e.analytics().options({exposure:n,analytics:t.analytics}),e.analytics().newAnalytics({exposureApiURL:i.exposureApiURL,customer:i.customer,businessUnit:i.businessUnit,sessionToken:i.sessionToken}),e.analytics().onEntitlementLoadStart())}(t,s,p,m),t.entitlementExpirationService().options({exposure:m});var f=s.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,Xi.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];if(i&&"Html5"!==t&&"EmpCast"!==t)return i.isSupported()});if(0===f.length){var v=new fe("Unable to load asset: None of the playback technologies are supported",me.ENTITLEMENT);return t.error(v),void n(v)}var y;oe(f.length,function(e){var i=e.iteration();if(s.excludeTechs&&-1!==s.excludeTechs.indexOf(f[i][0]))return void e.next();var u=f[i][1];t.tech_&&t.techName_!==f[i][0]&&(t.techCall_("reset"),t.unloadTech_());try{if(a)return a=o(a,u),r(t,s,m,a,function(){n(null,a)}),void e.break();var h=s[f[i][0].toLowerCase()],p=h&&h.streamType&&u.entitlementPlayRequests?u.entitlementPlayRequests[h.streamType]:u.entitlementPlayRequest;m.getV2Entitlement(c,p,function(h,d){if(d){if(t.options_.excludeTechs||(t.options_.excludeTechs=[]),t.options_.excludeTechs.push(f[i][0]),y=new fe(d.message+"  "+JSON.stringify(p)+JSON.stringify(c),d.code,d.stack),d.fatal)return t.error(y),Re.stop(t),void n(y);l=h,e.next()}else a=o(h,u),Re.currentAsset(t,h.assetId,h.programId,h.channelId),a.adMediaLocator&&t.yospace?(ye("play adMediaLocator with yospace",a.adMediaLocator),t.yospace().start("VoD",a.adMediaLocator).then(function(i){ye("yospace mediaLocator returned",i),a.mediaLocator=i,a.src=i,r(t,s,m,a,function(){n(null,a)}),e.break()}).catch(function(e){y=new fe(e,me.ENTITLEMENT),t.error(y),Re.stop(t)})):(r(t,s,m,a,function(){n(null,a)}),e.break())},l)}catch(t){return ye.warn("error try next tech",new fe(t,me.ENTITLEMENT)),void e.next()}},function(){if(null===a)return y||(y=new fe("Unable to load asset: None of the playback technologies are supported",me.ENTITLEMENT)),t.error(y),Re.stop(t),void n(y)})}}};$i.isExposure=function(e){return Ti.isEntitlementEngine(e)},$i.EntitlementClass=fi,$i.getExposure=function(e,t){if(e){return new(Ti.getEntitlementEngine(t))(e)}throw new fe("Missing exposureOptions",me.ENTITLEMENT)},$i.registerExposure=function(e,t){return Ti.registerEntitlementEngine(e,t)},$i.getLog=function(){return ye},$i.getEntitlementEngine=Ti.getEntitlementEngine,$i.registerEntitlementEngine=Ti.registerEntitlementEngine,$i.isEntitlementEngine=Ti.isEntitlementEngine,$i.VERSION="2.1.100-291",ue.EntitlementMiddleware?ue.log.warn("EntitlementMiddleware already exists."):(ue.use("video/emp",$i),ue.EntitlementMiddleware=$i);var Ji=window.empEntitlement?window.empEntitlement:$i,Zi=ue;return Zi.canPlayUnencrypted=X,Zi.canPlayEncrypted=$,Zi.getExposure=Ji.getExposure,Zi.getEntitlementEngine=Ji.getEntitlementEngine,Zi.registerEntitlementEngine=Ji.registerEntitlementEngine,Zi.isEntitlementEngine=Ji.isEntitlementEngine,Zi.EntitlementClass=Ji.EntitlementClass,Zi.log=ye,Zi.plugin=ue.plugin,Zi.videojs=ue,Zi.EntitlementMiddleware=Ji,Zi.extend=ue.extend,Zi.Events=pe,Zi.VERSION="2.1.100-291","function"==typeof define&&define.amd?define("empPlayer",[],function(){return Zi}):"object"==typeof exports&&"object"==typeof module&&(module.exports=Zi),Zi});
