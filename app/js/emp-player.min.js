!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.empPlayer=t()}(this,function(){function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e,t){se(e).forEach(function(i){return t(e[i],i)})}function r(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return se(e).reduce(function(i,n){return t(i,e[n],n)},i)}function o(e){return!!e&&"object"===(void 0===e?"undefined":Q(e))}function s(e){return"string"==typeof e||!!e&&"object"===(void 0===e?"undefined":Q(e))&&"[object String]"===Object.prototype.toString.call(e)}function a(e){var t={assetId:void 0,programId:void 0,channelId:void 0};try{t=JSON.parse(e)}catch(i){t.assetId=e}return t.channelId&&(t.assetId=t.channelId),t}function l(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){e=l(e),Array.isArray(e)?t=t.concat(e):o(e)&&t.push(e)}),e=t}else e="string"==typeof e&&e.trim()?[{src:e}]:o(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[e]:[];return e}function c(e,t){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function u(e,t){var i=Array.prototype.slice.call(t),n=function(){},r=$.console||{log:n,warn:n,error:n,trace:n};e?i.unshift(e.toUpperCase()+":"):e="log",i.unshift("EMPPlayer:"),r[e].apply?r[e].apply(r,i):r[e](i.join(" "))}function p(){return me++}function h(e){return e.replace(/\n\r?\s*/g,"")}function d(e,t){if(!e||!t)return"";if("function"==typeof $.getComputedStyle){var i=$.getComputedStyle(e);return i?i[t]:""}return e.currentStyle[t]||""}function m(e){return o(e)&&1===e.nodeType}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],r=Ee.createElement(e);return Object.getOwnPropertyNames(t).forEach(function(e){var i=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(pe.warn(Ie(xe,e,i)),r.setAttribute(e,i)):"textContent"===e?g(r,i):r[e]=i}),Object.getOwnPropertyNames(i).forEach(function(e){r.setAttribute(e,i[e])}),n&&_(r,n),r}function g(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function y(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(d(e,"height"))),i.width||(i.width=parseFloat(d(e,"width"))),i}}function v(e){return o(e)&&3===e.nodeType}function T(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),m(e)||v(e)?e:"string"==typeof e&&/\S/.test(e)?Ee.createTextNode(e):void 0}).filter(function(e){return e})}function _(e,t){return T(t).forEach(function(t){return e.appendChild(t)}),e}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),o=Math.floor(t/60%60),s=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(r=n=i="-"),r=r>0||s>0?r+":":"",n=((r||o>=10)&&n<10?"0"+n:n)+":",i=i<10?"0"+i:i,r+n+i}function S(e){return void 0!==e&&"function"==typeof e.then}function b(e){S(e)&&e.then(null,function(e){})}function C(e,t){return Array.isArray(e)?A(e):void 0===e||void 0===t?A():A([[e,t]])}function A(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:w.bind(null,"start",0,e),end:w.bind(null,"end",1,e)}}function w(e,t,i,n){return void 0===n&&(log.warn("DEPRECATED: Function '"+e+"' on 'TimeRanges' called without an index argument."),n=0),P(e,n,i.length-1),i[n][t]}function P(e,t,i){if(t<0||t>i)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is greater than or equal to the maximum bound ("+i+").")}function I(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}function x(e,t,i){try{e.style[t]=i}catch(e){return}}function k(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}function O(e,t){return k(e.options[e.options.selectedIndex].value,t)}function D(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(k(e.options[n].value,i)===t){e.selectedIndex=n;break}}function L(){var e=Z.getTech("EmpShaka");if(void 0!==e&&e.isSupported())return Promise.resolve(!0);var t=Z.getTech("EmpHLS");if(void 0!==t&&t.isSupported())return Promise.resolve(!0);var i=Z.getTech("EmpFlash");return void 0!==i&&i.isSupported()?Promise.resolve(!0):Promise.resolve(!1)}function N(){var e=[];if("function"==typeof $.navigator.requestMediaKeySystemAccess){var t=-1!==$.navigator.userAgent.indexOf("Android"),i=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:!0===t?"SW_SECURE_DECODE":"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}],n=Z.getTech("EmpShaka");void 0!==n&&n.isSupported()&&(e.push(new Promise(function(e,t){$.navigator.requestMediaKeySystemAccess("com.microsoft.playready",i).then(function(){e(!0)},function(){e(!1)})})),e.push(new Promise(function(e,t){$.navigator.requestMediaKeySystemAccess("com.widevine.alpha",i).then(function(){e(!0)},function(){e(!1)})})))}var r=Z.getTech("EmpHLS");void 0!==r&&r.isSupported()&&$.WebKitMediaKeys&&r.getKeySystem&&$.WebKitMediaKeys.isTypeSupported(r.getKeySystem(),"video/mp4")&&e.push(!0);var o=Z.getTech("EmpFlash");return void 0!==o&&o.isSupported()&&e.push(!0),0===e.length&&e.push(!1),Promise.all(e).then(function(e){return-1!==e.indexOf(!0)},function(e){return!1})}function R(e){var t=ri.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}function M(e,t,i){if(!ni(t))throw new TypeError("iterator must be a function");arguments.length<3&&(i=this),"[object Array]"===ai.call(e)?B(e,t,i):"string"==typeof e?G(e,t,i):U(e,t,i)}function B(e,t,i){for(var n=0,r=e.length;n<r;n++)li.call(e,n)&&t.call(i,e[n],n,e)}function G(e,t,i){for(var n=0,r=e.length;n<r;n++)t.call(i,e.charAt(n),n,e)}function U(e,t,i){for(var n in e)li.call(e,n)&&t.call(i,e[n],n,e)}function F(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var n in i)hi.call(i,n)&&(e[n]=i[n])}return e}function H(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function j(e,t,i){var n=e;return ni(t)?(i=t,"string"==typeof e&&(n={uri:e})):n=pi(t,{uri:e}),n.callback=i,n}function V(e,t,i){return t=j(e,t,i),W(t)}function W(e){function t(){4===a.readyState&&setTimeout(r,0)}function i(){var e=void 0;if(e=a.response?a.response:a.responseText||K(a),g)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(u),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,s(e,y)}function r(){if(!c){var t;clearTimeout(u),t=e.useXDR&&void 0===a.status?200:1223===a.status?204:a.status;var n=y,r=null;return 0!==t?(n={body:i(),statusCode:t,method:h,headers:{},url:p,rawRequest:a},a.getAllResponseHeaders&&(n.headers=ui(a.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),s(r,n,n.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var o=!1,s=function(t,i,n){o||(o=!0,e.callback(t,i,n))},a=e.xhr||null;a||(a=e.cors||e.useXDR?new V.XDomainRequest:new V.XMLHttpRequest);var l,c,u,p=a.url=e.uri||e.url,h=a.method=e.method||"GET",d=e.body||e.data,m=a.headers=e.headers||{},f=!!e.sync,g=!1,y={body:void 0,headers:{},statusCode:0,method:h,url:p,rawRequest:a};if("json"in e&&!1!==e.json&&(g=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),d=JSON.stringify(!0===e.json?d:e.json))),a.onreadystatechange=t,a.onload=r,a.onerror=n,a.onprogress=function(){},a.onabort=function(){c=!0},a.ontimeout=n,a.open(h,p,!f,e.username,e.password),f||(a.withCredentials=!!e.withCredentials),!f&&e.timeout>0&&(u=setTimeout(function(){if(!c){c=!0,a.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),a.setRequestHeader)for(l in m)m.hasOwnProperty(l)&&a.setRequestHeader(l,m[l]);else if(e.headers&&!H(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(a.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(a),a.send(d||null),a}function K(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function q(){}function Y(e,t,i){var n=0,r=!1,o={next:function(){r||(n<e?(n++,t(o)):(r=!0,i()))},iteration:function(){return n-1},break:function(){r=!0,i()}};return o.next(),o}var z,X="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};z="undefined"!=typeof window?window:void 0!==X?X:"undefined"!=typeof self?self:{};var $=z,J=$.videojs,Z=J,Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},te=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ie=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ne=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},re=function e(){ee(this,e),this.ENDED="ended",this.ERROR="error",this.LOADED_DATA="loadeddata",this.TIMESHIFT_CHANGE="timeshiftchange",this.DURATION_CHANGE="durationchange",this.LOADED_METADATA="loadedmetadata",this.SEEKING="seeking",this.TIME_UPDATE="timeupdate",this.USER_ACTIVE="useractive",this.USERIN_ACTIVE="userinactive",this.VOLUME_CHANGE="volumechange",this.LOAD_START="loadstart",this.CAN_PLAY="canplay",this.PLAYING="playing",this.WAITING="waiting",this.SEEKED="seeked",this.ABORT="abort",this.PLAY="play",this.PAUSE="pause",this.DISPOSE="dispose",this.MODE_CHANGE="modechange",this.CHANGE="change",this.ADD_TRACK="addtrack",this.REMOVE_TRACK="removetrack",this.METRIC_CHANGED="metricchanged",this.RECOVERABLE_ASSET_ERROR="recoverableasseterror",this.BITRATE_CHANGED="bitratechanged",this.CLOSE="close",this.READY="ready",this.RESIZE="resize",this.TAP="tap",this.CLICK="click",this.FOCUS="focus",this.BLUR="blur",this.BEFORE_MODAL_OPEN="beforemodalopen",this.MODAL_OPEN="modalopen",this.BEFORE_MODAL_CLOSE="beforemodalclose",this.MODAL_CLOSE="modalclose",this.BEFORE_MODAL_FILL="beforemodalfill",this.MODAL_FILL="modalfill",this.BEFORE_MODAL_EMPTY="beforemodalempty",this.MODAL_EMPTY="modalempty",this.CAN_PLAY_THROUGH="canplaythrough",this.FIRST_PLAY="firstplay",this.PROGRESS="progress",this.SUSPEND="suspend",this.EMPTIED="emptied",this.STALLED="stalled",this.RATE_CHANGE="ratechange",this.TEXT_TRACK_CHANGE="texttrackchange",this.TRACK_CHANGE="trackchanged",this.POSTER_CHANGE="posterchange",this.KEY_DOWN="keydown",this.KEY_UP="keyup",this.MOUSE_DOWN="mousedown",this.MOUSE_MOVE="mousemove",this.MOUSE_UP="mouseup",this.TOUCH_START="touchstart",this.TOUCH_MOVE="touchmove",this.TOUCH_END="touchend",this.TOUCH_LEAVE="touchleave",this.TOUCH_CANCEL="touchcancel",this.FULLSCREEN_CHANGE="fullscreenchange",this.ENTER_FULL_WINDOW="enterFullWindow",this.EXIT_FULL_WINDOW="exitFullWindow",this.CONTROLS_ENABLED="controlsenabled",this.CONTROLS_DISABLED="controlsdisabled",this.USING_NATIVE_CONTROLS="usingnativecontrols",this.USING_CUSTOM_CONTROLS="usingcustomcontrols",this.SLIDER_ACTIVE="slideractive",this.SLIDER_INACTIVE="sliderinactive",this.ENTITLEMENT_CHANGE="entitlementchange",this.ENTITLEMENT_LOAD_START="entitlementloadstart",this.PLAYER_CREATED="playercreated",this.RESTARTING="restarting",this.SEGMENTS_UPDATED="segmentsupdated",this.SEGMENT_CHANGED="segmentchanged",this.CHROMECAST_CASTING="chromecastcasting",this.CHROMECAST_STOPPED="chromecaststopped",this.STOPPED="stopped",this.READY_TO_PLAY="readytoplay",this.PROGRAM_CHANGED="programchanged",this.ASSET_CHANGED="assetchanged",this.SEGMENT_MISSING="segmentmissing",this.AIRPLAY_START="airplayStart",this.REPLAY="replay"},oe=new re,se=function(e){return o(e)?Object.keys(e):[]},ae={UNKNOWN:100,LOAD_ASSET:101,ENTITLEMENT:102,SHAKA_TECH:200,HLS_TECH:300,FLASH_TECH:400,CHROMECAST_TECH:500},le=function(e){function t(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae.UNKNOWN,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;ee(this,t);var o=ne(this,e.call(this));return o.code=n,s(i)?o.message=i:i.message&&(o.message=i.message),o.status=r,Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return ie(t,e),te(t,[{key:"codes",get:function(){return ae}}]),t}(Error),ce=!1,ue=function(){ce&&u(null,arguments)};$.EMP_DEBUG_LOG&&(ue=$.console&&$.console.log&&void 0||function(){});var pe=ue;if(pe.history=[],pe.error=function(){u("error",arguments)},pe.warn=function(){u("warn",arguments)},pe.debug=function(){u("debug",arguments)},$.EMP_DEBUG_LOG){var he=function(){};pe.debug=$.console&&$.console.debug&&void 0||he,pe.warn=$.WARN=$.console&&$.console.warn&&void 0||he,pe.error=$.ERROR=$.console&&$.console.error&&void 0||he}pe.setLogToBrowserConsole=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ce=e};var de,me=1,fe=function(e,t,i){t.guid||(t.guid=p());var n=function(){return t.apply(e,arguments)};return n.guid=i?i+"_"+t.guid:t.guid,n},ge=function(e,t){var i=Date.now();return function(){var n=Date.now();n-i>=t&&(e.apply(void 0,arguments),i=n)}},ye={},ve=(Object.freeze||Object)({default:ye}),Te=ve&&ye||ve,_e=void 0!==X?X:"undefined"!=typeof window?window:{};"undefined"!=typeof document?de=document:(de=_e["__GLOBAL_DOCUMENT_CACHE@4"])||(de=_e["__GLOBAL_DOCUMENT_CACHE@4"]=Te);var Ee=de,Se=Z.getComponent("MenuItem"),be=Z.getComponent("Component"),Ce=function(e){function t(i,n){ee(this,t);var r=n.bitrate;n.label=0===r?"auto":Math.max(0,Math.round(r/1e3))+"Kb/s",n.selected=i.bitrate()===r;var o=ne(this,e.call(this,i,n));return o.bitrate=r,o.player_.on(oe.BITRATE_CHANGED,function(e,t){o.el()&&o.selected(t.bitrate===o.bitrate)}),o}return ie(t,e),t.prototype.handleClick=function(e){this.player_.bitrate(this.bitrate)},t}(Se);be.registerComponent("BitrateMenuItem",Ce);var Ae=Z.getComponent("MenuButton"),we=Z.getComponent("Component"),Pe=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));r.el_.setAttribute("aria-label","Bitrate menu");r.player_.bitrates();r.items.length<=1&&r.hide();var o=fe(r,r.update);return r.player_.on(oe.LOADED_DATA,o),r.player_.on(oe.CHROMECAST_CASTING,o),r.player_.on(oe.ENDED,function(){return r.hide()}),r.player_.on(oe.PLAYING,function(){r.items.length>1&&r.show()}),r.player_.on(oe.DISPOSE,function(){this.player_.on(oe.LOADED_DATA,o)}),r}return ie(t,e),t.prototype.buildCSSClass=function(){return"vjs-bitrate-button "+e.prototype.buildCSSClass.call(this)},t.prototype.createItems=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.player_.bitrates();if(!t)return e;t.length>0&&e.push(new Ce(this.player_,{selectable:!0,bitrate:0}));for(var i=0;i<t.length;i++){var n=t[i];e.push(new Ce(this.player_,{selectable:!0,bitrate:n}))}return e},t}(Ae);Pe.prototype.controlText_="Bitrate",we.registerComponent("BitrateButton",Pe);var Ie=function(e){for(var t="",i=0;i<arguments.length;i++)t+=h(e[i])+(arguments[i+1]||"");return t},xe=function(e,t){return e.raw=t,e}(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]),ke={bitrates:function(e){return e.tech_&&void 0!==e.tech_.bitrates?e.techGet_("bitrates"):[]},bitrate:function(e,t){return e.tech_&&void 0!==e.tech_.bitrate?(void 0!==t&&e.techCall_("bitrate",t),e.techGet_("bitrate")):0},canRestart:function(e){return!e.tech_||void 0===e.tech_.canRestart||e.techGet_("canRestart")},restart:function(e,t){e.currentSource()&&(e.options_.startTime=0,e.options_.absoluteStartTime=void 0,e.previousAbsoluteStartTime=void 0,e.options_.autoplay||(e.options_.autoplay=!0,e.one("play",function(){e.options_.autoplay=!1})),e.trigger(oe.RESTARTING),e.options_.useLastViewedOffset=t,e.trigger(oe.REPLAY))},getSelectedAudioTrack:function(e){for(var t=e.audioTracks(),i=t.length;i--;){var n=t[i];if(n.enabled)return n.language}return null},getSelectedTextTrack:function(e){for(var t=e.textTracks(),i=t.length;i--;){var n=t[i];if("showing"===n.mode)return n.language}return null},loadAsset:function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o={assetId:t||n,programId:i,channelId:n};e.on(oe.LOADED_DATA,function(){r(e.entitlement)}),e.src({type:"video/emp",src:JSON.stringify(o)})},currentAsset:function(e,t,i,n){if(!t&&!i&&!n){var r=e.cache_.source;if(r&&r.src&&"video/emp"===r.type){return a(r.src)}return r&&r.assetId?{assetId:r.channelId?r.channelId:r.assetId,programId:r.programId,channelId:r.channelId}:null}if(pe("Update currentAsset",t,i,n),e.cache_.source&&"video/emp"===e.cache_.source.type)e.cache_.source.src=JSON.stringify({assetId:t,programId:i,channelId:n});else if(e.cache_.source&&e.cache_.source.assetId)e.cache_.source.assetId=t,e.cache_.source.programId=i,e.cache_.source.channelId=n;else{var o={assetId:t,programId:i,channelId:n};e.cache_.source={type:"video/emp",src:JSON.stringify(o)}}e.cache_.sources=[e.cache_.source]},getAbsoluteTime:function(e){if(!e.tech_||void 0===e.tech_.getAbsoluteTime)return new Date(1e3*e.currentTime());var t=this.getServerTime(e),i=e.tech_.getAbsoluteTime(t);if("EmpCast"!==e.techName_){var n=this.getEntitlement(e);i&&n&&n.isStaticCachupAsLive?i=new Date(i.getTime()+n.streamInfo.start.getTime()):n&&n.isDynamicCachupAsLive&&"EmpHLS"===e.techName_&&(i=new Date(1e3*e.tech_.baseCurrentTime()+n.streamInfo.start.getTime()))}return i},getPlayheadTime:function(e){var t=this.getAbsoluteTime(e);return t?t.getTime():0},timeBehindLive:function(e){if(!e.tech_||void 0===e.tech_.timeBehindLive)return 0;var t=0,i=this.getServerTime(e),n=this.getEntitlement(e);return t=n&&n.isStaticCachupAsLive?(i-this.getPlayheadTime(e))/1e3:e.tech_.timeBehindLive(i),t!==1/0&&t?Math.round(t):0},liveDelay:function(e){var t=0;return this.isLive(e)&&(t=e.tech_&&void 0!==e.tech_.liveDelay?e.tech_.liveDelay():(this.getServerTime(e)-this.getSeekTimerange(e).end)/1e3),Math.round(t)},stop:function(e,t){e.stopProgramService&&e.stopProgramService(),e.sourceChanging_=!1,e.cache_.sources=[],e.tech_&&void 0!==e.tech_.stop?(e.techCall_("stop",t),e.techCall_("stopTrackingCurrentTime")):(e.techCall_("stopTrackingCurrentTime"),t&&t())},timeShiftEnabled:function(e){return!e.tech_||void 0===e.tech_.timeShiftEnabled||e.techGet_("timeShiftEnabled")},baseCurrentTime:function(e){return e.tech_&&void 0!==e.tech_.baseCurrentTime?e.techGet_("baseCurrentTime"):e.currentTime()},baseDuration:function(e){return e.tech_&&void 0!==e.tech_.duration?e.techGet_("duration"):0},startTimeLive:function(e){if(!e.tech_||void 0===e.tech_.startTimeLive)return 0;var t=this.getServerTime(e),i=e.tech_.startTimeLive(t),n=this.getEntitlement(e);return n&&n.isDynamicCachupAsLive&&"EmpHLS"===e.techName_&&(i=n.streamInfo.referenceTime),n&&n.isStaticCachupAsLive&&"EmpCast"!==e.techName_&&(i=n.streamInfo.referenceTime),i},isLive:function(e){return!(!e.tech_||void 0===e.tech_.live)&&e.techGet_("live")},isCatchupAsLive:function(e){var t=this.getEntitlement(e);return!this.isLive(e)&&t&&t.live},getBitrate:function(e){return e.tech_&&void 0!==e.tech_.getBitrate?e.techGet_("getBitrate"):0},duration:function(e,t){return e.tech_&&void 0!==e.tech_.duration?(e.duration(t),e.techGet_("duration")):e.duration(t)},techVersion:function(e){return e.tech_&&void 0!==e.tech_.techVersion?e.techGet_("techVersion"):"2.x.x"},canSeekTo:function(e,t){if(!1===this.timeShiftEnabled(e)||!e.hasStarted())return!1;var i=this.getEntitlement(e);return!(i&&e.cache_&&!1===i.ffEnabled&&e.cache_.currentTime<=t)&&!(i&&e.cache_&&!1===i.rwEnabled&&e.cache_.currentTime>=t)},remainingTime:function(e){if(!e.tech_||void 0===e.tech_.remainingTime){var t=e.duration();return t===1/0||0===t?1/0:t-e.currentTime()}return e.techGet_("remainingTime")},casting:function(e,t){return!(!e.castPlugin||!e.castPlugin().canOverride("Cast"))&&(e.cache_.sources=t,e.cache_.source=t[0],e.castPlugin().cast(),!0)},setAbsoluteTime:function(e,t){if(!e.tech_||void 0===e.tech_.setAbsoluteTime){var i=(t.getTime()-new Date(0))/1e3;return void e.currentTime(i)}var n=this.getServerTime(e);if("EmpCast"!==e.techName_){var r=this.getEntitlement(e);if(r&&r.isStaticCachupAsLive){if(t.getTime()<r.streamInfo.start.getTime())pe("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),t=0;else{if(t.getTime()>=r.streamInfo.end.getTime())return pe("setAbsoluteTime","playNextProgram"),void this.playProgram(e,t);t=t.getTime()-r.streamInfo.start.getTime()}return void e.techCall_("setCurrentTime",t/1e3)}if(r&&r.isDynamicCachupAsLive)if(t.getTime()<r.streamInfo.start.getTime()){if(pe("setAbsoluteTime","playPreviousProgram"),this.playProgram(e,t),"EmpHLS"===e.techName_)return void e.techCall_("setCurrentTime",0);t=new Date(r.streamInfo.start.getTime())}else if("EmpHLS"===e.techName_)return t-=r.streamInfo.start.getTime(),void e.techCall_("setCurrentTime",t/1e3)}e.techCall_("setAbsoluteTime",{date:t,nowDate:n})},gotoLive:function(e){if(e.sourceChanging_)return void pe("gotoLive ignore sourceChanging");if(e.tech_.gotoLive)e.techCall_("gotoLive");else{var t=this.getEntitlement(e);if(t&&t.isDynamicCachupAsLive)this.setAbsoluteTime(e,new Date(e.getServerTime()));else if(t&&t.isStaticCachupAsLive){var i=this.currentAsset(e);i&&i.channelId&&e.startPlayback(null,i.channelId,null)}else if(this.isLive(e)){var n=e.duration();e.currentTime(n)}else pe.warn("Not suppoted for VOD")}},setPlayheadTime:function(e,t){this.setAbsoluteTime(e,new Date(t))},supportsEpgProgramChange:function(e){if(e.tech_&&void 0!==e.tech_.supportsEpgProgramChange)return e.techGet_("supportsEpgProgramChange")},program:function(e){return e.tech_&&void 0!==e.tech_.program?e.techGet_("program"):null},playPreviousProgram:function(e,t){if(e.sourceChanging_)return void pe("playPreviousProgram ignore sourceChanging");e.programService&&(e.sourceChanging_=!0,e.programService().getPreviousProgram(function(i,n){if(n)e.sourceChanging_=!1,pe.error("playPreviousProgram",n);else{var r={};if(t){r.playFrom="startTime";var o=new Date(i.endTime);o.setSeconds(o.getSeconds()-30),r.startTime=o}else r.playFrom="beginning";e.startPlayback(null,i.channelId,i.programId,r)}}))},playNextProgram:function(e){if(e.sourceChanging_)return void pe("playNextProgram ignore sourceChanging");e.programService&&e.programService().currentProgram&&this.getServerTime(e)>e.programService().currentProgram.end.getTime()&&(e.sourceChanging_=!0,e.programService().getNextProgram(function(t,i){if(i)e.sourceChanging_=!1,pe.error("playNextProgram",i);else{var n={};n.playFrom="beginning",e.startPlayback(null,t.channelId,t.programId,n)}}))},playProgram:function(e,t){if(e.sourceChanging_)return void pe("playProgram ignore sourceChanging");e.programService&&(e.sourceChanging_=!0,e.programService().getProgram(t,function(i,n){if(n)pe.error("getProgram",n);else{var r={};r.playFrom="startTime",r.startTime=t,e.startPlayback(null,i.channelId,i.programId,r)}}))},getServerTime:function(e){return e.programService&&e.programService()&&e.programService().exposure?e.programService().exposure.getCachedServerTime():Date.now()},getEntitlement:function(e){if(e.programService)return e.programService().entitlement();if(e.tech_){var t=e.tech_.options_;if(t&&t.source&&t.source.playSessionId)return t.source}return null},getSeekTimerange:function(e){var t={start:0,end:0};if(!e.tech_||void 0===e.tech_.seekable||e.seeking())return t;if(seekable=e.techGet_("seekable"),seekable&&seekable.length>0&&(t.start=1e3*(seekable.start(seekable.length-1)+this.startTimeLive(e)/1e3),t.end=1e3*(seekable.end(seekable.length-1)+this.startTimeLive(e)/1e3),"EmpCast"===e.techName_)){var i=this.liveDelay(e);t.end>this.getServerTime(e)-1e3*i&&(t.end=this.getServerTime(e)-1e3*i)}return t},getBufferedTimerange:function(e){var t={start:0,end:0};return!e.tech_||void 0===e.tech_.buffered||e.seeking()?t:(buffered=e.techGet_("buffered"),buffered&&buffered.length>0&&(t.start=1e3*(buffered.start(buffered.length-1)+this.startTimeLive(e)/1e3),t.end=1e3*(buffered.end(buffered.length-1)+this.startTimeLive(e)/1e3)),t)},setTechProgram:function(e,t){(e.tech_||void 0!==e.tech_.program)&&e.techCall_("program",t)}},Oe=Z.getComponent("Button"),De=Z.getComponent("Component"),Le=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.updateShowing(),r.on(r.player(),oe.PLAYING,function(){return r.updateShowing()}),r.on(r.player(),oe.DURATION_CHANGE,function(){return r.updateShowing()}),r.on(r.player(),oe.TIME_UPDATE,function(){return r.timeUpdate()}),r.on(r.player(),oe.ENDED,function(){return r.hide()}),r}return ie(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"emp-live-control vjs-control"});return this.contentEl_=f("div",{className:"emp-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.prototype.updateShowing=function(){this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive?this.show():this.hide()},t.prototype.timeUpdate=function(){var e=(this.player().currentTime(),this.player().duration(),this.player().timeBehindLive());this.player().isLive()&&e<20?this.addClass("emp-live-edge"):this.removeClass("emp-live-edge")},t.prototype.handleClick=function(){this.player().gotoLive()},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(Oe);De.registerComponent("EmpLiveDisplay",Le);var Ne=Z.getComponent("Component"),Re=Z.getComponent("MouseTimeDisplay"),Me=function(e){function t(i,n){return ee(this,t),ne(this,e.call(this,i,n))}return ie(t,e),t.prototype.update=function(e,t){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var n=i.player_.duration(),r=void 0;r=i.player().isLive()?"-"+E(n-t*n,n):E(t*n,n),i.el_.style.left=e.width*t+"px",i.getChild("timeTooltip").update(e,t,r)})},t}(Re);Ne.registerComponent("MouseTimeDisplay",Me);var Be=$.navigator&&$.navigator.userAgent||"",Ge=(/AppleWebKit\/([\d.]+)/i.exec(Be),/iPad/i.test(Be)),Ue=$.navigator.userAgent.indexOf("CrKey")>=0,Fe=/iPhone/i.test(Be)&&!Ge,He=/iPod/i.test(Be),je=Fe||Ge||He,Ve=(function(){var e=Be.match(/OS (\d+)_/i);e&&e[1]&&e[1]}(),/Android/i.test(Be)),We=function(){var e=Be.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),Ke=(Ve&&/webkit/i.test(Be),/Firefox/i.test(Be),/Edge/i.test(Be)),qe=!Ke&&/Chrome/i.test(Be),Ye=(function(){var e=Be.match(/Chrome\/(\d+)/);e&&e[1]&&parseFloat(e[1])}(),/MSIE\s8\.0/.test(Be),function(){var e=/MSIE\s(\d+)\.\d/.exec(Be),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Be)&&/rv:11.0/.test(Be)&&(t=11),t}()),ze=(/Safari/i.test(Be),function(){return Ee===$.document&&void 0!==Ee.createElement}()&&$.document.createElement("video").style,Z.getComponent("Component")),Xe=Z.getComponent("Slider"),$e=(Z.getComponent("LoadProgressBar"),Z.getComponent("PlayProgressBar"),Ue||$.EMP_DEBUG_CHROMECAST?1e3:30),Je=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.lastStep=0,r.update=ge(fe(r,r.update),$e),r.on(i,"timeupdate",r.update),r.on(i,"ended",r.handleEnded),r.updateInterval=null,r.on(i,["playing"],function(){r.updateInterval&&(r.clearInterval(r.updateInterval),r.updateInterval=null),Ue||$.EMP_DEBUG_CHROMECAST||(r.updateInterval=r.setInterval(function(){r.requestAnimationFrame(function(){r.update()})},$e))}),r.on(i,["ended","pause","waiting"],function(){r.updateInterval&&(r.clearInterval(r.updateInterval),r.updateInterval=null)}),r.on(i,["timeupdate","ended"],r.update),r}return ie(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.prototype.update_=function(e,t){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[E(e,i),E(i,i)],"{1} of {2}")),Ue||$.EMP_DEBUG_CHROMECAST||this.bar.update(y(this.el_),t)},t.prototype.update=function(t){var i=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),i),i},t.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.prototype.handleEnded=function(e){this.update_(this.player_.duration(),1)},t.prototype.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return e>=1?1:e},t.prototype.handleMouseDown=function(t){this.player_.scrubbing(!0),e.prototype.handleMouseDown.call(this,t)},t.prototype.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.throttleSetCurrentTime(t)},t.prototype.throttleSetCurrentTime=function(e){null!=this.seekTimeoutId_&&$.clearTimeout(this.seekTimeoutId_),this.seekTimeoutId_=$.setTimeout(this.onSeekInputTimeout_.bind(this,e),1e3)},t.prototype.onSeekInputTimeout_=function(e){this.lastStep=0,this.seekTimeoutId_=null,this.player_.currentTime(e)},t.prototype.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},t.prototype.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},t.prototype.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),this.player_.scrubbing(!1)},t.prototype.stepForward=function(){this.lastStep+=5,this.throttleSetCurrentTime(this.player_.currentTime()+this.lastStep)},t.prototype.stepBack=function(){this.lastStep-=5,this.throttleSetCurrentTime(this.player_.currentTime()+this.lastStep)},t.prototype.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},t.prototype.handleKeyPress=function(t){32===t.which||13===t.which?(t.preventDefault(),this.handleAction(t)):e.prototype.handleKeyPress&&e.prototype.handleKeyPress.call(this,t)},t}(Xe);Je.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},
Ye&&!(Ye>8)||je||Ve||Je.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Je.prototype.playerEvent="timeupdate",ze.registerComponent("SeekBar",Je);var Ze=Z.getComponent("Button"),Qe=Z.getComponent("Component"),et=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.shouldRestart_=!0,r.updateShowing(),r.on(r.player(),oe.LOADED_METADATA,r.updateShowing),r.on(r.player(),oe.PLAYING,function(){r.shouldRestart_=!1,r.updateShowing()}),r.on(r.player(),oe.ERROR,function(){return r.shouldRestart_=!0}),r}return ie(t,e),t.prototype.buildCSSClass=function(){return"emp-restart-control "+e.prototype.buildCSSClass.call(this)},t.prototype.updateShowing=function(){this.player().canRestart()?this.show():this.hide()},t.prototype.handleClick=function(){if(!0===this.shouldRestart_)return void this.player_.restart();this.player_.scrubbing(!0);var e=!this.player_.paused();this.player_.pause(),this.player_.currentTime(0),this.player_.scrubbing(!1),e&&b(this.player_.play())},t}(Ze);et.prototype.controlText_="Restart",Qe.registerComponent("EmpRestartButton",et);var tt=Z.getComponent("Button"),it=Z.getComponent("Component"),nt=function(e){function t(i,n){ee(this,t),n=Object.assign({seconds:30},n);var r=ne(this,e.call(this,i,n));return r.controlText("Forward "+n.seconds+"s"),i.on(oe.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),i.on(oe.PROGRAM_CHANGED,function(e,t){return r.updateEnabled(t&&t.program)}),i.on(oe.DURATION_CHANGE,function(){return r.updateEnabled()}),r.updateEnabled(),r}return ie(t,e),t.prototype.updateEnabled=function(e){this.entitlement&&!this.entitlement.ffEnabled?(this.disable(),this.controlText("Forward restricted")):(this.enable(),this.show(),this.controlText("Forward "+this.options_.seconds+"s"))},t.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.prototype.buildCSSClass=function(){return"emp-forward-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()+this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(tt);nt.prototype.controlText_="Forward",it.registerComponent("EmpForwardButton",nt);var rt=Z.getComponent("Button"),ot=Z.getComponent("Component"),st=function(e){function t(i,n){ee(this,t),n=Object.assign({seconds:30},n);var r=ne(this,e.call(this,i,n));return r.controlText("Rewind "+n.seconds+"s"),i.on(oe.TIMESHIFT_CHANGE,function(){return r.onTimeshift()}),i.on(oe.PROGRAM_CHANGED,function(e,t){return r.updateEnabled(t&&t.program)}),i.on(oe.DURATION_CHANGE,function(){return r.updateEnabled()}),r.updateEnabled(),r}return ie(t,e),t.prototype.updateEnabled=function(e){this.entitlement&&!this.entitlement.rwEnabled?(this.disable(),this.controlText("Rewind restricted")):(this.enable(),this.show(),this.controlText("Rewind "+this.options_.seconds+"s"))},t.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.prototype.buildCSSClass=function(){return"emp-rewind-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var e=this.player().currentTime()-this.options_.seconds;this.player().currentTime(e),this.player().scrubbing(!1)}},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(rt);st.prototype.controlText_="Rewind",ot.registerComponent("EmpRewindButton",st);var at=Z.getComponent("Button"),lt=Z.getComponent("Component"),ct=function(e){function t(i,n){return ee(this,t),ne(this,e.call(this,i,n))}return ie(t,e),t.prototype.buildCSSClass=function(){return"emp-reload-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){this.player_.restart()},t}(at);ct.prototype.controlText_="Reload",lt.registerComponent("EmpReloadButton",ct);var ut=(Z.getComponent("RemainingTimeDisplay"),Z.getComponent("Component")),pt=Ue||window.EMP_DEBUG_CHROMECAST?1e3:30,ht=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.mode_=n.mode||"remainingTime",r.throttledUpdateContent=ge(fe(r,r.updateContent),pt),r.on(i,oe.TIME_UPDATE,r.throttledUpdateContent),r.on(i,oe.DURATION_CHANGE,r.updateContent),i.on(oe.ENDED,function(){r.hide()}),i.on(oe.PLAYING,function(){r.show()}),r}return ie(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"emp-time vjs-time-control vjs-remaining-time vjs-control"});return this.contentEl_=f("div",{className:"emp-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span>0:00"},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},t.prototype.updateContent=function(){if("currentTime"===this.mode_){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),t=this.localize("Current Time"),i=E(e,this.player_.duration());i!==this.formattedTime_&&(this.formattedTime_=i,this.contentEl_.innerHTML='<span class="vjs-control-text">'+t+"</span>"+i)}else{var n=this.player_.duration();if(n){var r=this.localize("Remaining Time"),o=void 0;if(n>4294967295)(o="")!==this.formattedTime_&&(this.formattedTime_=o,this.contentEl_.innerHTML='<span class="vjs-control-text">'+r+"</span>"+o);else{var s=this.player_.remainingTime();s<0&&(s=0),o=E(s),o!==this.formattedTime_&&(this.formattedTime_=o,this.contentEl_.innerHTML='<span class="vjs-control-text">'+r+"</span>"+o)}}}},t}(ut);ut.registerComponent("EmpTimeDisplay",ht),ut.registerComponent("EmpTimeDisplay2",ht);var dt=Z.getComponent("Button"),mt=Z.getComponent("Component"),ft=function(e){function t(i,n,r){ee(this,t);var o=ne(this,e.call(this,i,n,r));return o.el_.setAttribute("aria-label","Stop Playback"),i.on(oe.TIMESHIFT_CHANGE,function(){return o.onTimeshift()}),i.on(oe.PLAYING,function(){return o.onTimeshift()}),i.on(oe.ENDED,function(){return o.hide()}),o}return ie(t,e),t.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.hide():this.show())},t.prototype.handleClick=function(e){this.player()&&this.player().stop()},t.prototype.buildCSSClass=function(){return"emp-stop-control vjs-icon-square "+e.prototype.buildCSSClass.call(this)},t}(dt);ft.prototype.kind_="stop",ft.prototype.controlText_="stop",mt.registerComponent("EmpStopButton",ft);var gt=Z.getComponent("PlayToggle"),yt=Z.getComponent("Component"),vt=function(e){function t(i,n,r){ee(this,t);var o=ne(this,e.call(this,i,n,r));return o.el_.setAttribute("aria-label","Play Toggle"),i.on(oe.TIMESHIFT_CHANGE,function(){return o.onTimeshift()}),i.on(oe.PLAYING,function(){return o.onTimeshift()}),o}return ie(t,e),t.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},t.prototype.handleClick=function(t){e.prototype.handleClick.call(this,t)},t.prototype.buildCSSClass=function(){return""+e.prototype.buildCSSClass.call(this)},t}(gt);vt.prototype.kind_="playToggle",vt.prototype.controlText_="playToggle",yt.registerComponent("EmpPlayToggle",vt);var Tt=(Z.getComponent("Component"),Z.getComponent("Button")),_t=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.addClass("vjs-hidden"),i.ready(function(){r.initAirPlay()}),r}return ie(t,e),t.prototype.initAirPlay=function(){var e=this.player();if(window.WebKitPlaybackTargetAvailabilityEvent){e.el().getElementsByTagName("video")[0].addEventListener("webkitplaybacktargetavailabilitychanged",function(t){switch(t.availability){case"available":pe("Airplay available"),e.on("loadeddata",function(){e.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")&&(this.entitlement&&this.entitlement.airplayBlocked?e.controlBar.airplayToggle.hide():e.controlBar.airplayToggle.show())});break;case"not-available":pe("Airplay not-available")}})}},t.prototype.buildCSSClass=function(){return"vjs-airplay-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){this.entitlement&&this.entitlement.airplayBlocked?pe("Airplay Blocked"):(this.player().el().getElementsByTagName("video")[0].webkitShowPlaybackTargetPicker(),this.player().trigger(oe.AIRPLAY_START))},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(Tt);_t.prototype.controlText_="Airplay",Z.registerComponent("AirplayToggle",_t);var Et=Z.getComponent("Button"),St=Z.getComponent("Component"),bt=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.controlText("Next program"),r.updateShowing(),r.on(r.player(),oe.PLAYING,function(){return r.updateShowing()}),r.on(r.player(),oe.DURATION_CHANGE,function(){return r.updateShowing()}),r.on(r.player(),oe.PROGRAM_CHANGED,function(e,t){return r.updateShowing(t&&t.program)}),r}return ie(t,e),t.prototype.updateShowing=function(e){e=e||this.player().getProgramDetails(),!this.player().noEPG()&&this.entitlement&&e?(this.show(),this.enable()):this.hide(),e&&Date.now()<e.end.getTime()&&this.disable(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.prototype.buildCSSClass=function(){return"emp-next-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){this.player().ended()||this.player().playNextProgram()},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(Et);bt.prototype.controlText_="Next",St.registerComponent("EmpNextButton",bt);var Ct=Z.getComponent("Button"),At=Z.getComponent("Component"),wt=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return r.controlText("Previous Program"),r.updateShowing(),r.on(r.player(),oe.PLAYING,function(){return r.updateShowing()}),r.on(r.player(),oe.DURATION_CHANGE,function(){return r.updateShowing()}),r.on(r.player(),oe.PROGRAM_CHANGED,function(){return r.updateShowing()}),r}return ie(t,e),t.prototype.updateShowing=function(){var e=this.player().getProgramDetails();!this.player().noEPG()&&this.entitlement&&e?this.show():this.hide(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},t.prototype.buildCSSClass=function(){return"emp-previous-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){this.player().ended()||this.player().playPreviousProgram()},te(t,[{key:"entitlement",get:function(){return ke.getEntitlement(this.player())}}]),t}(Ct);wt.prototype.controlText_="Previous",At.registerComponent("EmpPreviousButton",wt);var Pt=Z.getComponent("ControlBar"),It=Z.getComponent("Component"),xt=function(e){function t(){return ee(this,t),ne(this,e.apply(this,arguments))}return ie(t,e),t}(Pt);xt.prototype.options_={loadEvent:"play",children:{empPlayToggle:{},empReloadButton:{},empStopButton:{},empPreviousButton:{},empRewindButton:{},empForwardButton:{},empNextButton:{},volumePanel:{inline:!1},empTimeDisplay:{mode:"currentTime"},timeDivider:{},durationDisplay:{},empLiveDisplay:{},progressControl:{},empTimeDisplay2:{mode:"remainingTime"},customControlSpacer:{},empRestartButton:{},playbackRateMenuButton:{},chaptersButton:{},bitrateButton:{},audioTrackButton:{},subsCapsButton:{},airplayToggle:{},fullscreenToggle:{}}},It.registerComponent("ControlBar",xt);var kt=Z.getComponent("Component"),Ot={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},Dt=function(e){function t(i,n,r){ee(this,t);var o=ne(this,e.call(this,i,n,r));return i.on("loadstart",fe(o,o.toggleDisplay)),i.on("texttrackchange",fe(o,o.updateDisplay)),i.on("loadstart",fe(o,o.preselectTrack)),i.ready(fe(o,function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)return void this.hide();if("EmpShaka"===i.techName_||"EmpHLS"===i.techName_||"EmpCast"===i.techName_)return void this.hide();i.on("fullscreenchange",fe(this,this.updateDisplay));for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()})),o}return ie(t,e),t.prototype.preselectTrack=function(){for(var e={captions:1,subtitles:1},t=this.player_.textTracks(),i=this.player_.cache_.selectedLanguage,n=void 0,r=void 0,o=void 0,s=0;s<t.length;s++){var a=t[s];i&&i.enabled&&i.language===a.language?a.kind===i.kind?o=a:o||(o=a):i&&!i.enabled?(o=null,n=null,r=null):a.default&&("descriptions"!==a.kind||n?a.kind in e&&!r&&(r=a):n=a)}o?o.mode="showing":r?r.mode="showing":n&&(n.mode="showing")},t.prototype.toggleDisplay=function(){if("EmpShaka"===this.player_.techName_||"EmpHLS"===this.player_.techName_||"EmpCast"===this.player_.techName_)return void this.hide();this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.prototype.clearDisplay=function(){"function"==typeof $.WebVTT&&$.WebVTT.processCues($,[],this.el_)},t.prototype.removeStyles=function(e){var t=Ee.getElementById(e);return t&&Ee.getElementsByTagName("head")[0].removeChild(t),t},t.prototype.writeStyles=function(e,t){var i=this.removeStyles(e);i=Ee.createElement("style"),i.type="text/css",i.id=e,i.innerHTML=t,Ee.getElementsByTagName("head")[0].appendChild(i)},t.prototype.getStyle=function(e){var t=void 0,i=void 0,n=void 0,r=void 0,o=void 0,s=void 0,a=void 0,l=void 0,c=void 0,u=void 0;return e.color&&(t="color: "+e.color),e.textOpacity&&(t="color: "+I(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(i="background-color: "+e.backgroundColor),e.backgroundOpacity&&(i="background-color: "+I(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(u=e.windowOpacity?"outline: "+I(e.windowColor,e.windowOpacity)+" solid 10px":"outline: "+e.windowColor+" solid 10px"),e.edgeStyle&&("dropshadow"===e.edgeStyle?n="text-shadow: 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, black 0.1em 0.1em 0.2em":"raised"===e.edgeStyle?n="text-shadow: 1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===e.edgeStyle?n="text-shadow: 1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===e.edgeStyle&&(n="text-shadow: 0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),e.fontPercent&&1!==e.fontPercent&&(r="font-size: "+e.fontPercent+"em",o="height: auto",s="top: auto",a="bottom: 2px"),e.fontFamily&&"default"!==e.fontFamily&&("small-caps"===e.fontFamily?l="font-variant: small-caps":c="font-family: "+Ot[e.fontFamily]),(t?t+"; ":"")+(i?i+"; ":"")+(n?n+"; ":"")+(r?r+"; ":"")+(o?o+"; ":"")+(s?s+"; ":"")+(a?a+"; ":"")+(l?l+"; ":"")+(c?c+"; ":"")+(u?u+"; ":"")},t.prototype.getSafariStyle=function(e){var t=void 0;return e.backgroundColor&&(t="background-color: "+e.backgroundColor),e.backgroundOpacity&&(t="background-color: "+I(e.backgroundColor||"#000",e.backgroundOpacity)),t?"video::-webkit-media-text-track-display-backdrop {"+t+" !important;overflow: visible !important;}":""},t.prototype.updateDisplay=function(){if(this.player_.textTrackSettings){var e=void 0;e=this.player_.options_.textTrackStyle?this.player_.options_.textTrackStyle:this.player_.textTrackSettings.getValues();if("EmpShaka"===this.player_.techName_||"EmpHLS"===this.player_.techName_||"EmpCast"===this.player_.techName_){var t=this.getStyle(e);return"EmpHLS"===this.player_.techName_?this.writeStyles("styles_cue","video::cue {"+t+"}\n"+this.getSafariStyle(e)):this.writeStyles("styles_cue","video::cue {"+t+"}"),void this.clearDisplay()}this.removeStyles("styles_cue")}var i=this.player_.textTracks();this.clearDisplay();for(var n=null,r=null,o=i.length;o--;){var s=i[o];"showing"===s.mode&&("descriptions"===s.kind?n=s:r=s)}r?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):n&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(n))},t.prototype.updateForTrack=function(e){if("function"==typeof $.WebVTT&&e.activeCues){var t=void 0;this.player_.textTrackSettings&&(t=this.player_.textTrackSettings.getValues());for(var i=[],n=0;n<e.activeCues.length;n++)i.push(e.activeCues[n]);if($.WebVTT.processCues($,i,this.el_),!t)for(var r=i.length;r--;){var o=i[r];if(o){var s=o.displayState;if(t.color&&(s.firstChild.style.color=t.color),t.textOpacity&&x(s.firstChild,"color",I(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(s.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&x(s.firstChild,"backgroundColor",I(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?x(s,"backgroundColor",I(t.windowColor,t.windowOpacity)):s.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?s.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===t.edgeStyle?s.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===t.edgeStyle?s.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===t.edgeStyle&&(s.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),t.fontPercent&&1!==t.fontPercent){var a=$.parseFloat(s.style.fontSize);s.style.fontSize=a*t.fontPercent+"px",s.style.height="auto",s.style.top="auto",s.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?s.firstChild.style.fontVariant="small-caps":s.firstChild.style.fontFamily=Ot[t.fontFamily])}}}},t}(kt);kt.registerComponent("TextTrackDisplay",Dt);var Lt=Z.getComponent("Component"),Nt=Z.getComponent("ModalDialog"),Rt=["#000","Black"],Mt=["#00F","Blue"],Bt=["#0FF","Cyan"],Gt=["#0F0","Green"],Ut=["#F0F","Magenta"],Ft=["#F00","Red"],Ht=["#FFF","White"],jt=["#FF0","Yellow"],Vt=["1","Opaque"],Wt=["0.5","Semi-Transparent"],Kt=["0","Transparent"],qt={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Rt,Ht,Ft,Gt,Mt,jt,Ut,Bt]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Kt,Wt,Vt]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Ht,Rt,Ft,Gt,Mt,jt,Ut,Bt]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]],default:4},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.25","25%"],["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["2.50","250%"]],default:3,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Vt,Wt]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Kt,Wt,Vt]}};qt.windowColor.options=qt.backgroundColor.options;var Yt=function(e){function t(i,r){ee(this,t),r.temporary=!1;var o=ne(this,e.call(this,i,r));return o.updateDisplay=fe(o,o.updateDisplay),o.fill(),o.hasBeenOpened_=o.hasBeenFilled_=!0,o.endDialog=f("p",{className:"vjs-control-text",textContent:o.localize("End of dialog window.")}),o.el().appendChild(o.endDialog),o.setDefaults(),void 0===r.persistTextTrackSettings&&(o.options_.persistTextTrackSettings=o.options_.playerOptions.persistTextTrackSettings),o.on(o.$(".vjs-done-button"),"click",function(){o.saveSettings(),o.close()}),o.on(o.$(".vjs-default-button"),"click",function(){o.setDefaults(),o.updateDisplay()}),n(qt,function(e){o.on(o.$(e.selector),"change",o.updateDisplay)}),o.options_.persistTextTrackSettings&&o.restoreSettings(),o}return ie(t,e),t.prototype.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},t.prototype.createElSelect_=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",r=qt[e],o=r.id.replace("%s",this.id_);return["<"+n+' id="'+o+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(r.label),"</"+n+">",'<select aria-labelledby="'+(""!==i?i+" ":"")+o+'">'].concat(r.options.map(function(e){var n=o+"-"+e[1];return['<option id="'+n+'" value="'+e[0]+'" ','aria-labelledby="'+(""!==i?i+" ":"")+o+" "+n+'">',t.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.prototype.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.prototype.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.prototype.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.prototype.createElColors_=function(){return f("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.prototype.createElFont_=function(){return f("div",{className:'vjs-track-settings-font">',innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.prototype.createElControls_=function(){var e=this.localize("restore all settings to the default values");return f("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.prototype.label=function(){return this.localize("Caption Settings Dialog")},t.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.prototype.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.prototype.getValues=function(){var e=this;return r(qt,function(t,i,n){var r=O(e.$(i.selector),i.parser);return void 0!==r&&(t[n]=r),t},{})},t.prototype.setValues=function(e){var t=this;n(qt,function(i,n){D(t.$(i.selector),e[n],i.parser)})},t.prototype.setDefaults=function(){var e=this;n(qt,function(t){var i=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=i})},t.prototype.restoreSettings=function(){var e=void 0;try{e=JSON.parse($.localStorage.getItem("vjs-text-track-settings"))}catch(e){pe.warn(e)}e&&this.setValues(e)},t.prototype.saveSettings=function(){var e=this.getValues();if(this.player_.options_.textTrackStyle=void 0,"EmpCast"===this.player_.techName_&&this.player_.techCall_("sendTextTrackStyle",e),this.options_.persistTextTrackSettings)try{Object.keys(e).length?$.localStorage.setItem("vjs-text-track-settings",JSON.stringify(e)):$.localStorage.removeItem("vjs-text-track-settings")}catch(e){pe.warn(e)}},t.prototype.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(Ee,"keydown",this.handleKeyDown);var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},t}(Nt);Lt.registerComponent("TextTrackSettings",Yt);var zt=Z.getComponent("Player"),Xt=Z.getComponent("Tech"),$t=Z.getComponent("CaptionSettingsMenuItem"),Jt=function(e){function t(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};ee(this,t),n.startTime=n.absoluteStartTime?0:n.startTime,n=Object.assign({children:["mediaLoader","PosterImage","textTrackDisplay","loadingSpinner","controlBar","errorDisplay","textTrackSettings","BigPlayButton"]},n),("auto"===n.techOrder||Array.isArray(n.techOrder)&&1===n.techOrder.length&&"auto"===n.techOrder[0])&&(n.techOrder=t.AutoTechArray()),n=Z.mergeOptions({"entitlement-engine":"EricssonExposure",techOrder:t.AutoTechArray(),maxBitrate:0,timeShiftDisabled:!1,useLastViewedOffset:!1,startTime:0,absoluteStartTime:void 0,persistTextTrackSettings:!0,textTrackSettings:!0},n);var o=ne(this,e.call(this,i,n,r));return o.monkeyPatchingTextMenu_(),$.empPlayer&&pe.islogToBrowserConsole&&$.empPlayer.setInstance(o),o.previousAbsoluteStartTime_=void 0,o.castPlugin&&o.castPlugin(),o.on(oe.ENDED,function(){pe("ENDED"),o.ended_=!0,o.sourceChanging_=!1,o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop(),"EmpCast"!==o.techName_&&o.loadNextSource()}),o.on(oe.DISPOSE,function(){o.sourceChanging_=!1,o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop()}),o.on(oe.ERROR,function(){o.sourceChanging_=!1,o.stopProgramService(),o.entitlementExpirationService&&o.entitlementExpirationService().stop()}),o.on(oe.CAN_PLAY,function(){o.disableTimeShift(o.options_.timeShiftDisabled)}),o.on(oe.LOADED_DATA,function(){if(o.addClass("vjs-has-started"),o.ended_=!1,o.programService){var e=o.programService().entitlement();e&&(e.streamInfo.referenceTime=o.startTimeLive())}}),o.on(oe.REPLAY,function(){o.cache_&&o.cache_.source&&o.src(o.cache_.source)}),o.on(oe.FIRST_PLAY,function(){pe("FIRST_PLAY"),o.options_.startTime&&"Html5"===o.techName_&&o.currentTime(o.options_.startTime),o.options_.startTime=0}),o.initialSeekToAbsoluteStartTimeBind=o.initialSeekToAbsoluteStartTime_.bind(o),o.isCreated=!0,o.trigger(oe.PLAYER_CREATED),o.ended_=!1,o.sourceChanging_=!1,o}return ie(t,e),t.prototype.monkeyPatchingTextMenu_=function(){if(this.controlBar&&this.controlBar.subsCapsButton){var e=this.controlBar.subsCapsButton.createItems,t=this;this.controlBar.subsCapsButton.createItems=function(){var i=e.apply(this,arguments);return i&&"CaptionSettingsMenuItem"!==i[0].name()&&"EmpHLS"===t.techName_&&t.options_.textTrackSettings&&(i.unshift(new $t(this.player_,{kind:this.label_})),this.hideThreshold_+=1),i}}return null},t.prototype.options=function(e){return e?(("auto"===e.techOrder||Array.isArray(e.techOrder)&&1===e.techOrder.length&&"auto"===e.techOrder[0])&&(e.techOrder=t.AutoTechArray()),void 0!==e.startTime&&(e.startTime=parseFloat(e.startTime)||0),void 0!==e.absoluteStartTime&&(e.startTime=0),this.options_=Z.mergeOptions(this.options_,e),this.options_):this.options_},t.prototype.getTechOptions_=function(){return{autoplay:this.options_.autoplay,muted:this.options_.muted,language:this.options_.language,maxBitrate:this.options_.maxBitrate,timeShiftDisabled:this.options_.timeShiftDisabled,useLastViewedOffset:this.options_.useLastViewedOffset,startTime:this.options_.startTime,absoluteStartTime:this.options_.absoluteStartTime,audioLanguage:this.options_.audioLanguage,subtitleLanguage:this.options_.subtitleLanguage,liveDelay:this.options_.liveDelay}},t.prototype.loadTech_=function(t,i){var n=this;e.prototype.loadTech_.call(this,t,i),this.on(this.tech_,oe.RECOVERABLE_ASSET_ERROR,this.handleRecoverableError),this.on(this.tech_,oe.ERROR,function(e,t){n.player_.error(t)}),this.on(this.tech_,oe.TRACK_CHANGE,function(){pe("TRACK_CHANGE"),n.player_.trigger(oe.TRACK_CHANGE)}),this.on(this.tech_,oe.DURATION_CHANGE,function(){n.player_.trigger(oe.DURATION_CHANGE)})},t.prototype.loadNextSource=function(){return this.sourceChanging_?void pe("loadNextSource ignore sourceChanging"):(this.sourceChanging_=!0,this.tech_&&void 0!==this.tech_.loadNextSource?(this.techCall_("loadNextSource"),!0):this.cache_.sources&&this.cache_.sources.length>1?(this.cache_.sources.shift(),this.src(this.cache_.sources),!0):(this.sourceChanging_=!1,!1))},t.prototype.setTextTrackStyle=function(e){"EmpCast"===this.techName_?this.techCall_("sendTextTrackStyle",e):(this.options_.textTrackStyle=e,this.trigger("texttrackchange"))},t.prototype.lineUpAsset=function(e,t,i,n){var r={assetId:e,programId:i,channelId:t};n&&this.options({playFrom:"beginning",absoluteStartTime:n}),this.lineupSource({type:"video/emp",src:JSON.stringify(r)})},t.prototype.lineupSource=function(e){if(this.tech_&&void 0!==this.tech_.lineupSource)return void this.techCall_("lineupSource",e);this.cache_.sources.push(e)},t.prototype.unloadTech_=function(){e.prototype.unloadTech_.call(this)},t.prototype.stop=function(e){ke.stop(this,e)},t.prototype.handleRecoverableError=function(t,i){if(i.source&&(6001!==i.code&&(pe.error("handleRecoverableError",i.techName,i.message),this.analytics&&this.analytics().onError({code:i.code,message:i.message})),this.options_.excludeTechs||(this.options_.excludeTechs=[]),this.options_.excludeTechs.push(i.techName),this.options_.techOrder.length>this.options_.excludeTechs.length)){if(this.error(null),this.resetWithoutReload_(),this.options_.autoplay=this.options_.autoplay,this.hasStarted()&&(this.options_.autoplay=!0),this.options_.absoluteStartTime=this.previousAbsoluteStartTime_,i.source.channelId){var n={channelId:i.source.channelId,programId:i.source.programId};return void e.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(n)})}if(i.source.assetId){var r={assetId:i.source.assetId};return void e.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(r)})}}i.message=i.message||this.localize("Unknown error, can't recover"),this.error(new le(i.message,i.code)),this.resetWithoutReload_()},t.prototype.resetWithoutReload_=function(){this.tech_&&(this.techCall_("reset"),this.unloadTech_())},t.prototype.bitrates=function(){return ke.bitrates(this)},t.prototype.bitrate=function(e){return ke.bitrate(this,e)},t.prototype.getBitrate=function(){return ke.getBitrate(this)},t.prototype.selectAudioTrack=function(e,t){for(var i=this.audioTracks(),n=i.length;n--;){var r=i[n]
;if(r.language===e&&!r.enabled)return void(t&&r.kind!==t||(r.enabled=!0))}},t.prototype.getSelectedAudioTrack=function(){return ke.getSelectedAudioTrack(this)},t.prototype.getAudioTracksLanguages=function(){for(var e=[],t=this.audioTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},t.prototype.selectTextTrack=function(e,t){e=e&&"None"!==e?e:null;for(var i=this.textTracks(),n=i.length;n--;){var r=i[n];r.language===e?t&&r.kind!==t||(r.mode="showing"):"disabled"!==r.mode&&(r.mode="disabled")}},t.prototype.getSelectedTextTrack=function(){return ke.getSelectedTextTrack(this)},t.prototype.textTrackVisible=function(e){for(var t=this.textTracks(),i=t.length;i--;){var n=t[i];if(e){if("hidden"===n.mode)return void(n.mode="showing")}else"showing"===n.mode?n.mode="hidden":"disabled"!==n.mode&&(n.mode="disabled")}},t.prototype.isTextTrackVisible=function(){for(var e=this.textTracks(),t=e.length;t--;){if("showing"===e[t].mode)return!0}return!1},t.prototype.getTextTracksLanguages=function(){for(var e=[],t=this.textTracks(),i=0;i<t.length;i++)e.push(t[i].language);return e},t.prototype.canSeekTo=function(e){return ke.canSeekTo(this,e)},t.prototype.getRestrictions=function(){var e={},t=ke.getEntitlement(this);return t&&(e={minBitrate:t.minBitrate,maxBitrate:t.maxBitrate,maxResWidth:t.maxResWidth,maxResHeight:t.maxResHeight,rwEnabled:t.rwEnabled,ffEnabled:t.ffEnabled}),e},t.prototype.isPlaying=function(){return this.hasStarted()},t.prototype.isLive=function(){return ke.isLive(this)},t.prototype.techVersion=function(){return ke.techVersion(this)},t.prototype.baseCurrentTime=function(){return ke.baseCurrentTime(this)},t.prototype.baseDuration=function(t){if(void 0===t)return ke.baseDuration(this);e.prototype.duration.call(this,t)},t.prototype.src=function(t){var i=this;if(void 0===t)return this.cache_.src||"";if(!this.isCreated)return void this.one(oe.PLAYER_CREATED,function(){i.src(t)});var n=l(t);return n.length?(n[0].type||(n[0].type="video/emp"),this.options_.excludeTechs=[],this.tech_||this.reset(),this.cache_.currentTime=0,this.error(null),"video/emp"!==n[0].type&&this.stopProgramService(),this.isPlaying()&&(this.sourceChanging_=!0),ke.casting(this,n)?void 0:(n[0].options&&this.options(n[0].options),"video/emp"!==n[0].type&&(n[0].options=this.getTechOptions_()),this.off(oe.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),this.one(oe.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),e.prototype.src.call(this,n))):void this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},t.prototype.initialSeekToAbsoluteStartTime_=function(){var e=ke.getEntitlement(this);this.options_.absoluteStartTime&&this.timeShiftEnabled()?(this.setAbsoluteTime(new Date(this.options_.absoluteStartTime)),this.previousAbsoluteStartTime_=this.options_.absoluteStartTime,this.options_.absoluteStartTime=void 0):this.options_.useLastViewedOffset&&e&&!this.isLive()&&"EmpShaka"===this.techName_&&e.lastViewedOffset&&this.currentTime(e.lastViewedOffset/1e3)},t.prototype.setMaxBitrate=function(e){this.options_.maxBitrate=e,this.tech_&&void 0!==this.tech_.setMaxBitrate&&this.techCall_("setMaxBitrate",e)},t.prototype.getMaxBitrate=function(){return this.tech_&&void 0!==this.tech_.getMaxBitrate?this.techGet_("getMaxBitrate"):0},t.prototype.disableTimeShift=function(e){if(!this.tech_||void 0===this.tech_.disableTimeShift)return!1;if(void 0!==e){if(!1===e&&!this.canEnableTimeshift())return!ke.timeShiftEnabled(this);this.techCall_("disableTimeShift",e);var t=ke.timeShiftEnabled(this);return this.options_.timeShiftDisabled=void 0===t?e:!t,this.trigger(oe.TIMESHIFT_CHANGE,{timeShiftDisabled:this.options_.timeShiftDisabled}),this.options_.timeShiftDisabled}return!ke.timeShiftEnabled(this)},t.prototype.canEnableTimeshift=function(){var e=ke.getEntitlement(this);return!e||!1!==e.timeshiftEnabled},t.prototype.timeShiftEnabled=function(e){if(void 0===e)return ke.timeShiftEnabled(this);this.disableTimeShift(!e)},t.prototype.noEPG=function(){if(!this.getProgramDetails()){var e=ke.getEntitlement(this);return!e||e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)}return!1},t.prototype.canRestart=function(){return!this.noEPG()&&ke.canRestart(this)},t.prototype.restart=function(e){ke.restart(this,e)},t.prototype.error=function(t){return void 0===t?this.error_||null:(t&&s(t)?t=new le(t):t&&!t.code&&(t.code=ae.UNKNOWN),t&&this.cache_.sources&&this.cache_.sources.length>1?(pe.error(t),this.loadNextSource(),t):e.prototype.error.call(this,t))},t.prototype.getError=function(){return this.error_},t.prototype.setAbsoluteTime=function(e){ke.setAbsoluteTime(this,e)},t.prototype.getAbsoluteTime=function(){return ke.getAbsoluteTime(this)},t.prototype.playheadTime=function(e){if(void 0===e)return ke.getPlayheadTime(this);ke.setPlayheadTime(this,e)},t.prototype.setAnalyticsCustomAttribute=function(e,t){this.options_.analytics||(this.options_.analytics={}),this.options_.analytics.customAttributes||(this.options_.analytics.customAttributes=[]),this.options_.analytics.customAttributes.push({key:e,value:t})},t.prototype.loadAsset=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};pe.warn("loadAsset() has been deprecated with new USP a/v pipe use startPlayback() or src() instead"),this.options({playFrom:void 0}),ke.loadAsset(this,e,t,null,i)},t.prototype.startPlayback=function(e,t,i,n){if(n||(n={}),!e&&!t)return void pe.error("assetId or channelId is undefined");if(i&&!t)return void pe.error("channelId is undefined");n.playFrom||(n.playFrom="defaultBehaviour");var r={playFrom:n.playFrom};void 0!==n.autoplay&&(r.autoplay=n.autoplay),n.startTime&&"startTime"===n.playFrom?(r.absoluteStartTime=n.startTime,this.options_.useLastViewedOffset=!1):r.absoluteStartTime=void 0,void 0!==n.startOffset?r.startTime=n.startOffset/1e3:r.startTime=0,r.useLastViewedOffset="bookmark"===n.playFrom||!0===this.options_.useLastViewedOffset,this.options(r),ke.loadAsset(this,e,i,t)},t.prototype.playEntitlement=function(t){t&&o(t)?(t.type="video/emp",e.prototype.src.call(this,t)):pe.error("Call playEntitlement without entitlement")},t.prototype.timeBehindLive=function(){return ke.timeBehindLive(this)},t.prototype.liveDelay=function(){return ke.liveDelay(this)},t.prototype.startTimeLive=function(){return ke.startTimeLive(this)},t.prototype.getCurrentTechName=function(){return this.techName_},t.prototype.stopProgramService=function(){this.programService&&this.programService().reset()},t.prototype.startProgramService=function(){this.programService&&this.programService().start()},t.prototype.supportsEpgProgramChange=function(){return void 0!==this.programService},t.prototype.getServerTime=function(){return ke.getServerTime(this)},t.prototype.getProgram=function(e){if(this.programService){var t=this.getProgramDetails();e(t,t?null:"No EPG for program")}},t.prototype.getProgramDetails=function(){return ke.supportsEpgProgramChange(this)?ke.program(this):this.programService?this.programService().currentProgram:void 0},t.prototype.getAssetDetails=function(){return this.tech_&&this.tech_.VOD?this.techGet_("VOD"):this.programService?this.programService().currentVOD:void 0},t.prototype.getSeekTimerange=function(){return ke.getSeekTimerange(this)},t.prototype.getBufferedTimerange=function(){return ke.getBufferedTimerange(this)},t.prototype.currentTime=function(e){var t=ke.getEntitlement(this);if(t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==e){var i=this.getProgramDetails();if(i){e<1&&e>-1&&(e=1);var n=new Date(i.startTime);if(t.isStaticCachupAsLive||"EmpHLS"===this.techName_){var r=t.streamInfo;e+=(n.getTime()-r.start.getTime())/1e3,e<=0&&(e=0,ke.playPreviousProgram(this,!0))}else 1e3*(e+=n.getTime()/1e3)<=t.streamInfo.start.getTime()&&(e=t.streamInfo.start.getTime()/1e3+1,ke.playPreviousProgram(this,!0))}return e<0&&(e=0),void this.techCall_("setCurrentTime",e)}var o=this.techGet_("currentTime")||0,s=this.getProgramDetails();if(s&&o>1){var a=new Date(s.startTime);if(t.isStaticCachupAsLive||"EmpHLS"===this.techName_){var l=t.streamInfo;o-=(a.getTime()-l.start.getTime())/1e3}else o-=a.getTime()/1e3}else s||this.duration(1/0);return this.cache_.currentTime=o,this.cache_.currentTime}return void 0!==e?void this.techCall_("setCurrentTime",e):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},t.prototype.duration=function(t){var i=ke.getEntitlement(this);if(i&&(i.isDynamicCachupAsLive||i.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==t){var n=this.getProgramDetails();if(n&&t!==1/0){var r=new Date(n.startTime);if(i.isStaticCachupAsLive||"EmpHLS"===this.techName_){var o=i.streamInfo;t-=(r.getTime()-o.start.getTime())/1e3}else t-=r.getTime()/1e3}return this.noEPG()&&(t=1/0,this.addClass("vjs-live")),void e.prototype.duration.call(this,t)}var s=this.techGet_("duration"),a=this.getProgramDetails();return a&&s!==1/0&&(s=a.duration/1e3),this.noEPG()&&(s=1/0,this.addClass("vjs-live")),this.cache_.duration=s,s}return e.prototype.duration.call(this,t),this.techGet_("duration")},t.prototype.seekable=function(){var t=e.prototype.seekable.call(this);return"EmpCast"!==this.techName_?this.getRange_(t):t},t.prototype.buffered=function(){var t=e.prototype.buffered.call(this);return"EmpCast"!==this.techName_?this.getRange_(t):t},t.prototype.getRange_=function(e){var t=ke.getEntitlement(this);if(this.seeking()||!e)return C(0,0);if(e.length>0&&t&&(t.isDynamicCachupAsLive||t.isStaticCachupAsLive)){var i=this.getProgramDetails();if(i){var n=new Date(i.startTime),r=t.streamInfo,o=e.start(e.length-1),s=e.end(e.length-1);if(s)if(t.isStaticCachupAsLive||"EmpHLS"===this.techName_)o-=(n.getTime()-r.start.getTime())/1e3,s-=(n.getTime()-r.start.getTime())/1e3,e=C(o>0?o:0,s>this.duration()?this.duration():s);else if(t.isDynamicCachupAsLive){o-=n.getTime()/1e3,s-=n.getTime()/1e3;var a=this.getGrowingLiveDuration();e=C(o>0?o:0,s>a?a:s)}}}return e},t.prototype.getGrowingLiveDuration=function(){var e=ke.getEntitlement(this),t=this.duration(),i=this.getProgramDetails();if(i&&t!==1/0&&e&&e.isDynamicCachupAsLive){if(this.getServerTime()<new Date(i.endTime).getTime()){if((t=this.techGet_("duration"))!==1/0){var n=e.streamInfo;t="EmpHLS"===this.techName_?(n.start.getTime()+1e3*t-i.start.getTime())/1e3:(1e3*t-i.start.getTime())/1e3}}else t=i.duration/1e3}return t},t.prototype.remainingTime=function(){var e=ke.getEntitlement(this),t=0;if(e&&(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){var i=this.duration();if(i===1/0||0===i)return 1/0;t=i-this.currentTime()}else t=ke.remainingTime(this);return t<0&&(t=0),Math.round(t)},t.prototype.gotoLive=function(){ke.gotoLive(this)},t.prototype.playPreviousProgram=function(e){var t=this;if(this.sourceChanging_)return void pe("playPreviousProgram ignore sourceChanging");if(this.tech_.playPreviousProgram)this.techCall_("playPreviousProgram",e);else{var i=ke.getEntitlement(this);this.programService&&(i.isStaticCachupAsLive||i.isDynamicCachupAsLive)&&i.rwEnabled?this.programService().getPreviousProgram(function(i,n){if(n)pe.error("playPreviousProgram",n);else{new Date(i.startTime);e?t.playheadTime(i.end.getTime()-3e4):t.playheadTime(i.start.getTime()+1e3)}}):ke.playPreviousProgram(this)}},t.prototype.playNextProgram=function(){if(this.sourceChanging_)return void pe("playNextProgram ignore sourceChanging");if(this.tech_.playNextProgram)this.techCall_("playNextProgram");else{var e=ke.getEntitlement(this),t=this.getProgramDetails();t&&(e.isStaticCachupAsLive||e.isDynamicCachupAsLive)&&e.ffEnabled?this.playheadTime(t.end.getTime()+1e3):ke.playNextProgram(this)}},t.prototype.isProgramLive=function(){var e=this.getProgramDetails();return e?e.end.getTime()>this.getServerTime():this.isLive()},t.prototype.isProgramCatchup=function(){var e=ke.getEntitlement(this);return e?e.isStaticCachupAsLive||!this.isProgramLive()&&e.isDynamicCachupAsLive:!this.isLive()},t.prototype.currentAsset=function(){return ke.currentAsset(this)},t.prototype.ended=function(){return this.ended_},t.prototype.handleTechWaiting_=function(){var e=this;!this.hasStarted()||this.ended()||this.paused()||this.hasClass("vjs-waiting")||this.playheadMoving_(function(t){t||(e.addClass("vjs-waiting"),e.trigger("waiting"),e.removeWaitingClass_())})},t.prototype.removeWaitingClass_=function(){var e=this;this.one("timeupdate",function(){e.playheadTime()-e.prePlayheadTime_>1||e.playheadTime()-e.prePlayheadTime_<-1?(e.prePlayheadTime_=0,e.removeClass("vjs-waiting"),e.paused()?e.trigger(oe.PAUSE):e.trigger(oe.PLAYING)):e.removeWaitingClass_()})},t.prototype.playheadMoving_=function(e){this.playheadMovingTimer_&&(clearInterval(this.playheadMovingTimer_),this.playheadMovingTimer_=null),this.prePlayheadTime_=this.playheadTime(),this.playheadMovingTimer_=this.setTimeout(function(){e(this.playheadTime()-this.prePlayheadTime_>200||this.playheadTime()-this.prePlayheadTime_<-200)},2e3)},t.prototype.handleTechCanPlay_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger("canplay")},t.prototype.handleTechCanPlayThrough_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},t.prototype.handleTechPlaying_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.sourceChanging_=!1,this.trigger("playing")},t.prototype.sourceChanging=function(){return this.sourceChanging_},te(t,[{key:"version",get:function(){return"2.0.84-89"}},{key:"entitlement",get:function(){var e=ke.getEntitlement(this);return e&&(e=Object.assign({},e),e.options=void 0),e}},{key:"entitlementEngine",get:function(){return this.programService?this.programService().exposure:null}}]),t}(zt);Jt.AutoTechArray=function(){var e=["EmpShaka","EmpHLS","EmpFlash","Html5"];Jt.SupportFairplay_()&&(e=["EmpHLS","EmpShaka","EmpFlash","Html5"]);for(var t=[],i=0;i<e.length;i++)Xt.techs_.hasOwnProperty(e[i])&&t.push(e[i]);return t},Jt.SupportFairplay_=function(){var e=Z.getTech("EmpHLS");return!!(void 0!==e&&e.isSupported()&&$.WebKitMediaKeys&&e.getKeySystem&&$.WebKitMediaKeys.isTypeSupported(e.getKeySystem(),"video/mp4"))},Z.getComponent("Component").registerComponent("player",Jt);var Zt=function(){function e(t){ee(this,e),this.assetId=t.assetId||0,this.playToken=t.playToken||"",this.playTokenExpiration=t.playTokenExpiration||"",this.productId=t.productId||"",this.edrmConfig=t.edrmConfig||null,this.mediaLocator=t.mediaLocator||"",this.mediaLocator&&(this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),t.streamInfo?this.streamInfo=t.streamInfo:this.setupStreamInfo(t.mediaLocator||""),this.mimeType=t.mimeType||"",this.entitlementType=t.entitlementType||"",this.live=t.live||!1,this.playSessionId=t.playSessionId||"",this.analyticsConfig=t.analyticsConfig||null,this.lastViewedOffset=t.lastViewedOffset||null,this.lastViewedTime=t.lastViewedTime||null,this.liveTime=t.liveTime||null;var i=Date.parse(t.licenseExpiration||null);!1===isNaN(i)&&(this.licenseExpiration=new Date(i)),this.licenseExpirationReason=t.licenseExpirationReason||"",this.playRequest=t.playRequest||null,this.minBitrate=t.minBitrate||0,this.maxBitrate=t.maxBitrate||0,this.maxResWidth=t.maxResWidth||0,this.maxResHeight=t.maxResHeight||0,this.rwEnabled=void 0===t.rwEnabled||t.rwEnabled,this.ffEnabled=void 0===t.ffEnabled||t.ffEnabled,this.airplayBlocked=void 0!==t.airplayBlocked&&t.airplayBlocked,t.fairplayConfig&&(this.protection={},this.protection.certificateUrl=t.fairplayConfig.certificateUrl||"",this.protection.licenseUrl=t.fairplayConfig.licenseAcquisitionUrl||""),this.mdnRequestRouterUrl=t.mdnRequestRouterUrl||"",this.timeshiftEnabled=t.timeshiftEnabled,t.cencConfig&&(this.licenseServers=t.cencConfig)}return e.prototype.setupStreamInfo=function(){if(this.streamInfo={referenceTime:0},this.isDynamicCachupAsLive=!1,this.isStaticCachupAsLive=!1,this.mediaLocator){var e=c("t",this.mediaLocator);if(e)try{e&&47===e.length?(this.streamInfo.start=new Date(e.slice(0,23)+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime(),this.streamInfo.end=new Date(e.slice(24)+"Z"),this.streamInfo.endTime=this.streamInfo.end.getTime()):e&&23===e.length&&(this.streamInfo.start=new Date(e+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime()),this.isDynamicCachupAsLive=void 0!==this.streamInfo.start&&void 0===this.streamInfo.end,this.isStaticCachupAsLive=void 0!==this.streamInfo.start&&void 0!==this.streamInfo.end}catch(e){pe.warn("timeParams",e)}}},te(e,null,[{key:"Type",get:function(){return{DASH:"DASH",FLASH:"FLASH",HLS:"HLS"}}}]),e}(),Qt=i(function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,i){for(var n=!0;n;){var r=e,o=t,s=i;n=!1,null===r&&(r=Function.prototype);var a=Object.getOwnPropertyDescriptor(r,o);if(void 0!==a){if("value"in a)return a.value;var l=a.get;if(void 0===l)return;return l.call(s)}var c=Object.getPrototypeOf(r);if(null===c)return;e=c,t=o,i=s,n=!0,a=c=void 0}},o=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];if(i(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),Object.defineProperty(this,"message",{enumerable:!1,value:e,writable:!0}),Object.defineProperty(this,"name",{enumerable:!1,value:this.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace"))return void Error.captureStackTrace(this,this.constructor);Object.defineProperty(this,"stack",{enumerable:!1,value:new Error(e).stack,writable:!0})}return n(t,e),t}(Error);t.default=o,e.exports=t.default}),ei=t(Qt),ti=function(e){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ee(this,t);var n=void 0,r=!0;"string"==typeof i?n=i:i instanceof Object&&(n=i.message,!1===i.fatal&&(r=i.fatal));var o=ne(this,e.call(this,n));return o.fatal=r,o}return ie(t,e),te(t,[{key:"fatal",get:function(){return!!this.fatal_},set:function(e){this.fatal_=e}}]),t}(ei),ii=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ee(this,e),this.options_=t}return e.prototype.getEntitlement=function(e,t,i){throw new ti("EntitlementEngine: getEntitlement should be implemented in subclass.")},e.prototype.getServerTime=function(e){throw new ti("EntitlementEngine: getServerTime should be implemented in subclass.")},e.prototype.getCachedServerTime=function(){return void 0!==e.ServerTimeDiff_?Date.now()+e.ServerTimeDiff_:Date.now()},e.prototype.getPreferences=function(e){throw new ti("EntitlementEngine: getPreferences should be implemented in subclass.")},e.prototype.savePreferences=function(e,t){throw new ti("EntitlementEngine: savePreferences should be implemented in subclass.")},e.prototype.getProgramInfo=function(e,t,i,n){throw new ti("EntitlementEngine: getProgramInfo should be implemented in subclass.")},e.prototype.getEPG=function(e,t,i,n){throw new ti("EntitlementEngine: getEPG should be implemented in subclass.")},e.prototype.getAssetInfo=function(e,t){throw new ti("EntitlementEngine: getAssetInfo should be implemented in subclass.")},e.prototype.getChannelInfo=function(e,t){throw new ti("EntitlementEngine: getChannelInfo should be implemented in subclass.")},e.prototype.verifySession=function(e,t){throw new ti("EntitlementEngine: verifySession should be implemented in subclass.")},e.prototype.verifyEntitlement=function(e,t,i){throw new ti("EntitlementEngine: verifyEntitlement should be implemented in subclass.")},e.prototype.login=function(e,t,i,n){throw new ti("EntitlementEngine: login should be implemented in subclass.")},e.prototype.logout=function(e){throw new ti("EntitlementEngine: logout should be implemented in subclass.")},e.prototype.fetchPreferences=function(e){throw new ti("EntitlementEngine: fetchPreferences should be implemented in subclass.")},e.prototype.savePreferences=function(e,t){throw new ti("EntitlementEngine: savePreferences should be implemented in subclass.")},e.isEntitlementEngine=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerEntitlementEngine=function(t,i){if(e.engines_||(e.engines_={}),!e.isEntitlementEngine(i))throw new ti("EntitlementEngine "+t+" must be a EntitlementEngine");return e.engines_[t]=i,i},e.getEntitlementEngine=function(t){if(e.engines_&&e.engines_[t])return e.engines_[t]},e}();ii.ServerTimeDiff_=void 0,ii.registerEntitlementEngine("EntitlementEngine",ii);var ni=R,ri=Object.prototype.toString,oi=i(function(e,t){function i(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=i,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),si=M,ai=Object.prototype.toString,li=Object.prototype.hasOwnProperty,ci=function(e){return"[object Array]"===Object.prototype.toString.call(e)},ui=function(e){if(!e)return{};var t={};return si(oi(e).split("\n"),function(e){var i=e.indexOf(":"),n=oi(e.slice(0,i)).toLowerCase(),r=oi(e.slice(i+1));void 0===t[n]?t[n]=r:ci(t[n])?t[n].push(r):t[n]=[t[n],r]}),t},pi=F,hi=Object.prototype.hasOwnProperty,di=V;V.XMLHttpRequest=$.XMLHttpRequest||q,V.XDomainRequest="withCredentials"in new V.XMLHttpRequest?V.XMLHttpRequest:$.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(e){V["delete"===e?"del":e]=function(t,i,n){return i=j(t,i,n),i.method=e.toUpperCase(),W(i)}});var mi=function(){function e(){ee(this,e)}return e.getBaseUrl=function(e,t){var i=new XMLHttpRequest;i.open("GET",e.mdnRequestRouterUrl),i.onreadystatechange=function(n){if(4===i.readyState)if(200===i.status){pe("getBaseUrl OK");var r=i.responseXML;try{var o=r.firstChild.getElementsByTagName("baseURL")[0].textContent;o?e.baseUrl=o:pe.error("getBaseUrl Error can not find baseURL"),t(e)}catch(i){pe.error("getBaseUrl Error",i),t(e)}}else pe.error("getBaseUrl Error",i.statusText),t(e)},i.send(null)},e}(),fi=function(e){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ee(this,t),i=Object.assign({exposureApiURL:"https://exposure.emps.ebsd.ericsson.net",exposureApiVersion:"v1"},i);var n=ne(this,e.call(this,i));return n.errorMap={400:{INVALID_JSON:{message:"Invalid json.",fatal:!1}},401:{NO_SESSION_TOKEN:{message:"The session token is missing.",fatal:!0},INVALID_SESSION_TOKEN:{message:"The session token is not valid.",fatal:!0}},403:{FORBIDDEN:{message:"The business unit has been configured to require server to server authentication, but it is not valid.",fatal:!0},NOT_ENTITLED:{message:"The user is not entitled.",fatal:!0},DEVICE_BLOCKED:{message:"The device is not allowed to play the asset.",fatal:!0},GEO_BLOCKED:{message:"Not allowed from this region.",fatal:!0},LICENSE_EXPIRED:{message:"Asset has been expired.",fatal:!0},NOT_AVAILABLE_IN_FORMAT:{message:"The media is not available in the requested format.",fatal:!1},NOT_ENABLED:{message:"The media is not enabled.",fatal:!0},CONCURRENT_STREAMS_LIMIT_REACHED:{message:"You have reached the maximum number of concurrent streams you are allowed to watch.",fatal:!0},NO_MEDIA_ON_CHANNEL:{message:"The media is not available on the channel.",fatal:!1},NO_MEDIA_FOR_PROGRAM:{message:"No media available for this program.",fatal:!1}},404:{UNKNOWN_BUSINESS_UNIT:{message:"The business unit cannot be found.",fatal:!0},UNKNOWN_ASSET:{message:"The asset cannot be found.",fatal:!1}},0:{NETWORK_ERROR:{message:"Network error.",fatal:!1}}},void 0===ii.ServerTimeDiff_&&n.getServerTime(function(e,t){t&&(pe.error("getServerTime",t),e=new Date),ii.ServerTimeDiff_=new Date-e,pe("serverDiff",ii.ServerTimeDiff_)}),n}return ie(t,e),t.prototype.login=function(e,t,i,n){var r=this;if(!i)throw"callback is mandantory for login";var o=!1;n&&(o=!0);var s=""===e,a=new Date(this.getCachedServerTime());if(a.setTime(a.getTime()+864e5),this.options_.apiKey){var l={"EMP-Auth":this.options_.apiKey},c=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/auth/session",u={accountId:e,userId:e,deviceId:"WEB_"+e,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},expiration:a.toISOString(),anonymous:!1};di.post(c,{json:u,headers:l},function(e,t,n){r.checkForError(e,t,function(e,t){i({success:!1,expiration:0,message:t.message})})||(r.sessionToken=n.sessionToken,i({success:!0,expiration:864e5,session:n}))})}else{var p=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit;p+=!0===s?"/auth/anonymous":!0===o?"/auth/twofactorlogin":"/auth/login";var h={deviceId:"WEB_"+e,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},rememberMe:!1,username:e,password:t,totp:!0===o?n:void 0};di.post(p,{json:h},function(e,t,n){r.checkForError(e,t,function(e,t){i({success:!1,expiration:0,message:t.message})})||(r.sessionToken=n.sessionToken,i({success:!0,expiration:n.expirationDateTime?new Date(n.expirationDateTime)-new Date(r.getCachedServerTime()):864e5,session:n}))})}},t.prototype.logout=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments[1],n=this.customer,r=this.businessUnit;if(!n)throw new ti("Customer was not provided.");if(!r)throw new ti("Business unit was not provided.");var o=this.requestHeaders;i&&(o={Authorization:"Bearer "+i});var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/auth/session";return di.del(s,{headers:o},function(i,n,r){e.checkForError(i,n,t)||(e.sessionToken=null,void 0!==(void 0===t?"undefined":Q(t))&&t(!0))})},t.prototype.getEntitlement=function(e,t,i){if(void 0===e)throw new ti("No request specified.");if(void 0===e.assetId)throw new ti("No assetId specified.");if(void 0===t)throw new ti("Media not found.");if(!t.drm||!t.format)throw new ti("Invalid playrequest specified.");null!==e.programId||e.channelId?this.getProgram_(e.assetId,e.programId,t,i):this.getAsset_(e.assetId,t,i)},t.prototype.getErrorForResponse=function(e){if(!e)return null;var t=e.statusCode,i="";e.body&&(i=e.body.message);var n=this.errorMap[t];if(n){var r=t+" "+i,o=n[i];return o&&(r+=": "+o.message),new ti(o?{message:r,fatal:!!o.fatal}:r)}if(!(t>=200&&t<=299)){return new ti(t+" "+i)}return null},t.prototype.checkForError=function(e,t,i){var n=e;return e||(n=this.getErrorForResponse(t)),n?(i&&i(null,n),n):null},t.prototype.getAsset_=function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.customer,o=this.businessUnit;if(!r)throw new ti("Customer was not provided.");if(!o)throw new ti("Business unit was not provided.");var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/entitlement/"+e+"/play";return di.post(s,{json:t,headers:this.requestHeaders},function(r,o,s){if(!i.checkForError(r,o,n)){var a=new Zt(s);a.assetId=e,a.playRequest=t,a.mimeType=t.type,a.mdnRequestRouterUrl?mi.getBaseUrl(a,n):n(a)}})},t.prototype.setStreamReferenceTime_=function(e){(e.isDynamicCachupAsLive||e.isStaticCachupAsLive)&&("application/dash+xml"===e.mimeType?e.isStaticCachupAsLive?e.streamInfo.referenceTime=e.streamInfo.startTime:e.streamInfo.referenceTime=0:"application/x-mpegurl"===e.mimeType&&(e.streamInfo.referenceTime=e.streamInfo.startTime))},t.prototype.getAssetMetadata_=function(e,t){var i=this,n=this.customer,r=this.businessUnit;if(!n)throw new ti("Customer was not provided.");if(!r)throw new ti("Business unit was not provided.");var o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/content/asset/"+e;return di.get(o,null,function(e,n,r){if(!i.checkForError(e,n,t)){var o=JSON.parse(r);t(o)}})},t.prototype.getProgram_=function(e,t,i){var n=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=this.customer,s=this.businessUnit;if(!o)throw new ti("Customer was not provided.");if(!s)throw new ti("Business unit was not provided.");var a="";t&&(a="/program/"+t);var l=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+o+"/businessunit/"+s+"/entitlement/channel/"+e+a+"/play";return di.post(l,{json:i,headers:this.requestHeaders},function(o,s,a){if(!n.checkForError(o,s,r)){var l=new Zt(a);l.assetId=e,l.channelId=e,t&&(l.programId=t),l.playRequest=i,l.mimeType=i.type,n.setStreamReferenceTime_(l),l.mdnRequestRouterUrl?mi.getBaseUrl(l,r):r(l)}})},t.prototype.getServerTime=function(e){var t=this.customer,i=this.businessUnit;if(!t||!i)return pe.warn("getServerTime no customer or businessUnit"),void e(new Date);var n=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+t+"/businessunit/"+i+"/time";return di.get(n,null,function(t,i,n){if(t)return void e(null,t);var r=JSON.parse(n),o=new Date(r.iso8601);e(o)})},t.prototype.getPreferences=function(e){var t=this,i=this.customer,n=this.businessUnit,r=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+i+"/businessunit/"+n+"/preferences";return di.get(r,{headers:this.requestHeaders},function(i,n,r){if(!t.checkForError(i,n,e)){var o=JSON.parse(r);e(o)}})},t.prototype.savePreferences=function(e,t){var i=this,n=this.customer,r=this.businessUnit;if(!e)return void pe.error("Preferences was not provided.");var o={preferences:e},s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/preferences";return di.post(s,{json:o,headers:this.requestHeaders},function(e,n,r){i.checkForError(e,n,t)||t(!0)})},t.prototype.getEPG=function(e,t,i,n){var r=this,o=this.customer,s=this.businessUnit,a=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+o+"/businessunit/"+s+"/epg/"+e;return a+="?from="+t+"&to="+i,di.get(a,null,function(e,t,i){if(!r.checkForError(e,t,n)){var o=JSON.parse(i);n(o)}})},t.prototype.getProgramInfo=function(e,t,i,n){var r=this.customer,o=this.businessUnit,s=null,a=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/epg/"+e;return n?a=a+"/program/"+n:(s={from:t.getTime(),to:t.getTime()},a+="?from="+s.from+"&to="+s.to),di.get(a,null,function(e,t,n){if(e)return void i(null,e);var r=JSON.parse(n),o=void 0;if(r.programs&&r.programs.length>0)o=r.programs[0];else{if(!r.programId)return void i(null,"Invalid response from EPG. No programs found.");o=r}o.start=new Date(o.startTime),o.end=new Date(o.endTime),o.duration=new Date(o.endTime)-new Date(o.startTime),i(o)})},t.prototype.getChannelInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.getAssetInfo(e,t)},t.prototype.getAssetInfo=function(e,t){var i=this.customer,n=this.businessUnit,r=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+i+"/businessunit/"+n+"/content/asset/"+e;return di.get(r,null,function(e,i,n){if(e)return void t(null,e);var r=JSON.parse(n);t(r)})},t.prototype.verifyEntitlement=function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.customer,o=this.businessUnit;if(!r)throw new ti("Customer was not provided.");if(!o)throw new ti("Business unit was not provided.");if(!e)throw new ti("assetId was not provided.");if(!t)throw new ti("playRequest was not provided.")
;var s=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+r+"/businessunit/"+o+"/entitlement/"+e+"?drm="+t.drm+"&format="+t.format;return di.get(s,{headers:this.requestHeaders},function(e,t,r){i.checkForError(e,t,n)||void 0!==(void 0===n?"undefined":Q(n))&&n(JSON.parse(r))})},t.prototype.verifySession=function(e,t){var i=this,n=this.customer,r=this.businessUnit,o=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+n+"/businessunit/"+r+"/auth/session";return di.get(o,{headers:this.requestHeaders},function(n,r,o){if(i.checkForError(n,r))return void(t&&t());e&&e()})},te(t,[{key:"requestHeaders",get:function(){var e={Authorization:"Bearer "+this.sessionToken};return this.options_.apiKey&&(e=Object.assign({"EMP-Auth":this.options_.apiKey},e)),e}},{key:"customer",get:function(){return this.customer_||this.options_.customer||null},set:function(e){this.customer_=e}},{key:"businessUnit",get:function(){return this.businessUnit_||this.options_.businessUnit||null},set:function(e){this.businessUnit_=e}},{key:"sessionToken",get:function(){return this.options_.sessionToken||null},set:function(e){this.options_.sessionToken=e}}]),t}(ii);ii.registerEntitlementEngine("EricssonExposure",fi);var gi=function(){function e(t){ee(this,e),this.assetId=t.assetId||null,this.programId=t.programId||null,this.channelId=t.channelId||null}return te(e,[{key:"assetId",get:function(){return this.assetId_},set:function(e){this.assetId_=e}},{key:"programId",get:function(){return this.programId_},set:function(e){this.programId_=e}},{key:"channelId",get:function(){return this.channelId_},set:function(e){this.channelId_=e}}]),e}(),yi=videojs.getPlugin("plugin"),vi=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return pe("ProgramService","create"),r.MIN_PROGRAM_CHECK_TIMEOUT=1e3,r.checkForProgramChangeBind=r.checkForProgramChange_.bind(r),r.onEntitlementChangeBind=r.onEntitlementChange.bind(r),r.clearProgramChangeTimeoutBind=r.clearProgramChangeTimeout_.bind(r),r.options_=n||{},r.programChangeTimeout_=null,r.programChangeCheckTimestamp_=0,r.player.on(oe.ENTITLEMENT_CHANGE,r.onEntitlementChangeBind),r}return ie(t,e),t.prototype.entitlement=function(e){return void 0===e?this.entitlement_:(this.entitlement_=e,e)},t.prototype.options=function(e){if(!e)return this.options_;this.options_=e},t.prototype.onEntitlementChange=function(e,t){var i=t&&t.entitlement;i&&(i instanceof Zt||(this.stop(),i=Object.assign(new Zt({}),i)),this.entitlement(i)),ke.supportsEpgProgramChange(this.player)||(this.player.off(oe.PLAYING,this.checkForProgramChangeBind),this.player.one(oe.PLAYING,this.checkForProgramChangeBind))},t.prototype.start=function(){pe("ProgramService","start"),this.entitlement()&&this.checkForProgramChange_({type:"startplayback"})},t.prototype.stop=function(){pe("ProgramService stop"),this.clearProgramChangeTimeout_(),this.player&&(this.player.off(oe.SEEKED,this.checkForProgramChangeBind),this.player.off(oe.PLAYING,this.checkForProgramChangeBind),this.player.off(oe.PAUSE,this.clearProgramChangeTimeoutBind),this.player.off(oe.PLAY,this.checkForProgramChangeBind))},t.prototype.reset=function(){this.stop(),this.currentProgram_=null,this.currentVOD_=null,this.entitlement_=null},t.prototype.clearProgramChangeTimeout_=function(e,t){this.programChangeTimeout_&&(e&&pe("clearProgramChangeTimeout",e.type),clearTimeout(this.programChangeTimeout_),this.programChangeTimeout_=null)},t.prototype.running=function(){return!!this.programChangeTimeout_&&(pe("ProgramService:running",this.programChangeCheckTimestamp_?new Date(this.programChangeCheckTimestamp_):0),!0)},t.prototype.dispose=function(){pe("ProgramService","dispose"),this.player.off(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.stop(),e.prototype.dispose.call(this)},t.prototype.checkForProgramChange_=function(e,t){var i=this;if(!e)return void pe.error("checkForProgramChange","event was not provided.");if(pe("checkForProgramChange",e.type),this.entitlement().live||this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive||e.type!==oe.SEEKED){if(this.player.options_.absoluteStartTime&&e.type===oe.SEEKED)return void pe("checkForProgramChange","ignore livepoint");if(this.clearProgramChangeTimeout_(),ke.supportsEpgProgramChange(this.player)){if(ke.program(this.player))return void pe("updateCurrentProgram from player")}var n=this.entitlement().assetId,r=this.entitlement().live,o=this.entitlement().programId;if(!r&&!o)return void this.updateVOD_(n);var s=void 0;if(r&&!o){var a=new Date(this.exposure.getCachedServerTime()),l="startplayback"===e.type?15:ke.timeBehindLive(this.player);if(a.setSeconds(a.getSeconds()-l),s=a,pe("checkForProgramChange","Live",l),this.currentProgram&&this.currentProgram.channelId===this.entitlement().channelId&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return pe("checkForProgramChange","Same"),s=null,void this.updateCurrentProgram_(this.currentProgram,!1)}else if("startplayback"!==e.type&&(this.entitlement().isDynamicCachupAsLive||this.entitlement().isStaticCachupAsLive)){var c=ke.getPlayheadTime(this.player);if(c){s=new Date(c);new Date(this.exposure.getCachedServerTime());if(this.currentProgram&&this.entitlement().isStaticCachupAsLive&&s.getTime()+2e3>=this.entitlement().streamInfo.end.getTime())return pe("checkForProgramChange","Load next stream",s),void(this.player.lineUpAsset&&this.player.lineUpAsset(null,this.currentProgram.channelId,this.currentProgram.programId,s.getTime()));if(this.currentProgram&&s.getTime()+2e3>=this.currentProgram.end.getTime())pe("checkForProgramChange","Next",s),s.setSeconds(s.getSeconds()+2);else{if(this.currentProgram&&s.getTime()<this.currentProgram.end.getTime()&&s.getTime()>=this.currentProgram.start.getTime())return pe("checkForProgramChange","Same",s),s=null,void this.updateCurrentProgram_(this.currentProgram,!1);pe("checkForProgramChange","Prev",s)}}}this.exposure.getProgramInfo(n,s,function(t,n){if(i.currentVOD_=null,n)return pe.warn("getProgramInfo","No EPG found.",n),void i.pollingForEPG_();i.updateCurrentProgram_(t,"startplayback"===e.type)},s?null:o)}},t.prototype.updateChannelInfo_=function(e,t){var i=this;return e&&e.channelId?this.currentChannelAsset_&&this.currentChannelAsset_.assetId===e.channelId?(e.channelInfo=this.extractAssetMetadata(this.currentChannelAsset_),void t()):void this.exposure.getChannelInfo(e.channelId,function(n,r){if(r)return void pe.warn("updateChannelInfo","No ChannelInfo found.",r);pe("updateChannelInfo",e.channelId),i.currentChannelAsset_=n,e.channelInfo=i.extractAssetMetadata(i.currentChannelAsset_),t()}):(pe.error("updateChannelInfo","program or channelId empty"),void t())},t.prototype.updateVOD_=function(e){var t=this;this.exposure.getAssetInfo(e,function(e,i){if(t.currentProgram_=null,i)return pe.warn("No AssetInfo found.",i),t.currentVOD_=null,void t.player.trigger(oe.ASSET_CHANGED,{asset:null});t.currentVOD_&&t.currentVOD_.assetId===e.assetId||(t.currentVOD_=e,pe("ASSET_CHANGED"),t.player.trigger(oe.ASSET_CHANGED,{asset:e}))})},t.prototype.updateCurrentProgram_=function(e,t){var i=this;if(pe("updateCurrentProgram",e,t),this.clearProgramChangeTimeout_(),this.currentProgram_&&this.currentProgram_.programId===e.programId||(this.currentVOD_=null,this.currentProgram_=e,t||this.verifyEntitlement(),this.updateChannelInfo_(e,function(){ke.setTechProgram(i.player,e),i.player.trigger(oe.PROGRAM_CHANGED,{program:e}),i.player.trigger(oe.DURATION_CHANGE)})),t)return void pe("updateCurrentProgram","startplayback");if(this.entitlement().isDynamicCachupAsLive||this.entitlement().live||this.entitlement().isStaticCachupAsLive){var n=void 0;if(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive){var r=ke.getPlayheadTime(this.player);if(!r)return void pe("updateCurrentProgram","no playHeadTime",r);n=new Date(r)}else{var o=ke.timeBehindLive(this.player);n=new Date(this.exposure.getCachedServerTime()),n.setSeconds(n.getSeconds()-o)}var s=new Date(e.start.getTime()+e.duration),a=s.getTime()-n.getTime();(!a||a<this.MIN_PROGRAM_CHECK_TIMEOUT)&&(pe("updateCurrentProgram","timediff is below minimum",a),a=this.MIN_PROGRAM_CHECK_TIMEOUT),this.programChangeCheckTimestamp_=Date.now()+a,pe("updateCurrentProgram","programChangeTimeout",new Date(this.programChangeCheckTimestamp_)),this.programChangeTimeout_=setTimeout(function(){i.checkForProgramChange_({type:"programend"}),i.programChangeTimeout_=null},a>2147483647?2147483647:a)}this.player.off(oe.SEEKED,this.checkForProgramChangeBind),this.player.one(oe.SEEKED,this.checkForProgramChangeBind),this.player.off(oe.PLAY,this.checkForProgramChangeBind),this.player.one(oe.PLAY,this.checkForProgramChangeBind),this.player.off(oe.PAUSE,this.clearProgramChangeTimeoutBind),this.player.one(oe.PAUSE,this.clearProgramChangeTimeoutBind)},t.prototype.pollingForEPG_=function(){var e=this;this.currentProgram_;this.currentProgram_=null,this.player.trigger(oe.PROGRAM_CHANGED,{program:null}),this.player.trigger(oe.DURATION_CHANGE);this.programChangeCheckTimestamp_=Date.now()+3e5,this.programChangeTimeout_=setTimeout(function(){e.checkForProgramChange_({type:"pollingforepg"}),e.programChangeTimeout_=null},3e5)},t.prototype.getNextProgram=function(e){if(!this.currentProgram&&e)return void e(null,{message:"getNextProgram No Current Program"});if(this.exposure.getCachedServerTime()<this.currentProgram.end.getTime())return void e(this.currentProgram);var t=new Date(this.currentProgram.endTime);t.setSeconds(t.getSeconds()+15),this.exposure.getProgramInfo(this.currentProgram.channelId,t,function(t,i){i?e(null,i):e(t)},null)},t.prototype.getPreviousProgram=function(e){if(!this.currentProgram&&e)return void e(null,{message:"getPreviousProgram No Current Program"});var t=new Date(this.currentProgram.startTime);t.setSeconds(t.getSeconds()-15),this.exposure.getProgramInfo(this.currentProgram.channelId,t,function(t,i){i?e(null,i):e(t)},null)},t.prototype.getProgram=function(e,t){if(!this.currentProgram&&t)return void t(null,{message:"getProgram No Current Program"});this.exposure.getProgramInfo(this.currentProgram.channelId,e,function(e,i){i?t(null,i):t(e)},null)},t.prototype.verifyEntitlement=function(){var e=this;this.currentProgram&&this.exposure.verifyEntitlement(this.currentProgram.assetId,this.entitlement().playRequest,function(t,i){return i?(e.player.error("verifyEntitlement "+i.message),void ke.stop(e.player)):t&&"SUCCESS"===t.status?void pe("verifyEntitlement",t.status):(e.player.error(t?t.status:"verifyEntitlement no status"),void ke.stop(e.player))})},t.prototype.getAssetMetadata=function(e,t){var i=this,n=this.currentProgram?this.currentProgram.asset:this.currentVOD;n?t(this.extractAssetMetadata(n)):this.exposure.getAssetMetadata_(e,function(e,n){return n?(pe.warn("getAssetMetadata","No data found.",n),void t(null,n)):void t(i.extractAssetMetadata(e))})},t.prototype.extractAssetMetadata=function(e){var t=null,i=null,n=null;return e&&e.localized&&e.localized.length>0&&(e.localized[0].title&&(t=e.localized[0].title),e.localized[0].shortDescription&&(i=e.localized[0].shortDescription),e.localized[0].images&&e.localized[0].images.length>0&&e.localized[0].images[0].url&&(n=e.localized[0].images)),{title:t||"",subtitle:i||"",images:n||[]}},te(t,[{key:"exposure",get:function(){if(!this.options_.exposure){var e=this.player.options_["entitlement-engine"];e||(e=this.player.options_["exposure-service"]?this.player.options_["exposure-service"]:"EricssonExposure");var t=this.player.options_[e.toLowerCase()];if(!t){pe.warn("Missing entitlementOptions in player options");new le("Missing entitlementOptions in player options",ae.ENTITLEMENT);return null}var i=ii.getEntitlementEngine(e);this.options_.exposure=new i(t)}return this.options_.exposure}},{key:"currentProgram",get:function(){if(ke.supportsEpgProgramChange(this.player)){return ke.program(this.player)}return this.currentProgram_}},{key:"currentChannelAsset",get:function(){return this.currentChannelAsset_}},{key:"currentVOD",get:function(){return this.currentVOD_}}]),t}(yi);vi.VERSION="2.0.84-89",videojs.getPlugin("programService")?videojs.log.warn('A plugin named "programService" already exists.'):videojs.registerPlugin("programService",vi);var Ti=videojs.getPlugin("plugin"),_i=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return pe("EntitlementExpirationService","create"),r.options_=n,r.onEntitlementChangeBind=r.onEntitlementChange.bind(r),r}return ie(t,e),t.prototype.dispose=function(){pe("EntitlementExpirationService","dispose"),this.stop(),e.prototype.dispose.call(this)},t.prototype.stop=function(){pe("EntitlementExpirationService","stop"),this.player.off(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null)},t.prototype.start=function(){pe("EntitlementExpirationService","start"),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.player.off(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player.on(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},t.prototype.entitlement=function(e){return void 0===e?this.entitlement_:(this.entitlement_=e,e)},t.prototype.onEntitlementChange=function(e,t){this.entitlement(t&&t.entitlement),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.checkForExpiration()},t.prototype.options=function(e){if(!e)return this.options_;this.options_=e},t.prototype.checkForExpiration=function(){var e=this,t=this.entitlement();if(pe("EntitlementExpirationService","checkForExpiration",t.licenseExpiration),this.hasLicenseExpiration(t)){var i=t.licenseExpiration.getTime()-this.exposure.getCachedServerTime();if(i<=0)return this.player.error(this.errorForReason(t.licenseExpirationReason)),void ke.stop(this.player);i<2147483647?this.expirationTimeout_=setTimeout(function(){e.expirationTimeout_=null,pe("EntitlementExpirationService","license expired"),e.refreshEntitlement()},i):setTimeout(function(){return e.checkForExpiration()},1073741823)}},t.prototype.refreshEntitlement=function(){ke.restart(this.player,!0)},t.prototype.errorForReason=function(e){switch(e){case"GEO_BLOCKED":return this.player.localize("Not allowed from this region.");case"NOT_ENTITLED":return this.player.localize("The user is not entitled.");case"GAP_IN_EPG":return this.player.localize("Asset temporarily not available");case"EPG_PLAY_MAX_HOURS":default:return this.player.localize("Asset exceeded maximum playback time")}},t.prototype.hasLicenseExpiration=function(e){return!!e.licenseExpiration},te(t,[{key:"exposure",get:function(){return this.options_&&this.options_.exposure}}]),t}(Ti);_i.VERSION="2.0.84-89",videojs.getPlugin("entitlementExpirationService")?videojs.log.warn('A plugin named "entitlementExpirationService" already exists.'):videojs.registerPlugin("entitlementExpirationService",_i);var Ei=Z.getComponent("Tech"),Si=function e(t){return{setSource:function(i,n){function r(e,t,i,n,r){e.options_.absoluteStartTime&&e.options_.absoluteStartTime>i.getCachedServerTime()?e.options_.absoluteStartTime=i.getCachedServerTime()-1e4:e.options_.startTime&&e.options_.startTime>i.getCachedServerTime()/1e3&&(e.options_.startTime=(i.getCachedServerTime()-1e4)/1e3);if(e.programService&&(!t.programService||!t.programService.disable)){if(e.programService().options({exposure:i}),n.isDynamicCachupAsLive&&t.playFrom){if("beginning"===t.playFrom||!n.live&&!e.options_.absoluteStartTime&&!e.options_.startTime){var o=n.streamInfo.start.getTime()+100;pe("SET startTime",o),"EmpShaka"===e.techName_?(e.options({startTime:o/1e3}),n.options.startTime=o/1e3):(e.options({startTime:.1}),n.options.startTime=.1)}else if(e.options_.absoluteStartTime){e.options_.absoluteStartTime<n.streamInfo.start.getTime()&&(e.options_.absoluteStartTime=n.streamInfo.start.getTime());var s=e.options_.absoluteStartTime;"EmpHLS"===e.techName_&&(s=e.options_.absoluteStartTime-n.streamInfo.start.getTime()),pe("absoluteStartTime SET startTime",s),e.options({startTime:s/1e3}),n.options.startTime=s/1e3,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0}else e.options_.startTime&&(n.options.startTime=e.options_.startTime,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0)}else if(n.isStaticCachupAsLive&&e.options_.absoluteStartTime){e.options_.absoluteStartTime<n.streamInfo.start.getTime()&&(e.options_.absoluteStartTime=n.streamInfo.start.getTime());var a=e.options_.absoluteStartTime-n.streamInfo.start.getTime();pe("absoluteStartTime SET startTime",a),e.options({startTime:a/1e3}),n.options.startTime=a/1e3,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0}else n.isStaticCachupAsLive&&e.options_.startTime&&(n.options.startTime=e.options_.startTime,e.options_.absoluteStartTime=void 0,n.options.absoluteStartTime=void 0);e.programService().start()}r()}function o(e,i){if(!e)return void pe.error("setupEntitlement no entitlement");!0===s.useLastViewedOffset&&((e.isStaticCachupAsLive||e.isDynamicCachupAsLive||e.live)&&(e.lastViewedTime||e.liveTime)?e.liveTime?(pe("liveTime",new Date(e.liveTime),e.liveTime),t.options({absoluteStartTime:e.liveTime})):(pe("lastViewedTime",new Date(e.lastViewedTime),e.lastViewedTime),t.options({absoluteStartTime:e.lastViewedTime})):e.lastViewedOffset&&(pe("lastViewedOffset",e.lastViewedOffset/1e3),"EmpShaka"!==t.techName_&&t.options({startTime:e.lastViewedOffset/1e3}))),!1===e.timeshiftEnabled&&t.options({timeShiftDisabled:!0}),t.trigger(oe.ENTITLEMENT_CHANGE,{entitlement:e}),e=Object.assign(new Zt({}),e),e.type=e.mimeType;var n={autoplay:t.options_.autoplay,muted:t.options_.muted,language:t.options_.language,maxBitrate:t.options_.maxBitrate,timeShiftDisabled:t.options_.timeShiftDisabled,useLastViewedOffset:t.options_.useLastViewedOffset,startTime:t.options_.startTime,absoluteStartTime:t.options_.absoluteStartTime,audioLanguage:t.options_.audioLanguage,subtitleLanguage:t.options_.subtitleLanguage,liveDelay:t.options_.liveDelay};return e.options=n,e.options.source=e,t.entitlementExpirationService().start(),e}var s=t.options(),l=null,c=null;if(t.programService&&t.programService().stop(),function(e){return e&&e.playSessionId&&e.playToken&&e.mediaLocator}(t.currentSource()))l=t.currentSource();else{var u=a(i.src);c=new gi(u),t.trigger(oe.ENTITLEMENT_LOAD_START,c)}var p=s["entitlement-engine"];p||(p=s["exposure-service"]?s["exposure-service"]:"EricssonExposure");var h=s[p.toLowerCase()];if(!h){var d=new le("Missing entitlementOptions in player options",ae.ENTITLEMENT);return t.error(d),void n(d)}var m=e.getExposure(h,p);s.analytics&&s.analytics.disable||function(e,t,i,n){var r=t.analyticsDeviceInfo;r&&(pe.warn("options.analyticsDeviceInfo is deprecated. Use options.analytics.deviceInfo."),t.analytics||(t.analytics={}),t.analytics.deviceInfo=r),e.analytics&&(e.analytics().options({exposure:n,analytics:t.analytics}),e.analytics().newAnalytics({exposureApiURL:i.exposureApiURL,customer:i.customer,businessUnit:i.businessUnit,sessionToken:i.sessionToken}),e.analytics().onEntitlementLoadStart())}(t,s,h,m),t.entitlementExpirationService().options({exposure:m});var f=s.techOrder.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).map(function(e){return[e,Ei.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];if(i&&"Html5"!==t&&"EmpCast"!==t)return i.isSupported()});if(0===f.length){var d=new le("Unable to load asset: None of the playback technologies are supported",ae.ENTITLEMENT);return t.error(d),void n(d)}Y(f.length,function(e){var i=e.iteration();if(s.excludeTechs&&-1!==s.excludeTechs.indexOf(f[i][0]))return void e.next();var a=f[i][1];t.tech_&&t.techName_!==f[i][0]&&(t.techCall_("reset"),t.unloadTech_());try{if(l)return l=o(l,a),r(t,s,m,l,function(){n(null,l)}),void e.break();m.getEntitlement(c,a.entitlementPlayRequest,function(i,c){if(c){if(c.fatal){var c=new le(c,ae.ENTITLEMENT);return t.error(c),ke.stop(t),void n(c)}e.next()}else l=o(i,a),r(t,s,m,l,function(){n(null,l)}),e.break()})}catch(t){return pe.warn("error try next tech",new le(t,ae.ENTITLEMENT)),void e.next()}},function(){if(null===l){var e=new le("Unable to load asset: None of the playback technologies are supported",ae.ENTITLEMENT);return t.error(e),ke.stop(t),void n(e)}})}}};Si.isExposure=function(e){return ii.isEntitlementEngine(e)},Si.EntitlementClass=Zt,Si.getExposure=function(e,t){if(e){return new(ii.getEntitlementEngine(t||"EricssonExposure"))(e)}throw new le("Missing exposureOptions",ae.ENTITLEMENT)},Si.registerExposure=function(e,t){return ii.registerEntitlementEngine(e,t)},Si.getLog=function(){return pe},Si.VERSION="2.0.84-89",Z.use("video/emp",Si);var bi=function(){function e(t,i,n){ee(this,e),this.INITIAL_REFERENCE_TIME=1,this.player_=t,this.analytics_=i,this.sessionId_=null,this.customAttributes=n.analytics&&n.analytics.customAttributes,this.exposure=n.exposure,this.currentTimeTimer=null,this.onPlayBind=this.onPlay.bind(this),this.onResumedBind=this.onResume.bind(this),this.onPlayingBind=this.onPlaying.bind(this),this.onPauseBind=this.onPause.bind(this),this.onEndedBind=this.onEnded.bind(this),this.onErrorBind=this.onError.bind(this),this.onEntitlementLoadStartBind=this.onEntitlementLoadStart.bind(this),this.onBitrateChangeBind=this.onBitrateChange.bind(this),this.onDisposeBind=this.onDispose.bind(this),this.onLoadStartBind=this.onLoadStart.bind(this),this.onSeekedBind=this.onSeeked.bind(this),this.onWaitingBind=this.onWaiting.bind(this),this.onChromeCastingStartBind=this.onChromeCastingStart.bind(this),this.onChromeCastingStopBind=this.onChromeCastingStop.bind(this),this.onProgramChangeBind=this.onProgramChange.bind(this),this.onWaitingEndedBind=this.onWaitingEnded.bind(this),this.onErrorBeforeAssetBind=this.onErrorBeforeAsset.bind(this),this.onEntitlementChangeBind=this.onEntitlementChange.bind(this),this.onWindowUnloadBind=this.onWindowUnload.bind(this),this.onPlayingAfterStartBind=this.onPlayingAfterStart.bind(this),this.allEvents_=Object.keys(oe).map(function(e){return oe[e]}),this.init(),this.createdSessions={},this.mem={}}return e.prototype.SessionId=function(e){if(!(e||this.entitlement()&&this.entitlementLoaded_))return"error-"+Math.random().toString().split(".")[1];var t=e||this.entitlement().playSessionId;return this.mem[t]||(this.mem[t]={pause:{},resume:{}}),t},e.prototype.hasSessionId=function(){return!(!this.entitlement()||!this.entitlementLoaded_)},e.prototype.sendCurrentTime=function(){var e=this.SessionId();e&&this.player_&&this.analytics_.getSessionState&&"PLAYING"===this.analytics_.getSessionState(e)&&this.analytics_.setCurrentTime(e,this.OffsetTime())},e.prototype.registerCurrentTimeTimer=function(){var e=this;this.clearTimers(),this.currentTimeTimer=setInterval(function(){e.sendCurrentTime();var t=e.SessionId();t&&e.analytics_&&e.analytics_.ok&&!1===e.analytics_.ok(t)&&(e.exposure?e.exposure.verifySession(null,function(){e.player_.el_&&(e.player_.trigger(oe.ERROR,"401 INVALID_SESSION_TOKEN: The session token is no longer valid."),ke.stop(e.player_)),e.clearTimers()}):pe.error("registerCurrentTimeTimer Exposure is undefined"))},1e3)},e.prototype.clearTimers=function(){this.currentTimeTimer&&clearInterval(this.currentTimeTimer),this.currentTimeTimer=null},e.prototype.init=function(){if(!this.player_||!this.analytics_)return void pe.warn("Warning: init failed . Possible causes: either player or analytics were not set.");this.disabled_=!1,this.entitlementLoaded_=!1,pe("Initialization EmpAnalytics"),this.analytics_.init(),$.addEventListener("beforeunload",this.onWindowUnloadBind),this.player_.on(oe.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.on(oe.PAUSE,this.onPauseBind),this.player_.on(oe.SEEKED,this.onSeekedBind),this.player_.on(oe.ENDED,this.onEndedBind),this.player_.on(oe.ERROR,this.onErrorBind),this.player_.on(oe.DISPOSE,this.onDisposeBind),this.player_.on(oe.STOPPED,this.onDisposeBind),this.player_.on(oe.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.on(oe.WAITING,this.onWaitingBind),this.player_.on(oe.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.on(oe.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.on(oe.PROGRAM_CHANGED,this.onProgramChangeBind)},e.prototype.onWindowUnload=function(){var e=this;this.onGeneric("WindowClose",this.analytics_.dispose,function(){!0===e.hasSessionId()&&e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.analytics_.dispatchNow(!1),e.clearTimers()},!0)},e.prototype.onChromeCastingStart=function(){var e=this;this.onGeneric("StartCasting",this.analytics_.startCasting,function(){if(!1!==e.hasSessionId()){e.SessionId()&&e.analytics_.startCasting(e.SessionId(),e.OffsetTime()),e.clearTimers()}},!1),this.disabled_=!0},e.prototype.onChromeCastingStop=function(){var e=this;this.disabled_=!1,this.onGeneric("StopCasting",this.analytics_.stopCasting,function(){!1!==e.hasSessionId()&&e.analytics_.stopCasting(e.SessionId(),e.OffsetTime())},!1)},e.prototype.onProgramChange=function(e,t){var i=this,n=t?t.program:null;pe("analytics","onProgramChange",n),n&&this.analytics_.programChanged&&this.player_.hasStarted()&&this.onGeneric("ProgramChange",this.analytics_.programChanged,function(){i.analytics_.programChanged(i.SessionId(),i.OffsetTime(),{programId:n.programId})},!0)},e.prototype.onEntitlementChange=function(e,t,i){var n=this;this.entitlementLoaded_=!0,this.player_.off(oe.ERROR,this.onErrorBeforeAssetBind);var r=this.entitlement(t&&t.entitlement);this.onGeneric("HandShake",this.analytics_.handshake,function(){var e={};r&&r.assetId&&(e.assetId=r.assetId),r&&r.programId&&(e.programId=r.programId);var t=r?r.playSessionId:i;n.analytics_.handshake(n.SessionId(t),e),n.onLoadStart(t)},!1)},e.prototype.onEntitlementLoadStart=function(){var e=this;this.entitlementLoaded_=!1,this.onGeneric("ExitOngoingSession",this.analytics_.exitOngoingSession,function(){return e.analytics_.exitOngoingSession(e.getCachedCurrentTime())}),this.player_.one(oe.ERROR,this.onErrorBeforeAssetBind),this.player_.one(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},e.prototype.onLoadStart=function(e){var t=this,i=e||this.SessionId();if(!i)return void pe("onLoadStart called but not session available.");this.sessionCreated(i)||(this.createdSessions[i]=!0,this.onGeneric("Created",this.analytics_.created,function(){var e=t.player_.options(),n={version:t.playerVersion};e&&e.autoplay&&(n.autoplay=e.autoplay),t.analytics_.created(i,n)},!1),this.player_.off(oe.PLAYING,this.onResumedBind),this.player_.off(oe.PLAYING,this.onPlayingAfterStartBind),this.player_.one(oe.PLAYING,this.onPlayingAfterStartBind))},e.prototype.onPlayingAfterStart=function(){this.onPlayBind(),this.onPlayingBind(),this.player_.on(oe.PLAYING,this.onResumedBind)},e.prototype.onBitrateChange=function(){var e=this;this.onGeneric("BitrateChange",this.analytics_.bitrateChanged,function(){var t={bitrate:Math.max(0,Math.round(e.getBitrate()/1024))};e.analytics_.bitrateChanged(e.SessionId(),e.OffsetTime(),t)},!0)},e.prototype.onWaiting=function(){var e=this;this.onGeneric("StartWaiting",this.analytics_.waiting,function(){e.player_.hasStarted()&&e.analytics_.waiting(e.SessionId(),e.OffsetTime()),e.allEvents_.map(function(t){t!==oe.PLAY&&t!==oe.PLAYING&&t!==oe.ENDED&&t!==oe.ERROR&&t!==oe.DISPOSE&&t!==oe.SEEKED&&t!==oe.CHROMECAST_CASTING&&t!==oe.CHROMECAST_STOPPED||e.player_.one(t,e.onWaitingEndedBind)})},!0)},e.prototype.OffsetTime=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)?ke.getPlayheadTime(this.player_)/1e3:ke.baseCurrentTime(this.player_)},e.prototype.startTimeLive=function(){return ke.startTimeLive(this.player_)},e.prototype.isLive=function(){return ke.isLive(this.player_)},e.prototype.getBitrate=function(){return ke.getBitrate(this.player_)},e.prototype.duration=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)&&this.player_.getProgramDetails&&this.player_.getProgramDetails()?this.player_.getProgramDetails().duration/1e3:ke.duration(this.player_)},e.prototype.entitlement=function(e){return void 0===e?ke.getEntitlement(this.player_)||this.entitlement_:(this.entitlement_=e,e)},e.prototype.onWaitingEnded=function(){var e=this;this.allEvents_.map(function(t){e.player_.off(t,e.onWaitingEndedBind)}),this.onGeneric("WaitingEnded",this.analytics_.waitingEnded,function(){e.analytics_.waitingEnded(e.SessionId(),e.OffsetTime())},!0)},e.prototype.onDispose=function(){var e=this;this.onGeneric("Dispose",this.analytics_.dispose,function(){!1!==e.hasSessionId()&&(e.analytics_.dispose(e.SessionId(),e.getCachedCurrentTime()),e.clearTimers())},!0,!0)},e.prototype.getCachedCurrentTime=function(){if(this.player_){var e=this.player_.getCache().currentTime,t=this.OffsetTime();return t||e}},e.prototype.onEnded=function(){var e=this;this.onGeneric("End of Stream",this.analytics_.endOfStream,function(){e.analytics_.endOfStream(e.SessionId()),e.clearTimers()},!0,!0)},e.prototype.onPlay=function(){var e=this;this.onGeneric("Play",this.analytics_.play,function(){var t=e.player_.techName_,i="Unknown";switch(t){case"EmpShaka":i="Shaka";break;case"EmpDash":i="DashJS";break;case"EmpFlash":i="Flash";break;case"EmpHLS":i="NativeHLS"}var n={techName:i,version:e.playerVersion,techVersion:e.techVersion};e.analytics_.play(e.SessionId(),e.OffsetTime(),n),e.registerCurrentTimeTimer()},!1)},e.prototype.onPlaying=function(){var e=this;this.onGeneric("Playing",this.analytics_.playing,function(){var t={};t.bitrate=Math.max(0,Math.round(e.getBitrate()/1024)),!0===e.isLive()?t.referenceTime=e.startTimeLive():t.duration=e.duration(),e.entitlement()&&e.entitlement().mediaLocator&&(t.mediaLocator=e.entitlement().mediaLocator),t.mediaLocator&&t.mediaLocator.indexOf(".isml")>=0&&(t.referenceTime=e.INITIAL_REFERENCE_TIME),e.analytics_.clearCustomAttributes(),(e.customAttributes||[]).map(function(t){e.analytics_.setCustomAttribute(t.key,t.value)}),e.analytics_.playing(e.SessionId(),e.OffsetTime(),t)},!1)},e.prototype.onSeeked=function(){var e=this;this.onGeneric("Seeked",this.analytics_.seek,function(){e.analytics_.seek(e.SessionId(),e.OffsetTime())},!0)},e.prototype.onPause=function(){var e=this;this.onGeneric("Pause",this.analytics_.paused,function(){if(!1!==e.player_.hasStarted()){var t=e.SessionId(),i=parseInt((new Date-0)/25);e.mem[t].pause[i]||(e.mem[t].pause[i]=!0,e.analytics_.paused(t,e.OffsetTime()))}},!0)},e.prototype.onResume=function(){var e=this;this.onGeneric("Resume",this.analytics_.resume,function(){var t=e.SessionId(),i=parseInt((new Date-0)/25);e.mem[t].resume[i]||(e.mem[t].resume[i]=!0,e.analytics_.resume(t,e.OffsetTime()))},!0)},e.prototype.onErrorBeforeAsset=function(){this.entitlementLoaded_=!1;var e="error-"+Math.random().toString().split(".")[1];this.onEntitlementChange(null,null,e),this.onError(null,e),this.clearTimers()},e.prototype.onError=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(i||this.entitlementLoaded_)&&this.onGeneric("Error",this.analytics_.error,function(){var n=e.player_.error(),r={};n&&n.code&&(r.errorCode=n.code),n&&n.message&&(r.errorMessage=n.message),!n&&t&&(r.errorCode=t.code,r.errorMessage=t.message?t.message:"Unknown Error");var o=e.SessionId();(o||i)&&e.analytics_.error(o||i,e.OffsetTime(),r),e.clearTimers()},!1)},e.prototype.onGeneric=function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.disabled_&&!r)return void pe(e+" not delivered: analytics disabled.");n&&!this.sessionCreated(this.SessionId())?pe(e+" was discarded."):t&&i&&i()},e.prototype.sessionCreated=function(e){return e&&this.createdSessions[e]},e.prototype.dispose=function(){this.clearTimers(),this.analytics_&&(this.analytics_.exitOngoingSession(this.getCachedCurrentTime()),
this.analytics_.dispatchNow(!1)),$.removeEventListener("beforeunload",this.onWindowUnloadBind),this.player_.off(oe.PLAY,this.onPlayBind),this.player_.off(oe.PLAYING,this.onPlayingBind),this.player_.off(oe.PLAYING,this.onResumedBind),this.player_.off(oe.PAUSE,this.onPauseBind),this.player_.off(oe.SEEKED,this.onSeekedBind),this.player_.off(oe.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.off(oe.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player_.off(oe.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.off(oe.ENDED,this.onEndedBind),this.player_.off(oe.DISPOSE,this.onDisposeBind),this.player_.off(oe.STOPPED,this.onDisposeBind),this.player_.off(oe.ERROR,this.onErrorBind),this.player_.off(oe.ERROR,this.onErrorBeforeAssetBind),this.player_.off(oe.WAITING,this.onWaitingBind),this.player_.off(oe.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.off(oe.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.off(oe.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.off(oe.PLAYING,this.onPlayingAfterStartBind)},te(e,[{key:"techVersion",get:function(){return ke.techVersion(this.player_)}},{key:"playerVersion",get:function(){return this.player_.version?this.player_.version:$.videojs?$.videojs.VERSION:"2.x.x"}}]),e}(),Ci=i(function(t,i){!function(i){t.exports=function(){var t;return function t(i,n,r){function o(a,l){if(!n[a]){if(!i[a]){var c="function"==typeof e&&e;if(!l&&c)return c(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[a]={exports:{}};i[a][0].call(p.exports,function(e){var t=i[a][1][e];return o(t||e)},p,p.exports,t,i,n,r)}return n[a].exports}for(var s="function"==typeof e&&e,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,i){(function(e){"undefined"!=typeof window?t.exports=window:void 0!==e?t.exports=e:"undefined"!=typeof self?t.exports=self:t.exports={}}).call(this,void 0!==X?X:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,i,n){!function(e,r){"object"==typeof n&&void 0!==i?r(n):"function"==typeof t&&t.amd?t(["exports"],r):r(e.workerTimersBroker=e.workerTimersBroker||{})}(this,function(e){"use strict";var t=function(e){return void 0!==e.method&&"call"===e.method},i=function(e){return null===e.error&&"number"==typeof e.id},n=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,r=function(e){for(var t=Math.round(Math.random()*n);e.has(t);)t=Math.round(Math.random()*n);return t},o=function(e){var n=new Map,o=new Map,s=new Map,a=new Worker(e);return a.addEventListener("message",function(e){var r=e.data;if(t(r)){var a=r.params,l=a.timerId,c=a.timerType;if("interval"===c){var u=n.get(l);if("number"==typeof u){var p=s.get(u);if(void 0===p||p.timerId!==l||p.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===u)throw new Error("The timer is in an undefined state.");u()}}else if("timeout"===c){var h=o.get(l);if("number"==typeof h){var d=s.get(h);if(void 0===d||d.timerId!==l||d.timerType!==c)throw new Error("The timer is in an undefined state.")}else{if(void 0===h)throw new Error("The timer is in an undefined state.");h(),o.delete(l)}}}else{if(!i(r)){var m=r.error.message;throw new Error(m)}var f=r.id,g=s.get(f);if(void 0===g)throw new Error("The timer is in an undefined state.");var y=g.timerId,v=g.timerType;s.delete(f),"interval"===v?n.delete(y):o.delete(y)}}),{clearInterval:function(e){var t=r(s);s.set(t,{timerId:e,timerType:"interval"}),n.set(e,t),a.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=r(s);s.set(t,{timerId:e,timerType:"timeout"}),o.set(e,t),a.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,t){var i=r(n);return n.set(i,function(){e(),"function"==typeof n.get(i)&&a.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}})}),a.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"interval"}}),i},setTimeout:function(e,t){var i=r(o);return o.set(i,e),a.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:i,timerType:"timeout"}}),i}}};e.load=o,Object.defineProperty(e,"__esModule",{value:!0})})},{}],3:[function(e,i,n){!function(r,o){"object"==typeof n&&void 0!==i?o(n,e("worker-timers-broker")):"function"==typeof t&&t.amd?t(["exports","worker-timers-broker"],o):o(r.workerTimers=r.workerTimers||{},r.workerTimersBroker)}(this,function(e,t){"use strict";var i=new Blob(['!function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'+t+\'".\');clearTimeout(r),e.delete(t)},i=function(e){var r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'+e+\'".\');clearTimeout(r),t.delete(e)},o=function(e,t){var r=void 0;if("performance"in self){var i=performance.now();e-=Math.max(0,i-t),r=i}else r=Date.now();return{delay:e,expected:r+e}},n=function e(t,r,i,o){var n="performance"in self?performance.now():Date.now();n>i?postMessage({id:null,method:"call",params:{timerId:r,timerType:o}}):t.set(r,setTimeout(e,i-n,t,r,i,o))},a=function(t,r,i){var a=void 0,s=o(t,i);t=s.delay,a=s.expected,e.set(r,setTimeout(n,t,e,r,a,"interval"))},s=function(e,r,i){var a=void 0,s=o(e,i);e=s.delay,a=s.expected,t.set(r,setTimeout(n,e,t,r,a,"timeout"))};addEventListener("message",function(e){var t=e.data;try{if("clear"===t.method){var o=t.id,n=t.params,d=n.timerId,l=n.timerType;if("interval"===l)r(d),postMessage({error:null,id:o});else{if("timeout"!==l)throw new Error(\'The given type "\'+l+\'" is not supported\');i(d),postMessage({error:null,id:o})}}else{if("set"!==t.method)throw new Error(\'The given method "\'+t.method+\'" is not supported\');var m=t.params,u=m.delay,p=m.now,v=m.timerId,c=m.timerType;if("interval"===c)a(u,v,p);else{if("timeout"!==c)throw new Error(\'The given type "\'+c+\'" is not supported\');s(u,v,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}})}();'],{type:"application/javascript"}),n=URL.createObjectURL(i),r=t.load(n),o=r.clearInterval,s=r.clearTimeout,a=r.setInterval,l=r.setTimeout;e.clearInterval=o,e.clearTimeout=s,e.setInterval=a,e.setTimeout=l,Object.defineProperty(e,"__esModule",{value:!0})})},{"worker-timers-broker":2}],4:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("global/window"),a=n(s),l=e("./platform"),c=n(l),u=e("worker-timers"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(u),h=function(){function e(t,i,n,o,s){var a=arguments.length<=5||void 0===arguments[5]?{}:arguments[5],l=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];r(this,e),this.CYCLE_TIME=1e3,this.EVENT_PURGE_TIME_DEFAULT=3*this.CYCLE_TIME,this.TIME_WITHOUT_BEAT_DEFAULT=60*this.CYCLE_TIME,this.SERVER_URL_DEFAULT="",this.CUSTOMER_DEFAULT="",this.BUSINESS_UNIT_DEFAULT="",this.INCLUDE_DEVICE_METRICS_DEFAULT=!0,this.SESSION_TOKEN_DEFAULT="",this.SESSION_ID_DEFAULT="",this.DEBUG_DEFAULT=!1,this.MAX_RETRIES=20,this.DEVICE_CLOCK_CHECK_THRESHOLD=3e5,this.eventsSkeleton=this.initEventSkeleton(),this.customer_=i,this.businessUnit_=n,this.sessionToken_=o,this.serverURL_=t,this.includeDeviceMetrics_=!1,this.userId_=s,this.deviceInfoData_=a,this.props_=l||{},this.pendingRequest_=!1}return e.prototype.init=function(){var e=this;this.cycleTimer&&("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?p.clearInterval(this.cycleTimer):clearInterval(this.cycleTimer)),"undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?this.cycleTimer=p.setInterval(function(){return e.cycle()},this.CYCLE_TIME):this.cycleTimer=setInterval(function(){return e.cycle()},this.CYCLE_TIME),this.communicationCurrentTime=0,this.lastCommunicationTime=0,this.eventPool={}},e.prototype.clear=function(){this.eventPool={}},e.prototype.ok=function(e){var t=this.eventPool[e];return!!t&&!1===t.forbidden&&t.retries<this.MAX_RETRIES},e.prototype.created=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"Created"};this.addEventToPool(e,i,t)},e.prototype.play=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"PlayerReady",currentTime:t};this.deviceAppInfo&&(i.deviceAppInfo=this.deviceAppInfo),this.addEventToPool(e,n,i)},e.prototype.playing=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Started",currentTime:t};if(this.customAttributes){var r=Object.keys(this.customAttributes);r.length&&r.length>0&&(i.attributes=this.customAttributes)}this.addEventToPool(e,n,i),this.changeSessionState(e,"PLAYING")},e.prototype.paused=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Paused",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.seek=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"ScrubbedTo",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.programChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"ProgramChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.startCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"StartCasting",currentTime:t};this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"DIRTY")},e.prototype.stopCasting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"StopCasting",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.setCurrentTime=function(e,t){this.eventPool[e]&&(this.eventPool[e].currentTime=t)},e.prototype.handshake=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"HandshakeStarted"};this.addEventToPool(e,i,t)},e.prototype.resume=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Resumed",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.bitrateChanged=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BitrateChanged",currentTime:t};this.addEventToPool(e,n,i,!0)},e.prototype.endOfStream=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i={type:"Completed"};this.addEventToPool(e,i,t,!0),this.changeSessionState(e,"FINISHED")},e.prototype.error=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Error",currentTime:t};this.changeSessionState(e,"DIRTY"),this.addEventToPool(e,n,i)},e.prototype.dispose=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"Aborted"};t&&(n.currentTime=t),this.addEventToPool(e,n,i,!0),this.changeSessionState(e,"FINISHED")},e.prototype.waiting=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BufferingStarted",currentTime:t};this.addEventToPool(e,n,i)},e.prototype.waitingEnded=function(e,t){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n={type:"BufferingEnded",currentTime:t};this.addEventToPool(e,n,i)},e.prototype.getSessionState=function(e){return this.eventPool[e]?this.eventPool[e].currentState||"IDLE":"IDLE"},e.prototype.dispatchNow=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.cycle(e,!0)},e.prototype.exitOngoingSession=function(e){var t=this;Object.keys(this.eventPool).map(function(i){t.eventPool[i]&&t.dispose(i,e)})},e.prototype.setCustomAttribute=function(e,t){this.customAttributes||this.resetAnalyticsCustomAttributes(),this.customAttributes[e]=t},e.prototype.clearCustomAttributes=function(){this.customAttributes={}},e.prototype.removeSession=function(e){if(!0===(!(arguments.length<=1||void 0===arguments[1])&&arguments[1]))delete this.eventPool[e];else{var t=this.eventPool[e];t&&(t.currentState="REMOVED")}},e.prototype.hasDataToSend=function(){for(var e=Object.keys(this.eventPool),t=0;t<e.length;++t)if(this.eventPool[e[t]].events.length>0)return!0;return!1},e.prototype.sendData=function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0],i=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!this.pendingRequest_){var n=!1;this.pendingRequest_=!0;var r=void 0;r="undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?p.setTimeout(function(){e.pendingRequest_=!1,r=void 0},2*this.EVENT_PURGE_TIME_DEFAULT):setTimeout(function(){e.pendingRequest_=!1,r=void 0},2*this.EVENT_PURGE_TIME_DEFAULT);Object.keys(this.eventPool).map(function(o){var s=e.eventPool[o];if(s){if(!o)return s.events=[],void e.removeSession(o,!0);if("PLAYING"===s.currentState&&0===s.events.length&&i&&s.events.push({EventType:"Playback.Heartbeat",Timestamp:(new Date).getTime(),OffsetTime:Math.floor(1e3*s.currentTime)}),"IDLE"!==s.currentState&&"REMOVED"!==s.currentState){if(0===s.events.length)return void("FINISHED"===s.currentState&&e.removeSession(o));var a={DispatchTime:(new Date).getTime(),Customer:e.customer_,BusinessUnit:e.businessUnit_,Payload:s.events,SessionId:o,ClockOffset:s.clockOffset};if(e.debugLog("Sending analytics - sessionId: "+o+" and params: ",a),s.retries>e.MAX_RETRIES||!0===s.forbidden)return void(s.events=[]);Math.abs(e.communicationCurrentDate-e.lastCommunicationDate)>e.DEVICE_CLOCK_CHECK_THRESHOLD&&e.initRequest(o),n=!0,e.sendRequest(t,a,function(t,i){if(r)try{"undefined"!=typeof Worker&&!0!==e.props_.disableWebWorkers?(p.clearTimeout(r),r=void 0):(clearTimeout(r),r=void 0)}catch(e){}e.pendingRequest_=!1;var n=t&&t.httpCode?t.httpCode:200;void 0!==i||200!==n?(401===n&&(s.forbidden=!0),e.debugLog("Error sending request to backend",i),s.retries++):(s.events=[],s.retries=0,"FINISHED"===s.currentState&&e.removeSession(o))})}}}),n||(this.pendingRequest_=!1)}},e.prototype.cycle=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.communicationCurrentDate=new Date,this.communicationCurrentTime+=this.CYCLE_TIME,this.hasDataToSend()?(t||this.lastCommunicationTime+this.EVENT_PURGE_TIME_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate):(t||this.lastCommunicationTime+this.TIME_WITHOUT_BEAT_DEFAULT<this.communicationCurrentTime)&&(this.sendData(e,!0),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate)},e.prototype.sendRequest=function(e,t,i){var n=new XMLHttpRequest;n.open("POST",this.serverURL_+"/eventsink/send",e),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Authorization","Bearer "+this.sessionToken_),n.onload=function(){var e=JSON.parse(this.responseText);i(e)},n.onerror=function(e){i(null,e)},n.send(JSON.stringify(t))},e.prototype.initRequest=function(e,t,i){var n=this,r=(new Date).getTime(),o=new XMLHttpRequest;o.open("POST",this.serverURL_+"/eventsink/init",!0),o.setRequestHeader("Content-type","application/json"),o.setRequestHeader("Authorization","Bearer "+this.sessionToken_),o.onload=function(){var i=(new Date).getTime(),s=JSON.parse(o.responseText);n.determineClockOffset(e,s,r,i),s&&s.settings&&(s.settings,s.settings.includeDeviceMetrics&&(n.includeDeviceMetrics_=!!s.settings.includeDeviceMetrics)),t&&t()},o.onerror=function(e){n.debugLog("Unable to init. Aborting."),i&&i()};var s={Customer:this.customer_,BusinessUnit:this.businessUnit_,SessionId:e};o.send(JSON.stringify(s))},e.prototype.debugLog=function(e,t){t=t||"",this.debug_},e.prototype.addDeviceInfoEvent=function(e){var t=this.eventPool[e];if(this.includeDeviceMetrics_&&t&&t.events&&t.events.length){var i={Timestamp:(new Date).getTime(),EventType:"Device.Info",DeviceModel:this.deviceInfoData_.deviceModel||"Desktop",UserAgent:this.deviceInfoData_.userAgent||a.default.navigator.userAgent,Height:this.deviceInfoData_.screenHeight||a.default.screen.height,Width:this.deviceInfoData_.screenWidth||a.default.screen.width,Model:this.deviceInfoData_.model||a.default.navigator.appName,Name:this.deviceInfoData_.deviceName||a.default.navigator.product,OS:this.deviceInfoData_.deviceOS||c.default.os.family,OSVersion:this.deviceInfoData_.deviceOSVersion||c.default.os.version,Type:this.deviceInfoData_.type||"WEB"};(this.deviceInfoData_.deviceManufacturer||c.default.manufacturer)&&(i.Manufacturer=this.deviceInfoData_.deviceManufacturer||c.default.manufacturer),this.deviceInfoData_.deviceId&&(i.DeviceId=this.deviceInfoData_.deviceId),t.events.push(i)}},e.prototype.determineClockOffset=function(e,t,i,n){var r=this.eventPool[e];r&&(r.clockOffset=Math.floor((n-t.repliedTime+i-t.receivedTime)/2))},e.prototype.createPool=function(e){var t=this;this.eventPool[e]={currentState:"IDLE",currentTime:0,clockOffset:0,events:[],retries:0,forbidden:!1},this.initRequest(e,function(){return t.addDeviceInfoEvent(e)})},e.prototype.addEventToPool=function(e,t,i){if(arguments.length<=3||void 0===arguments[3]||!arguments[3]||!this.eventPool[e]||"FINISHED"!==this.eventPool[e].currentState&&"REMOVED"!==this.eventPool[e].currentState){this.eventPool[e]||this.createPool(e);var n=this.eventsSkeleton[t.type];if(!n)return void this.debugLog("Unknown playback event: ",t);var r={Timestamp:(new Date).getTime(),EventType:"Playback."+n.event};n.includeOffset&&(r.OffsetTime=Math.floor(1e3*t.currentTime)),n.attributes&&"function"==typeof n.attributes&&(r=this.objectAssign(r,n.attributes(i))),this.eventPool[e].events.push(r),this.debugLog("added "+n.event+" to queue")}},e.prototype.changeSessionState=function(e,t){this.eventPool[e]||this.createPool(e),this.eventPool[e].currentState=t},e.prototype.initEventSkeleton=function(){var e={};return e.Completed={event:"Completed",autoListener:!1},e.PlayerReady={event:"PlayerReady",autoListener:!1,attributes:function(e){var t={Technology:e.techName,PlayerVersion:e.version};return e.techVersion&&(t.TechVersion=e.techVersion),e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.Resumed={event:"Resumed",autoListener:!1,includeOffset:!0},e.BufferingStarted={event:"BufferingStarted",includeOffset:!0},e.BufferingEnded={event:"BufferingEnded",includeOffset:!0},e.ScrubbedTo={event:"ScrubbedTo",includeOffset:!0},e.Created={event:"Created",attributes:function(e){var t={};return void 0!==e.autoplay&&(t.AutoPlay=e.autoplay),e.techName&&(t.Technology=e.techName),e.player&&(t.Player=e.player),e.version&&(t.Version=e.version),e.techVersion&&(t.TechVersion=e.techVersion),e.deviceAppInfo&&(t.DeviceAppInfo=e.deviceAppInfo),e.playMode&&(t.PlayMode=e.playMode),t}},e.StartCasting={event:"StartCasting",includeOffset:!0},e.StopCasting={event:"StopCasting",includeOffset:!0},e.Paused={event:"Paused",includeOffset:!0},e.BitrateChanged={event:"BitrateChanged",includeOffset:!0,attributes:function(e){return{Bitrate:e.bitrate}}},e.Error={event:"Error",includeOffset:!0,attributes:function(e){var t={};return e.errorCode&&(t.Code=e.errorCode),e.errorMessage?t.Message=e.errorMessage:t.Message="Unknown Error",t}},e.HandshakeStarted={event:"HandshakeStarted",autoListener:!1,attributes:function(e){if(!e.assetId)return{};var t={AssetId:e.assetId};return e.programId&&(t.ProgramId=e.programId),t}},e.ProgramChanged={event:"ProgramChanged",includeOffset:!0,autoListener:!1,attributes:function(e){return e.programId?{ProgramId:e.programId}:{}}},e.Aborted={event:"Aborted",autoListener:!1,includeOffset:!0},e.Started={event:"Started",autoListener:!1,includeOffset:!0,attributes:function(e){var t={};if(e.bitrate&&(t.Bitrate=e.bitrate),e.duration&&(t.VideoLength=1e3*e.duration),e.mediaLocator){var i=e.mediaLocator.split("?");t.MediaLocator=i[0]}return e.attributes&&(t.Attributes=e.attributes),e.referenceTime&&(t.ReferenceTime=e.referenceTime),e.playMode&&(t.PlayMode=e.playMode),t}},e},e.prototype.objectAssign=function(e,t){for(var i,n,r=1;r<arguments.length;++r){n=arguments[r];for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o(e,[{key:"debug",get:function(){return this.debug_},set:function(e){this.debug_=e}},{key:"deviceAppInfo",get:function(){return this.deviceInfoData_?this.deviceInfoData_.deviceAppInfo:null}}]),e}();i.default=h,t.exports=i.default},{"./platform":5,"global/window":1,"worker-timers":3}],5:[function(e,i,n){(function(e){"use strict";(function(){function r(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function o(e,t,i){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"7 / Server 2008 R2","6.0":"Vista / Server 2008",5.2:"XP 64-bit / Server 2003",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&i&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&i&&(e=e.replace(RegExp(t,"i"),i)),e=a(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function s(e,t){var i=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=E)for(;++i<n;)t(e[i],i,e);else l(e,t)}function a(e){return e=d(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:r(e)}function l(e,t){for(var i in e)A.call(e,i)&&t(e[i],i,e)}function c(e){return null==e?r(e):w.call(e).slice(8,-1)}function u(e,t){var i=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!e[t])}function p(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function h(e,t){var i=null;return s(e,function(n,r){i=t(i,n,r,e)}),i}function d(e){return String(e).replace(/^ +| +$/g,"")}function m(e){function t(t){return h(t,function(t,i){var n=i.pattern||p(i);return!t&&(t=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(n,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=a(t[0].replace(RegExp(n,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function i(){return this.description||""}var n=g,r=e&&"object"==typeof e&&"String"!=c(e);r&&(n=e,e=null);var s=n.navigator||{},f=s.userAgent||"";e||(e=f);var v,T,_=r||b==y,E=r?!!s.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(w.toString()),C="Object",A=r?C:"ScriptBridgingProxyObject",P=r?C:"Environment",I=r&&n.java?"JavaPackage":c(n.java),x=r?C:"RuntimeObject",k=/\bJava/.test(I)&&n.java,O=k&&c(n.environment)==P,D=k?"a":"",L=k?"b":"",N=n.document||{},R=n.operamini||n.opera,M=S.test(M=r&&R?R["[[Class]]"]:c(R))?M:R=null,B=e,G=[],U=null,F=e==f,H=F&&R&&"function"==typeof R.version&&R.version(),j=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||p(i))+"\\b","i").exec(e)&&(i.label||i)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),V=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||p(i))+"\\b","i").exec(e)&&(i.label||i)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox Mobile",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),W=t([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),K=function(t){return h(t,function(t,i,n){return t||(i[W]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(W)]||RegExp("\\b"+p(n)+"(?:\\b|\\w*\\d)","i").exec(e))&&n})}({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),q=function(t){return h(t,function(t,i){var n=i.pattern||p(i);return!t&&(t=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=o(t,n,i.label||i)),t})}(["Windows Phone ","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(j&&(j=[j]),K&&!W&&(W=t([K])),(v=/\bGoogle TV\b/.exec(W))&&(W=v[0]),/\bSimulator\b/i.test(e)&&(W=(W?W+" ":"")+"Simulator"),"Opera Mini"==V&&/\bOPiOS\b/.test(e)&&G.push("running in Turbo/Uncompressed mode"),/^iP/.test(W)?(V||(V="Safari"),q="iOS"+((v=/ OS ([\d_]+)/i.exec(e))?" "+v[1].replace(/_/g,"."):"")):"Konqueror"!=V||/buntu/i.test(q)?K&&"Google"!=K&&(/Chrome/.test(V)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(W))?(V="Android Browser",q=/\bAndroid\b/.test(q)?q:"Android"):"Silk"==V?(/\bMobi/i.test(e)||(q="Android",G.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&G.unshift("accelerated")):"PaleMoon"==V&&(v=/\bFirefox\/([\d.]+)\b/.exec(e))?G.push("identifying as Firefox "+v[1]):"Firefox"==V&&(v=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(q||(q="Firefox OS"),W||(W=v[1])):V&&!(v=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(V))||(V&&!W&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(v+"/")+8))&&(V=null),(v=W||K||q)&&(W||K||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(q))&&(V=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(q)?q:v)+" Browser")):q="Kubuntu",H||(H=function(t){return h(t,function(t,i){return t||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",p(V),"(?:Firefox|Minefield|NetFront)"])),(v="iCab"==j&&parseFloat(H)>3&&"WebKit"||/\bOpera\b/.test(V)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(j)&&"WebKit"||!j&&/\bMSIE\b/i.test(e)&&("Mac OS"==q?"Tasman":"Trident")||"WebKit"==j&&/\bPlayStation\b(?! Vita\b)/i.test(V)&&"NetFront")&&(j=[v]),"IE"==V&&(v=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(V+=" Mobile",q="Windows Phone "+(/\+$/.test(v)?v:v+".x"),G.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(V="IE Mobile",q="Windows Phone 8.x",G.unshift("desktop mode"),H||(H=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=V&&"Trident"==j&&(v=/\brv:([\d.]+)/.exec(e))&&(V&&G.push("identifying as "+V+(H?" "+H:"")),V="IE",H=v[1]),F){if(u(n,"global"))if(k&&(v=k.lang.System,B=v.getProperty("os.arch"),q=q||v.getProperty("os.name")+" "+v.getProperty("os.version")),_&&u(n,"system")&&(v=[n.system])[0]){q||(q=v[0].os||null);try{v[1]=n.require("ringo/engine").version,H=v[1].join("."),V="RingoJS"}catch(e){v[0].global.system==n.system&&(V="Narwhal")}}else"object"==typeof n.process&&(v=n.process)?(V="Node.js",B=v.arch,q=v.platform,H=/[\d.]+/.exec(v.version)[0]):O&&(V="Rhino");else c(v=n.runtime)==A?(V="Adobe AIR",q=v.flash.system.Capabilities.os):c(v=n.phantom)==x?(V="PhantomJS",H=(v=v.version||null)&&v.major+"."+v.minor+"."+v.patch):"number"==typeof N.documentMode&&(v=/\bTrident\/(\d+)/i.exec(e))&&(H=[H,N.documentMode],(v=+v[1]+4)!=H[1]&&(G.push("IE "+H[1]+" mode"),j&&(j[1]=""),H[1]=v),H="IE"==V?String(H[1].toFixed(1)):H[0]);q=q&&a(q)}H&&(v=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(H)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(F&&s.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(U=/b/i.test(v)?"beta":"alpha",H=H.replace(RegExp(v+"\\+?$"),"")+("beta"==U?L:D)+(/\d+\+?/.exec(v)||"")),"Fennec"==V||"Firefox"==V&&/\b(?:Android|Firefox OS)\b/.test(q)?V="Firefox Mobile":"Maxthon"==V&&H?H=H.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(W)?(q=null,"Xbox 360"==W&&/\bIEMobile\b/.test(e)&&G.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(V)&&(!V||W||/Browser|Mobi/.test(V))||"Windows CE"!=q&&!/Mobi/i.test(e)?"IE"==V&&F&&null===n.external?G.unshift("platform preview"):(/\bBlackBerry\b/.test(W)||/\bBB10\b/.test(e))&&(v=(RegExp(W.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||H)?(v=[v,/BB10/.test(e)],q=(v[1]?(W=null,K="BlackBerry"):"Device Software")+" "+v[0],H=null):this!=l&&"Wii"!=W&&(F&&R||/Opera/.test(V)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==V&&/\bOS X (?:\d+\.){2,}/.test(q)||"IE"==V&&(q&&!/^Win/.test(q)&&H>5.5||/\bWindows XP\b/.test(q)&&H>8||8==H&&!/\bTrident\b/.test(e)))&&!S.test(v=m.call(l,e.replace(S,"")+";"))&&v.name&&(v="ing as "+v.name+((v=v.version)?" "+v:""),S.test(V)?(/\bIE\b/.test(v)&&"Mac OS"==q&&(q=null),v="identify"+v):(v="mask"+v,V=M?a(M.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(v)&&(q=null),F||(H=null)),j=["Presto"],G.push(v)):V+=" Mobile",(v=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(v=[parseFloat(v.replace(/\.(\d)$/,".0$1")),v],"Safari"==V&&"+"==v[1].slice(-1)?(V="WebKit Nightly",U="alpha",H=v[1].slice(0,-1)):H!=v[1]&&H!=(v[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(H=null),v[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==v[0]&&537.36==v[2]&&parseFloat(v[1])>=28&&"WebKit"==j&&(j=["Blink"]),F&&(E||v[1])?(j&&(j[1]="like Chrome"),v=v[1]||(v=v[0],v<530?1:v<532?2:v<532.05?3:v<533?4:v<534.03?5:v<534.07?6:v<534.1?7:v<534.13?8:v<534.16?9:v<534.24?10:v<534.3?11:v<535.01?12:v<535.02?"13+":v<535.07?15:v<535.11?16:v<535.19?17:v<536.05?18:v<536.1?19:v<537.01?20:v<537.11?"21+":v<537.13?23:v<537.18?24:v<537.24?25:v<537.36?26:"Blink"!=j?"27":"28")):(j&&(j[1]="like Safari"),v=v[0],v=v<400?1:v<500?2:v<526?3:v<533?4:v<534?"4+":v<535?5:v<537?6:v<538?7:v<601?8:"8"),j&&(j[1]+=" "+(v+="number"==typeof v?".x":/[.+]/.test(v)?"":"+")),"Safari"==V&&(!H||parseInt(H)>45)&&(H=v)),"Opera"==V&&(v=/\bzbov|zvav$/.exec(q))?(V+=" ",G.unshift("desktop mode"),"zvav"==v?(V+="Mini",H=null):V+="Mobile",q=q.replace(RegExp(" *"+v+"$"),"")):"Safari"==V&&/\bChrome\b/.exec(j&&j[1])&&(G.unshift("desktop mode"),V="Chrome Mobile",H=null,/\bOS X\b/.test(q)?(K="Apple",q="iOS 4.3+"):q=null),H&&0==H.indexOf(v=/[\d.]+$/.exec(q))&&e.indexOf("/"+v+"-")>-1&&(q=d(q.replace(v,""))),j&&!/\b(?:Avant|Nook)\b/.test(V)&&(/Browser|Lunascape|Maxthon/.test(V)||"Safari"!=V&&/^iOS/.test(q)&&/\bSafari\b/.test(j[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(V)&&j[1])&&(v=j[j.length-1])&&G.push(v),G.length&&(G=["("+G.join("; ")+")"]),K&&W&&W.indexOf(K)<0&&G.push("on "+K),W&&G.push((/^on /.test(G[G.length-1])?"":"on ")+W),
q&&(v=/ ([\d.+]+)$/.exec(q)||(T=/^[a-z]+ ([\d.+]+) \//i.exec(q)),q={architecture:32,family:v&&!T?q.replace(v[0],""):q,version:v?v[1]:null,toString:function(){var e=this.version;return this.family+(e&&!T?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(v=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(B))&&!/\bi686\b/i.test(B)&&(q&&(q.architecture=64,q.family=q.family.replace(RegExp(" *"+v),"")),V&&(/\bWOW64\b/i.test(e)||F&&/\w(?:86|32)$/.test(s.cpuClass||s.platform)&&!/\bWin64; x64\b/i.test(e))&&G.unshift("32-bit")),e||(e=null);var Y={};return Y.description=e,Y.layout=j&&j[0],Y.manufacturer=K,Y.name=V,Y.prerelease=U,Y.product=W,Y.ua=e,Y.version=V&&H,Y.os=q||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=m,Y.toString=i,Y.version&&G.unshift(H),Y.name&&G.unshift(V),q&&V&&(q!=String(q).split(" ")[0]||q!=V.split(" ")[0]&&!W)&&G.push(W?"("+q+")":"on "+q),G.length&&(Y.description=G.join(" ")),Y}var f={function:!0,object:!0},g=f[typeof window]&&window||this,y=g,v=f[typeof n]&&n,T=f[typeof i]&&i&&!i.nodeType&&i,_=v&&T&&"object"==typeof e&&e;!_||_.global!==_&&_.window!==_&&_.self!==_||(g=_);var E=Math.pow(2,53)-1,S=/\bOpera/,b=this,C=Object.prototype,A=C.hasOwnProperty,w=C.toString;"function"==typeof t&&"object"==typeof t.amd&&t.amd?t(function(){return m()}):v&&T?l(m(),function(e,t){v[t]=e}):g.platform=m()}).call(void 0)}).call(this,void 0!==X?X:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[4])(4)}()}()}),Ai=t(Ci),wi=$.empAnalytics?$.empAnalytics:Ai,Pi=Z.getPlugin("plugin"),Ii=function(e){function t(i,n){ee(this,t);var r=ne(this,e.call(this,i,n));return pe("AnalyticsPlugin","create"),r.analyticsConnector_=null,r.options_=n,r.onLoadStartBind=r.onLoadStart_.bind(r),r.player.on(oe.LOAD_START,r.onLoadStartBind),r}return ie(t,e),t.prototype.stop=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.dispose(),this.analyticsConnector_=null)},t.prototype.dispose=function(){pe("AnalyticsPlugin","dispose"),this.player.off(oe.LOAD_START,this.onLoadStartBind),this.stop(),e.prototype.dispose.call(this)},t.prototype.options=function(e){if(!e)return this.options_;this.options_=e},t.prototype.newAnalytics=function(e){pe("new EMPAnalytics");var t=new wi(e.exposureApiURL,e.customer,e.businessUnit,e.sessionToken,e.userId,this.options_.analytics&&this.options_.analytics.deviceInfo);this.stop(),pe("new EMPAnalyticsConnector"),this.analyticsConnector_=new bi(this.player,t,this.options_)},t.prototype.onEntitlementLoadStart=function(){this.analyticsConnector_&&this.analyticsConnector_.onEntitlementLoadStart()},t.prototype.onError=function(e){this.analyticsConnector_&&this.analyticsConnector_.onError(e)},t.prototype.onWindowUnload=function(){this.analyticsConnector_&&this.analyticsConnector_.onWindowUnload()},t.prototype.onLoadStart_=function(e){ke.getEntitlement(this.player)||this.stop()},te(t,[{key:"connector",get:function(){return this.analyticsConnector_}}]),t}(Pi);Ii.VERSION="2.0.84-89",Z.getPlugin("analytics")?Z.log.warn('A plugin named "analytics" already exists.'):Z.registerPlugin("analytics",Ii);var xi=Z;return xi.canPlayUnencrypted=L,xi.canPlayEncrypted=N,xi.getExposure=Si.getExposure,xi.getEntitlementEngine=Si.getEntitlementEngine,xi.registerEntitlementEngine=Si.registerEntitlementEngine,xi.isEntitlementEngine=Si.isEntitlementEngine,xi.EntitlementClass=Si.EntitlementClass,xi.log=pe,xi.plugin=Z.plugin,xi.videojs=Z,xi.EntitlementMiddleware=Si,xi.extend=Z.extend,xi.Events=oe,xi.VERSION="2.0.84-89","function"==typeof define&&define.amd?define("empPlayer",[],function(){return xi}):"object"===("undefined"==typeof exports?"undefined":Q(exports))&&"object"===("undefined"==typeof module?"undefined":Q(module))&&(module.exports=xi),xi});
