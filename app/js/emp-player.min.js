!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.empPlayer=factory()}(this,function(){function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}function each(object,fn){keys(object).forEach(function(key){return fn(object[key],key)})}function reduce(object,fn){var initial=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return keys(object).reduce(function(accum,key){return fn(accum,object[key],key)},initial)}function assign(target){for(var _len=arguments.length,sources=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];return Object.assign?Object.assign.apply(Object,[target].concat(sources)):(sources.forEach(function(source){source&&each(source,function(value,key){target[key]=value})}),target)}function isObject(value){return!!value&&"object"===(void 0===value?"undefined":_typeof(value))}function isEmpty(value){return 0===keys(value).length}function isString(val){return"string"==typeof val||!!val&&"object"===(void 0===val?"undefined":_typeof(val))&&"[object String]"===Object.prototype.toString.call(val)}function parseSrc(src){var asset={assetId:void 0,programId:void 0,channelId:void 0};try{asset=JSON.parse(src)}catch(e){asset.assetId=src}return asset.channelId&&(asset.assetId=asset.channelId),asset}function filterSource(src){if(Array.isArray(src)){var newsrc=[];src.forEach(function(srcobj){srcobj=filterSource(srcobj),Array.isArray(srcobj)?newsrc=newsrc.concat(srcobj):isObject(srcobj)&&newsrc.push(srcobj)}),src=newsrc}else src="string"==typeof src&&src.trim()?[{src:src}]:isObject(src)&&"string"==typeof src.src&&src.src&&src.src.trim()?[src]:[];return src}function getParameterByName(name,url){name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}function _log(type,args){var argsArray=Array.prototype.slice.call(args),noop=function(){},console=window_1.console||{log:noop,warn:noop,error:noop,trace:noop};type?argsArray.unshift(type.toUpperCase()+":"):type="log",argsArray.unshift("EMPPlayer:"),console[type].apply?console[type].apply(console,argsArray):console[type](argsArray.join(" "))}function newGUID(){return _guid++}function clean(s){return s.replace(/\n\r?\s*/g,"")}function computedStyle(el,prop){if(!el||!prop)return"";if("function"==typeof window_1.getComputedStyle){var cs=window_1.getComputedStyle(el);return cs?cs[prop]:""}return el.currentStyle[prop]||""}function isEl(value){return isObject(value)&&1===value.nodeType}function createEl(){var tagName=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",properties=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},content=arguments[3],el=document_1.createElement(tagName);return Object.getOwnPropertyNames(properties).forEach(function(propName){var val=properties[propName];-1!==propName.indexOf("aria-")||"role"===propName||"type"===propName?(log$1.warn(tsml(_templateObject,propName,val)),el.setAttribute(propName,val)):"textContent"===propName?textContent(el,val):el[propName]=val}),Object.getOwnPropertyNames(attributes).forEach(function(attrName){el.setAttribute(attrName,attributes[attrName])}),content&&appendContent(el,content),el}function textContent(el,text){return void 0===el.textContent?el.innerText=text:el.textContent=text,el}function getBoundingClientRect(el){if(el&&el.getBoundingClientRect&&el.parentNode){var rect=el.getBoundingClientRect(),result={};return["bottom","height","left","right","top","width"].forEach(function(k){void 0!==rect[k]&&(result[k]=rect[k])}),result.height||(result.height=parseFloat(computedStyle(el,"height"))),result.width||(result.width=parseFloat(computedStyle(el,"width"))),result}}function isTextNode(value){return isObject(value)&&3===value.nodeType}function normalizeContent(content){return"function"==typeof content&&(content=content()),(Array.isArray(content)?content:[content]).map(function(value){return"function"==typeof value&&(value=value()),isEl(value)||isTextNode(value)?value:"string"==typeof value&&/\S/.test(value)?document_1.createTextNode(value):void 0}).filter(function(value){return value})}function appendContent(el,content){return normalizeContent(content).forEach(function(node){return el.appendChild(node)}),el}function formatTime(seconds){var guide=arguments.length>1&&void 0!==arguments[1]?arguments[1]:seconds;seconds=seconds<0?0:seconds;var s=Math.floor(seconds%60),m=Math.floor(seconds/60%60),h=Math.floor(seconds/3600),gm=Math.floor(guide/60%60),gh=Math.floor(guide/3600);return(isNaN(seconds)||seconds===1/0)&&(h=m=s="-"),h=h>0||gh>0?h+":":"",m=((h||gm>=10)&&m<10?"0"+m:m)+":",s=s<10?"0"+s:s,h+m+s}function detectClient(){var tem,ua=navigator.userAgent,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([0-9.]+)/i)||[];if(/trident/i.test(M[1]))return tem=/\brv[ :]+([0-9.]+)/g.exec(ua)||[],{name:"Explorer",version:tem[1]||""};if("Chrome"===M[1]&&null!=(tem=ua.match(/\b(OPR|Edge)\/([0-9.]+)/))){var app=tem.slice(1).toString().split(",");return{name:app[0].replace("OPR","Opera"),version:app[1]}}return M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(tem=ua.match(/version\/([0-9.]+)/i))&&M.splice(1,1,tem[1]),{name:M[0],version:M[1]}}function isPromise(value){return void 0!==value&&"function"==typeof value.then}function silencePromise(value){isPromise(value)&&value.then(null,function(e){})}function createTimeRanges(start,end){return Array.isArray(start)?createTimeRangesObj(start):void 0===start||void 0===end?createTimeRangesObj():createTimeRangesObj([[start,end]])}function createTimeRangesObj(ranges){return void 0===ranges||0===ranges.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:ranges.length,start:getRange.bind(null,"start",0,ranges),end:getRange.bind(null,"end",1,ranges)}}function getRange(fnName,valueIndex,ranges,rangeIndex){return void 0===rangeIndex&&(log.warn("DEPRECATED: Function '"+fnName+"' on 'TimeRanges' called without an index argument."),rangeIndex=0),rangeCheck(fnName,rangeIndex,ranges.length-1),ranges[rangeIndex][valueIndex]}function rangeCheck(fnName,index,maxIndex){if(index<0||index>maxIndex)throw new Error("Failed to execute '"+fnName+"' on 'TimeRanges': The index provided ("+index+") is greater than or equal to the maximum bound ("+maxIndex+").")}function constructColor(color,opacity){return"rgba("+parseInt(color[1]+color[1],16)+","+parseInt(color[2]+color[2],16)+","+parseInt(color[3]+color[3],16)+","+opacity+")"}function parseOptionValue(value,parser){if(parser&&(value=parser(value)),value&&"none"!==value)return value}function getSelectedOptionValue(el,parser){return parseOptionValue(el.options[el.options.selectedIndex].value,parser)}function setSelectedOption(el,value,parser){if(value)for(var i=0;i<el.options.length;i++)if(parseOptionValue(el.options[i].value,parser)===value){el.selectedIndex=i;break}}function MediaError(value){if(value instanceof MediaError)return value;"number"==typeof value?this.code=value:"string"==typeof value?this.message=value:isObject(value)&&("number"==typeof value.code&&(this.code=value.code),value.message&&(this.message=value.message),value.status&&(this.status=value.status),assign(this,value)),this.message||(this.message=MediaError.defaultMessages[this.code]||"")}function canPlayUnencrypted(){var shakaTech=videojs$1.getTech("EmpShaka");if(void 0!==shakaTech&&shakaTech.isSupported())return Promise.resolve(!0);var dashifTech=videojs$1.getTech("EmpDashif");if(void 0!==dashifTech&&dashifTech.isSupported())return Promise.resolve(!0);var hlsTech=videojs$1.getTech("EmpHLS");if(void 0!==hlsTech&&hlsTech.isSupported())return Promise.resolve(!0);var hlsMseTech=videojs$1.getTech("EmpHLS-MSE");return void 0!==hlsMseTech&&hlsMseTech.isSupported()?Promise.resolve(!0):Promise.resolve(!1)}function canPlayEncrypted(){var ptable=[];if("function"==typeof window_1.navigator.requestMediaKeySystemAccess){var isAndroid=-1!==window_1.navigator.userAgent.indexOf("Android"),config=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:!0===isAndroid?"SW_SECURE_DECODE":"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}],shakaTech=videojs$1.getTech("EmpShaka"),dashifTech=videojs$1.getTech("EmpDashif");(void 0!==shakaTech&&shakaTech.isSupported()||void 0!==dashifTech&&dashifTech.isSupported())&&(ptable.push(new Promise(function(resolve,reject){window_1.navigator.requestMediaKeySystemAccess("com.microsoft.playready",config).then(function(){resolve(!0)},function(){resolve(!1)})})),ptable.push(new Promise(function(resolve,reject){window_1.navigator.requestMediaKeySystemAccess("com.widevine.alpha",config).then(function(){resolve(!0)},function(){resolve(!1)})})))}var hlsTech=videojs$1.getTech("EmpHLS");return void 0!==hlsTech&&hlsTech.isSupported()&&window_1.WebKitMediaKeys&&hlsTech.getKeySystem&&window_1.WebKitMediaKeys.isTypeSupported(hlsTech.getKeySystem(),"video/mp4")&&ptable.push(!0),0===ptable.length&&ptable.push(!1),Promise.all(ptable).then(function(values){return-1!==values.indexOf(!0)},function(reason){return!1})}function isFunction(fn){var string=toString$1.call(fn);return"[object Function]"===string||"function"==typeof fn&&"[object RegExp]"!==string||"undefined"!=typeof window&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)}function forEach(list,iterator,context){if(!isFunction_1(iterator))throw new TypeError("iterator must be a function");arguments.length<3&&(context=this),"[object Array]"===toString$2.call(list)?forEachArray$1(list,iterator,context):"string"==typeof list?forEachString(list,iterator,context):forEachObject(list,iterator,context)}function forEachArray$1(array,iterator,context){for(var i=0,len=array.length;i<len;i++)hasOwnProperty.call(array,i)&&iterator.call(context,array[i],i,array)}function forEachString(string,iterator,context){for(var i=0,len=string.length;i<len;i++)iterator.call(context,string.charAt(i),i,string)}function forEachObject(object,iterator,context){for(var k in object)hasOwnProperty.call(object,k)&&iterator.call(context,object[k],k,object)}function extend(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty$1.call(source,key)&&(target[key]=source[key])}return target}function isEmpty$1(obj){for(var i in obj)if(obj.hasOwnProperty(i))return!1;return!0}function initParams(uri,options,callback){var params=uri;return isFunction_1(options)?(callback=options,"string"==typeof uri&&(params={uri:uri})):params=immutable(options,{uri:uri}),params.callback=callback,params}function createXHR(uri,options,callback){return options=initParams(uri,options,callback),_createXHR(options)}function _createXHR(options){function readystatechange(){4===xhr.readyState&&setTimeout(loadFunc,0)}function getBody(){var body=void 0;if(body=xhr.response?xhr.response:xhr.responseText||getXml(xhr),isJson)try{body=JSON.parse(body)}catch(e){}return body}function errorFunc(evt){return clearTimeout(timeoutTimer),evt instanceof Error||(evt=new Error(""+(evt||"Unknown XMLHttpRequest Error"))),evt.statusCode=0,callback(evt,failureResponse)}function loadFunc(){if(!aborted){var status;clearTimeout(timeoutTimer),status=options.useXDR&&void 0===xhr.status?200:1223===xhr.status?204:xhr.status;var response=failureResponse,err=null;return 0!==status?(response={body:getBody(),statusCode:status,method:method,headers:{},url:uri,rawRequest:xhr},xhr.getAllResponseHeaders&&(response.headers=parseHeaders(xhr.getAllResponseHeaders()))):err=new Error("Internal XMLHttpRequest Error"),callback(err,response,response.body)}}if(void 0===options.callback)throw new Error("callback argument missing");var called=!1,callback=function(err,response,body){called||(called=!0,options.callback(err,response,body))},xhr=options.xhr||null;xhr||(xhr=options.cors||options.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var key,aborted,timeoutTimer,uri=xhr.url=options.uri||options.url,method=xhr.method=options.method||"GET",body=options.body||options.data,headers=xhr.headers=options.headers||{},sync=!!options.sync,isJson=!1,failureResponse={body:void 0,headers:{},statusCode:0,method:method,url:uri,rawRequest:xhr};if("json"in options&&!1!==options.json&&(isJson=!0,headers.accept||headers.Accept||(headers.Accept="application/json"),"GET"!==method&&"HEAD"!==method&&(headers["content-type"]||headers["Content-Type"]||(headers["Content-Type"]="application/json"),body=JSON.stringify(!0===options.json?body:options.json))),xhr.onreadystatechange=readystatechange,xhr.onload=loadFunc,xhr.onerror=errorFunc,xhr.onprogress=function(){},xhr.onabort=function(){aborted=!0},xhr.ontimeout=errorFunc,xhr.open(method,uri,!sync,options.username,options.password),sync||(xhr.withCredentials=!!options.withCredentials),!sync&&options.timeout>0&&(timeoutTimer=setTimeout(function(){if(!aborted){aborted=!0,xhr.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",errorFunc(e)}},options.timeout)),xhr.setRequestHeader)for(key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);else if(options.headers&&!isEmpty$1(options.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in options&&(xhr.responseType=options.responseType),"beforeSend"in options&&"function"==typeof options.beforeSend&&options.beforeSend(xhr),xhr.send(body||null),xhr}function getXml(xhr){if("document"===xhr.responseType)return xhr.responseXML;var firefoxBugTakenEffect=xhr.responseXML&&"parsererror"===xhr.responseXML.documentElement.nodeName;return""!==xhr.responseType||firefoxBugTakenEffect?null:xhr.responseXML}function noop$1(){}function asyncLoop(iterations,func,callback){var index=0,done=!1,loop={next:function(){done||(index<iterations?(index++,func(loop)):(done=!0,callback()))},iteration:function(){return index-1},break:function(){done=!0,callback()}};return loop.next(),loop}var win,commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};win="undefined"!=typeof window?window:void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:{};var window_1=win,videojsTmp=window_1.videojs,videojs$1=videojsTmp,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)},possibleConstructorReturn=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call},EmpPlayerEvents=function EmpPlayerEvents(){classCallCheck(this,EmpPlayerEvents),this.ENDED="ended",this.ERROR="error",this.LOADED_DATA="loadeddata",this.TIMESHIFT_CHANGE="timeshiftchange",this.DURATION_CHANGE="durationchange",this.LOADED_METADATA="loadedmetadata",this.SEEKING="seeking",this.TIME_UPDATE="timeupdate",this.USER_ACTIVE="useractive",this.USERIN_ACTIVE="userinactive",this.VOLUME_CHANGE="volumechange",this.LOAD_START="loadstart",this.CAN_PLAY="canplay",this.PLAYING="playing",this.WAITING="waiting",this.SEEKED="seeked",this.ABORT="abort",this.PLAY="play",this.PAUSE="pause",this.DISPOSE="dispose",this.MODE_CHANGE="modechange",this.CHANGE="change",this.ADD_TRACK="addtrack",this.REMOVE_TRACK="removetrack",this.METRIC_CHANGED="metricchanged",this.RECOVERABLE_ASSET_ERROR="recoverableasseterror",this.BITRATE_CHANGED="bitratechanged",this.CLOSE="close",this.READY="ready",this.RESIZE="resize",this.TAP="tap",this.CLICK="click",this.FOCUS="focus",this.BLUR="blur",this.BEFORE_MODAL_OPEN="beforemodalopen",this.MODAL_OPEN="modalopen",this.BEFORE_MODAL_CLOSE="beforemodalclose",this.MODAL_CLOSE="modalclose",this.BEFORE_MODAL_FILL="beforemodalfill",this.MODAL_FILL="modalfill",this.BEFORE_MODAL_EMPTY="beforemodalempty",this.MODAL_EMPTY="modalempty",this.CAN_PLAY_THROUGH="canplaythrough",this.FIRST_PLAY="firstplay",this.PROGRESS="progress",this.SUSPEND="suspend",this.EMPTIED="emptied",this.STALLED="stalled",this.RATE_CHANGE="ratechange",this.TEXT_TRACK_CHANGE="texttrackchange",this.TRACK_CHANGE="trackchanged",this.POSTER_CHANGE="posterchange",this.KEY_DOWN="keydown",this.KEY_UP="keyup",this.MOUSE_DOWN="mousedown",this.MOUSE_MOVE="mousemove",this.MOUSE_UP="mouseup",this.TOUCH_START="touchstart",this.TOUCH_MOVE="touchmove",this.TOUCH_END="touchend",this.TOUCH_LEAVE="touchleave",this.TOUCH_CANCEL="touchcancel",this.FULLSCREEN_CHANGE="fullscreenchange",this.ENTER_FULL_WINDOW="enterFullWindow",this.EXIT_FULL_WINDOW="exitFullWindow",this.CONTROLS_ENABLED="controlsenabled",this.CONTROLS_DISABLED="controlsdisabled",this.USING_NATIVE_CONTROLS="usingnativecontrols",this.USING_CUSTOM_CONTROLS="usingcustomcontrols",this.SLIDER_ACTIVE="slideractive",this.SLIDER_INACTIVE="sliderinactive",this.ENTITLEMENT_CHANGE="entitlementchange",this.ENTITLEMENT_LOAD_START="entitlementloadstart",this.PLAYER_CREATED="playercreated",this.RESTARTING="restarting",this.AD_TIMELINE_CHANGED="adtimelinechanged",this.CHROMECAST_CASTING="chromecastcasting",this.CHROMECAST_STOPPED="chromecaststopped",this.STOPPED="stopped",this.READY_TO_PLAY="readytoplay",this.PROGRAM_CHANGED="programchanged",this.ASSET_CHANGED="assetchanged",this.SEGMENT_MISSING="segmentmissing",this.AIRPLAY_START="airplayStart",this.REPLAY="replay",this.DOWNLOAD_PROGRESS="downloadprogress",this.DRM_SESSION_UPDATE="drmsessionupdate"},empPlayerEvents=new EmpPlayerEvents,keys=function(object){return isObject(object)?Object.keys(object):[]},EmpPlayerErrorCodes={UNKNOWN:100,LOAD_ASSET:101,ENTITLEMENT:102,ENTITLEMENT2:103,SHAKA_TECH:200,HLS_TECH:300,FLASH_TECH:400,CHROMECAST_TECH:500,HLS_MSE_TECH:1e4,DASHIF_TECH:2e4},EmpPlayerError=function(_Error){function EmpPlayerError(value){var code=arguments.length>1&&void 0!==arguments[1]?arguments[1]:EmpPlayerErrorCodes.UNKNOWN,status=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;classCallCheck(this,EmpPlayerError);var _this=possibleConstructorReturn(this,_Error.call(this));return _this.code=code,isString(value)?_this.message=value:value.message&&(_this.message=value.message),_this.status=status,Error.captureStackTrace&&Error.captureStackTrace(_this,EmpPlayerError),_this}return inherits(EmpPlayerError,_Error),createClass(EmpPlayerError,[{key:"codes",get:function(){return EmpPlayerErrorCodes}}]),EmpPlayerError}(Error),logToBrowserConsole=!1,log_temp=function(){logToBrowserConsole&&_log(null,arguments)};window_1.EMP_DEBUG_LOG&&(log_temp=window_1.console&&window_1.console.log&&console.log.bind(console)||function(){});var log$1=log_temp;if(log$1.history=[],log$1.error=function(){_log("error",arguments)},log$1.warn=function(){_log("warn",arguments)},log$1.debug=function(){_log("debug",arguments)},window_1.EMP_DEBUG_LOG){var noop=function(){};log$1.debug=window_1.console&&window_1.console.debug&&console.debug.bind(console)||noop,log$1.warn=window_1.WARN=window_1.console&&window_1.console.warn&&console.warn.bind(console)||noop,log$1.error=window_1.ERROR=window_1.console&&window_1.console.error&&console.error.bind(console)||noop}log$1.setLogToBrowserConsole=function(){var value=arguments.length>0&&void 0!==arguments[0]&&arguments[0];logToBrowserConsole=value};var doccy,_guid=1,bind=function(context,fn,uid){fn.guid||(fn.guid=newGUID());var bound=function(){return fn.apply(context,arguments)};return bound.guid=uid?uid+"_"+fn.guid:fn.guid,bound},throttle=function(fn,wait){var last=Date.now();return function(){var now=Date.now();now-last>=wait&&(fn.apply(void 0,arguments),last=now)}},empty={},empty$1=(Object.freeze||Object)({default:empty}),minDoc=empty$1&&empty||empty$1,topLevel=void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof window?window:{};"undefined"!=typeof document?doccy=document:(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"])||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc);var document_1=doccy,MenuItem=videojs$1.getComponent("MenuItem"),Component$3=videojs$1.getComponent("Component"),BitrateMenuItem=function(_MenuItem){function BitrateMenuItem(player,options){classCallCheck(this,BitrateMenuItem);var bitrate=options.bitrate;options.label=0===bitrate?"auto":Math.max(0,Math.round(bitrate/1e3))+" kbps",options.selected=0===bitrate;var _this=possibleConstructorReturn(this,_MenuItem.call(this,player,options));return _this.bitrate=bitrate,_this.player_.on(empPlayerEvents.BITRATE_CHANGED,function(event,data){_this.el()&&(0===_this.bitrate?_this.selected(data.auto):_this.selected(!data.auto&&data.bitrate===_this.bitrate))}),_this}return inherits(BitrateMenuItem,_MenuItem),BitrateMenuItem.prototype.handleClick=function(event){this.player_.bitrate(this.bitrate)},BitrateMenuItem}(MenuItem);Component$3.registerComponent("BitrateMenuItem",BitrateMenuItem);var MenuButton=videojs$1.getComponent("MenuButton"),Component$2=videojs$1.getComponent("Component"),BitrateButton=function(_MenuButton){function BitrateButton(player,options){classCallCheck(this,BitrateButton);var _this=possibleConstructorReturn(this,_MenuButton.call(this,player,options));_this.el_.setAttribute("aria-label","Bitrate menu");_this.player_.bitrates();_this.hide();var updateHandler=bind(_this,_this.update);return _this.player_.on(empPlayerEvents.LOADED_DATA,updateHandler),_this.player_.on(empPlayerEvents.CHROMECAST_CASTING,updateHandler),_this.player_.on(empPlayerEvents.ENDED,function(){return _this.hide()}),_this.player_.on(empPlayerEvents.PLAYING,function(){_this.items&&_this.items.length>1&&"EmpHLS"!==_this.player_.techName_&&_this.show()}),_this.player_.on(empPlayerEvents.DISPOSE,function(){this.player_.on(empPlayerEvents.LOADED_DATA,updateHandler)}),_this}return inherits(BitrateButton,_MenuButton),BitrateButton.prototype.buildCSSClass=function(){return"vjs-bitrate-button "+_MenuButton.prototype.buildCSSClass.call(this)},BitrateButton.prototype.createItems=function(){var items=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],bitrates=this.player_.bitrates();if(!bitrates||1===bitrates.length||"EmpHLS"===this.player_.techName_)return this.hide(),items;bitrates.length>0&&items.push(new BitrateMenuItem(this.player_,{selectable:!0,bitrate:0}));for(var i=0;i<bitrates.length;i++){var bitrate=bitrates[i];items.push(new BitrateMenuItem(this.player_,{selectable:!0,bitrate:bitrate}))}return this.show(),items},BitrateButton}(MenuButton);BitrateButton.prototype.controlText_="Bitrate",Component$2.registerComponent("BitrateButton",BitrateButton);var tsml=function(sa){for(var s="",i=0;i<arguments.length;i++)s+=clean(sa[i])+(arguments[i+1]||"");return s},_templateObject=function(strings,raw){return strings.raw=raw,strings}(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]),extplayer={bitrates:function(player){return player.tech_&&void 0!==player.tech_.bitrates?player.techGet_("bitrates"):[]},bitrate:function(player,value){return player.tech_&&void 0!==player.tech_.bitrate?(void 0!==value&&player.techCall_("bitrate",value),player.techGet_("bitrate")):0},canRestart:function(player){return!player.tech_||void 0===player.tech_.canRestart||player.techGet_("canRestart")},restart:function(player,useLastViewedOffset,absoluteStartTime){player.currentSource()&&(player.options_.startTime=0,player.options_.absoluteStartTime=void 0,player.previousAbsoluteStartTime=void 0,player.options_.autoplay||(player.options_.autoplay=!0,player.one("play",function(){player.options_.autoplay=!1})),player.trigger(empPlayerEvents.RESTARTING),absoluteStartTime?(player.options_.absoluteStartTime=absoluteStartTime,player.options_.useLastViewedOffset=!1):player.options_.useLastViewedOffset=useLastViewedOffset,player.trigger(empPlayerEvents.REPLAY))},getSelectedAudioTrack:function(player){for(var audioTracks=player.audioTracks(),i=audioTracks.length;i--;){var track=audioTracks[i];if(track.enabled)return track.language}return null},getSelectedTextTrack:function(player){for(var textTracks=player.textTracks(),i=textTracks.length;i--;){var track=textTracks[i];if("showing"===track.mode)return track.language}return null},loadAsset:function(player,assetId,programId,channelId){var callback=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},asset={assetId:assetId||channelId,programId:programId,channelId:channelId};player.one(empPlayerEvents.LOADED_DATA,function(){callback(player.entitlement)}),player.startResetAndReloadTimer_&&player.startResetAndReloadTimer_(),player.src({type:"video/emp",src:JSON.stringify(asset)})},currentAsset:function(player,assetId,programId,channelId){if(!assetId&&!programId&&!channelId){var srcObj=player.cache_.source;if(srcObj&&srcObj.src&&"video/emp"===srcObj.type){return parseSrc(srcObj.src)}return srcObj&&srcObj.assetId?{assetId:srcObj.channelId?srcObj.channelId:srcObj.assetId,programId:srcObj.programId,channelId:srcObj.channelId}:null}if(log$1("Update currentAsset",assetId,programId,channelId),player.cache_.source&&"video/emp"===player.cache_.source.type)player.cache_.source.src=JSON.stringify({assetId:assetId,programId:programId,channelId:channelId});else if(player.cache_.source&&player.cache_.source.assetId)player.cache_.source.assetId=assetId,player.cache_.source.programId=programId,player.cache_.source.channelId=channelId;else{var _asset={assetId:assetId,programId:programId,channelId:channelId};player.cache_.source={type:"video/emp",src:JSON.stringify(_asset)}}player.cache_.sources=[player.cache_.source]},getAbsoluteTime:function(player){if(!player.tech_||void 0===player.tech_.getAbsoluteTime)return new Date(1e3*player.currentTime());var nowDate=this.getServerTime(player),value=player.tech_.getAbsoluteTime(nowDate);if("EmpCast"!==player.techName_){var entitlement=this.getEntitlement(player);value&&entitlement&&entitlement.isStaticCachupAsLive?value=new Date(value.getTime()+entitlement.streamInfo.start.getTime()):entitlement&&entitlement.isDynamicCachupAsLive&&"HLS"===player.streamType&&(value=new Date(1e3*player.tech_.baseCurrentTime()+entitlement.streamInfo.start.getTime()))}return value},getPlayheadTime:function(player){var value=this.getAbsoluteTime(player);return value?value.getTime():0},timeBehindLive:function(player){if(!player.tech_||void 0===player.tech_.timeBehindLive)return 0;var value=0,nowdate=this.getServerTime(player),entitlement=this.getEntitlement(player);return value=entitlement&&entitlement.isStaticCachupAsLive?(nowdate-this.getPlayheadTime(player))/1e3:player.tech_.timeBehindLive(nowdate),value!==1/0&&value?Math.round(value):0},liveDelay:function(player){var liveDelay=0;return this.isLive(player)&&(liveDelay=player.tech_&&void 0!==player.tech_.liveDelay?player.tech_.liveDelay():(this.getServerTime(player)-this.getSeekTimerange(player).end)/1e3),Math.round(liveDelay)},stop:function(player,afterStopCallback){player.stopProgramService&&player.stopProgramService(),player.sourceChanging_=!1,player.cache_.sources=[],player.tech_&&void 0!==player.tech_.stop?(player.techCall_("stop",afterStopCallback),player.techCall_("stopTrackingCurrentTime")):(player.techCall_("stopTrackingCurrentTime"),afterStopCallback&&afterStopCallback())},timeShiftEnabled:function(player){return!player.tech_||void 0===player.tech_.timeShiftEnabled||player.techGet_("timeShiftEnabled")},baseCurrentTime:function(player){return player.tech_&&void 0!==player.tech_.baseCurrentTime?player.techGet_("baseCurrentTime"):player.currentTime()},baseDuration:function(player){return player.tech_&&void 0!==player.tech_.duration?player.techGet_("duration"):0},startTimeLive:function(player){if(!player.tech_||void 0===player.tech_.startTimeLive)return 0;var nowdate=this.getServerTime(player),value=player.tech_.startTimeLive(nowdate),entitlement=this.getEntitlement(player);return entitlement&&entitlement.isDynamicCachupAsLive&&"HLS"===player.streamType&&(value=entitlement.streamInfo.referenceTime),entitlement&&entitlement.isStaticCachupAsLive&&"EmpCast"!==player.techName_&&(value=entitlement.streamInfo.referenceTime),value},isLive:function(player){return!(!player.tech_||void 0===player.tech_.live)&&player.techGet_("live")},isCatchupAsLive:function(player){var entitlement=this.getEntitlement(player);return!this.isLive(player)&&entitlement&&entitlement.live},getBitrate:function(player){return player.tech_&&void 0!==player.tech_.getBitrate?player.techGet_("getBitrate"):0},duration:function(player,seconds){return player.tech_&&void 0!==player.tech_.duration?(player.duration(seconds),player.techGet_("duration")):player.duration(seconds)},techVersion:function(player){return player.tech_&&void 0!==player.tech_.techVersion?player.techGet_("techVersion"):"2.x.x"},canSeekTo:function(player,position){if(!1===this.timeShiftEnabled(player)||!player.hasStarted())return!1;var entitlement=this.getEntitlement(player);return!(entitlement&&player.cache_&&!1===entitlement.ffEnabled&&player.cache_.currentTime<=position)&&!(entitlement&&player.cache_&&!1===entitlement.rwEnabled&&player.cache_.currentTime>=position)},remainingTime:function(player){if(!player.tech_||void 0===player.tech_.remainingTime){var duration=player.duration();return duration===1/0||0===duration?1/0:duration-player.currentTime()}return player.techGet_("remainingTime")},casting:function(player,sources){return!(!player.castPlugin||!player.castPlugin().canOverride("Cast"))&&(player.cache_.sources=sources,player.cache_.source=sources[0],player.castPlugin().cast(),!0)},setAbsoluteTime:function(player,date){if(!player.tech_||void 0===player.tech_.setAbsoluteTime){var seconds=(date.getTime()-new Date(0))/1e3;return void player.currentTime(seconds)}var nowDate=this.getServerTime(player);if("EmpCast"!==player.techName_){var entitlement=this.getEntitlement(player);if(entitlement&&entitlement.isStaticCachupAsLive){if(date.getTime()<entitlement.streamInfo.start.getTime())log$1("setAbsoluteTime","playPreviousProgram"),
this.playProgram(player,date),date=0;else{if(date.getTime()>=entitlement.streamInfo.end.getTime())return log$1("setAbsoluteTime","playNextProgram"),void this.playProgram(player,date);date=date.getTime()-entitlement.streamInfo.start.getTime()}return void player.techCall_("setCurrentTime",date/1e3)}if(entitlement&&entitlement.isDynamicCachupAsLive)if(date.getTime()<entitlement.streamInfo.start.getTime()){if(log$1("setAbsoluteTime","playPreviousProgram"),this.playProgram(player,date),"HLS"===player.streamType)return void player.techCall_("setCurrentTime",0);date=new Date(entitlement.streamInfo.start.getTime())}else if("HLS"===player.streamType)return date-=entitlement.streamInfo.start.getTime(),void player.techCall_("setCurrentTime",date/1e3)}player.techCall_("setAbsoluteTime",{date:date,nowDate:nowDate})},gotoLive:function(player){if(player.sourceChanging_)return void log$1("gotoLive ignore sourceChanging");if(player.tech_.gotoLive)player.techCall_("gotoLive");else{var entitlement=this.getEntitlement(player);if(entitlement&&entitlement.isDynamicCachupAsLive)this.setAbsoluteTime(player,new Date(player.getServerTime()));else if(entitlement&&entitlement.isStaticCachupAsLive){var asset=this.currentAsset(player);asset&&asset.channelId&&player.startPlayback(null,asset.channelId,null)}else if(this.isLive(player)){var duration=player.duration();player.currentTime(duration)}else log$1.warn("Not suppoted for VOD")}},setPlayheadTime:function(player,unixTime){this.setAbsoluteTime(player,new Date(unixTime))},supportsEpgProgramChange:function(player){if(player.tech_&&void 0!==player.tech_.supportsEpgProgramChange)return player.techGet_("supportsEpgProgramChange")},program:function(player){return player.tech_&&void 0!==player.tech_.program?player.techGet_("program"):null},playPreviousProgram:function(player,theEnd){if(player.sourceChanging_)return void log$1("playPreviousProgram ignore sourceChanging");player.programService&&(player.sourceChanging_=!0,player.programService().getPreviousProgram(function(program,error){if(error)player.sourceChanging_=!1,log$1.warn("playPreviousProgram",error);else{var playbackProperties={};if(theEnd){playbackProperties.playFrom="startTime";var dateTime=new Date(program.endTime);dateTime.setSeconds(dateTime.getSeconds()-30),playbackProperties.startTime=dateTime}else playbackProperties.playFrom="beginning";player.startPlayback(null,program.channelId,program.programId,playbackProperties)}}))},playNextProgram:function(player){if(player.sourceChanging_)return void log$1("playNextProgram ignore sourceChanging");player.programService&&player.programService().currentProgram&&this.getServerTime(player)>player.programService().currentProgram.end.getTime()&&(player.sourceChanging_=!0,player.programService().getNextProgram(function(program,error){if(error)player.sourceChanging_=!1,log$1.warn("playNextProgram",error);else{var playbackProperties={};playbackProperties.playFrom="beginning",player.startPlayback(null,program.channelId,program.programId,playbackProperties)}}))},playProgram:function(player,startTime){if(player.sourceChanging_)return void log$1("playProgram ignore sourceChanging");player.programService&&(player.sourceChanging_=!0,player.programService().getProgram(startTime,function(program,error){if(error)player.sourceChanging_=!1,log$1.warn("getProgram",error);else{var playbackProperties={};playbackProperties.playFrom="startTime",playbackProperties.startTime=startTime,player.startPlayback(null,program.channelId,program.programId,playbackProperties)}}))},getServerTime:function(player){return player.programService&&player.programService()&&player.programService().exposure?player.programService().exposure.getCachedServerTime():Date.now()},getEntitlement:function(player){if(player.programService)return player.programService().entitlement();if(player.tech_){var opt=player.tech_.options_;if(opt&&opt.source&&opt.source.playSessionId)return opt.source}return null},getSeekTimerange:function(player){var result={start:0,end:0};if(!player.tech_||void 0===player.tech_.seekable||player.seeking())return result;if(seekable=player.techGet_("seekable"),seekable&&seekable.length>0&&(result.start=1e3*(seekable.start(seekable.length-1)+this.startTimeLive(player)/1e3),result.end=1e3*(seekable.end(seekable.length-1)+this.startTimeLive(player)/1e3),"EmpCast"===player.techName_)){var liveDelay=this.liveDelay(player);result.end>this.getServerTime(player)-1e3*liveDelay&&(result.end=this.getServerTime(player)-1e3*liveDelay)}return result},getBufferedTimerange:function(player){var result={start:0,end:0};return!player.tech_||void 0===player.tech_.buffered||player.seeking()?result:(buffered=player.techGet_("buffered"),buffered&&buffered.length>0&&(result.start=Math.round(1e3*(buffered.start(buffered.length-1)+this.startTimeLive(player)/1e3)),result.end=Math.round(1e3*(buffered.end(buffered.length-1)+this.startTimeLive(player)/1e3))),result)},setTechProgram:function(player,program){(player.tech_||void 0!==player.tech_.program)&&player.techCall_("program",program)}},Button=videojs$1.getComponent("Button"),Component$4=videojs$1.getComponent("Component"),EmpLiveDisplay=function(_Button){function EmpLiveDisplay(player,options){classCallCheck(this,EmpLiveDisplay);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.updateShowing(),_this.on(_this.player(),empPlayerEvents.PLAYING,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.DURATION_CHANGE,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.TIME_UPDATE,function(){return _this.timeUpdate()}),_this.on(_this.player(),empPlayerEvents.ENDED,function(){return _this.hide()}),_this}return inherits(EmpLiveDisplay,_Button),EmpLiveDisplay.prototype.createEl=function(){var el=_Button.prototype.createEl.call(this,"button",{className:"emp-live-control vjs-control"});return this.contentEl_=createEl("div",{className:"emp-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),el.appendChild(this.contentEl_),el},EmpLiveDisplay.prototype.updateShowing=function(){this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive?this.show():this.hide()},EmpLiveDisplay.prototype.timeUpdate=function(){if(this.player().isLive()||this.entitlement&&this.entitlement.isStaticCachupAsLive){var timeBehindLive=(this.player().currentTime(),this.player().duration(),this.player().timeBehindLive());this.player().isLive()&&timeBehindLive<20?this.addClass("emp-live-edge"):this.removeClass("emp-live-edge")}},EmpLiveDisplay.prototype.handleClick=function(){this.player().gotoLive()},createClass(EmpLiveDisplay,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),EmpLiveDisplay}(Button);Component$4.registerComponent("EmpLiveDisplay",EmpLiveDisplay);var Component$6=videojs$1.getComponent("Component"),EmpMarker=function(_Component){function EmpMarker(player,options){classCallCheck(this,EmpMarker);var _this=possibleConstructorReturn(this,_Component.call(this,player,options));return _this.on(_this.player(),empPlayerEvents.PLAYING,function(){return _this.updateVisibility()}),_this.on(_this.player(),empPlayerEvents.DURATION_CHANGE,function(){return _this.updateVisibility()}),_this.on(_this.player(),empPlayerEvents.SEEKED,function(){return _this.updateVisibility()}),_this.addClass("vjs-hidden"),_this}return inherits(EmpMarker,_Component),EmpMarker.prototype.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"emp-ad-marker"})},EmpMarker.prototype.buildCSSClass=function(){return"emp-ad-marker "+_Component.prototype.buildCSSClass.call(this)},EmpMarker.prototype.updateVisibility=function(){if(this.player_.duration()){var element=this.options_.element;element.offset+element.duration<this.player_.currentTime()?this.addClass("emp-ad-past"):this.removeClass("emp-ad-past");var percent_startTime=element.offset/this.player_.duration();percent_startTime>=1&&(percent_startTime=1);var percent_duration=element.duration/this.player_.duration();percent_duration>=1&&(percent_duration=1),this.el_.style.left=(100*percent_startTime).toFixed(2)+"%",this.el_.style.width=(100*percent_duration).toFixed(2)+"%",this.show()}},EmpMarker.prototype.dispose=function(){_Component.prototype.dispose.call(this)},EmpMarker}(Component$6);Component$6.registerComponent("EmpMarker",EmpMarker);var Component$7=videojs$1.getComponent("Component"),MouseTimeDisplay=videojs$1.getComponent("MouseTimeDisplay"),EmpMouseTimeDisplay=function(_MouseTimeDisplay){function EmpMouseTimeDisplay(player,options){return classCallCheck(this,EmpMouseTimeDisplay),possibleConstructorReturn(this,_MouseTimeDisplay.call(this,player,options))}return inherits(EmpMouseTimeDisplay,_MouseTimeDisplay),EmpMouseTimeDisplay.prototype.update=function(seekBarRect,seekBarPoint){var _this2=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var duration=_this2.player_.duration(),content=void 0;content=formatTime(seekBarPoint*duration,duration),_this2.el_.style.left=seekBarRect.width*seekBarPoint+"px",_this2.getChild("timeTooltip").update(seekBarRect,seekBarPoint,content)})},EmpMouseTimeDisplay}(MouseTimeDisplay);Component$7.registerComponent("MouseTimeDisplay",EmpMouseTimeDisplay);var USER_AGENT=window_1.navigator&&window_1.navigator.userAgent||"",IS_IPAD=(/AppleWebKit\/([\d.]+)/i.exec(USER_AGENT),/iPad/i.test(USER_AGENT)),IS_CHROMECAST=window_1.navigator.userAgent.indexOf("CrKey")>=0,IS_IPHONE=/iPhone/i.test(USER_AGENT)&&!IS_IPAD,IS_IPOD=/iPod/i.test(USER_AGENT),IS_IOS=IS_IPHONE||IS_IPAD||IS_IPOD,IS_ANDROID=(function(){var match=USER_AGENT.match(/OS (\d+)_/i);match&&match[1]&&match[1]}(),/Android/i.test(USER_AGENT)),ANDROID_VERSION=function(){var match=USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!match)return null;var major=match[1]&&parseFloat(match[1]),minor=match[2]&&parseFloat(match[2]);return major&&minor?parseFloat(match[1]+"."+match[2]):major||null}(),IS_EDGE=(IS_ANDROID&&/webkit/i.test(USER_AGENT),/Firefox/i.test(USER_AGENT),/Edge/i.test(USER_AGENT)),IS_CHROME=!IS_EDGE&&/Chrome/i.test(USER_AGENT),IE_VERSION=(function(){var match=USER_AGENT.match(/Chrome\/(\d+)/);match&&match[1]&&parseFloat(match[1])}(),/MSIE\s8\.0/.test(USER_AGENT),function(){var result=/MSIE\s(\d+)\.\d/.exec(USER_AGENT),version=result&&parseFloat(result[1]);return!version&&/Trident\/7.0/i.test(USER_AGENT)&&/rv:11.0/.test(USER_AGENT)&&(version=11),version}()),IS_IE_OR_EDGE=(/Safari/i.test(USER_AGENT),IS_EDGE||null!==IE_VERSION),Component$5=(function(){return document_1===window_1.document&&void 0!==document_1.createElement}()&&window_1.document.createElement("video").style,videojs$1.getComponent("Component")),Slider=videojs$1.getComponent("Slider"),UPDATE_REFRESH_INTERVAL=(videojs$1.getComponent("LoadProgressBar"),videojs$1.getComponent("PlayProgressBar"),IS_CHROMECAST||window_1.EMP_DEBUG_CHROMECAST?1e3:30),SeekBar=function(_Slider){function SeekBar(player,options){classCallCheck(this,SeekBar);var _this=possibleConstructorReturn(this,_Slider.call(this,player,options));return _this.markers=[],_this.update=throttle(bind(_this,_this.update),UPDATE_REFRESH_INTERVAL),_this.on(player,empPlayerEvents.TIME_UPDATE,_this.update),_this.on(player,empPlayerEvents.ENDED,_this.handleEnded),_this.on(player,empPlayerEvents.AD_TIMELINE_CHANGED,_this.updateMarkers),_this.updateInterval=null,_this.on(player,["playing"],function(){_this.updateInterval&&(_this.clearInterval(_this.updateInterval),_this.updateInterval=null),IS_CHROMECAST||window_1.EMP_DEBUG_CHROMECAST||(_this.updateInterval=_this.setInterval(function(){_this.requestAnimationFrame(function(){_this.update()})},UPDATE_REFRESH_INTERVAL))}),_this.on(player,["ended","pause","waiting"],function(){_this.updateInterval&&(_this.clearInterval(_this.updateInterval),_this.updateInterval=null)}),_this.on(player,["timeupdate","ended"],_this.update),_this}return inherits(SeekBar,_Slider),SeekBar.prototype.updateMarkers=function(event,data){for(var _iterator=this.markers,_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if(_i=_iterator.next(),_i.done)break;_ref=_i.value}var marker=_ref;this.removeChild(marker)}if(data&&data.timeline)for(var _iterator2=data.timeline.getAllElements(),_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[Symbol.iterator]();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++]}else{if(_i2=_iterator2.next(),_i2.done)break;_ref2=_i2.value}var element=_ref2;if("advert"===element.type){var _marker=new EmpMarker(this.player_,{element:element});this.markers.push(_marker),this.addChild(_marker),_marker.updateVisibility()}}},SeekBar.prototype.createEl=function(){return _Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},SeekBar.prototype.update_=function(currentTime,percent){var duration=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*percent).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[formatTime(currentTime,duration),formatTime(duration,duration)],"{1} of {2}")),IS_CHROMECAST||window_1.EMP_DEBUG_CHROMECAST||this.bar.update(getBoundingClientRect(this.el_),percent)},SeekBar.prototype.update=function(event,data){var percent=_Slider.prototype.update.call(this);return this.update_(this.getCurrentTime_(),percent),percent},SeekBar.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?(this.player_.getCache().currentTime,this.player_.getCache().currentTime):(this.player_.getCache().currentTime=this.player_.currentTime(),this.player_.currentTime())},SeekBar.prototype.handleEnded=function(event){this.update_(this.player_.duration(),1);for(var _iterator3=this.markers,_isArray3=Array.isArray(_iterator3),_i3=0,_iterator3=_isArray3?_iterator3:_iterator3[Symbol.iterator]();;){var _ref3;if(_isArray3){if(_i3>=_iterator3.length)break;_ref3=_iterator3[_i3++]}else{if(_i3=_iterator3.next(),_i3.done)break;_ref3=_i3.value}var marker=_ref3;this.removeChild(marker)}},SeekBar.prototype.getPercent=function(){var percent=this.getCurrentTime_()/this.player_.duration();return percent>=1?1:percent},SeekBar.prototype.handleMouseDown=function(event){this.player_.scrubbing(!0),_Slider.prototype.handleMouseDown.call(this,event)},SeekBar.prototype.handleMouseMove=function(event){var newTime=this.calculateDistance(event)*this.player_.duration();newTime===this.player_.duration()&&(newTime-=.1),this.setCurrentTime(newTime)},SeekBar.prototype.setCurrentTime=function(newTime){var src=this.player_.src()?this.player_.src():"",isDownload=0===src.indexOf("offline:"),start=this.player_.buffered().start(0),end=this.player_.buffered().end(0);isDownload||newTime>=start&&newTime<=end?(this.player_.currentTime(newTime),this.player_.getCache().currentTime=newTime):this.player_.scrubbing()?(this.player_.getCache().currentTime=newTime,this.player_.getCache().currentTime=newTime):(this.player_.currentTime(newTime),this.player_.getCache().currentTime=newTime)},SeekBar.prototype.throttleSetCurrentTime=function(newTime){null!=this.seekTimeoutId_&&window_1.clearTimeout(this.seekTimeoutId_);var start=this.player_.buffered().start(0),end=this.player_.buffered().end(0);newTime>=start&&newTime<=end?(this.player_.scrubbing(!1),this.player_.currentTime(newTime),this.player_.getCache().currentTime=newTime):(this.player_.scrubbing(!0),this.player_.getCache().currentTime=newTime,this.seekTimeoutId_=window_1.setTimeout(this.onSeekInputTimeout_.bind(this,newTime),1e3))},SeekBar.prototype.onSeekInputTimeout_=function(newTime){this.seekTimeoutId_=null,this.player_.scrubbing(!1),this.player_.currentTime(newTime),this.player_.getCache().currentTime=newTime},SeekBar.prototype.enable=function(){_Slider.prototype.enable.call(this);var mouseTimeDisplay=this.getChild("mouseTimeDisplay");mouseTimeDisplay&&mouseTimeDisplay.show()},SeekBar.prototype.disable=function(){_Slider.prototype.disable.call(this);var mouseTimeDisplay=this.getChild("mouseTimeDisplay");mouseTimeDisplay&&mouseTimeDisplay.hide()},SeekBar.prototype.handleMouseUp=function(event){_Slider.prototype.handleMouseUp.call(this,event),this.player_.scrubbing(!1),this.setCurrentTime(this.player_.getCache().currentTime)},SeekBar.prototype.stepForward=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime+5)},SeekBar.prototype.stepBack=function(){this.throttleSetCurrentTime(this.player_.getCache().currentTime-5)},SeekBar.prototype.handleAction=function(event){this.player_.paused()?this.player_.play():this.player_.pause()},SeekBar.prototype.handleKeyPress=function(event){32===event.which||13===event.which?(event.preventDefault(),this.handleAction(event)):_Slider.prototype.handleKeyPress&&_Slider.prototype.handleKeyPress.call(this,event)},SeekBar}(Slider);SeekBar.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},IE_VERSION&&!(IE_VERSION>8)||IS_IOS||IS_ANDROID||SeekBar.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),SeekBar.prototype.playerEvent="timeupdate",Component$5.registerComponent("SeekBar",SeekBar);var Button$1=videojs$1.getComponent("Button"),Component$8=videojs$1.getComponent("Component"),EmpRestartButton=function(_Button){function EmpRestartButton(player,options){classCallCheck(this,EmpRestartButton);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.shouldRestart_=!0,_this.updateShowing(),_this.on(_this.player(),empPlayerEvents.LOADED_METADATA,_this.updateShowing),_this.on(_this.player(),empPlayerEvents.PLAYING,function(){_this.shouldRestart_=!1,_this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.ERROR,function(){return _this.shouldRestart_=!0}),_this}return inherits(EmpRestartButton,_Button),EmpRestartButton.prototype.buildCSSClass=function(){return"emp-restart-control "+_Button.prototype.buildCSSClass.call(this)},EmpRestartButton.prototype.updateShowing=function(){this.player().canRestart()?this.show():this.hide()},EmpRestartButton.prototype.handleClick=function(){if(!0===this.shouldRestart_)return void this.player_.restart();this.player_.scrubbing(!0);var videoWasPlaying=!this.player_.paused();this.player_.pause(),this.player_.currentTime(0),this.player_.scrubbing(!1),videoWasPlaying&&silencePromise(this.player_.play())},EmpRestartButton}(Button$1);EmpRestartButton.prototype.controlText_="Restart",Component$8.registerComponent("EmpRestartButton",EmpRestartButton);var Button$2=videojs$1.getComponent("Button"),Component$9=videojs$1.getComponent("Component"),EmpForwardButton=function(_Button){function EmpForwardButton(player,options){classCallCheck(this,EmpForwardButton),options=assign({seconds:30},options);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.controlText("Forward "+options.seconds+"s"),player.on(empPlayerEvents.TIMESHIFT_CHANGE,function(){return _this.onTimeshift()}),player.on(empPlayerEvents.PROGRAM_CHANGED,function(event,data){return _this.updateEnabled(data&&data.program)}),player.on(empPlayerEvents.DURATION_CHANGE,function(){return _this.updateEnabled()}),_this.updateEnabled(),_this}return inherits(EmpForwardButton,_Button),EmpForwardButton.prototype.updateEnabled=function(program){this.entitlement&&!this.entitlement.ffEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Forward restricted")):(this.enable(),this.show(),this.controlText("Forward "+this.options_.seconds+"s"))},EmpForwardButton.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},EmpForwardButton.prototype.buildCSSClass=function(){return"emp-forward-control "+_Button.prototype.buildCSSClass.call(this)},EmpForwardButton.prototype.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var newTime=this.player().currentTime()+this.options_.seconds;this.player().currentTime(newTime),this.player().scrubbing(!1)}},createClass(EmpForwardButton,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),EmpForwardButton}(Button$2);EmpForwardButton.prototype.controlText_="Forward",Component$9.registerComponent("EmpForwardButton",EmpForwardButton);var Button$3=videojs$1.getComponent("Button"),Component$10=videojs$1.getComponent("Component"),EmpRewindButton=function(_Button){function EmpRewindButton(player,options){classCallCheck(this,EmpRewindButton),options=assign({seconds:30},options);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.controlText("Rewind "+options.seconds+"s"),player.on(empPlayerEvents.TIMESHIFT_CHANGE,function(){return _this.onTimeshift()}),player.on(empPlayerEvents.PROGRAM_CHANGED,function(event,data){return _this.updateEnabled(data&&data.program)}),player.on(empPlayerEvents.DURATION_CHANGE,function(){return _this.updateEnabled()}),_this.updateEnabled(),_this}return inherits(EmpRewindButton,_Button),EmpRewindButton.prototype.updateEnabled=function(program){this.entitlement&&!this.entitlement.rwEnabled||!this.player().timeShiftEnabled()?(this.disable(),this.controlText("Rewind restricted")):(this.enable(),this.show(),this.controlText("Rewind "+this.options_.seconds+"s"))},EmpRewindButton.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},EmpRewindButton.prototype.buildCSSClass=function(){return"emp-rewind-control "+_Button.prototype.buildCSSClass.call(this)},EmpRewindButton.prototype.handleClick=function(){if(!this.player().ended()){this.player().scrubbing(!0);var newTime=this.player().currentTime()-this.options_.seconds;this.player().currentTime(newTime),this.player().scrubbing(!1)}},createClass(EmpRewindButton,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),EmpRewindButton}(Button$3);EmpRewindButton.prototype.controlText_="Rewind",Component$10.registerComponent("EmpRewindButton",EmpRewindButton);var Button$4=videojs$1.getComponent("Button"),Component$11=videojs$1.getComponent("Component"),EmpReloadButton=function(_Button){function EmpReloadButton(player,options){return classCallCheck(this,EmpReloadButton),possibleConstructorReturn(this,_Button.call(this,player,options))}return inherits(EmpReloadButton,_Button),EmpReloadButton.prototype.buildCSSClass=function(){return"emp-reload-control "+_Button.prototype.buildCSSClass.call(this)},EmpReloadButton.prototype.handleClick=function(){this.player_.restart()},EmpReloadButton}(Button$4);EmpReloadButton.prototype.controlText_="Reload",Component$11.registerComponent("EmpReloadButton",EmpReloadButton);var Component$12=(videojs$1.getComponent("RemainingTimeDisplay"),videojs$1.getComponent("Component")),UPDATE_REFRESH_INTERVAL$1=IS_CHROMECAST||window.EMP_DEBUG_CHROMECAST?1e3:30,EmpTimeDisplay=function(_Component){function EmpTimeDisplay(player,options){classCallCheck(this,EmpTimeDisplay);var _this=possibleConstructorReturn(this,_Component.call(this,player,options));return _this.mode_=options.mode||"remainingTime",_this.throttledUpdateContent=throttle(bind(_this,_this.updateContent),UPDATE_REFRESH_INTERVAL$1),_this.on(player,empPlayerEvents.TIME_UPDATE,_this.throttledUpdateContent),_this.on(player,empPlayerEvents.DURATION_CHANGE,_this.updateContent),player.on(empPlayerEvents.ENDED,function(){_this.hide()}),player.on(empPlayerEvents.PLAYING,function(){_this.show()}),_this}return inherits(EmpTimeDisplay,_Component),EmpTimeDisplay.prototype.createEl=function(){var classNameStr="emp-time vjs-time-control vjs-remaining-time vjs-control";this.options_&&"remainingTime"==this.options_.mode?classNameStr+=" emp-remaining-time":classNameStr+=" emp-currentTime-time";var el=_Component.prototype.createEl.call(this,"div",{className:classNameStr});return this.contentEl_=createEl("div",{className:"emp-time-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Remaining Time")+"</span>0:00"},{"aria-live":"off"}),el.appendChild(this.contentEl_),el},EmpTimeDisplay.prototype.updateContent=function(){if("currentTime"===this.mode_){var time=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),localizedText=this.localize("Current Time"),formattedTime=formatTime(time,this.player_.duration());formattedTime!==this.formattedTime_&&(this.formattedTime_=formattedTime,this.contentEl_.innerHTML='<span class="vjs-control-text">'+localizedText+"</span>"+formattedTime)}else{var duration=this.player_.duration();if(duration){var _localizedText=this.localize("Remaining Time"),_formattedTime=void 0;if(duration>4294967295)(_formattedTime="")!==this.formattedTime_&&(this.formattedTime_=_formattedTime,this.contentEl_.innerHTML='<span class="vjs-control-text">'+_localizedText+"</span>"+_formattedTime);else{var remainingTime=this.player_.remainingTime();remainingTime<0&&(remainingTime=0),_formattedTime=formatTime(remainingTime),_formattedTime!==this.formattedTime_&&(this.formattedTime_=_formattedTime,this.contentEl_.innerHTML='<span class="vjs-control-text">'+_localizedText+"</span>"+_formattedTime)}}}},EmpTimeDisplay}(Component$12);Component$12.registerComponent("EmpTimeDisplay",EmpTimeDisplay),Component$12.registerComponent("EmpTimeDisplay2",EmpTimeDisplay);var Button$5=videojs$1.getComponent("Button"),Component$13=videojs$1.getComponent("Component"),EmpStopButton=function(_Button){function EmpStopButton(player,options,ready){classCallCheck(this,EmpStopButton);var _this=possibleConstructorReturn(this,_Button.call(this,player,options,ready));return _this.el_.setAttribute("aria-label","Stop Playback"),player.on(empPlayerEvents.TIMESHIFT_CHANGE,function(){return _this.onTimeshift()}),player.on(empPlayerEvents.PLAYING,function(){return _this.onTimeshift()}),player.on(empPlayerEvents.ENDED,function(){return _this.hide()}),_this}return inherits(EmpStopButton,_Button),EmpStopButton.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.hide():this.show())},EmpStopButton.prototype.handleClick=function(event){this.player()&&this.player().stop()},EmpStopButton.prototype.buildCSSClass=function(){return"emp-stop-control vjs-icon-square "+_Button.prototype.buildCSSClass.call(this)},EmpStopButton}(Button$5);EmpStopButton.prototype.kind_="stop",EmpStopButton.prototype.controlText_="stop",Component$13.registerComponent("EmpStopButton",EmpStopButton);var PlayToggle=videojs$1.getComponent("PlayToggle"),Component$14=videojs$1.getComponent("Component"),EmpPlayToggle=function(_PlayToggle){function EmpPlayToggle(player,options,ready){classCallCheck(this,EmpPlayToggle);var _this=possibleConstructorReturn(this,_PlayToggle.call(this,player,options,ready));return _this.el_.setAttribute("aria-label","Play Toggle"),player.on(empPlayerEvents.TIMESHIFT_CHANGE,function(){return _this.onTimeshift()}),player.on(empPlayerEvents.PLAYING,function(){return _this.onTimeshift()}),_this}return inherits(EmpPlayToggle,_PlayToggle),EmpPlayToggle.prototype.onTimeshift=function(){this.player()&&(this.player().timeShiftEnabled()?this.show():this.hide())},EmpPlayToggle.prototype.handleClick=function(event){_PlayToggle.prototype.handleClick.call(this,event)},EmpPlayToggle.prototype.buildCSSClass=function(){return""+_PlayToggle.prototype.buildCSSClass.call(this)},EmpPlayToggle}(PlayToggle);EmpPlayToggle.prototype.kind_="playToggle",EmpPlayToggle.prototype.controlText_="playToggle",Component$14.registerComponent("EmpPlayToggle",EmpPlayToggle);var Button$6=(videojs$1.getComponent("Component"),videojs$1.getComponent("Button")),AirplayToggle=function(_Button){function AirplayToggle(player,options){classCallCheck(this,AirplayToggle);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.addClass("vjs-hidden"),player.ready(function(){_this.initAirPlay()}),_this}return inherits(AirplayToggle,_Button),AirplayToggle.prototype.initAirPlay=function(){var player=this.player();if(window.WebKitPlaybackTargetAvailabilityEvent){player.el().getElementsByTagName("video")[0].addEventListener("webkitplaybacktargetavailabilitychanged",function(event){switch(event.availability){case"available":log$1("Airplay available"),player.on("loadeddata",function(){player.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")&&(this.entitlement&&this.entitlement.airplayBlocked?player.controlBar.airplayToggle.hide():player.controlBar.airplayToggle.show())});break;case"not-available":log$1("Airplay not-available")}})}},AirplayToggle.prototype.buildCSSClass=function(){return"vjs-airplay-control "+_Button.prototype.buildCSSClass.call(this)},AirplayToggle.prototype.handleClick=function(){this.entitlement&&this.entitlement.airplayBlocked?log$1("Airplay Blocked"):(this.player().el().getElementsByTagName("video")[0].webkitShowPlaybackTargetPicker(),this.player().trigger(empPlayerEvents.AIRPLAY_START))},createClass(AirplayToggle,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),AirplayToggle}(Button$6);AirplayToggle.prototype.controlText_="Airplay",videojs$1.registerComponent("AirplayToggle",AirplayToggle);var Button$7=videojs$1.getComponent("Button"),Component$16=videojs$1.getComponent("Component"),EmpNextButton=function(_Button){function EmpNextButton(player,options){classCallCheck(this,EmpNextButton);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.controlText("Next program"),_this.updateShowing(),_this.on(_this.player(),empPlayerEvents.PLAYING,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.DURATION_CHANGE,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.PROGRAM_CHANGED,function(event,data){return _this.updateShowing(data&&data.program)}),_this}return inherits(EmpNextButton,_Button),EmpNextButton.prototype.updateShowing=function(program){program=program||this.player().getProgramDetails(),!this.player().noEPG()&&this.entitlement&&program?(this.show(),this.enable()):this.hide(),program&&Date.now()<program.end.getTime()&&this.disable(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},EmpNextButton.prototype.buildCSSClass=function(){return"emp-next-control "+_Button.prototype.buildCSSClass.call(this)},EmpNextButton.prototype.handleClick=function(){this.player().ended()||this.player().playNextProgram()},createClass(EmpNextButton,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),EmpNextButton}(Button$7);EmpNextButton.prototype.controlText_="Next",Component$16.registerComponent("EmpNextButton",EmpNextButton);var Button$8=videojs$1.getComponent("Button"),Component$17=videojs$1.getComponent("Component"),EmpPreviousButton=function(_Button){function EmpPreviousButton(player,options){classCallCheck(this,EmpPreviousButton);var _this=possibleConstructorReturn(this,_Button.call(this,player,options));return _this.controlText("Previous Program"),_this.updateShowing(),_this.on(_this.player(),empPlayerEvents.PLAYING,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.DURATION_CHANGE,function(){return _this.updateShowing()}),_this.on(_this.player(),empPlayerEvents.PROGRAM_CHANGED,function(){return _this.updateShowing()}),_this}return inherits(EmpPreviousButton,_Button),EmpPreviousButton.prototype.updateShowing=function(){var program=this.player().getProgramDetails();!this.player().noEPG()&&this.entitlement&&program?this.show():this.hide(),this.entitlement&&(this.entitlement.isDynamicCachupAsLive||this.entitlement.isStaticCachupAsLive)||this.hide()},EmpPreviousButton.prototype.buildCSSClass=function(){return"emp-previous-control "+_Button.prototype.buildCSSClass.call(this)},
EmpPreviousButton.prototype.handleClick=function(){this.player().ended()||this.player().playPreviousProgram()},createClass(EmpPreviousButton,[{key:"entitlement",get:function(){return extplayer.getEntitlement(this.player())}}]),EmpPreviousButton}(Button$8);EmpPreviousButton.prototype.controlText_="Previous",Component$17.registerComponent("EmpPreviousButton",EmpPreviousButton);var ControlBar=videojs$1.getComponent("ControlBar"),Component$1=videojs$1.getComponent("Component"),EmpControlBar=function(_ControlBar){function EmpControlBar(){return classCallCheck(this,EmpControlBar),possibleConstructorReturn(this,_ControlBar.apply(this,arguments))}return inherits(EmpControlBar,_ControlBar),EmpControlBar}(ControlBar);EmpControlBar.prototype.options_={loadEvent:"play",children:{empPlayToggle:{},empReloadButton:{},empStopButton:{},empPreviousButton:{},empRewindButton:{},empForwardButton:{},empNextButton:{},volumePanel:{inline:!1},empTimeDisplay:{mode:"currentTime"},timeDivider:{},durationDisplay:{},empLiveDisplay:{},progressControl:{},empTimeDisplay2:{mode:"remainingTime"},customControlSpacer:{},empRestartButton:{},playbackRateMenuButton:{},chaptersButton:{},bitrateButton:{},audioTrackButton:{},subsCapsButton:{},airplayToggle:{},fullscreenToggle:{}}},Component$1.registerComponent("ControlBar",EmpControlBar);var Component$18=videojs$1.getComponent("Component"),fontMap={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},TextTrackDisplay=function(_Component){function TextTrackDisplay(player,options,ready){classCallCheck(this,TextTrackDisplay);var _this=possibleConstructorReturn(this,_Component.call(this,player,options,ready));return player.on("loadstart",bind(_this,_this.toggleDisplay)),player.on("texttrackchange",bind(_this,_this.updateDisplay)),player.on("loadstart",bind(_this,_this.preselectTrack)),player.ready(bind(_this,function(){if(player.tech_&&player.tech_.featuresNativeTextTracks)return void this.hide();if("DASH"===player.streamType||"HLS"===player.streamType||"EmpCast"===player.techName_)return void this.hide();player.on("fullscreenchange",bind(this,this.updateDisplay));for(var tracks=this.options_.playerOptions.tracks||[],i=0;i<tracks.length;i++)this.player_.addRemoteTextTrack(tracks[i],!0);this.preselectTrack()})),_this}return inherits(TextTrackDisplay,_Component),TextTrackDisplay.prototype.preselectTrack=function(){for(var modes={captions:1,subtitles:1},trackList=this.player_.textTracks(),userPref=this.player_.cache_.selectedLanguage,firstDesc=void 0,firstCaptions=void 0,preferredTrack=void 0,i=0;i<trackList.length;i++){var track=trackList[i];userPref&&userPref.enabled&&userPref.language===track.language?track.kind===userPref.kind?preferredTrack=track:preferredTrack||(preferredTrack=track):userPref&&!userPref.enabled?(preferredTrack=null,firstDesc=null,firstCaptions=null):track.default&&("descriptions"!==track.kind||firstDesc?track.kind in modes&&!firstCaptions&&(firstCaptions=track):firstDesc=track)}preferredTrack?preferredTrack.mode="showing":firstCaptions?firstCaptions.mode="showing":firstDesc&&(firstDesc.mode="showing")},TextTrackDisplay.prototype.toggleDisplay=function(){if("DASH"===this.player_.streamType||"HLS"===this.player_.streamType||"EmpCast"===this.player_.techName_)return void this.hide();this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},TextTrackDisplay.prototype.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},TextTrackDisplay.prototype.clearDisplay=function(){"function"==typeof window_1.WebVTT&&window_1.WebVTT.processCues(window_1,[],this.el_)},TextTrackDisplay.prototype.removeStyles=function(styleName){var styleElement=document_1.getElementById(styleName);return styleElement&&document_1.getElementsByTagName("head")[0].removeChild(styleElement),styleElement},TextTrackDisplay.prototype.writeStyles=function(styleName,cssText){var styleElement=this.removeStyles(styleName);styleElement=document_1.createElement("style"),styleElement.type="text/css",styleElement.id=styleName,styleElement.innerHTML=cssText,document_1.getElementsByTagName("head")[0].appendChild(styleElement)},TextTrackDisplay.prototype.getStyle=function(overrides){var color=void 0,backgroundColor=void 0,textShadow=void 0,fontSize=void 0,height=void 0,top=void 0,bottom=void 0,fontVariant=void 0,fontFamily=void 0,windowColor=void 0;return overrides.color&&(color="color: "+overrides.color),overrides.textOpacity&&(color="color: "+constructColor(overrides.color||"#fff",overrides.textOpacity)),overrides.backgroundColor&&(backgroundColor="background-color: "+overrides.backgroundColor),overrides.backgroundOpacity&&(backgroundColor="background-color: "+constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity)),overrides.windowColor&&(windowColor=overrides.windowOpacity?"outline: "+constructColor(overrides.windowColor,overrides.windowOpacity)+" solid 10px":"outline: "+overrides.windowColor+" solid 10px"),overrides.edgeStyle&&("dropshadow"===overrides.edgeStyle?textShadow="text-shadow: 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, 0 0 2px black, black 0.1em 0.1em 0.2em":"raised"===overrides.edgeStyle?textShadow="text-shadow: 1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===overrides.edgeStyle?textShadow="text-shadow: 1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===overrides.edgeStyle&&(textShadow="text-shadow: 0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),overrides.fontPercent&&1!==overrides.fontPercent&&(fontSize="font-size: "+overrides.fontPercent+"em",height="height: auto",top="top: auto",bottom="bottom: 2px"),overrides.fontFamily&&"default"!==overrides.fontFamily&&("small-caps"===overrides.fontFamily?fontVariant="font-variant: small-caps":fontFamily="font-family: "+fontMap[overrides.fontFamily]),(color?color+"; ":"")+(backgroundColor?backgroundColor+"; ":"")+(textShadow?textShadow+"; ":"")+(fontSize?fontSize+"; ":"")+(height?height+"; ":"")+(top?top+"; ":"")+(bottom?bottom+"; ":"")+(fontVariant?fontVariant+"; ":"")+(fontFamily?fontFamily+"; ":"")+(windowColor?windowColor+"; ":"")},TextTrackDisplay.prototype.getSafariStyle=function(overrides){var backgroundColor=void 0;return overrides.backgroundColor&&(backgroundColor="background-color: "+overrides.backgroundColor),overrides.backgroundOpacity&&(backgroundColor="background-color: "+constructColor(overrides.backgroundColor||"#000",overrides.backgroundOpacity)),backgroundColor?"video::-webkit-media-text-track-display-backdrop {"+backgroundColor+" !important;overflow: visible !important;}":""},TextTrackDisplay.prototype.updateDisplay=function(){if(this.player_.textTrackSettings){var overrides=void 0;overrides=this.player_.options_.textTrackStyle?this.player_.options_.textTrackStyle:this.player_.textTrackSettings.getValues();if("DASH"===this.player_.streamType||"EmpHLS"===this.player_.techName_||"HLS"===this.player_.streamType){var styleStr=this.getStyle(overrides);return"EmpHLS"===this.player_.techName_?this.writeStyles("styles_cue","video::cue {"+styleStr+"}\n"+this.getSafariStyle(overrides)):this.writeStyles("styles_cue","video::cue {"+styleStr+"}"),void this.clearDisplay()}this.removeStyles("styles_cue")}else this.writeStyles("style_no_texttrack_settings",".vjs-texttrack-settings {display: none;}");return},TextTrackDisplay.prototype.updateForTrack=function(track){return},TextTrackDisplay}(Component$18);Component$18.registerComponent("TextTrackDisplay",TextTrackDisplay);var Component$19=videojs$1.getComponent("Component"),ModalDialog=videojs$1.getComponent("ModalDialog"),COLOR_BLACK=["#000","Black"],COLOR_BLUE=["#00F","Blue"],COLOR_CYAN=["#0FF","Cyan"],COLOR_GREEN=["#0F0","Green"],COLOR_MAGENTA=["#F0F","Magenta"],COLOR_RED=["#F00","Red"],COLOR_WHITE=["#FFF","White"],COLOR_YELLOW=["#FF0","Yellow"],OPACITY_OPAQUE=["1","Opaque"],OPACITY_SEMI=["0.5","Semi-Transparent"],OPACITY_TRANS=["0","Transparent"],selectConfigs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[COLOR_BLACK,COLOR_WHITE,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[OPACITY_TRANS,OPACITY_SEMI,OPACITY_OPAQUE]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[COLOR_WHITE,COLOR_BLACK,COLOR_RED,COLOR_GREEN,COLOR_BLUE,COLOR_YELLOW,COLOR_MAGENTA,COLOR_CYAN]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]],default:4},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.25","25%"],["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["2.50","250%"]],default:3,parser:function(v){return"1.00"===v?null:Number(v)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[OPACITY_OPAQUE,OPACITY_SEMI]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[OPACITY_TRANS,OPACITY_SEMI,OPACITY_OPAQUE]}};selectConfigs.windowColor.options=selectConfigs.backgroundColor.options;var TextTrackSettings=function(_ModalDialog){function TextTrackSettings(player,options){classCallCheck(this,TextTrackSettings),options.temporary=!1;var _this=possibleConstructorReturn(this,_ModalDialog.call(this,player,options));return _this.updateDisplay=bind(_this,_this.updateDisplay),_this.fill(),_this.hasBeenOpened_=_this.hasBeenFilled_=!0,_this.endDialog=createEl("p",{className:"vjs-control-text",textContent:_this.localize("End of dialog window.")}),_this.el().appendChild(_this.endDialog),_this.setDefaults(),void 0===options.persistTextTrackSettings&&(_this.options_.persistTextTrackSettings=_this.options_.playerOptions.persistTextTrackSettings),_this.on(_this.$(".vjs-done-button"),"click",function(){_this.saveSettings(),_this.close()}),_this.on(_this.$(".vjs-default-button"),"click",function(){_this.setDefaults(),_this.updateDisplay()}),each(selectConfigs,function(config){_this.on(_this.$(config.selector),"change",_this.updateDisplay)}),_this.options_.persistTextTrackSettings&&_this.restoreSettings(),_this}return inherits(TextTrackSettings,_ModalDialog),TextTrackSettings.prototype.dispose=function(){this.endDialog=null,_ModalDialog.prototype.dispose.call(this)},TextTrackSettings.prototype.createElSelect_=function(key){var _this2=this,legendId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",type=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",config=selectConfigs[key],id=config.id.replace("%s",this.id_);return["<"+type+' id="'+id+'" class="'+("label"===type?"vjs-label":"")+'">',this.localize(config.label),"</"+type+">",'<select aria-labelledby="'+(""!==legendId?legendId+" ":"")+id+'">'].concat(config.options.map(function(o){var optionId=id+"-"+o[1];return['<option id="'+optionId+'" value="'+o[0]+'" ','aria-labelledby="'+(""!==legendId?legendId+" ":"")+id+" "+optionId+'">',_this2.localize(o[1]),"</option>"].join("")})).concat("</select>").join("")},TextTrackSettings.prototype.createElFgColor_=function(){var legendId="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",legendId),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",legendId),"</span>","</fieldset>"].join("")},TextTrackSettings.prototype.createElBgColor_=function(){var legendId="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",legendId),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",legendId),"</span>","</fieldset>"].join("")},TextTrackSettings.prototype.createElWinColor_=function(){var legendId="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+legendId+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",legendId),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",legendId),"</span>","</fieldset>"].join("")},TextTrackSettings.prototype.createElColors_=function(){return createEl("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},TextTrackSettings.prototype.createElFont_=function(){return createEl("div",{className:'vjs-track-settings-font">',innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},TextTrackSettings.prototype.createElControls_=function(){var defaultsDescription=this.localize("restore all settings to the default values");return createEl("div",{className:"vjs-track-settings-controls",innerHTML:['<button class="vjs-default-button" title="'+defaultsDescription+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+defaultsDescription+"</span>","</button>",'<button class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},TextTrackSettings.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},TextTrackSettings.prototype.label=function(){return this.localize("Caption Settings Dialog")},TextTrackSettings.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},TextTrackSettings.prototype.buildCSSClass=function(){return _ModalDialog.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},TextTrackSettings.prototype.getValues=function(){var _this3=this;return reduce(selectConfigs,function(accum,config,key){var value=getSelectedOptionValue(_this3.$(config.selector),config.parser);return void 0!==value&&(accum[key]=value),accum},{})},TextTrackSettings.prototype.setValues=function(values){var _this4=this;each(selectConfigs,function(config,key){setSelectedOption(_this4.$(config.selector),values[key],config.parser)})},TextTrackSettings.prototype.setDefaults=function(){var _this5=this;each(selectConfigs,function(config){var index=config.hasOwnProperty("default")?config.default:0;_this5.$(config.selector).selectedIndex=index})},TextTrackSettings.prototype.restoreSettings=function(){var values=void 0;try{values=JSON.parse(window_1.localStorage.getItem("vjs-text-track-settings"))}catch(err){log$1.warn(err)}values&&this.setValues(values)},TextTrackSettings.prototype.saveSettings=function(){var values=this.getValues();if(this.player_.options_.textTrackStyle=void 0,"EmpCast"===this.player_.techName_&&this.player_.techCall_("sendTextTrackStyle",values),this.options_.persistTextTrackSettings)try{Object.keys(values).length?window_1.localStorage.setItem("vjs-text-track-settings",JSON.stringify(values)):window_1.localStorage.removeItem("vjs-text-track-settings")}catch(err){log$1.warn(err)}},TextTrackSettings.prototype.updateDisplay=function(){var ttDisplay=this.player_.getChild("textTrackDisplay");ttDisplay&&ttDisplay.updateDisplay()},TextTrackSettings.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(document_1,"keydown",this.handleKeyDown);var cb=this.player_.controlBar,subsCapsBtn=cb&&cb.subsCapsButton,ccBtn=cb&&cb.captionsButton;subsCapsBtn?subsCapsBtn.focus():ccBtn&&ccBtn.focus()},TextTrackSettings}(ModalDialog);Component$19.registerComponent("TextTrackSettings",TextTrackSettings);var Component$20=videojs$1.getComponent("Component"),EmpMediaInfoBar=function(_Component){function EmpMediaInfoBar(player,options){classCallCheck(this,EmpMediaInfoBar);var _this=possibleConstructorReturn(this,_Component.call(this,player,options));return _this.assetMetadata=null,_this.on(_this.player(),empPlayerEvents.ENDED,function(){_this.hide(),_this.clearEl(),_this.assetMetadata=null}),_this.on(_this.player(),empPlayerEvents.ABORT,function(){_this.hide(),_this.clearEl(),_this.assetMetadata=null}),_this.on(_this.player(),empPlayerEvents.CHROMECAST_CASTING,function(){_this.hide(),_this.clearEl(),_this.assetMetadata=null}),_this.on(_this.player(),empPlayerEvents.PLAYING,function(){if(_this.show(),!_this.assetMetadata){var opt=_this.player().options();opt.mediaInfo&&_this.updateMediaInformation_({title:opt.mediaInfo.title,subtitle:opt.mediaInfo.subtitle,images:opt.mediaInfo.artworkUrl?[{url:opt.mediaInfo.artworkUrl}]:[],channelInfo:{images:opt.mediaInfo.logoUrl?[{url:opt.mediaInfo.logoUrl}]:[]}})}}),_this.on(_this.player(),empPlayerEvents.PROGRAM_CHANGED,function(event,data){(data&&data.program?data.program.programId:null)?(_this.assetMetadata=_this.player().programService().extractAssetMetadata(data.program.asset),_this.assetMetadata.channelInfo=data.program.channelInfo,_this.updateMediaInformation_(_this.assetMetadata)):(_this.hide(),_this.clearEl(),_this.assetMetadata=null)}),_this.on(_this.player(),empPlayerEvents.ASSET_CHANGED,function(event,data){data&&data.asset?(_this.assetMetadata=_this.player().programService().extractAssetMetadata(data.asset),_this.updateMediaInformation_(_this.assetMetadata)):(_this.hide(),_this.clearEl(),_this.assetMetadata=null)}),_this.on(_this.player(),empPlayerEvents.DISPOSE,function(){_this.hide(),_this.clearEl()}),_this.fillEl(),_this}return inherits(EmpMediaInfoBar,_Component),EmpMediaInfoBar.prototype.buildCSSClass=function(){return"emp-mediainfo-bar "+_Component.prototype.buildCSSClass.call(this)},EmpMediaInfoBar.prototype.createEl=function(){return _Component.prototype.createEl.call(this,"div",{className:"emp-mediainfo-bar"})},EmpMediaInfoBar.prototype.imageSelector=function(images,imageType){var image=void 0;images.length>0&&(image=images[0]);for(var i=0;i<images.length;i++)if(images[i].url&&images[i].type===imageType)return images[i];return image},EmpMediaInfoBar.prototype.updateMediaInformation_=function(assetMetadata){if(this.el_){this.show();if(this.player().options().mediaInfo){this.fillEl();var mediaArtworkElCollection=this.el_.getElementsByClassName("emp-media-artwork"),mediaLogoElCollection=this.el_.getElementsByClassName("emp-media-logo"),mediaTitleElCollection=this.el_.getElementsByClassName("emp-media-title"),mediaSubtitleElCollection=this.el_.getElementsByClassName("emp-media-subtitle"),mediaArtworkEl=mediaArtworkElCollection.length?mediaArtworkElCollection[0]:null,mediaLogoEl=mediaLogoElCollection.length?mediaLogoElCollection[0]:null,mediaTitleEl=mediaTitleElCollection.length?mediaTitleElCollection[0]:null,mediaSubtitleEl=mediaSubtitleElCollection.length?mediaSubtitleElCollection[0]:null;if(mediaTitleEl&&(mediaTitleEl.innerHTML=assetMetadata.title||""),mediaSubtitleEl&&(mediaSubtitleEl.innerHTML=assetMetadata.subtitle||""),mediaArtworkEl&&assetMetadata.images&&assetMetadata.images.length>0){var image=this.imageSelector(assetMetadata.images,"chromecast");mediaArtworkEl.style.backgroundImage='url("'+image.url+'")',mediaArtworkEl.style.display="block"}else mediaArtworkEl&&(mediaArtworkEl.style.display="none",mediaArtworkEl.style.backgroundImage="none");if(mediaLogoEl&&assetMetadata.channelInfo){var channelLogo=this.imageSelector(assetMetadata.channelInfo.images,"thumbnail");channelLogo&&channelLogo.url?(mediaLogoEl.style.backgroundImage='url("'+channelLogo.url+'")',mediaLogoEl.style.display="block"):(mediaLogoEl.style.display="none",mediaLogoEl.style.backgroundImage="none")}this.player().userActive(!0)}}},EmpMediaInfoBar.prototype.clearEl=function(){this.el_&&(this.el_.innerHTML="")},EmpMediaInfoBar.prototype.fillEl=function(){var opt=this.player().options();if(opt.mediaInfo){var html="";opt.mediaInfo.artworkEnable&&(html+='<div class="emp-media-artwork"></div>'),(opt.mediaInfo.titleEnable||opt.mediaInfo.subtitleEnable)&&(html+='<div class="emp-media-text">'),opt.mediaInfo.titleEnable&&(html+='<div class="emp-media-title"></div>'),opt.mediaInfo.subtitleEnable&&(html+='<div class="emp-media-subtitle"></div>'),(opt.mediaInfo.titleEnable||opt.mediaInfo.subtitleEnable)&&(html+="</div>"),opt.mediaInfo.logoEnable&&(html+='<div class="emp-media-logo"></div>'),this.el_.innerHTML=html}else this.el_.innerHTML=""},EmpMediaInfoBar}(Component$20);EmpMediaInfoBar.prototype.controlText_="MediaInfo",Component$20.registerComponent("EmpMediaInfoBar",EmpMediaInfoBar),MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var errNum=0;errNum<MediaError.errorTypes.length;errNum++)MediaError[MediaError.errorTypes[errNum]]=errNum,MediaError.prototype[MediaError.errorTypes[errNum]]=errNum;var VjsPlayer=videojs$1.getComponent("Player"),Tech=videojs$1.getComponent("Tech"),CaptionSettingsMenuItem=videojs$1.getComponent("CaptionSettingsMenuItem");window_1.vttjs&&window_1.vttjs.restore();var Player=function(_VjsPlayer){function Player(tag){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},ready=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};classCallCheck(this,Player),options.absoluteStartTime&&(options.startTime=0),options=assign({children:["mediaLoader","PosterImage","textTrackDisplay","loadingSpinner","empMediaInfoBar","controlBar","errorDisplay","textTrackSettings","BigPlayButton"]},options),"auto"===options.techOrder||Array.isArray(options.techOrder)&&1===options.techOrder.length&&"auto"===options.techOrder[0]?options.techOrder=Player.AutoTechArray("EmpShaka"):"auto-dashif"===options.techOrder||Array.isArray(options.techOrder)&&1===options.techOrder.length&&"auto-dashif"===options.techOrder[0]?options.techOrder=Player.AutoTechArray("EmpDashif"):Array.isArray(options.techOrder)&&(options.techOrder=Player.GetValidAutoTechOrder(options.techOrder));var tagOptions=Player.getTagSettings(tag);options=videojs$1.mergeOptions({"entitlement-engine":"EricssonExposure",techOrder:tagOptions.techOrder?tagOptions.techOrder:Player.AutoTechArray("EmpShaka"),maxBitrate:tagOptions.maxBitrate?tagOptions.maxBitrate:0,timeShiftDisabled:!!tagOptions.timeShiftDisabled&&tagOptions.timeShiftDisabled,useLastViewedOffset:!!tagOptions.useLastViewedOffset&&tagOptions.useLastViewedOffset,startTime:tagOptions.startTime?tagOptions.startTime:0,absoluteStartTime:tagOptions.absoluteStartTime?tagOptions.absoluteStartTime:void 0,persistTextTrackSettings:tagOptions.persistTextTrackSettings?tagOptions.persistTextTrackSettings:!IS_IE_OR_EDGE,textTrackSettings:tagOptions.textTrackSettings?tagOptions.textTrackSettings:!IS_IE_OR_EDGE},options);var _this=possibleConstructorReturn(this,_VjsPlayer.call(this,tag,options,ready));return _this.monkeyPatchingTextMenu_(),window_1.empPlayer&&log$1.islogToBrowserConsole&&window_1.empPlayer.setInstance(_this),_this.previousAbsoluteStartTime_=void 0,_this.castPlugin&&_this.castPlugin(),_this.on(empPlayerEvents.ENDED,function(){log$1("ENDED"),_this.ended_=!0,_this.sourceChanging_=!1,_this.stopProgramService(),_this.entitlementExpirationService&&_this.entitlementExpirationService().stop(),"EmpCast"!==_this.techName_&&_this.loadNextSource(),_this.yospace&&_this.yospace().stop()}),_this.on(empPlayerEvents.DISPOSE,function(){_this.loadNextSrc_=null,_this.loadingSrc_&&(clearInterval(_this.loadingSrc_),_this.loadingSrc_=null),_this.sourceChanging_=!1,_this.clearResetAndReloadTimer_(),_this.stopProgramService(),_this.entitlementExpirationService&&_this.entitlementExpirationService().stop()}),_this.on(empPlayerEvents.ERROR,function(){_this.loadNextSrc_=null,_this.loadingSrc_&&(clearInterval(_this.loadingSrc_),_this.loadingSrc_=null),_this.sourceChanging_=!1,_this.clearResetAndReloadTimer_(),_this.stopProgramService(),_this.entitlementExpirationService&&_this.entitlementExpirationService().stop(),_this.yospace&&_this.yospace().stop()}),_this.on(empPlayerEvents.CAN_PLAY,function(){_this.disableTimeShift(_this.options_.timeShiftDisabled)}),_this.on(empPlayerEvents.LOADED_DATA,function(){if(_this.addClass("vjs-has-started"),_this.ended_=!1,_this.programService){var entitlement=_this.programService().entitlement();entitlement&&(entitlement.streamInfo.referenceTime=_this.startTimeLive())}}),_this.on(empPlayerEvents.REPLAY,function(){_this.cache_&&_this.cache_.source&&_this.cache_.source.yospaceUrl?_this.src({src:_this.cache_.source.yospaceUrl,type:"application/yospace"}):_this.cache_&&_this.cache_.source&&_this.src(_this.cache_.source)}),_this.on(empPlayerEvents.FIRST_PLAY,function(){log$1("FIRST_PLAY"),_this.options_.startTime&&"Html5"===_this.techName_&&_this.currentTime(_this.options_.startTime),_this.options_.startTime=0}),_this.initialSeekToAbsoluteStartTimeBind=_this.initialSeekToAbsoluteStartTime_.bind(_this),_this.isCreated=!0,_this.trigger(empPlayerEvents.PLAYER_CREATED),_this.ended_=!1,_this.sourceChanging_=!1,_this}return inherits(Player,_VjsPlayer),Player.prototype.monkeyPatchingTextMenu_=function(){if(this.controlBar&&this.controlBar.subsCapsButton){var originalCreateItems=this.controlBar.subsCapsButton.createItems,self=this;this.controlBar.subsCapsButton.createItems=function(){for(var oriItems=originalCreateItems.apply(this,arguments),items=[],ii=0;ii<oriItems.length;ii++)oriItems[ii].track&&""!==oriItems[ii].track.label&&items.push(oriItems[ii]);return items&&items.length>1&&"CaptionSettingsMenuItem"!==items[0].name()&&"EmpHLS"===self.techName_&&self.options_.textTrackSettings?(items.unshift(new CaptionSettingsMenuItem(this.player_,{kind:this.label_})),this.hideThreshold_+=1):items&&items.length>1&&"CaptionSettingsMenuItem"===items[0].name()&&"EmpDashif"===self.techName_&&(items.shift(),this.hideThreshold_-=1),items}}if(IS_EDGE){var textTrackMenuItem=videojs$1.getComponent("TextTrackMenuItem");if(textTrackMenuItem){var originalTextTrackMenuItem_handleClick=textTrackMenuItem.prototype.handleClick,self=this;textTrackMenuItem.prototype.handleClick=function(){originalTextTrackMenuItem_handleClick.apply(this,arguments),self.trigger(empPlayerEvents.TRACK_CHANGE),self.trigger(empPlayerEvents.TEXT_TRACK_CHANGE)}}}},Player.prototype.options=function(obj){return obj?("auto"===obj.techOrder||Array.isArray(obj.techOrder)&&1===obj.techOrder.length&&"auto"===obj.techOrder[0]?obj.techOrder=Player.AutoTechArray("EmpShaka"):"auto-dashif"===obj.techOrder||Array.isArray(obj.techOrder)&&1===obj.techOrder.length&&"auto-dashif"===obj.techOrder[0]?obj.techOrder=Player.AutoTechArray("EmpDashif"):Array.isArray(obj.techOrder)&&(obj.techOrder=Player.GetValidAutoTechOrder(obj.techOrder)),void 0!==obj.startTime&&(obj.startTime=parseFloat(obj.startTime)||0),void 0!==obj.absoluteStartTime&&(obj.startTime=0),this.options_=videojs$1.mergeOptions(this.options_,obj),this.options_):this.options_},Player.prototype.getTechOptions_=function(){return{autoplay:this.options_.autoplay,muted:this.options_.muted,language:this.options_.language,maxBitrate:this.options_.maxBitrate,timeShiftDisabled:this.options_.timeShiftDisabled,useLastViewedOffset:this.options_.useLastViewedOffset,startTime:this.options_.startTime,absoluteStartTime:this.options_.absoluteStartTime,audioLanguage:this.options_.audioLanguage,subtitleLanguage:this.options_.subtitleLanguage,liveDelay:this.options_.liveDelay}},Player.prototype.loadTech_=function(techName,source){var _this2=this;_VjsPlayer.prototype.loadTech_.call(this,techName,source),this.on(this.tech_,empPlayerEvents.RECOVERABLE_ASSET_ERROR,this.handleRecoverableError),this.on(this.tech_,empPlayerEvents.ERROR,function(event,error){_this2.player_.error(error)}),this.on(this.tech_,empPlayerEvents.TRACK_CHANGE,function(){log$1("TRACK_CHANGE"),_this2.player_.trigger(empPlayerEvents.TRACK_CHANGE)}),this.on(this.tech_,empPlayerEvents.DURATION_CHANGE,function(){_this2.player_.trigger(empPlayerEvents.DURATION_CHANGE)})},Player.prototype.loadNextSource=function(){return this.sourceChanging_?void log$1("loadNextSource ignore sourceChanging"):(this.sourceChanging_=!0,this.tech_&&void 0!==this.tech_.loadNextSource?(this.techCall_("loadNextSource"),!0):this.cache_.sources&&this.cache_.sources.length>1?(this.cache_.sources.shift(),this.src(this.cache_.sources),!0):(this.sourceChanging_=!1,!1))},Player.prototype.setTextTrackStyle=function(style){"EmpCast"===this.techName_?this.techCall_("sendTextTrackStyle",style):(this.options_.textTrackStyle=style,this.trigger(empPlayerEvents.TEXT_TRACK_CHANGE))},Player.prototype.lineUpAsset=function(assetId,channelId,programId,startTime){var asset={assetId:assetId,programId:programId,channelId:channelId};startTime&&this.options({playFrom:"beginning",absoluteStartTime:startTime}),this.lineupSource({type:"video/emp",src:JSON.stringify(asset)})},Player.prototype.lineupSource=function(source){if(this.tech_&&void 0!==this.tech_.lineupSource)return void this.techCall_("lineupSource",source);this.cache_.sources.push(source)},Player.prototype.unloadTech_=function(){this.techName_=null,_VjsPlayer.prototype.unloadTech_.call(this)},Player.prototype.stop=function(afterStopCallback){this.analytics&&this.analytics().stop(),this.yospace&&this.yospace().stop(),extplayer.stop(this,afterStopCallback)},Player.prototype.getAvalibleTechs_=function(excludeTechs){return this.options_.techOrder.map(function(techName){return techName.charAt(0).toUpperCase()+techName.slice(1)}).map(function(techName){return[techName,Tech.getTech(techName)]}).filter(function(_ref){var techName=_ref[0],tech=_ref[1];if(tech&&"Html5"!==techName&&"EmpCast"!==techName&&-1===excludeTechs.indexOf(techName))return tech.isSupported()})},Player.prototype.selectSource=function(sources){var _this3=this,orgTechOrder=this.options_.techOrder
;if(this.options_.excludeTechs&&this.options_.excludeTechs.length>0){var techs=this.options_.techOrder.filter(function(techName){if(-1===_this3.options_.excludeTechs.indexOf(techName))return!0});this.options_.techOrder=techs}var sourceTech=_VjsPlayer.prototype.selectSource.call(this,sources);return this.options_.techOrder=orgTechOrder,sourceTech},Player.prototype.handleRecoverableError=function(event,data){var excludeTechs=[];this.options_.excludeTechs&&(excludeTechs=this.options_.excludeTechs.slice(0)),excludeTechs.push(data.techName);var techs=this.getAvalibleTechs_(excludeTechs);if(data.source&&!data.source.licenseServer&&(!data.source.licenseServers||isEmpty(data.source.licenseServers))&&!data.source.protection&&!IS_CHROMECAST&&techs.length>0&&(6001!==data.error.code&&(log$1.error("handleRecoverableError",data.techName,data.message),this.analytics&&this.analytics().onError({code:data.error.code,message:data.message,stack:data.error.stack})),this.options_.excludeTechs||(this.options_.excludeTechs=[]),this.options_.excludeTechs.push(data.techName),this.options_.techOrder.length>this.options_.excludeTechs.length)){if(this.error(null),this.resetWithoutReload_(),this.options_.autoplay=this.options_.autoplay,this.hasStarted()&&(this.options_.autoplay=!0),this.options_.absoluteStartTime=this.previousAbsoluteStartTime_,data.source.channelId){var asset={channelId:data.source.channelId,programId:data.source.programId};return void _VjsPlayer.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(asset)})}if(data.source.assetId){var _asset={assetId:data.source.assetId};return void _VjsPlayer.prototype.src.call(this,{type:"video/emp",src:JSON.stringify(_asset)})}}data.error.code&&data.error.message?this.error(data.error):(data.message=data.message||this.localize("Tech error, can't recover"),this.error(new EmpPlayerError(data.message,data.error.code))),this.resetWithoutReload_()},Player.prototype.resetWithoutReload_=function(){this.tech_&&(this.techCall_("reset"),this.unloadTech_())},Player.prototype.resetAndRestartFormPlayhead=function(){var program=this.getProgramDetails();program&&extplayer.currentAsset(this,null,program.programId,program.channelId);var startTime=this.getAbsoluteTime();log$1("resetAndRestartFormPlayhead",startTime),this.reset(),this.startResetAndReloadTimer_(),this.restart(null,startTime)},Player.prototype.bitrates=function(){return extplayer.bitrates(this)},Player.prototype.bitrate=function(value){return extplayer.bitrate(this,value)},Player.prototype.getBitrate=function(){return extplayer.getBitrate(this)},Player.prototype.selectAudioTrack=function(languageCode,kind){for(var audioTracks=this.audioTracks(),i=audioTracks.length;i--;){var track=audioTracks[i];if(track.language===languageCode&&!track.enabled)return void(kind&&track.kind!==kind||(track.enabled=!0))}},Player.prototype.getSelectedAudioTrack=function(){return extplayer.getSelectedAudioTrack(this)},Player.prototype.getAudioTracksLanguages=function(){for(var audioTracksLanguages=[],audioTracks=this.audioTracks(),i=0;i<audioTracks.length;i++)audioTracksLanguages.push(audioTracks[i].language);return audioTracksLanguages},Player.prototype.selectTextTrack=function(languageCode,kind){languageCode=languageCode&&"None"!==languageCode?languageCode:null;for(var textTracks=this.textTracks(),i=textTracks.length;i--;){var track=textTracks[i];track.language===languageCode?kind&&track.kind!==kind||(track.mode="showing"):"disabled"!==track.mode&&(track.mode="disabled")}"EmpHLS"===this.techName_&&IS_EDGE&&(this.trigger(empPlayerEvents.TRACK_CHANGE),this.trigger(empPlayerEvents.TEXT_TRACK_CHANGE))},Player.prototype.getSelectedTextTrack=function(){return extplayer.getSelectedTextTrack(this)},Player.prototype.textTrackVisible=function(visible){for(var textTracks=this.textTracks(),i=textTracks.length;i--;){var track=textTracks[i];if(visible){if("hidden"===track.mode)return void(track.mode="showing")}else"showing"===track.mode?track.mode="hidden":"disabled"!==track.mode&&(track.mode="disabled")}},Player.prototype.isTextTrackVisible=function(){for(var textTracks=this.textTracks(),i=textTracks.length;i--;){if("showing"===textTracks[i].mode)return!0}return!1},Player.prototype.getTextTracksLanguages=function(){for(var textTracksLanguages=[],textTracks=this.textTracks(),i=0;i<textTracks.length;i++)textTracksLanguages.push(textTracks[i].language);return textTracksLanguages},Player.prototype.canSeekTo=function(position){return extplayer.canSeekTo(this,position)},Player.prototype.getRestrictions=function(){var restrictions={},entitlement=extplayer.getEntitlement(this);return entitlement&&(restrictions={minBitrate:entitlement.minBitrate,maxBitrate:entitlement.maxBitrate,maxResWidth:entitlement.maxResWidth,maxResHeight:entitlement.maxResHeight,rwEnabled:entitlement.rwEnabled,ffEnabled:entitlement.ffEnabled}),restrictions},Player.prototype.isPlaying=function(){return this.hasStarted()},Player.prototype.isLive=function(){return extplayer.isLive(this)},Player.prototype.techVersion=function(){return extplayer.techVersion(this)},Player.prototype.baseCurrentTime=function(){return extplayer.baseCurrentTime(this)},Player.prototype.baseDuration=function(seconds){if(void 0===seconds)return extplayer.baseDuration(this);_VjsPlayer.prototype.duration.call(this,seconds)},Player.prototype.src=function(source){var _this4=this;if(void 0===source)return this.cache_.src||"";if(!this.isCreated)return void this.one(empPlayerEvents.PLAYER_CREATED,function(){_this4.src(source)});var sources=filterSource(source);if(!sources.length)return void this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);if(sources[0].type||(sources[0].type="video/emp"),"video/emp"===sources[0].type){if(this.loadingSrc_)return log$1("load src blocked",source),void(this.loadNextSrc_=source);this.loadingSrc_=setTimeout(function(){_this4.loadingSrc_=null,_this4.loadNextSrc_&&_this4.src(_this4.loadNextSrc_)},3e3)}return this.loadNextSrc_=null,log$1("load src OK"),this.yospace&&this.yospace().stop(),this.options_.excludeTechs=[],this.tech_||this.reset(),this.cache_.currentTime=0,this.cache_.duration=NaN,this.error(null),"video/emp"!==sources[0].type&&this.stopProgramService(),this.isPlaying()&&(this.sourceChanging_=!0),extplayer.casting(this,sources)?void 0:(sources[0].options&&this.options(sources[0].options),"video/emp"!==sources[0].type&&(sources[0].options=this.getTechOptions_()),this.off(empPlayerEvents.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),this.one(empPlayerEvents.LOADED_DATA,this.initialSeekToAbsoluteStartTimeBind),"application/yospace"===sources[0].type&&this.yospace?void this.yospace().start("VoD",sources[0].src).then(function(mediaLocator){log$1("yospace mediaLocator returned",mediaLocator),_this4.options_.excludeTechs.push("EmpShaka"),_this4.options_.excludeTechs.push("EmpDashif"),sources[0]={src:mediaLocator,type:"application/x-mpegURL",yospaceUrl:sources[0].src},_VjsPlayer.prototype.src.call(_this4,sources)}).catch(function(errMsg){_this4.error(errMsg)}):_VjsPlayer.prototype.src.call(this,sources))},Player.prototype.reset=function(){this.clearResetAndReloadTimer_(),this.hasStarted(!1),_VjsPlayer.prototype.reset.call(this)},Player.prototype.clearResetAndReloadTimer_=function(){this.resetAndReloadTimer_&&(log$1("clearResetAndReloadTimer"),clearInterval(this.resetAndReloadTimer_),this.resetAndReloadTimer_=null)},Player.prototype.startResetAndReloadTimer_=function(){var _this5=this;if(!(IS_CHROMECAST&&this.hasStarted()||(this.clearResetAndReloadTimer_(),log$1("startResetAndReloadTimer"),!1===this.options_.resetAndReloadLive))){var time=120;time=this.options_.resetAndReloadLive?this.options_.resetAndReloadLive>1?this.options_.resetAndReloadLive:1:IS_CHROMECAST?120:360,this.resetAndReloadTimer_=this.setTimeout(function(){_this5.clearResetAndReloadTimer_(),_this5.isLive()&&"DASH"===_this5.streamType&&_this5.resetAndRestartFormPlayhead()},1e3*time*60)}},Player.prototype.initialSeekToAbsoluteStartTime_=function(){var entitlement=extplayer.getEntitlement(this);this.options_.absoluteStartTime&&this.timeShiftEnabled()?(this.setAbsoluteTime(new Date(this.options_.absoluteStartTime)),this.previousAbsoluteStartTime_=this.options_.absoluteStartTime,this.options_.absoluteStartTime=void 0):this.options_.useLastViewedOffset&&entitlement&&!this.isLive()&&"DASH"===this.streamType&&entitlement.lastViewedOffset&&this.currentTime(entitlement.lastViewedOffset/1e3)},Player.prototype.setMaxBitrate=function(bitrate){this.options_.maxBitrate=bitrate,this.tech_&&void 0!==this.tech_.setMaxBitrate&&this.techCall_("setMaxBitrate",bitrate)},Player.prototype.getMaxBitrate=function(){return this.tech_&&void 0!==this.tech_.getMaxBitrate?this.techGet_("getMaxBitrate"):0},Player.prototype.disableTimeShift=function(value){if(!this.tech_||void 0===this.tech_.disableTimeShift)return!1;if(void 0!==value){if(!1===value&&!this.canEnableTimeshift())return!extplayer.timeShiftEnabled(this);this.techCall_("disableTimeShift",value);var isEnabled=extplayer.timeShiftEnabled(this);return this.options_.timeShiftDisabled=void 0===isEnabled?value:!isEnabled,this.trigger(empPlayerEvents.TIMESHIFT_CHANGE,{timeShiftDisabled:this.options_.timeShiftDisabled}),this.options_.timeShiftDisabled}return!extplayer.timeShiftEnabled(this)},Player.prototype.canEnableTimeshift=function(){var entitlement=extplayer.getEntitlement(this);return!entitlement||!1!==entitlement.timeshiftEnabled},Player.prototype.timeShiftEnabled=function(value){if(void 0===value)return extplayer.timeShiftEnabled(this);this.disableTimeShift(!value)},Player.prototype.noEPG=function(){if(!this.getProgramDetails()){var entitlement=extplayer.getEntitlement(this);return!entitlement||entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)}return!1},Player.prototype.canRestart=function(){return!extplayer.getEntitlement(this)||!this.noEPG()&&extplayer.canRestart(this)},Player.prototype.restart=function(useLastViewedOffset,startTime){extplayer.restart(this,useLastViewedOffset,startTime)},Player.prototype.error=function(err){return void 0===err?this.error_||null:null===err?void _VjsPlayer.prototype.error.call(this,err):this.error_&&err&&4===err.code?this.error_:(err&&isString(err)?err=new EmpPlayerError(err):err&&!err.code&&(err.code=EmpPlayerErrorCodes.UNKNOWN),err&&this.cache_.sources&&this.cache_.sources.length>1?(log$1.error(err),this.loadNextSource(),err):this.videojsError_(err))},Player.prototype.videojsError_=function(err){if(void 0===err)return this.error_||null;if(null===err)return this.error_=err,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new MediaError(err),this.addClass("vjs-error");var errorTypes="";MediaError.errorTypes.hasOwnProperty(this.error_.code)&&(errorTypes=MediaError.errorTypes[this.error_.code]),log$1.error("(CODE:"+this.error_.code+" "+errorTypes+")",this.error_.message,this.error_),this.trigger({type:empPlayerEvents.ERROR,bubbles:!0},this.error_)},Player.prototype.getError=function(){return this.error_},Player.prototype.setAbsoluteTime=function(date){extplayer.setAbsoluteTime(this,date)},Player.prototype.getAbsoluteTime=function(){return extplayer.getAbsoluteTime(this)},Player.prototype.playheadTime=function(unixTime){if(void 0===unixTime)return extplayer.getPlayheadTime(this);extplayer.setPlayheadTime(this,unixTime)},Player.prototype.setAnalyticsCustomAttribute=function(key,value){this.options_.analytics||(this.options_.analytics={}),this.options_.analytics.customAttributes||(this.options_.analytics.customAttributes=[]),this.options_.analytics.customAttributes.push({key:key,value:value})},Player.prototype.loadAsset=function(assetId,programId){var callback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};log$1.warn("loadAsset() has been deprecated with new USP a/v pipe use startPlayback() or src() instead"),this.options({playFrom:void 0}),extplayer.loadAsset(this,assetId,programId,null,callback)},Player.prototype.startPlayback=function(assetId,channelId,programId,playbackProperties){if(playbackProperties||(playbackProperties={}),!assetId&&!channelId&&!programId)return void log$1.error("assetId or channelId or programId is undefined");playbackProperties.playFrom||(playbackProperties.playFrom="defaultBehaviour");var options={playFrom:playbackProperties.playFrom};void 0!==playbackProperties.autoplay&&(options.autoplay=playbackProperties.autoplay),playbackProperties.startTime&&"startTime"===playbackProperties.playFrom?(options.absoluteStartTime=playbackProperties.startTime,this.options_.useLastViewedOffset=!1):options.absoluteStartTime=void 0,void 0!==playbackProperties.startOffset?options.startTime=playbackProperties.startOffset/1e3:options.startTime=0,options.useLastViewedOffset="bookmark"===playbackProperties.playFrom||!0===this.options_.useLastViewedOffset,this.options(options),extplayer.loadAsset(this,assetId,programId,channelId)},Player.prototype.playEntitlement=function(entitlement){entitlement&&isObject(entitlement)?(entitlement.type="video/emp",_VjsPlayer.prototype.src.call(this,entitlement)):log$1.error("Call playEntitlement without entitlement")},Player.prototype.timeBehindLive=function(){return extplayer.timeBehindLive(this)},Player.prototype.liveDelay=function(){return extplayer.liveDelay(this)},Player.prototype.startTimeLive=function(){return extplayer.startTimeLive(this)},Player.prototype.getCurrentTechName=function(){return this.techName_},Player.prototype.getExposure=function(){return this.programService?this.programService().exposure:null},Player.prototype.syncServerTime=function(callback){if(this.programService&&(exposure=this.programService().exposure,exposure))return void exposure.syncServerTime(callback);var errMsg="No programService or No exposure";log$1.error(errMsg),callback&&callback(0,errMsg)},Player.prototype.stopProgramService=function(){this.programService&&this.programService().reset()},Player.prototype.startProgramService=function(){this.programService&&this.programService().start()},Player.prototype.supportsEpgProgramChange=function(){return void 0!==this.programService},Player.prototype.getServerTime=function(){return extplayer.getServerTime(this)},Player.prototype.getProgram=function(callback){if(this.programService){var program=this.getProgramDetails();callback(program,program?null:"No EPG for program")}},Player.prototype.getProgramDetails=function(){return extplayer.supportsEpgProgramChange(this)?extplayer.program(this):this.programService?this.programService().currentProgram:void 0},Player.prototype.getAssetDetails=function(){return this.tech_&&this.tech_.VOD?this.techGet_("VOD"):this.programService?this.programService().currentVOD:void 0},Player.prototype.getSeekTimerange=function(){return extplayer.getSeekTimerange(this)},Player.prototype.getBufferedTimerange=function(){return extplayer.getBufferedTimerange(this)},Player.prototype.currentTime=function(seconds){var entitlement=extplayer.getEntitlement(this);if(entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==seconds){var _program=this.getProgramDetails();if(_program){seconds<1&&seconds>-1&&(seconds=1);var start=new Date(_program.startTime);if(entitlement.isStaticCachupAsLive||"HLS"===this.streamType){var t=entitlement.streamInfo;if((seconds+=(start.getTime()-t.start.getTime())/1e3)<=0)return seconds=0,void extplayer.playPreviousProgram(this,!0)}else if(1e3*(seconds+=start.getTime()/1e3)<=entitlement.streamInfo.start.getTime())return seconds=entitlement.streamInfo.start.getTime()/1e3+1,void extplayer.playPreviousProgram(this,!0)}return seconds<0&&(seconds=0),void this.techCall_("setCurrentTime",seconds)}var currentTime=this.techGet_("currentTime")||0,program=this.getProgramDetails();if(program&&currentTime>1){var _start=new Date(program.startTime);if(entitlement.isStaticCachupAsLive||"HLS"===this.streamType){var _t=entitlement.streamInfo;currentTime-=(_start.getTime()-_t.start.getTime())/1e3}else currentTime-=_start.getTime()/1e3}else program||this.duration(1/0);return this.scrubbing()||(this.cache_.currentTime=currentTime),this.cache_.currentTime}return void 0!==seconds?(entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)&&"EmpCast"===this.techName_||(seconds=seconds<0?0:seconds),void this.techCall_("setCurrentTime",seconds)):(this.scrubbing()||(this.cache_.currentTime=this.techGet_("currentTime")||0),this.cache_.currentTime)},Player.prototype.duration=function(seconds){var entitlement=extplayer.getEntitlement(this);if(entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){if(void 0!==seconds){var _program2=this.getProgramDetails();if(_program2&&seconds!==1/0){var start=new Date(_program2.startTime);if(entitlement.isStaticCachupAsLive||"HLS"===this.streamType){var t=entitlement.streamInfo;seconds-=(start.getTime()-t.start.getTime())/1e3}else seconds-=start.getTime()/1e3}return this.noEPG()&&(seconds=1/0,this.addClass("vjs-live")),void _VjsPlayer.prototype.duration.call(this,seconds)}var duration=this.techGet_("duration"),program=this.getProgramDetails();return program&&duration!==1/0&&(duration=program.duration/1e3),this.noEPG()&&(duration=1/0,this.addClass("vjs-live")),this.cache_.duration=duration,duration}return _VjsPlayer.prototype.duration.call(this,seconds),this.techGet_("duration")},Player.prototype.seekable=function(){var range=_VjsPlayer.prototype.seekable.call(this);return"EmpCast"!==this.techName_?this.getRange_(range):range},Player.prototype.buffered=function(){var range=_VjsPlayer.prototype.buffered.call(this);return"EmpCast"!==this.techName_?this.getRange_(range):range},Player.prototype.getRange_=function(range){var entitlement=extplayer.getEntitlement(this);if(this.seeking()||!range)return createTimeRanges(0,0);if(range.length>0&&entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)){var program=this.getProgramDetails();if(program){var programStart=new Date(program.startTime),t=entitlement.streamInfo,startRange=range.start(range.length-1),endRange=range.end(range.length-1);if(endRange)if(entitlement.isStaticCachupAsLive||"HLS"===this.streamType)startRange-=(programStart.getTime()-t.start.getTime())/1e3,endRange-=(programStart.getTime()-t.start.getTime())/1e3,range=createTimeRanges(startRange>0?startRange:0,endRange>this.duration()?this.duration():endRange);else if(entitlement.isDynamicCachupAsLive){startRange-=programStart.getTime()/1e3,endRange-=programStart.getTime()/1e3;var liveDuration=this.getGrowingLiveDuration();range=createTimeRanges(startRange>0?startRange:0,endRange>liveDuration?liveDuration:endRange)}}}return range},Player.prototype.getGrowingLiveDuration=function(){var entitlement=extplayer.getEntitlement(this),duration=this.duration(),program=this.getProgramDetails();if(program&&duration!==1/0&&entitlement&&entitlement.isDynamicCachupAsLive){if(this.getServerTime()<new Date(program.endTime).getTime()){if((duration=this.techGet_("duration"))!==1/0){var t=entitlement.streamInfo;duration="HLS"===this.streamType?(t.start.getTime()+1e3*duration-program.start.getTime())/1e3:(1e3*duration-program.start.getTime())/1e3}}else duration=program.duration/1e3}return duration},Player.prototype.remainingTime=function(){var entitlement=extplayer.getEntitlement(this),time=0;if(entitlement&&(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)&&"EmpCast"!==this.techName_){var duration=this.duration();if(duration===1/0||0===duration)return 1/0;time=duration-this.currentTime()}else time=extplayer.remainingTime(this);return time<0&&(time=0),Math.round(time)},Player.prototype.gotoLive=function(){extplayer.gotoLive(this)},Player.prototype.playPreviousProgram=function(end){var _this6=this;if(this.sourceChanging_)return void log$1("playPreviousProgram ignore sourceChanging");if(this.tech_.playPreviousProgram)this.techCall_("playPreviousProgram",end);else{var entitlement=extplayer.getEntitlement(this);this.programService&&(entitlement.isStaticCachupAsLive||entitlement.isDynamicCachupAsLive)&&entitlement.rwEnabled?this.programService().getPreviousProgram(function(program,error){if(error)log$1.warn("playPreviousProgram",error);else{new Date(program.startTime);end?_this6.playheadTime(program.end.getTime()-3e4):_this6.playheadTime(program.start.getTime()+1e3)}}):extplayer.playPreviousProgram(this)}},Player.prototype.playNextProgram=function(){if(this.sourceChanging_)return void log$1("playNextProgram ignore sourceChanging");if(this.tech_.playNextProgram)this.techCall_("playNextProgram");else{var entitlement=extplayer.getEntitlement(this),program=this.getProgramDetails();program&&(entitlement.isStaticCachupAsLive||entitlement.isDynamicCachupAsLive)&&entitlement.ffEnabled?this.playheadTime(program.end.getTime()+1e3):extplayer.playNextProgram(this)}},Player.prototype.isProgramLive=function(){var program=this.getProgramDetails();return program?program.end.getTime()>this.getServerTime():this.isLive()},Player.prototype.isProgramCatchup=function(){var entitlement=extplayer.getEntitlement(this);return entitlement?entitlement.isStaticCachupAsLive||!this.isProgramLive()&&entitlement.isDynamicCachupAsLive:!this.isLive()},Player.prototype.currentAsset=function(){return extplayer.currentAsset(this)},Player.prototype.ended=function(){return this.ended_},Player.prototype.handleTechWaiting_=function(){var _this7=this;!this.hasStarted()||this.ended()||this.paused()||this.hasClass("vjs-waiting")||this.playheadMoving_(function(moving){moving||(_this7.addClass("vjs-waiting"),_this7.trigger(empPlayerEvents.WAITING),_this7.removeWaitingClass_())})},Player.prototype.removeWaitingClass_=function(){var _this8=this;this.one("timeupdate",function(){_this8.playheadTime()-_this8.prePlayheadTime_>1||_this8.playheadTime()-_this8.prePlayheadTime_<-1?(_this8.prePlayheadTime_=0,_this8.removeClass("vjs-waiting"),_this8.paused()?_this8.trigger(empPlayerEvents.PAUSE):_this8.trigger(empPlayerEvents.PLAYING)):_this8.removeWaitingClass_()})},Player.prototype.playheadMoving_=function(callback){this.playheadMovingTimer_&&(clearInterval(this.playheadMovingTimer_),this.playheadMovingTimer_=null),this.prePlayheadTime_=this.playheadTime(),this.playheadMovingTimer_=this.setTimeout(function(){callback(this.playheadTime()-this.prePlayheadTime_>200||this.playheadTime()-this.prePlayheadTime_<-200)},2e3)},Player.prototype.handleTechCanPlay_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(empPlayerEvents.CAN_PLAY)},Player.prototype.handleTechCanPlayThrough_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.trigger(empPlayerEvents.CAN_PLAY_THROUGH)},Player.prototype.handleTechPlaying_=function(){this.prePlayheadTime_||this.removeClass("vjs-waiting"),this.sourceChanging_=!1,this.trigger(empPlayerEvents.PLAYING)},Player.prototype.sourceChanging=function(){return this.sourceChanging_},Player.prototype.isCasting=function(){return"EmpCast"===this.techName_},createClass(Player,[{key:"version",get:function(){return"2.1.97-259"}},{key:"entitlement",get:function(){var entitlement=extplayer.getEntitlement(this);return entitlement&&(entitlement=assign({},entitlement),entitlement.options=void 0),entitlement}},{key:"streamType",get:function(){return this.tech_?this.tech_.streamType:void 0}}]),Player}(VjsPlayer);Player.AutoTechArray=function(chosenDashTech){var dashTech1=Tech.techs_.hasOwnProperty("EmpShaka"),dashTech2=Tech.techs_.hasOwnProperty("EmpDashif");dashTech1&&dashTech2||(chosenDashTech=dashTech1?"EmpShaka":"EmpDashif");var autoTechOrder=[chosenDashTech,"EmpHLS-MSE","EmpHLS","Html5"];return Player.SupportFairplay_()&&(autoTechOrder=["EmpHLS",chosenDashTech,"Html5"]),Player.GetValidAutoTechOrder(autoTechOrder)},Player.GetValidAutoTechOrder=function(techOrder){for(var validAutoTechOrder=[],i=0;i<techOrder.length;i++)Tech.techs_.hasOwnProperty(techOrder[i])&&validAutoTechOrder.push(techOrder[i]);return validAutoTechOrder},Player.SupportFairplay_=function(){var hlsTech=videojs$1.getTech("EmpHLS");return!!(void 0!==hlsTech&&hlsTech.isSupported()&&window_1.WebKitMediaKeys&&hlsTech.getKeySystem&&window_1.WebKitMediaKeys.isTypeSupported(hlsTech.getKeySystem(),"video/mp4"))},videojs$1.getComponent("Component").registerComponent("player",Player);var EMPAnalyticsConnector=function(){function EMPAnalyticsConnector(player,analytics,analyticsConfig){classCallCheck(this,EMPAnalyticsConnector),this.INITIAL_REFERENCE_TIME=1,this.player_=player,this.analytics_=analytics,this.sessionId_=null,this.customAttributes=analyticsConfig.analytics&&analyticsConfig.analytics.customAttributes,this.exposure=analyticsConfig.exposure,this.currentTimeTimer=null,this.onPlayBind=this.onPlay.bind(this),this.onResumedBind=this.onResume.bind(this),this.onPlayingBind=this.onPlaying.bind(this),this.onPauseBind=this.onPause.bind(this),this.onEndedBind=this.onEnded.bind(this),this.onErrorBind=this.onError.bind(this),this.onDrmSessionUpdateBind=this.onDrmSessionUpdate.bind(this),this.onEntitlementLoadStartBind=this.onEntitlementLoadStart.bind(this),this.onBitrateChangeBind=this.onBitrateChange.bind(this),this.onDisposeBind=this.onDispose.bind(this),this.onLoadStartBind=this.onLoadStart.bind(this),this.onSeekedBind=this.onSeeked.bind(this),this.onWaitingBind=this.onWaiting.bind(this),this.onChromeCastingStartBind=this.onChromeCastingStart.bind(this),this.onChromeCastingStopBind=this.onChromeCastingStop.bind(this),this.onProgramChangeBind=this.onProgramChange.bind(this),this.onWaitingEndedBind=this.onWaitingEnded.bind(this),this.onErrorBeforeAssetBind=this.onErrorBeforeAsset.bind(this),this.onEntitlementChangeBind=this.onEntitlementChange.bind(this),this.onWindowUnloadBind=this.onWindowUnload.bind(this),this.onPlayingAfterStartBind=this.onPlayingAfterStart.bind(this),this.allEvents_=Object.keys(empPlayerEvents).map(function(key){return empPlayerEvents[key]}),this.init(),this.createdSessions={},this.mem={}}return EMPAnalyticsConnector.prototype.SessionId=function(playSessionId){if(!(playSessionId||this.entitlement()&&this.entitlementLoaded_))return this.errorSessionId;var sId=playSessionId||this.entitlement().playSessionId;return this.mem[sId]||(this.mem[sId]={pause:{},resume:{}}),sId},EMPAnalyticsConnector.prototype.hasSessionId=function(){return!(!this.entitlement()||!this.entitlementLoaded_)},EMPAnalyticsConnector.prototype.sendCurrentTime=function(){var sessionId=this.SessionId();sessionId&&this.player_&&this.analytics_.getSessionState&&"PLAYING"===this.analytics_.getSessionState(sessionId)&&this.analytics_.setCurrentTime(sessionId,this.OffsetTime())},EMPAnalyticsConnector.prototype.registerCurrentTimeTimer=function(){var _this=this;this.clearTimers(),this.currentTimeTimer=setInterval(function(){_this.sendCurrentTime();var sessionId=_this.SessionId();sessionId&&_this.analytics_&&_this.analytics_.ok&&!1===_this.analytics_.ok(sessionId)&&(_this.exposure?_this.exposure.verifySession(null,function(){_this.player_.el_&&(_this.player_.trigger(empPlayerEvents.ERROR,"401 INVALID_SESSION_TOKEN: The session token is no longer valid."),extplayer.stop(_this.player_)),_this.clearTimers()}):log$1.error("registerCurrentTimeTimer Exposure is undefined"))},1e3)},EMPAnalyticsConnector.prototype.clearTimers=function(){this.currentTimeTimer&&clearInterval(this.currentTimeTimer),this.currentTimeTimer=null},EMPAnalyticsConnector.prototype.init=function(){if(!this.player_||!this.analytics_)return void log$1.warn("Warning: init failed . Possible causes: either player or analytics were not set.");this._errorSessionId=null,this.disabled_=!1,this.entitlementLoaded_=!1,log$1("Initialization EmpAnalytics"),this.analytics_.init(),window_1.addEventListener("beforeunload",this.onWindowUnloadBind),this.player_.on(empPlayerEvents.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.on(empPlayerEvents.PAUSE,this.onPauseBind),this.player_.on(empPlayerEvents.SEEKED,this.onSeekedBind),this.player_.on(empPlayerEvents.ENDED,this.onEndedBind),this.player_.on(empPlayerEvents.ERROR,this.onErrorBind),this.player_.on(empPlayerEvents.DISPOSE,this.onDisposeBind),this.player_.on(empPlayerEvents.STOPPED,this.onDisposeBind),this.player_.on(empPlayerEvents.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.on(empPlayerEvents.WAITING,this.onWaitingBind),this.player_.on(empPlayerEvents.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.on(empPlayerEvents.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.on(empPlayerEvents.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.on(empPlayerEvents.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},EMPAnalyticsConnector.prototype.onWindowUnload=function(){var _this2=this;this.onGeneric("WindowClose",this.analytics_.dispose,function(){!0===_this2.hasSessionId()&&_this2.analytics_.dispose(_this2.SessionId(),_this2.getCachedCurrentTime()),_this2.analytics_.dispatchNow(!1),_this2.clearTimers()},!0)},EMPAnalyticsConnector.prototype.onChromeCastingStart=function(){var _this3=this;this.onGeneric("StartCasting",this.analytics_.startCasting,function(){if(!1!==_this3.hasSessionId()){if(_this3.SessionId()){var currentTime=_this3.getCachedCurrentTime();log$1("StartCasting",currentTime),_this3.analytics_.startCasting(_this3.SessionId(),currentTime)}_this3.clearTimers()}},!1),this.disabled_=!0},EMPAnalyticsConnector.prototype.onChromeCastingStop=function(isChromecast){var _this4=this;this.disabled_=!1,isChromecast&&this.onGeneric("StopCasting",this.analytics_.stopCasting,function(){!1!==_this4.hasSessionId()&&_this4.analytics_.stopCasting(_this4.SessionId(),_this4.OffsetTime())},!1)},EMPAnalyticsConnector.prototype.onProgramChange=function(event,data){var _this5=this,program=data?data.program:null;log$1("analytics","onProgramChange",program),program&&this.analytics_.programChanged&&this.player_.hasStarted()&&this.onGeneric("ProgramChange",this.analytics_.programChanged,function(){_this5.analytics_.programChanged(_this5.SessionId(),_this5.OffsetTime(),{programId:program.programId})},!0)},EMPAnalyticsConnector.prototype.onEntitlementChange=function(event,data,errorSessionId){var _this6=this;this.entitlementLoaded_=!0,this.player_.off(empPlayerEvents.ERROR,this.onErrorBeforeAssetBind);var entitlement=this.entitlement(data&&data.entitlement);this.onGeneric("HandShake",this.analytics_.handshake,function(){var params={};if(entitlement&&entitlement.assetId&&(params.assetId=entitlement.assetId),entitlement&&entitlement.programId&&(params.programId=entitlement.programId),!entitlement){var asset=extplayer.currentAsset(_this6.player_);asset&&(params.assetId=asset.assetId,params.programId=asset.programId)}var playSessionId=entitlement?entitlement.playSessionId:errorSessionId;_this6.analytics_.handshake(_this6.SessionId(playSessionId),params),_this6.onLoadStart(playSessionId)},!1)},EMPAnalyticsConnector.prototype.onEntitlementLoadStart=function(){var _this7=this;this.entitlementLoaded_=!1,this.onGeneric("ExitOngoingSession",this.analytics_.exitOngoingSession,function(){return _this7.analytics_.exitOngoingSession(_this7.getCachedCurrentTime())}),this.player_.one(empPlayerEvents.ERROR,this.onErrorBeforeAssetBind),this.player_.one(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},EMPAnalyticsConnector.prototype.onLoadStart=function(playSessionId){var _this8=this,currentSessionId=playSessionId||this.SessionId();if(!currentSessionId)return void log$1("onLoadStart called but not session available.");this.sessionCreated(currentSessionId)||(this.createdSessions[currentSessionId]=!0,this.onGeneric("Created",this.analytics_.created,function(){var options=_this8.player_.options(),params={version:_this8.playerVersion};options&&options.autoplay&&(params.autoplay=options.autoplay),_this8.entitlement()&&_this8.entitlement().requestId&&(params.requestId=_this8.entitlement().requestId),_this8.analytics_.created(currentSessionId,params)},!1),
this.player_.off(empPlayerEvents.PLAYING,this.onResumedBind),this.player_.off(empPlayerEvents.PLAYING,this.onPlayingAfterStartBind),this.player_.one(empPlayerEvents.PLAYING,this.onPlayingAfterStartBind))},EMPAnalyticsConnector.prototype.onPlayingAfterStart=function(){this.onPlayBind(),this.onPlayingBind(),this.player_.on(empPlayerEvents.PLAYING,this.onResumedBind)},EMPAnalyticsConnector.prototype.onBitrateChange=function(){var _this9=this;this.onGeneric("BitrateChange",this.analytics_.bitrateChanged,function(){var params={bitrate:Math.max(0,Math.round(_this9.getBitrate()/1e3))};_this9.analytics_.bitrateChanged(_this9.SessionId(),_this9.OffsetTime(),params)},!0)},EMPAnalyticsConnector.prototype.onWaiting=function(){var _this10=this;this.onGeneric("StartWaiting",this.analytics_.waiting,function(){_this10.player_.hasStarted()&&_this10.analytics_.waiting(_this10.SessionId(),_this10.OffsetTime()),_this10.allEvents_.map(function(eventName){eventName!==empPlayerEvents.PLAY&&eventName!==empPlayerEvents.PLAYING&&eventName!==empPlayerEvents.ENDED&&eventName!==empPlayerEvents.ERROR&&eventName!==empPlayerEvents.DISPOSE&&eventName!==empPlayerEvents.SEEKED&&eventName!==empPlayerEvents.CHROMECAST_CASTING&&eventName!==empPlayerEvents.CHROMECAST_STOPPED||_this10.player_.one(eventName,_this10.onWaitingEndedBind)})},!0)},EMPAnalyticsConnector.prototype.OffsetTime=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)?extplayer.getPlayheadTime(this.player_)/1e3:extplayer.baseCurrentTime(this.player_)},EMPAnalyticsConnector.prototype.startTimeLive=function(){return extplayer.startTimeLive(this.player_)},EMPAnalyticsConnector.prototype.isLive=function(){return extplayer.isLive(this.player_)},EMPAnalyticsConnector.prototype.getBitrate=function(){return extplayer.getBitrate(this.player_)},EMPAnalyticsConnector.prototype.duration=function(){return this.entitlement()&&(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive)&&this.player_.getProgramDetails&&this.player_.getProgramDetails()?this.player_.getProgramDetails().duration/1e3:extplayer.duration(this.player_)},EMPAnalyticsConnector.prototype.entitlement=function(value){return void 0===value?extplayer.getEntitlement(this.player_)||this.entitlement_:(this.entitlement_=value,value)},EMPAnalyticsConnector.prototype.onWaitingEnded=function(){var _this11=this;this.allEvents_.map(function(eventNameOff){_this11.player_.off(eventNameOff,_this11.onWaitingEndedBind)}),this.onGeneric("WaitingEnded",this.analytics_.waitingEnded,function(){_this11.analytics_.waitingEnded(_this11.SessionId(),_this11.OffsetTime())},!0)},EMPAnalyticsConnector.prototype.onDispose=function(event,data){var _this12=this;this.onGeneric("Dispose",this.analytics_.dispose,function(){!1!==_this12.hasSessionId()&&(_this12.analytics_.dispose(_this12.SessionId(),_this12.getCachedCurrentTime()),_this12.clearTimers())},!0,!0)},EMPAnalyticsConnector.prototype.getCachedCurrentTime=function(){if(this.player_){var cachedcurrentTime=this.player_.getCache().currentTime,currentTime=this.OffsetTime();return currentTime||cachedcurrentTime}},EMPAnalyticsConnector.prototype.onEnded=function(){var _this13=this;this.onGeneric("End of Stream",this.analytics_.endOfStream,function(){_this13.analytics_.endOfStream(_this13.SessionId()),_this13.clearTimers()},!0,!0)},EMPAnalyticsConnector.prototype.onPlay=function(){var _this14=this;this.onGeneric("Play",this.analytics_.play,function(){var tech=_this14.player_.techName_,techName="Unknown";switch(tech){case"EmpShaka":techName="Shaka";break;case"EmpDashif":techName="DashIf";break;case"EmpFlash":techName="Flash";break;case"EmpHLS":techName="NativeHLS";break;case"EmpHLS-MSE":techName="HLS-MSE"}var params={techName:techName,version:_this14.playerVersion,techVersion:_this14.techVersion};_this14.analytics_.play(_this14.SessionId(),_this14.OffsetTime(),params),_this14.registerCurrentTimeTimer()},!1)},EMPAnalyticsConnector.prototype.onPlaying=function(){var _this15=this;this.onGeneric("Playing",this.analytics_.playing,function(){var params={};params.bitrate=Math.max(0,Math.round(_this15.getBitrate()/1024)),!0===_this15.isLive()?params.referenceTime=_this15.startTimeLive():params.duration=_this15.duration(),_this15.entitlement()&&_this15.entitlement().mediaLocator&&(params.mediaLocator=_this15.entitlement().mediaLocator),params.mediaLocator&&params.mediaLocator.indexOf(".isml")>=0&&(params.referenceTime=_this15.INITIAL_REFERENCE_TIME),_this15.analytics_.clearCustomAttributes(),(_this15.customAttributes||[]).map(function(item){_this15.analytics_.setCustomAttribute(item.key,item.value)}),_this15.analytics_.playing(_this15.SessionId(),_this15.OffsetTime(),params)},!1)},EMPAnalyticsConnector.prototype.onSeeked=function(){var _this16=this;this.onGeneric("Seeked",this.analytics_.seek,function(){_this16.analytics_.seek(_this16.SessionId(),_this16.OffsetTime())},!0)},EMPAnalyticsConnector.prototype.onPause=function(){var _this17=this;this.onGeneric("Pause",this.analytics_.paused,function(){if(!1!==_this17.player_.hasStarted()){var sId=_this17.SessionId(),refTim=parseInt((new Date-0)/25);_this17.mem[sId].pause[refTim]||(_this17.mem[sId].pause[refTim]=!0,_this17.analytics_.paused(sId,_this17.OffsetTime()))}},!0)},EMPAnalyticsConnector.prototype.onResume=function(){var _this18=this;this.onGeneric("Resume",this.analytics_.resume,function(){var sId=_this18.SessionId(),refTim=parseInt((new Date-0)/25);_this18.mem[sId].resume[refTim]||(_this18.mem[sId].resume[refTim]=!0,_this18.analytics_.resume(sId,_this18.OffsetTime()))},!0)},EMPAnalyticsConnector.prototype.onErrorBeforeAsset=function(){this.entitlementLoaded_=!1,this.onEntitlementChange(null,null,this.errorSessionId),this.onError(null,this.errorSessionId),this.clearTimers()},EMPAnalyticsConnector.prototype.onError=function(){var _this19=this,errorEvent=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,fallbackSessionId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(fallbackSessionId||this.entitlementLoaded_)&&this.onGeneric("Error",this.analytics_.error,function(){var err=_this19.player_.error(),params={};err&&err.code&&(params.errorCode=err.code),err&&err.message&&(params.errorMessage=err.message),err&&err.status&&(params.errorDetails=err.status+""),err&&err.stack&&(params.errorDetails=params.errorDetails?params.errorDetails+"\n"+err.stack.toString():err.stack.toString());var options=_this19.player_.options();if(_this19.player_.tech_){var streamType="EmpShaka"===_this19.player_.techName_&&options&&options.empshaka?options.empshaka.streamType:"";params.errorInfo=_this19.player_.techName_+(streamType?"-"+streamType:"")}else params.errorInfo="Unknown tech, techOrder: "+options.techOrder.toString();!err&&errorEvent&&(params.errorCode=errorEvent.code,params.errorMessage=errorEvent.message?errorEvent.message:"Browser Error",errorEvent.status&&(params.errorDetails=errorEvent.status+""),errorEvent.stack&&(params.errorDetails=params.errorDetails?params.errorDetails+"\n"+errorEvent.stack.toString():errorEvent.stack.toString()));var currentSessId=_this19.SessionId();(currentSessId||fallbackSessionId)&&_this19.analytics_.error(currentSessId||fallbackSessionId,_this19.OffsetTime(),params),_this19.clearTimers()},!1)},EMPAnalyticsConnector.prototype.onDrmSessionUpdate=function(event,data){var _this20=this;log$1("onDrmSessionUpdate",event,data),this.onGeneric("DrmSessionUpdate",this.analytics_.drmSessionUpdate,function(){_this20.analytics_.drmSessionUpdate(_this20.SessionId(),{message:data.messageType,code:data.code,info:data.info})},!0)},EMPAnalyticsConnector.prototype.onGeneric=function(eventName,eventFnc,callback,checkSessionCreation){var ignoreDisabled=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.disabled_&&!ignoreDisabled)return void log$1(eventName+" not delivered: analytics disabled.");checkSessionCreation&&!this.sessionCreated(this.SessionId())?log$1(eventName+" was discarded."):eventFnc&&callback&&callback()},EMPAnalyticsConnector.prototype.sessionCreated=function(sessionId){return sessionId&&this.createdSessions[sessionId]},EMPAnalyticsConnector.prototype.dispose=function(){this.clearTimers(),this.analytics_&&(this.analytics_.exitOngoingSession(this.getCachedCurrentTime()),this.analytics_.dispatchNow(!1)),window_1.removeEventListener("beforeunload",this.onWindowUnloadBind),this.player_.off(empPlayerEvents.PLAY,this.onPlayBind),this.player_.off(empPlayerEvents.PLAYING,this.onPlayingBind),this.player_.off(empPlayerEvents.PLAYING,this.onResumedBind),this.player_.off(empPlayerEvents.PAUSE,this.onPauseBind),this.player_.off(empPlayerEvents.SEEKED,this.onSeekedBind),this.player_.off(empPlayerEvents.ENTITLEMENT_LOAD_START,this.onEntitlementLoadStartBind),this.player_.off(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player_.off(empPlayerEvents.BITRATE_CHANGED,this.onBitrateChangeBind),this.player_.off(empPlayerEvents.ENDED,this.onEndedBind),this.player_.off(empPlayerEvents.DISPOSE,this.onDisposeBind),this.player_.off(empPlayerEvents.STOPPED,this.onDisposeBind),this.player_.off(empPlayerEvents.ERROR,this.onErrorBind),this.player_.off(empPlayerEvents.ERROR,this.onErrorBeforeAssetBind),this.player_.off(empPlayerEvents.WAITING,this.onWaitingBind),this.player_.off(empPlayerEvents.CHROMECAST_CASTING,this.onChromeCastingStartBind),this.player_.off(empPlayerEvents.CHROMECAST_STOPPED,this.onChromeCastingStopBind),this.player_.off(empPlayerEvents.PROGRAM_CHANGED,this.onProgramChangeBind),this.player_.off(empPlayerEvents.PLAYING,this.onPlayingAfterStartBind),this.player_.off(empPlayerEvents.DRM_SESSION_UPDATE,this.onDrmSessionUpdateBind)},createClass(EMPAnalyticsConnector,[{key:"techVersion",get:function(){return extplayer.techVersion(this.player_)}},{key:"playerVersion",get:function(){return this.player_.version?this.player_.version:window_1.videojs?window_1.videojs.VERSION:"2.x.x"}},{key:"errorSessionId",get:function(){return this._errorSessionId||(this._errorSessionId="error-"+Math.random().toString().split(".")[1]),this._errorSessionId}}]),EMPAnalyticsConnector}(),empAnalytics_min=createCommonjsModule(function(module,exports){!function(a){module.exports=function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof commonjsRequire&&commonjsRequire;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c||b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof commonjsRequire&&commonjsRequire,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){var c;c="undefined"!=typeof window?window:void 0!==a?a:"undefined"!=typeof self?self:{},b.exports=c}).call(this,void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(b,c,d){!function(e,f){"object"==typeof d&&void 0!==c?f(d,b("worker-timers-broker")):"function"==typeof a&&a.amd?a(["exports","worker-timers-broker"],f):f(e.workerTimers={},e.workerTimersBroker)}(this,function(a,b){"use strict";var d=new Blob(['!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,r){"use strict";r.r(t);r(1)},function(e,t,r){!function(){"use strict";var w=new Map,T=new Map,b=function(e,t){var r,n;if("performance"in self){var o=performance.now(),i=Math.max(0,o-t);r=o,n=e-i}else r=Date.now(),n=e;var a=r+n;return{expected:a,remainingDelay:n}},M=function e(t,r,n,o){var i="performance"in self?performance.now():Date.now();n<i?postMessage({id:null,method:"call",params:{timerId:r,timerType:o}}):t.set(r,setTimeout(e,n-i,t,r,n,o))};addEventListener("message",function(e){var t,r,n,o,i,a,u,s,c=e.data;try{if("clear"===c.method){var l=c.id,d=c.params,f=d.timerId,p=d.timerType;if("interval"===p)!function(e){var t=w.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),w.delete(e)}(f),postMessage({error:null,id:l});else{if("timeout"!==p)throw new Error(\'The given type "\'.concat(p,\'" is not supported\'));!function(e){var t=T.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),T.delete(e)}(f),postMessage({error:null,id:l})}}else{if("set"!==c.method)throw new Error(\'The given method "\'.concat(c.method,\'" is not supported\'));var m=c.params,v=m.delay,h=m.now,g=m.timerId,y=m.timerType;if("interval"===y)i=g,a=b(v,h),u=a.expected,s=a.remainingDelay,w.set(i,setTimeout(M,s,w,i,u,"interval"));else{if("timeout"!==y)throw new Error(\'The given type "\'.concat(y,\'" is not supported\'));t=g,r=b(v,h),n=r.expected,o=r.remainingDelay,T.set(t,setTimeout(M,o,T,t,n,"timeout"))}}}catch(e){postMessage({error:{message:e.message},id:c.id,result:null})}})}()}]);'],{type:"application/javascript; charset=utf-8"}),e=URL.createObjectURL(d),f=b.load(e),g=f.clearInterval,h=f.clearTimeout,i=f.setInterval,j=f.setTimeout;URL.revokeObjectURL(e),a.clearInterval=g,a.clearTimeout=h,a.setInterval=i,a.setTimeout=j,Object.defineProperty(a,"__esModule",{value:!0})})},{"worker-timers-broker":3}],3:[function(b,c,d){!function(e,f){"object"==typeof d&&void 0!==c?f(d,b("fast-unique-numbers")):"function"==typeof a&&a.amd?a(["exports","fast-unique-numbers"],f):f(e.workerTimersBroker={},e.fastUniqueNumbers)}(this,function(a,b){"use strict";var c=function(a){return void 0!==a.method&&"call"===a.method},d=function(a){return null===a.error&&"number"==typeof a.id},e=function(a){var e=new Map,f=new Map,g=new Map,h=new Worker(a);return h.addEventListener("message",function(a){var b=a.data;if(c(b)){var h=b.params,i=h.timerId,j=h.timerType;if("interval"===j){var k=e.get(i);if("number"==typeof k){var l=g.get(k);if(void 0===l||l.timerId!==i||l.timerType!==j)throw new Error("The timer is in an undefined state.")}else{if(void 0===k)throw new Error("The timer is in an undefined state.");k()}}else if("timeout"===j){var m=f.get(i);if("number"==typeof m){var n=g.get(m);if(void 0===n||n.timerId!==i||n.timerType!==j)throw new Error("The timer is in an undefined state.")}else{if(void 0===m)throw new Error("The timer is in an undefined state.");m(),f.delete(i)}}}else{if(!d(b)){var o=b.error.message;throw new Error(o)}var p=b.id,q=g.get(p);if(void 0===q)throw new Error("The timer is in an undefined state.");var r=q.timerId,s=q.timerType;g.delete(p),"interval"===s?e.delete(r):f.delete(r)}}),{clearInterval:function(a){var c=b.generateUniqueNumber(g);g.set(c,{timerId:a,timerType:"interval"}),e.set(a,c),h.postMessage({id:c,method:"clear",params:{timerId:a,timerType:"interval"}})},clearTimeout:function(a){var c=b.generateUniqueNumber(g);g.set(c,{timerId:a,timerType:"timeout"}),f.set(a,c),h.postMessage({id:c,method:"clear",params:{timerId:a,timerType:"timeout"}})},setInterval:function(a,c){var d=b.generateUniqueNumber(e);return e.set(d,function(){a(),"function"==typeof e.get(d)&&h.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:d,timerType:"interval"}})}),h.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:d,timerType:"interval"}}),d},setTimeout:function(a,c){var d=b.generateUniqueNumber(f);return f.set(d,a),h.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:d,timerType:"timeout"}}),d}}};a.load=e,Object.defineProperty(a,"__esModule",{value:!0})})},{"fast-unique-numbers":4}],4:[function(b,c,d){!function(b,e){"object"==typeof d&&void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.fastUniqueNumbers={})}(this,function(a){"use strict";var b=new WeakMap,c=Number.MAX_SAFE_INTEGER||9007199254740991,d=function(a,c){return b.set(a,c),c},e=function(a){var e=b.get(a),f=void 0===e?a.size:e>2147483648?0:e+1;if(!a.has(f))return d(a,f);if(a.size<1073741824){for(;a.has(f);)f=Math.floor(2147483648*Math.random());return d(a,f)}if(a.size>c)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;a.has(f);)f=Math.floor(Math.random()*c);return d(a,f)},f=function(a){var b=e(a);return a.add(b),b};a.addUniqueNumber=f,a.generateUniqueNumber=e,Object.defineProperty(a,"__esModule",{value:!0})})},{}],5:[function(a,b,c){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}c.__esModule=!0;var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("global/window"),i=e(h),j=a("./platform"),k=e(j),l=a("worker-timers"),m=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(l),n=function(){function a(b,c,d,e,g){var h=arguments.length<=5||void 0===arguments[5]?{}:arguments[5],i=arguments.length<=6||void 0===arguments[6]?{}:arguments[6];f(this,a),this.CYCLE_TIME=1e3,this.EVENT_PURGE_TIME_DEFAULT=3*this.CYCLE_TIME,this.TIME_WITHOUT_BEAT_DEFAULT=60*this.CYCLE_TIME,this.SERVER_URL_DEFAULT="",this.CUSTOMER_DEFAULT="",this.BUSINESS_UNIT_DEFAULT="",this.INCLUDE_DEVICE_METRICS_DEFAULT=!0,this.SESSION_TOKEN_DEFAULT="",this.SESSION_ID_DEFAULT="",this.DEBUG_DEFAULT=!1,this.MAX_RETRIES=20,this.DEVICE_CLOCK_CHECK_THRESHOLD=3e5,this.eventsSkeleton=this.initEventSkeleton(),this.customer_=c,this.businessUnit_=d,this.sessionToken_=e,this.serverURL_=b,this.includeDeviceMetrics_=!1,this.userId_=g,this.deviceInfoData_=h,this.props_=i||{},this.pendingRequest_=!1}return a.prototype.init=function(){var a=this;this.cycleTimer&&("undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?m.clearInterval(this.cycleTimer):clearInterval(this.cycleTimer)),"undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?this.cycleTimer=m.setInterval(function(){return a.cycle()},this.CYCLE_TIME):this.cycleTimer=setInterval(function(){return a.cycle()},this.CYCLE_TIME),this.communicationCurrentTime=0,this.lastCommunicationTime=0,this.eventPool={}},a.prototype.clear=function(){this.eventPool={}},a.prototype.ok=function(a){var b=this.eventPool[a];return!!b&&!1===b.forbidden&&b.retries<this.MAX_RETRIES},a.prototype.created=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c={type:"Created"};this.addEventToPool(a,c,b)},a.prototype.play=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"PlayerReady",currentTime:b};this.deviceAppInfo&&(c.deviceAppInfo=this.deviceAppInfo),this.addEventToPool(a,d,c)},a.prototype.playing=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"Started",currentTime:b};if(this.customAttributes){var e=Object.keys(this.customAttributes);e.length&&e.length>0&&(c.attributes=this.customAttributes)}this.addEventToPool(a,d,c),this.changeSessionState(a,"PLAYING")},a.prototype.paused=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"Paused",currentTime:b};this.addEventToPool(a,d,c,!0)},a.prototype.seek=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"ScrubbedTo",currentTime:b};this.addEventToPool(a,d,c,!0)},a.prototype.programChanged=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"ProgramChanged",currentTime:b};this.addEventToPool(a,d,c,!0)},a.prototype.startCasting=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"StartCasting",currentTime:b};this.addEventToPool(a,d,c,!0),this.changeSessionState(a,"FINISHED")},a.prototype.stopCasting=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"StopCasting",currentTime:b};this.addEventToPool(a,d,c,!0),this.changeSessionState(a,"FINISHED")},a.prototype.setCurrentTime=function(a,b){this.eventPool[a]&&(this.eventPool[a].currentTime=b)},a.prototype.handshake=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c={type:"HandshakeStarted"};this.addEventToPool(a,c,b)},a.prototype.resume=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"Resumed",currentTime:b};this.addEventToPool(a,d,c,!0)},a.prototype.bitrateChanged=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"BitrateChanged",currentTime:b};this.addEventToPool(a,d,c,!0)},a.prototype.drmSessionUpdate=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c={type:"DRM"};this.addEventToPool(a,c,b,!0)},a.prototype.endOfStream=function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c={type:"Completed"};this.addEventToPool(a,c,b,!0),this.changeSessionState(a,"FINISHED")},a.prototype.error=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"Error",currentTime:b};this.addEventToPool(a,d,c),this.changeSessionState(a,"FINISHED")},a.prototype.dispose=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=this.eventPool[a];if(d&&"FINISHED"!==d.currentState){var e={type:"Aborted"};b&&(e.currentTime=b),this.addEventToPool(a,e,c,!0),this.changeSessionState(a,"FINISHED")}},a.prototype.waiting=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"BufferingStarted",currentTime:b};this.addEventToPool(a,d,c)},a.prototype.waitingEnded=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d={type:"BufferingEnded",currentTime:b};this.addEventToPool(a,d,c)},a.prototype.getSessionState=function(a){return this.eventPool[a]?this.eventPool[a].currentState||"IDLE":"IDLE"},a.prototype.dispatchNow=function(){var a=arguments.length<=0||void 0===arguments[0]||arguments[0];this.cycle(a,!0)},a.prototype.exitOngoingSession=function(a){var b=this;Object.keys(this.eventPool).map(function(c){b.eventPool[c]&&b.dispose(c,a)})},a.prototype.setCustomAttribute=function(a,b){this.customAttributes||this.resetAnalyticsCustomAttributes(),this.customAttributes[a]=b},a.prototype.clearCustomAttributes=function(){this.customAttributes={}},a.prototype.removeSession=function(a){if(!0===(!(arguments.length<=1||void 0===arguments[1])&&arguments[1]))delete this.eventPool[a];else{var c=this.eventPool[a];c&&(c.currentState="REMOVED")}},a.prototype.hasDataToSend=function(){for(var a=Object.keys(this.eventPool),b=0;b<a.length;++b)if(this.eventPool[a[b]].events.length>0)return!0;return!1},a.prototype.sendData=function(){var a=this,b=arguments.length<=0||void 0===arguments[0]||arguments[0],c=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];if(!this.pendingRequest_){var d=!1;this.pendingRequest_=!0;var e=void 0;e="undefined"!=typeof Worker&&!0!==this.props_.disableWebWorkers?m.setTimeout(function(){a.pendingRequest_=!1,e=void 0},2*this.EVENT_PURGE_TIME_DEFAULT):setTimeout(function(){a.pendingRequest_=!1,e=void 0},2*this.EVENT_PURGE_TIME_DEFAULT);Object.keys(this.eventPool).map(function(f){var g=a.eventPool[f];if(g){if(!f)return g.events=[],void a.removeSession(f,!0);if("PLAYING"===g.currentState&&0===g.events.length&&c&&g.events.push({EventType:"Playback.Heartbeat",Timestamp:(new Date).getTime(),OffsetTime:Math.floor(1e3*g.currentTime)}),"IDLE"!==g.currentState&&"REMOVED"!==g.currentState){if(0===g.events.length)return void("FINISHED"===g.currentState&&a.removeSession(f));var h={DispatchTime:(new Date).getTime(),Customer:a.customer_,BusinessUnit:a.businessUnit_,Payload:g.events,SessionId:f,ClockOffset:g.clockOffset};if(a.debugLog("Sending analytics - sessionId: "+f+" and params: ",h),g.retries>a.MAX_RETRIES||!0===g.forbidden)return void(g.events=[]);Math.abs(a.communicationCurrentDate-a.lastCommunicationDate)>a.DEVICE_CLOCK_CHECK_THRESHOLD&&a.initRequest(f).then(function(){}),d=!0,a.sendRequest(b,h,function(b,c){if(e)try{"undefined"!=typeof Worker&&!0!==a.props_.disableWebWorkers?(m.clearTimeout(e),e=void 0):(clearTimeout(e),e=void 0)}catch(d){}a.pendingRequest_=!1;var h=b&&b.httpCode?b.httpCode:200;void 0!==c||200!==h?(401===h&&(g.forbidden=!0),a.debugLog("Error sending request to backend",c),g.retries++):(g.events=[],g.retries=0,"FINISHED"===g.currentState&&a.removeSession(f))})}}}),d||(this.pendingRequest_=!1)}},a.prototype.cycle=function(){var a=arguments.length<=0||void 0===arguments[0]||arguments[0],b=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.communicationCurrentDate=new Date,this.communicationCurrentTime+=this.CYCLE_TIME,this.hasDataToSend()?(b||this.lastCommunicationTime+this.EVENT_PURGE_TIME_DEFAULT<this.communicationCurrentTime)&&(this.sendData(a),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate):(b||this.lastCommunicationTime+this.TIME_WITHOUT_BEAT_DEFAULT<this.communicationCurrentTime)&&(this.sendData(a,!0),this.lastCommunicationTime=this.communicationCurrentTime,this.lastCommunicationDate=this.communicationCurrentDate)},a.prototype.sendRequest=function(a,b,c){var d=new XMLHttpRequest;d.open("POST",this.serverURL_+"/eventsink/send",!0),d.setRequestHeader("Content-type","application/json"),d.setRequestHeader("Authorization","Bearer "+this.sessionToken_),d.onload=function(){var a=JSON.parse(this.responseText);c(a)},d.onerror=function(a){c(null,a)},d.send(JSON.stringify(b))},a.prototype.initRequest=function(a){var b=this;return new Promise(function(c,d){var e=(new Date).getTime(),f=new XMLHttpRequest;f.open("POST",b.serverURL_+"/eventsink/init",!0),f.setRequestHeader("Content-type","application/json"),f.setRequestHeader("Authorization","Bearer "+b.sessionToken_),f.onload=function(){var d=(new Date).getTime(),g=JSON.parse(f.responseText);b.determineClockOffset(a,g,e,d),g&&g.settings&&(g.settings,g.settings.includeDeviceMetrics&&(b.includeDeviceMetrics_=!!g.settings.includeDeviceMetrics)),c()},f.onerror=function(a){b.debugLog("Unable to init. Aborting."),d(a)};var g={Customer:b.customer_,BusinessUnit:b.businessUnit_,SessionId:a};f.send(JSON.stringify(g))})},a.prototype.debugLog=function(a,b){b=b||"",this.debug_},a.prototype.addDeviceInfoEvent=function(a){var b=this.eventPool[a];if(this.includeDeviceMetrics_&&b&&b.events&&b.events.length){var c={Timestamp:(new Date).getTime(),EventType:"Device.Info",DeviceModel:this.deviceInfoData_.deviceModel||"Desktop",UserAgent:this.deviceInfoData_.userAgent||i.default.navigator.userAgent,Height:this.deviceInfoData_.screenHeight||i.default.screen.height,Width:this.deviceInfoData_.screenWidth||i.default.screen.width,Model:this.deviceInfoData_.model||i.default.navigator.appName,Name:this.deviceInfoData_.deviceName||i.default.navigator.product,OS:this.deviceInfoData_.deviceOS||k.default.os.family,OSVersion:this.deviceInfoData_.deviceOSVersion||k.default.os.version,Type:this.deviceInfoData_.type||"WEB"};(this.deviceInfoData_.deviceManufacturer||k.default.manufacturer)&&(c.Manufacturer=this.deviceInfoData_.deviceManufacturer||k.default.manufacturer),this.deviceInfoData_.deviceId&&(c.DeviceId=this.deviceInfoData_.deviceId),b.events.push(c)}},a.prototype.determineClockOffset=function(a,b,c,d){var e=this.eventPool[a];e&&(e.clockOffset=Math.floor((d-b.repliedTime+c-b.receivedTime)/2))},a.prototype.createPool=function(a){var b=this;return new Promise(function(c,d){b.eventPool[a]={currentState:"IDLE",currentTime:0,clockOffset:0,events:[],retries:0,forbidden:!1},b.initRequest(a).then(function(){b.addDeviceInfoEvent(a),c()}).catch(function(a){d(a)})})},a.prototype.addEventToPool=function(a,b,c){var d=this;if(arguments.length<=3||void 0===arguments[3]||!arguments[3]||!this.eventPool[a]||"FINISHED"!==this.eventPool[a].currentState&&"REMOVED"!==this.eventPool[a].currentState){var f;this.eventPool[a]||(f=this.createPool(a)),f?f.then(function(){d.internalAddEventToPool(a,b,c)}):this.internalAddEventToPool(a,b,c)}},a.prototype.internalAddEventToPool=function(a,b,c){var d=this.eventsSkeleton[b.type];if(!d)return void this.debugLog("Unknown playback event: ",b);var e={Timestamp:(new Date).getTime(),EventType:"Playback."+d.event};d.includeOffset&&(e.OffsetTime=Math.floor(1e3*b.currentTime)),d.attributes&&"function"==typeof d.attributes&&(e=this.objectAssign(e,d.attributes(c))),this.eventPool[a].events.push(e),this.debugLog("added "+d.event+" to queue")},a.prototype.changeSessionState=function(a,b){var c,d=this;this.eventPool[a]||(c=this.createPool(a)),c?c.then(function(){d.eventPool[a].currentState=b}):this.eventPool[a].currentState=b},a.prototype.initEventSkeleton=function(){var b={};return b.Completed={event:"Completed",autoListener:!1},b.PlayerReady={event:"PlayerReady",autoListener:!1,attributes:function(b){var c={Technology:b.techName,PlayerVersion:b.version};return b.techVersion&&(c.TechVersion=b.techVersion),c.AnalyticsVersion=a.VERSION,b.deviceAppInfo&&(c.DeviceAppInfo=b.deviceAppInfo),b.playMode&&(c.PlayMode=b.playMode),c}},b.Resumed={event:"Resumed",autoListener:!1,includeOffset:!0},b.BufferingStarted={event:"BufferingStarted",includeOffset:!0},b.BufferingEnded={event:"BufferingEnded",includeOffset:!0},b.ScrubbedTo={event:"ScrubbedTo",includeOffset:!0},b.Created={event:"Created",attributes:function(a){var b={};return void 0!==a.autoplay&&(b.AutoPlay=a.autoplay),a.techName&&(b.Technology=a.techName),a.player&&(b.Player=a.player),a.version&&(b.Version=a.version),a.requestId&&(b.RequestId=a.requestId),a.techVersion&&(b.TechVersion=a.techVersion),a.deviceAppInfo&&(b.DeviceAppInfo=a.deviceAppInfo),a.playMode&&(b.PlayMode=a.playMode),b}},b.StartCasting={event:"StartCasting",includeOffset:!0},b.StopCasting={event:"StopCasting",includeOffset:!0},b.Paused={event:"Paused",includeOffset:!0},b.BitrateChanged={event:"BitrateChanged",includeOffset:!0,attributes:function(a){return{Bitrate:a.bitrate}}},b.DRM={event:"DRM",includeOffset:!1,attributes:function(a){var c={};return a.message&&(c.Message=a.message),a.code&&(c.Code=a.code),a.info&&(c.Info=a.info),c}},b.Error={event:"Error",includeOffset:!0,attributes:function(a){var d={};return a.errorCode&&(d.Code=a.errorCode),a.errorMessage?d.Message=a.errorMessage:d.Message="Unknown Error",a.errorInfo&&(d.Info=a.errorInfo),a.errorDetails&&(d.Details=a.errorDetails),d}},b.HandshakeStarted={event:"HandshakeStarted",autoListener:!1,attributes:function(a){if(!a.assetId)return{};var e={AssetId:a.assetId};return a.programId&&(e.ProgramId=a.programId),e}},b.ProgramChanged={event:"ProgramChanged",includeOffset:!0,autoListener:!1,attributes:function(a){return a.programId?{ProgramId:a.programId}:{}}},b.Aborted={event:"Aborted",autoListener:!1,includeOffset:!0},b.Started={event:"Started",autoListener:!1,includeOffset:!0,attributes:function(a){var f={};return a.bitrate&&(f.Bitrate=a.bitrate),a.duration&&(f.VideoLength=1e3*a.duration),a.mediaLocator&&(f.MediaLocator=a.mediaLocator),a.attributes&&(f.Attributes=a.attributes),a.referenceTime&&(f.ReferenceTime=a.referenceTime),a.playMode&&(f.PlayMode=a.playMode),f}},b},a.prototype.objectAssign=function(a,b){
for(var c,d,e=1;e<arguments.length;++e){d=arguments[e];for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a},g(a,[{key:"debug",get:function(){return this.debug_},set:function(a){this.debug_=a}},{key:"deviceAppInfo",get:function(){return this.deviceInfoData_?this.deviceInfoData_.deviceAppInfo:null}}]),a}();n.VERSION="2.0.93-7",c.default=n,b.exports=c.default},{"./platform":6,"global/window":1,"worker-timers":2}],6:[function(b,c,d){(function(b){"use strict";(function(){function e(a){return a=String(a),a.charAt(0).toUpperCase()+a.slice(1)}function f(a,b,c){var d={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"7 / Server 2008 R2","6.0":"Vista / Server 2008",5.2:"XP 64-bit / Server 2003",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return b&&c&&/^Win/i.test(a)&&!/^Windows Phone /i.test(a)&&(d=d[/[\d.]+$/.exec(a)])&&(a="Windows "+d),a=String(a),b&&c&&(a=a.replace(RegExp(b,"i"),c)),a=h(a.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function g(a,b){var c=-1,d=a?a.length:0;if("number"==typeof d&&d>-1&&d<=v)for(;++c<d;)b(a[c],c,a);else i(a,b)}function h(a){return a=n(a),/^(?:webOS|i(?:OS|P))/.test(a)?a:e(a)}function i(a,b){for(var c in a)z.call(a,c)&&b(a[c],c,a)}function j(a){return null==a?e(a):A.call(a).slice(8,-1)}function k(a,b){var c=null!=a?typeof a[b]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(c)||"object"==c&&!a[b])}function l(a){return String(a).replace(/([ -])(?!$)/g,"$1?")}function m(a,b){var c=null;return g(a,function(d,e){c=b(c,d,e,a)}),c}function n(a){return String(a).replace(/^ +| +$/g,"")}function o(a){function g(b){return m(b,function(b,c){var d=c.pattern||l(c);return!b&&(b=RegExp("\\b"+d+" *\\d+[.\\w_]*","i").exec(a)||RegExp("\\b"+d+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(a))&&((b=String(c.label&&!RegExp(d,"i").test(c.label)?c.label:b).split("/"))[1]&&!/[\d.]+/.test(b[0])&&(b[0]+=" "+b[1]),c=c.label||c,b=h(b[0].replace(RegExp(d,"i"),c).replace(RegExp("; *(?:"+c+"[_-])?","i")," ").replace(RegExp("("+c+")[-_.]?(\\w)","i"),"$1 $2"))),b})}function s(){return this.description||""}var t=q,u=a&&"object"==typeof a&&"String"!=j(a);u&&(t=a,a=null);var v=t.navigator||{},y=v.userAgent||"";a||(a=y);var z,B,C=u||x==r,D=u?!!v.likeChrome:/\bChrome\b/.test(a)&&!/internal|\n/i.test(A.toString()),E="Object",F=u?E:"ScriptBridgingProxyObject",G=u?E:"Environment",H=u&&t.java?"JavaPackage":j(t.java),I=u?E:"RuntimeObject",J=/\bJava/.test(H)&&t.java,K=J&&j(t.environment)==G,L=J?"a":"",M=J?"b":"",N=t.document||{},O=t.operamini||t.opera,P=w.test(P=u&&O?O["[[Class]]"]:j(O))?P:O=null,Q=a,R=[],S=null,T=a==y,U=T&&O&&"function"==typeof O.version&&O.version(),V=function(b){return m(b,function(b,c){return b||RegExp("\\b"+(c.pattern||l(c))+"\\b","i").exec(a)&&(c.label||c)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),W=function(b){return m(b,function(b,c){return b||RegExp("\\b"+(c.pattern||l(c))+"\\b","i").exec(a)&&(c.label||c)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox Mobile",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),X=g([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Y=function(b){return m(b,function(b,c,d){return b||(c[X]||c[/^[a-z]+(?: +[a-z]+\b)*/i.exec(X)]||RegExp("\\b"+l(d)+"(?:\\b|\\w*\\d)","i").exec(a))&&d})}({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),Z=function(b){return m(b,function(b,c){var d=c.pattern||l(c);return!b&&(b=RegExp("\\b"+d+"(?:/[\\d.]+|[ \\w.]*)","i").exec(a))&&(b=f(b,d,c.label||c)),b})}(["Windows Phone ","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(V&&(V=[V]),Y&&!X&&(X=g([Y])),(z=/\bGoogle TV\b/.exec(X))&&(X=z[0]),/\bSimulator\b/i.test(a)&&(X=(X?X+" ":"")+"Simulator"),"Opera Mini"==W&&/\bOPiOS\b/.test(a)&&R.push("running in Turbo/Uncompressed mode"),/^iP/.test(X)?(W||(W="Safari"),Z="iOS"+((z=/ OS ([\d_]+)/i.exec(a))?" "+z[1].replace(/_/g,"."):"")):"Konqueror"!=W||/buntu/i.test(Z)?Y&&"Google"!=Y&&(/Chrome/.test(W)&&!/\bMobile Safari\b/i.test(a)||/\bVita\b/.test(X))?(W="Android Browser",Z=/\bAndroid\b/.test(Z)?Z:"Android"):"Silk"==W?(/\bMobi/i.test(a)||(Z="Android",R.unshift("desktop mode")),/Accelerated *= *true/i.test(a)&&R.unshift("accelerated")):"PaleMoon"==W&&(z=/\bFirefox\/([\d.]+)\b/.exec(a))?R.push("identifying as Firefox "+z[1]):"Firefox"==W&&(z=/\b(Mobile|Tablet|TV)\b/i.exec(a))?(Z||(Z="Firefox OS"),X||(X=z[1])):W&&!(z=!/\bMinefield\b/i.test(a)&&/\b(?:Firefox|Safari)\b/.exec(W))||(W&&!X&&/[\/,]|^[^(]+?\)/.test(a.slice(a.indexOf(z+"/")+8))&&(W=null),(z=X||Y||Z)&&(X||Y||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Z))&&(W=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Z)?Z:z)+" Browser")):Z="Kubuntu",U||(U=function(b){return m(b,function(b,c){return b||(RegExp(c+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(a)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",l(W),"(?:Firefox|Minefield|NetFront)"])),(z="iCab"==V&&parseFloat(U)>3&&"WebKit"||/\bOpera\b/.test(W)&&(/\bOPR\b/.test(a)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(a)&&!/^(?:Trident|EdgeHTML)$/.test(V)&&"WebKit"||!V&&/\bMSIE\b/i.test(a)&&("Mac OS"==Z?"Tasman":"Trident")||"WebKit"==V&&/\bPlayStation\b(?! Vita\b)/i.test(W)&&"NetFront")&&(V=[z]),"IE"==W&&(z=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(a)||0)[1])?(W+=" Mobile",Z="Windows Phone "+(/\+$/.test(z)?z:z+".x"),R.unshift("desktop mode")):/\bWPDesktop\b/i.test(a)?(W="IE Mobile",Z="Windows Phone 8.x",R.unshift("desktop mode"),U||(U=(/\brv:([\d.]+)/.exec(a)||0)[1])):"IE"!=W&&"Trident"==V&&(z=/\brv:([\d.]+)/.exec(a))&&(W&&R.push("identifying as "+W+(U?" "+U:"")),W="IE",U=z[1]),T){if(k(t,"global"))if(J&&(z=J.lang.System,Q=z.getProperty("os.arch"),Z=Z||z.getProperty("os.name")+" "+z.getProperty("os.version")),C&&k(t,"system")&&(z=[t.system])[0]){Z||(Z=z[0].os||null);try{z[1]=t.require("ringo/engine").version,U=z[1].join("."),W="RingoJS"}catch($){z[0].global.system==t.system&&(W="Narwhal")}}else"object"==typeof t.process&&(z=t.process)?(W="Node.js",Q=z.arch,Z=z.platform,U=/[\d.]+/.exec(z.version)[0]):K&&(W="Rhino");else j(z=t.runtime)==F?(W="Adobe AIR",Z=z.flash.system.Capabilities.os):j(z=t.phantom)==I?(W="PhantomJS",U=(z=z.version||null)&&z.major+"."+z.minor+"."+z.patch):"number"==typeof N.documentMode&&(z=/\bTrident\/(\d+)/i.exec(a))&&(U=[U,N.documentMode],(z=+z[1]+4)!=U[1]&&(R.push("IE "+U[1]+" mode"),V&&(V[1]=""),U[1]=z),U="IE"==W?String(U[1].toFixed(1)):U[0]);Z=Z&&h(Z)}U&&(z=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(U)||/(?:alpha|beta)(?: ?\d)?/i.exec(a+";"+(T&&v.appMinorVersion))||/\bMinefield\b/i.test(a)&&"a")&&(S=/b/i.test(z)?"beta":"alpha",U=U.replace(RegExp(z+"\\+?$"),"")+("beta"==S?M:L)+(/\d+\+?/.exec(z)||"")),"Fennec"==W||"Firefox"==W&&/\b(?:Android|Firefox OS)\b/.test(Z)?W="Firefox Mobile":"Maxthon"==W&&U?U=U.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(X)?(Z=null,"Xbox 360"==X&&/\bIEMobile\b/.test(a)&&R.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(W)&&(!W||X||/Browser|Mobi/.test(W))||"Windows CE"!=Z&&!/Mobi/i.test(a)?"IE"==W&&T&&null===t.external?R.unshift("platform preview"):(/\bBlackBerry\b/.test(X)||/\bBB10\b/.test(a))&&(z=(RegExp(X.replace(/ +/g," *")+"/([.\\d]+)","i").exec(a)||0)[1]||U)?(z=[z,/BB10/.test(a)],Z=(z[1]?(X=null,Y="BlackBerry"):"Device Software")+" "+z[0],U=null):this!=i&&"Wii"!=X&&(T&&O||/Opera/.test(W)&&/\b(?:MSIE|Firefox)\b/i.test(a)||"Firefox"==W&&/\bOS X (?:\d+\.){2,}/.test(Z)||"IE"==W&&(Z&&!/^Win/.test(Z)&&U>5.5||/\bWindows XP\b/.test(Z)&&U>8||8==U&&!/\bTrident\b/.test(a)))&&!w.test(z=o.call(i,a.replace(w,"")+";"))&&z.name&&(z="ing as "+z.name+((z=z.version)?" "+z:""),w.test(W)?(/\bIE\b/.test(z)&&"Mac OS"==Z&&(Z=null),z="identify"+z):(z="mask"+z,W=P?h(P.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(z)&&(Z=null),T||(U=null)),V=["Presto"],R.push(z)):W+=" Mobile",(z=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(a)||0)[1])&&(z=[parseFloat(z.replace(/\.(\d)$/,".0$1")),z],"Safari"==W&&"+"==z[1].slice(-1)?(W="WebKit Nightly",S="alpha",U=z[1].slice(0,-1)):U!=z[1]&&U!=(z[2]=(/\bSafari\/([\d.]+\+?)/i.exec(a)||0)[1])||(U=null),z[1]=(/\bChrome\/([\d.]+)/i.exec(a)||0)[1],537.36==z[0]&&537.36==z[2]&&parseFloat(z[1])>=28&&"WebKit"==V&&(V=["Blink"]),T&&(D||z[1])?(V&&(V[1]="like Chrome"),z=z[1]||(z=z[0],z<530?1:z<532?2:z<532.05?3:z<533?4:z<534.03?5:z<534.07?6:z<534.1?7:z<534.13?8:z<534.16?9:z<534.24?10:z<534.3?11:z<535.01?12:z<535.02?"13+":z<535.07?15:z<535.11?16:z<535.19?17:z<536.05?18:z<536.1?19:z<537.01?20:z<537.11?"21+":z<537.13?23:z<537.18?24:z<537.24?25:z<537.36?26:"Blink"!=V?"27":"28")):(V&&(V[1]="like Safari"),z=z[0],z=z<400?1:z<500?2:z<526?3:z<533?4:z<534?"4+":z<535?5:z<537?6:z<538?7:z<601?8:"8"),V&&(V[1]+=" "+(z+="number"==typeof z?".x":/[.+]/.test(z)?"":"+")),"Safari"==W&&(!U||parseInt(U)>45)&&(U=z)),"Opera"==W&&(z=/\bzbov|zvav$/.exec(Z))?(W+=" ",R.unshift("desktop mode"),"zvav"==z?(W+="Mini",U=null):W+="Mobile",Z=Z.replace(RegExp(" *"+z+"$"),"")):"Safari"==W&&/\bChrome\b/.exec(V&&V[1])&&(R.unshift("desktop mode"),W="Chrome Mobile",U=null,/\bOS X\b/.test(Z)?(Y="Apple",Z="iOS 4.3+"):Z=null),U&&0==U.indexOf(z=/[\d.]+$/.exec(Z))&&a.indexOf("/"+z+"-")>-1&&(Z=n(Z.replace(z,""))),V&&!/\b(?:Avant|Nook)\b/.test(W)&&(/Browser|Lunascape|Maxthon/.test(W)||"Safari"!=W&&/^iOS/.test(Z)&&/\bSafari\b/.test(V[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(W)&&V[1])&&(z=V[V.length-1])&&R.push(z),R.length&&(R=["("+R.join("; ")+")"]),Y&&X&&X.indexOf(Y)<0&&R.push("on "+Y),X&&R.push((/^on /.test(R[R.length-1])?"":"on ")+X),Z&&(z=/ ([\d.+]+)$/.exec(Z)||(B=/^[a-z]+ ([\d.+]+) \//i.exec(Z)),Z={architecture:32,family:z&&!B?Z.replace(z[0],""):Z,version:z?z[1]:null,toString:function(){var a=this.version;return this.family+(a&&!B?" "+a:"")+(64==this.architecture?" 64-bit":"")}}),(z=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Q))&&!/\bi686\b/i.test(Q)&&(Z&&(Z.architecture=64,Z.family=Z.family.replace(RegExp(" *"+z),"")),W&&(/\bWOW64\b/i.test(a)||T&&/\w(?:86|32)$/.test(v.cpuClass||v.platform)&&!/\bWin64; x64\b/i.test(a))&&R.unshift("32-bit")),a||(a=null);var _={};return _.description=a,_.layout=V&&V[0],_.manufacturer=Y,_.name=W,_.prerelease=S,_.product=X,_.ua=a,_.version=W&&U,_.os=Z||{architecture:null,family:null,version:null,toString:function(){return"null"}},_.parse=o,_.toString=s,_.version&&R.unshift(U),_.name&&R.unshift(W),Z&&W&&(Z!=String(Z).split(" ")[0]||Z!=W.split(" ")[0]&&!X)&&R.push(X?"("+Z+")":"on "+Z),R.length&&(_.description=R.join(" ")),_}var p={function:!0,object:!0},q=p[typeof window]&&window||this,r=q,s=p[typeof d]&&d,t=p[typeof c]&&c&&!c.nodeType&&c,u=s&&t&&"object"==typeof b&&b;!u||u.global!==u&&u.window!==u&&u.self!==u||(q=u);var v=Math.pow(2,53)-1,w=/\bOpera/,x=this,y=Object.prototype,z=y.hasOwnProperty,A=y.toString;"function"==typeof a&&"object"==typeof a.amd&&a.amd?a(function(){return o()}):s&&t?i(o(),function(a,b){s[b]=a}):q.platform=o()}).call(void 0)}).call(this,void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[5])(5)}()}()}),empAnalyticsTmp=unwrapExports(empAnalytics_min),EMPAnalytics=window_1.empAnalytics?window_1.empAnalytics:empAnalyticsTmp,Plugin=videojs$1.getPlugin("plugin"),AnalyticsPlugin=function(_Plugin){function AnalyticsPlugin(player,options){classCallCheck(this,AnalyticsPlugin);var _this=possibleConstructorReturn(this,_Plugin.call(this,player,options));log$1("AnalyticsPlugin","create"),_this.analyticsConnector_=null,_this.options_=options,_this.onLoadStartBind=_this.onLoadStart_.bind(_this),_this.player.on(empPlayerEvents.LOAD_START,_this.onLoadStartBind);var client=detectClient();return _this.options_=_this.options_?_this.options_:{},_this.options_.analytics=_this.options_.analytics?_this.options_.analytics:{},_this.options_.analytics.deviceInfo=_this.options_.analytics.deviceInfo?_this.options_.analytics.deviceInfo:{},_this.options_.analytics.deviceInfo=videojs$1.mergeOptions({deviceName:client.name,model:client.version},_this.options_.analytics.deviceInfo),_this}return inherits(AnalyticsPlugin,_Plugin),AnalyticsPlugin.prototype.stop=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.dispose(),this.analyticsConnector_=null)},AnalyticsPlugin.prototype.stopCasting=function(){this.analyticsConnector_&&this.analyticsConnector_.dispose&&(this.analyticsConnector_.onChromeCastingStop(!0),this.analyticsConnector_=null)},AnalyticsPlugin.prototype.dispose=function(){log$1("AnalyticsPlugin","dispose"),this.player.off(empPlayerEvents.LOAD_START,this.onLoadStartBind),this.stop(),_Plugin.prototype.dispose.call(this)},AnalyticsPlugin.prototype.options=function(obj){if(!obj)return this.options_;this.options_=videojs$1.mergeOptions(this.options_,obj)},AnalyticsPlugin.prototype.newAnalytics=function(opt){log$1("new EMPAnalytics");var analytics=new EMPAnalytics(opt.exposureApiURL,opt.customer,opt.businessUnit,opt.sessionToken,opt.userId,this.options_.analytics&&this.options_.analytics.deviceInfo);this.stop(),log$1("new EMPAnalyticsConnector"),this.analyticsConnector_=new EMPAnalyticsConnector(this.player,analytics,this.options_)},AnalyticsPlugin.prototype.onEntitlementLoadStart=function(){this.analyticsConnector_&&this.analyticsConnector_.onEntitlementLoadStart()},AnalyticsPlugin.prototype.onError=function(e){this.analyticsConnector_&&this.analyticsConnector_.onError(e)},AnalyticsPlugin.prototype.onWindowUnload=function(){this.analyticsConnector_&&this.analyticsConnector_.onWindowUnload()},AnalyticsPlugin.prototype.onLoadStart_=function(event){extplayer.getEntitlement(this.player)||this.stop()},AnalyticsPlugin.prototype.version=function(){return EMPAnalytics?EMPAnalytics.VERSION:_Plugin.prototype.version.call(this)},createClass(AnalyticsPlugin,[{key:"connector",get:function(){return this.analyticsConnector_}}]),AnalyticsPlugin}(Plugin);AnalyticsPlugin.VERSION="2.1.97-259",videojs$1.getPlugin("analytics")?videojs$1.log.warn('A plugin named "analytics" already exists.'):videojs$1.registerPlugin("analytics",AnalyticsPlugin);var Entitlement=function(){function Entitlement(){classCallCheck(this,Entitlement),this.channelId,this.assetId,this.programId,this.productId="",this.mimeType="",this.playRequest=null,this.requestId="",this.edrmConfig=null,this.live=!1,this.playSessionId="",this.analyticsConfig=null,this.lastViewedOffset=null,this.lastViewedTime=null,this.liveTime=null,this.entitlementType="";Date.parse(null);this.licenseExpiration=null,this.licenseExpirationReason="",this.minBitrate=0,this.maxBitrate=0,this.maxResWidth=0,this.maxResHeight=0,this.rwEnabled=!0,this.ffEnabled=!0,this.airplayBlocked=!1,this.mdnRequestRouterUrl="",this.timeshiftEnabled=!0,this.formats=null,this.mediaLocator="",this.src="",this.adMediaLocator="",this.streamInfo=null,this.playToken="",this.playTokenExpiration="",this.protection=void 0,this.certificateServer=void 0,this.licenseServers=void 0}return Entitlement.prototype.commonInitiate=function(options){this.edrmConfig=options.edrmConfig||null,this.playSessionId=options.playSessionId||"",this.analyticsConfig=options.analyticsConfig||null,this.entitlementType=options.entitlementType||"",this.mdnRequestRouterUrl=options.mdnRequestRouterUrl||"",this.playToken=options.playToken||"",this.playTokenExpiration=options.playTokenExpiration||""},Entitlement.prototype.initiateV1=function(options,serverTime){this.commonInitiate(options),this.minBitrate=options.minBitrate||0,this.maxBitrate=options.maxBitrate||0,this.maxResWidth=options.maxResWidth||0,this.maxResHeight=options.maxResHeight||0,this.rwEnabled=void 0===options.rwEnabled||options.rwEnabled,this.ffEnabled=void 0===options.ffEnabled||options.ffEnabled,this.airplayBlocked=void 0!==options.airplayBlocked&&options.airplayBlocked,this.timeshiftEnabled=options.timeshiftEnabled||!0,this.lastViewedOffset=options.lastViewedOffset||null,this.lastViewedTime=options.lastViewedTime||null,this.liveTime=options.liveTime||null,this.live=options.live||!1;var licenseExpirationTimestamp=Date.parse(options.licenseExpiration||null);!1===isNaN(licenseExpirationTimestamp)&&(this.licenseExpiration=new Date(licenseExpirationTimestamp)),this.licenseExpirationReason=options.licenseExpirationReason||"",this.mediaLocator=options.mediaLocator||"",this.mediaLocator&&("localhost"===location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=options.adMediaLocator||"",options.streamInfo?this.streamInfo=options.streamInfo:this.setupStreamInfo(serverTime),options.fairplayConfig&&(this.protection={},this.protection.certificateUrl=options.fairplayConfig.certificateUrl||"",this.protection.licenseUrl=options.fairplayConfig.licenseAcquisitionUrl||"",options.fairplayConfig.secondaryMediaLocator?this.protection.version="mrr":this.protection.version="irdeto"),options.widevineConfig&&(this.certificateServer=options.widevineConfig.certificateUrl||""),options.cencConfig&&(this.licenseServers=options.cencConfig)},Entitlement.prototype.initiateV2=function(options){if(this.commonInitiate(options),this.formats=options.formats||null,options.contractractRestrictions){var contractractRestrictions=options.contractractRestrictions;this.minBitrate=contractractRestrictions.minBitrate||0,this.maxBitrate=contractractRestrictions.maxBitrate||0,this.maxResWidth=contractractRestrictions.maxResWidth||0,this.maxResHeight=contractractRestrictions.maxResHeight||0,this.rwEnabled=void 0===contractractRestrictions.rwEnabled||contractractRestrictions.rwEnabled,this.ffEnabled=void 0===contractractRestrictions.ffEnabled||contractractRestrictions.ffEnabled,this.airplayBlocked=void 0===contractractRestrictions.airplayEnabled||!contractractRestrictions.airplayEnabled,this.timeshiftEnabled=contractractRestrictions.timeshiftEnabled||!0}if(options.bookmarks){var bookmarks=options.bookmarks;this.lastViewedOffset=bookmarks.lastViewedOffset||null,this.lastViewedTime=bookmarks.lastViewedTime||null,this.liveTime=bookmarks.liveTime||null}if(options.streamInfo){var streamInfo=options.streamInfo;this.streamInfo={referenceTime:0},this.live=streamInfo.live||!1,this.streamInfo.live=streamInfo.live||!1,this.channelId=streamInfo.channelId||void 0,this.programId=streamInfo.programId||void 0,this.streamInfo.channelId=streamInfo.channelId||void 0,this.streamInfo.programId=streamInfo.programId||void 0,this.streamInfo.static=streamInfo.static||!1,this.isDynamicCachupAsLive=!streamInfo.static&&void 0!==streamInfo.start,this.isStaticCachupAsLive=streamInfo.static&&void 0!==streamInfo.end,streamInfo.start&&(this.streamInfo.start=new Date(1e3*streamInfo.start),this.streamInfo.startTime=this.streamInfo.start.getTime()),streamInfo.end&&(this.streamInfo.end=new Date(1e3*streamInfo.end),this.streamInfo.endTime=this.streamInfo.end.getTime())}},Entitlement.prototype.setupMediaLocator=function(format){this.mediaLocator=format.mediaLocator||"",this.mediaLocator&&("localhost"===location.hostname?this.src=this.mediaLocator:this.src=this.mediaLocator.replace(/^(http:)/,"").replace(/^(https:)/,"")),this.adMediaLocator=format.adMediaLocator||"";var licenseExpirationTimestamp=Date.parse(format.licenseExpiration||null);!1===isNaN(licenseExpirationTimestamp)&&(this.licenseExpiration=new Date(licenseExpirationTimestamp)),this.licenseExpirationReason=format.licenseExpirationReason||""},Entitlement.prototype.selectFormat=function(playRequest){var _this=this,formats=void 0;switch(this.mediaLocator="",this.src="",this.playRequest=playRequest,this.mimeType=playRequest.type,playRequest.format){case"DASH":if(formats=this.formats.filter(function(obj){return"DASH"===obj.format}),formats.length>0){var format=formats[0];this.setupMediaLocator(format),format.drm&&(this.licenseServers=format.drm,format.drm["com.widevine.alpha"]&&(this.certificateServer=format.drm["com.widevine.alpha"].certificateUrl),this.licenseServers={},Object.keys(format.drm).forEach(function(key){_this.licenseServers[key]=format.drm[key].licenseServerUrl}))}break;case"HLS":if(formats=this.formats.filter(function(obj){return"HLS"===obj.format}),formats.length>0){var _format=formats[0];this.setupMediaLocator(_format),_format.drm&&_format.drm["com.apple.fps"]&&(this.protection={},this.protection.certificateUrl=_format.drm["com.apple.fps"].certificateUrl||"",this.protection.licenseUrl=_format.drm["com.apple.fps"].licenseServerUrl||"",this.protection.version="irdeto")}}},Entitlement.prototype.setupStreamInfo=function(serverTime){if(this.streamInfo={referenceTime:0},this.isDynamicCachupAsLive=!1,this.isStaticCachupAsLive=!1,this.mediaLocator){var t=getParameterByName("t",this.mediaLocator);if(!t){var dvr_window_length=getParameterByName("dvr_window_length",this.mediaLocator);if(dvr_window_length){var nowDate=serverTime?new Date(serverTime):new Date;t=new Date(nowDate.getTime()-1e3*dvr_window_length).toISOString().replace(/Z/g,"")}else if(this.live){var _nowDate=serverTime?new Date(serverTime):new Date;t=new Date(_nowDate.getTime()-72e5).toISOString().replace(/Z/g,"")}}if(t)try{t&&47===t.length?(this.streamInfo.start=new Date(t.slice(0,23)+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime(),this.streamInfo.end=new Date(t.slice(24)+"Z"),this.streamInfo.endTime=this.streamInfo.end.getTime()):t&&23===t.length&&(this.streamInfo.start=new Date(t+"Z"),this.streamInfo.startTime=this.streamInfo.start.getTime()),this.isDynamicCachupAsLive=void 0!==this.streamInfo.start&&void 0===this.streamInfo.end,this.isStaticCachupAsLive=void 0!==this.streamInfo.start&&void 0!==this.streamInfo.end}catch(e){log$1.warn("timeParams",e)}}},createClass(Entitlement,null,[{key:"Type",get:function(){return{DASH:"DASH",FLASH:"FLASH",HLS:"HLS"}}}]),Entitlement}(),dist=createCommonjsModule(function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(_x2,_x3,_x4){for(var _again=!0;_again;){var object=_x2,property=_x3,receiver=_x4;_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;if(void 0===getter)return;return getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return;_x2=parent,_x3=property,_x4=receiver,_again=!0,desc=parent=void 0}},ExtendableError=function(_Error){function ExtendableError(){var message=arguments.length<=0||void 0===arguments[0]?"":arguments[0];if(_classCallCheck(this,ExtendableError),_get(Object.getPrototypeOf(ExtendableError.prototype),"constructor",this).call(this,message),Object.defineProperty(this,"message",{enumerable:!1,value:message,writable:!0}),Object.defineProperty(this,"name",{enumerable:!1,value:this.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace"))return void Error.captureStackTrace(this,this.constructor);Object.defineProperty(this,"stack",{enumerable:!1,value:new Error(message).stack,writable:!0})}return _inherits(ExtendableError,_Error),ExtendableError}(Error);exports.default=ExtendableError,module.exports=exports.default}),ExtendableError=unwrapExports(dist),EntitlementError=function(_ExtendableError){function EntitlementError(){var error=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};classCallCheck(this,EntitlementError);var message=void 0,fatal=!0,code=EmpPlayerErrorCodes.ENTITLEMENT2;"string"==typeof error?message=error:error instanceof Object&&(message=error.message,!1===error.fatal&&(fatal=error.fatal),error.code&&(code=error.code));var _this=possibleConstructorReturn(this,_ExtendableError.call(this,message));return _this.fatal=fatal,_this.code=code,_this}return inherits(EntitlementError,_ExtendableError),createClass(EntitlementError,[{key:"fatal",get:function(){return!!this.fatal_},set:function(fatal){this.fatal_=fatal}}]),EntitlementError}(ExtendableError),EntitlementEngine=function(){function EntitlementEngine(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};classCallCheck(this,EntitlementEngine),this.options_=options}return EntitlementEngine.prototype.getEntitlement=function(entitlementRequest,playRequest,callback){throw new EntitlementError("EntitlementEngine: getEntitlement should be implemented in subclass.")},EntitlementEngine.prototype.getServerTime=function(callback){throw new EntitlementError("EntitlementEngine: getServerTime should be implemented in subclass.")},EntitlementEngine.prototype.syncServerTime=function(callback){this.getServerTime(function(date,error){error&&(log$1.error("getServerTime",error),date=new Date),EntitlementEngine.ServerTimeDiff_=date-new Date,log$1("serverDiff",EntitlementEngine.ServerTimeDiff_),callback&&callback(EntitlementEngine.ServerTimeDiff_,error)})},EntitlementEngine.prototype.getCachedServerTime=function(){return void 0!==EntitlementEngine.ServerTimeDiff_?Date.now()+EntitlementEngine.ServerTimeDiff_:Date.now()},EntitlementEngine.prototype.getPreferences=function(callback){throw new EntitlementError("EntitlementEngine: getPreferences should be implemented in subclass.")},EntitlementEngine.prototype.savePreferences=function(preferences,callback){throw new EntitlementError("EntitlementEngine: savePreferences should be implemented in subclass.")},EntitlementEngine.prototype.getProgramInfo=function(channelId,date,callback,programId){throw new EntitlementError("EntitlementEngine: getProgramInfo should be implemented in subclass.")},EntitlementEngine.prototype.getEPG=function(channelId,from,to,callback){throw new EntitlementError("EntitlementEngine: getEPG should be implemented in subclass.")},EntitlementEngine.prototype.getAssetInfo=function(assetId,callback){throw new EntitlementError("EntitlementEngine: getAssetInfo should be implemented in subclass.")},EntitlementEngine.prototype.getChannelInfo=function(channelId,callback){throw new EntitlementError("EntitlementEngine: getChannelInfo should be implemented in subclass.")},EntitlementEngine.prototype.verifySession=function(okFn,nokFn){throw new EntitlementError("EntitlementEngine: verifySession should be implemented in subclass.")},EntitlementEngine.prototype.verifyEntitlement=function(assetId,playRequest,callback){throw new EntitlementError("EntitlementEngine: verifyEntitlement should be implemented in subclass.")},EntitlementEngine.prototype.login=function(username,password,callback,mfacode){throw new EntitlementError("EntitlementEngine: login should be implemented in subclass.")},EntitlementEngine.prototype.logout=function(callBack){throw new EntitlementError("EntitlementEngine: logout should be implemented in subclass.")},EntitlementEngine.prototype.fetchPreferences=function(callback){throw new EntitlementError("EntitlementEngine: fetchPreferences should be implemented in subclass.")},EntitlementEngine.prototype.savePreferences=function(preferences,callback){throw new EntitlementError("EntitlementEngine: savePreferences should be implemented in subclass.")},EntitlementEngine.isEntitlementEngine=function(object){return object.prototype instanceof EntitlementEngine||object instanceof EntitlementEngine||object===EntitlementEngine},EntitlementEngine.registerEntitlementEngine=function(name,entitlementEngine){if(EntitlementEngine.engines_||(EntitlementEngine.engines_={}),!EntitlementEngine.isEntitlementEngine(entitlementEngine))throw new EntitlementError("EntitlementEngine "+name+" must be a EntitlementEngine");return EntitlementEngine.engines_[name]=entitlementEngine,entitlementEngine},EntitlementEngine.getEntitlementEngine=function(name){return name=name||"EricssonExposure",EntitlementEngine.engines_&&EntitlementEngine.engines_[name]?EntitlementEngine.engines_[name]:null},EntitlementEngine}();EntitlementEngine.ServerTimeDiff_=void 0;var isFunction_1=isFunction,toString$1=Object.prototype.toString,trim_1=createCommonjsModule(function(module,exports){function trim(str){return str.replace(/^\s*|\s*$/g,"")}exports=module.exports=trim,exports.left=function(str){return str.replace(/^\s*/,"")},exports.right=function(str){return str.replace(/\s*$/,"")}}),forEach_1=forEach,toString$2=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty,isArray=function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},parseHeaders=function(headers){if(!headers)return{};var result={};return forEach_1(trim_1(headers).split("\n"),function(row){var index=row.indexOf(":"),key=trim_1(row.slice(0,index)).toLowerCase(),value=trim_1(row.slice(index+1));void 0===result[key]?result[key]=value:isArray(result[key])?result[key].push(value):result[key]=[result[key],value]}),result},immutable=extend,hasOwnProperty$1=Object.prototype.hasOwnProperty,xhr=createXHR;createXHR.XMLHttpRequest=window_1.XMLHttpRequest||noop$1,createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:window_1.XDomainRequest,function(array,iterator){for(var i=0;i<array.length;i++)iterator(array[i])}(["get","put","post","patch","head","delete"],function(method){createXHR["delete"===method?"del":method]=function(uri,options,callback){return options=initParams(uri,options,callback),options.method=method.toUpperCase(),_createXHR(options)}});var EricssonMDN=function(){function EricssonMDN(){classCallCheck(this,EricssonMDN)}return EricssonMDN.getBaseUrl=function(entitlement,callback){var oXHR=new XMLHttpRequest
;oXHR.open("GET",entitlement.mdnRequestRouterUrl),oXHR.onreadystatechange=function(oEvent){if(4===oXHR.readyState)if(200===oXHR.status){log$1("getBaseUrl OK");var xmlDoc=oXHR.responseXML;try{var baseURL=xmlDoc.firstChild.getElementsByTagName("baseURL")[0].textContent;baseURL?entitlement.baseUrl=baseURL:log$1.error("getBaseUrl Error can not find baseURL"),callback(entitlement)}catch(err){log$1.error("getBaseUrl Error",err),callback(entitlement)}}else log$1.error("getBaseUrl Error",oXHR.statusText),callback(entitlement)},oXHR.send(null)},EricssonMDN}(),EricssonExposure=function(_EntitlementEngine){function EricssonExposure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};classCallCheck(this,EricssonExposure),options=assign({exposureApiURL:"https://exposure.emps.ebsd.ericsson.net",exposureApiVersion:"v1"},options);var _this=possibleConstructorReturn(this,_EntitlementEngine.call(this,options));return _this.errorMap={400:{INVALID_JSON:{message:"Invalid json.",fatal:!1}},401:{NO_SESSION_TOKEN:{message:"The session token is missing.",fatal:!0},INVALID_SESSION_TOKEN:{message:"The session token is not valid.",fatal:!0}},403:{FORBIDDEN:{message:"The business unit has been configured to require server to server authentication, but it is not valid.",fatal:!0},NOT_ENTITLED:{message:"The user is not entitled.",fatal:!0},DEVICE_BLOCKED:{message:"The device is not allowed to play the asset.",fatal:!0},GEO_BLOCKED:{message:"Not allowed from this region.",fatal:!0},LICENSE_EXPIRED:{message:"Asset has been expired.",fatal:!0},NOT_AVAILABLE_IN_FORMAT:{message:"The media is not available in the requested format.",fatal:!1},NOT_ENABLED:{message:"The media is not enabled.",fatal:!0},CONCURRENT_STREAMS_LIMIT_REACHED:{message:"You have reached the maximum number of concurrent streams you are allowed to watch.",fatal:!0},NO_MEDIA_ON_CHANNEL:{message:"The media is not available on the channel.",fatal:!1},NO_MEDIA_FOR_PROGRAM:{message:"No media available for this program.",fatal:!1}},404:{UNKNOWN_BUSINESS_UNIT:{message:"The business unit cannot be found.",fatal:!0},UNKNOWN_ASSET:{message:"The asset cannot be found.",fatal:!1}},0:{NETWORK_ERROR:{message:"Network error.",fatal:!1}}},void 0===EntitlementEngine.ServerTimeDiff_&&_this.getServerTime(function(date,error){error&&(log$1.error("getServerTime",error),date=new Date),EntitlementEngine.ServerTimeDiff_=date-new Date,log$1("serverDiff",EntitlementEngine.ServerTimeDiff_)}),_this}return inherits(EricssonExposure,_EntitlementEngine),EricssonExposure.prototype.login=function(username,password,callback,mfacode){var _this2=this;if(!callback)throw"callback is mandantory for login";var is2factor=!1;mfacode&&(is2factor=!0);var isAnonymous=""===username,expiration=new Date(this.getCachedServerTime());if(expiration.setTime(expiration.getTime()+864e5),this.options_.apiKey){var requestHeaders={"EMP-Auth":this.options_.apiKey},loginUrl=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit+"/auth/session",requestData={accountId:username,userId:username,deviceId:"WEB_"+username,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},expiration:expiration.toISOString(),anonymous:!1};xhr.post(loginUrl,{json:requestData,headers:requestHeaders},function(error,response,data){_this2.checkForError(error,response,function(nothing,error){callback({success:!1,expiration:0,message:error.message})})||(_this2.sessionToken=data.sessionToken,callback({success:!0,expiration:864e5,session:data}))})}else{var _loginUrl=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+this.customer+"/businessunit/"+this.businessUnit;_loginUrl+=!0===isAnonymous?"/auth/anonymous":!0===is2factor?"/auth/twofactorlogin":"/auth/login";var _requestData={deviceId:"WEB_"+username,device:{height:screen.height,width:screen.width,model:navigator.appName,name:navigator.product,os:navigator.platform,osVersion:navigator.appVersion,manufacturer:navigator.vendor,type:"WEB"},rememberMe:!1,username:username,password:password,totp:!0===is2factor?mfacode:void 0};xhr.post(_loginUrl,{json:_requestData},function(error,response,data){_this2.checkForError(error,response,function(nothing,error){callback({success:!1,expiration:0,message:error.message})})||(_this2.sessionToken=data.sessionToken,callback({success:!0,expiration:data.expirationDateTime?new Date(data.expirationDateTime)-new Date(_this2.getCachedServerTime()):864e5,session:data}))})}},EricssonExposure.prototype.logout=function(){var _this3=this,callback=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},sessionToken=arguments[1],customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");var requestHeaders=this.requestHeaders;sessionToken&&(requestHeaders={Authorization:"Bearer "+sessionToken});var queryUrl=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/auth/session";return xhr.del(queryUrl,{headers:requestHeaders},function(error,response,data){_this3.checkForError(error,response,callback)||(_this3.sessionToken=null,void 0!==(void 0===callback?"undefined":_typeof(callback))&&callback(!0))})},EricssonExposure.prototype.getV2Entitlement=function(entitlementRequest,playRequest,preEntitlement,callback){if(void 0===entitlementRequest)throw new EntitlementError("No request specified.");if(void 0===entitlementRequest.assetId)throw new EntitlementError("No assetId specified.");if(void 0===playRequest)throw new EntitlementError("Media not found.");if(!playRequest.drm||!playRequest.format)throw new EntitlementError("Invalid playrequest specified.");this.getV2Asset_(entitlementRequest,playRequest,preEntitlement,callback)},EricssonExposure.prototype.getEntitlement=function(entitlementRequest,playRequest,callback){if(void 0===entitlementRequest)throw new EntitlementError("No request specified.");if(void 0===entitlementRequest.assetId)throw new EntitlementError("No assetId specified.");if(void 0===playRequest)throw new EntitlementError("Media not found.");if(!playRequest.drm||!playRequest.format)throw new EntitlementError("Invalid playrequest specified.");null!==entitlementRequest.programId||entitlementRequest.channelId?this.getProgram_(entitlementRequest.assetId,entitlementRequest.programId,playRequest,callback):this.getAsset_(entitlementRequest.assetId,playRequest,callback)},EricssonExposure.prototype.getErrorForResponse=function(response){if(!response)return null;var statusCode=response.statusCode,message="";response.body&&(message=response.body.message);var error=this.errorMap[statusCode];if(error){var errorMessage=statusCode+" "+message,matchedError=error[message];return matchedError&&(errorMessage+=": "+matchedError.message),new EntitlementError(matchedError?{message:errorMessage,fatal:!!matchedError.fatal}:errorMessage)}if(!(statusCode>=200&&statusCode<=299)){return new EntitlementError(statusCode+" "+message)}return null},EricssonExposure.prototype.checkForError=function(xhrError,xhrResponse,callback){var error=xhrError;return xhrError||(error=this.getErrorForResponse(xhrResponse)),error?(callback&&callback(null,error),error):null},EricssonExposure.prototype.getV2Asset_=function(entitlementRequest,playRequest,preEntitlement){var _this4=this,callback=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");if(!preEntitlement||!preEntitlement.formats){var assetId=entitlementRequest.programId?entitlementRequest.programId:entitlementRequest.assetId,requestURL=this.options_.exposureApiURL+"/v2/customer/"+customer+"/businessunit/"+businessUnit+"/entitlement/"+assetId+"/play";return xhr.get(requestURL,{headers:this.requestHeaders},function(error,response,body){if(error)return log$1.warn("Fallback to Entitlement request v1"),void(null!==entitlementRequest.programId||entitlementRequest.channelId?_this4.getProgram_(entitlementRequest.assetId,entitlementRequest.programId,playRequest,callback):_this4.getAsset_(entitlementRequest.assetId,playRequest,callback));if(!_this4.checkForError(error,response,callback)){var options=JSON.parse(body),entitlement=new Entitlement;entitlement.initiateV2(options),entitlement.selectFormat(playRequest),entitlementRequest.assetId&&(entitlement.assetId=entitlementRequest.assetId),entitlement.channelId&&(entitlement.assetId=entitlement.channelId),(entitlement.channelId||entitlement.programId)&&_this4.setStreamReferenceTime_(entitlement);var requestId=response.headers["x-request-id"];if(entitlement.requestId=requestId||"",entitlement.mediaLocator)callback(entitlement,null);else{var _entitlementError=new EntitlementError(playRequest.format+" not avalible");_entitlementError.fatal=!1,callback(entitlement,_entitlementError)}}})}if(preEntitlement.selectFormat(playRequest),preEntitlement.mediaLocator)callback(preEntitlement,null);else{var entitlementError=new EntitlementError(playRequest.format+" not avalible");entitlementError.fatal=!1,callback(preEntitlement,entitlementError)}},EricssonExposure.prototype.getAsset_=function(assetId,playRequest){var _this5=this,callback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");var requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/entitlement/"+assetId+"/play";return xhr.post(requestURL,{json:playRequest,headers:this.requestHeaders},function(error,response,body){if(!_this5.checkForError(error,response,callback)){var entitlement=new Entitlement;entitlement.initiateV1(body,response.headers.date),entitlement.assetId=assetId,entitlement.playRequest=playRequest,entitlement.mimeType=playRequest.type;var requestId=response.headers["x-request-id"];entitlement.requestId=requestId||"",entitlement.mdnRequestRouterUrl?EricssonMDN.getBaseUrl(entitlement,callback):callback(entitlement)}})},EricssonExposure.prototype.setStreamReferenceTime_=function(entitlement){(entitlement.isDynamicCachupAsLive||entitlement.isStaticCachupAsLive)&&("application/dash+xml"===entitlement.mimeType?entitlement.isStaticCachupAsLive?entitlement.streamInfo.referenceTime=entitlement.streamInfo.startTime:entitlement.streamInfo.referenceTime=0:"application/x-mpegurl"===entitlement.mimeType&&(entitlement.streamInfo.referenceTime=entitlement.streamInfo.startTime))},EricssonExposure.prototype.getAssetMetadata_=function(assetId,callback){var _this6=this,customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");var requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/content/asset/"+assetId;return xhr.get(requestURL,null,function(error,response,body){if(!_this6.checkForError(error,response,callback)){var metadata=JSON.parse(body);callback(metadata)}})},EricssonExposure.prototype.getProgram_=function(channelId,programId,playRequest){var _this7=this,callback=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");var programUrl="";programId&&(programUrl="/program/"+programId);var channelUrl="";channelId&&(channelUrl="/channel/"+channelId);var requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/entitlement"+channelUrl+programUrl+"/play";return xhr.post(requestURL,{json:playRequest,headers:this.requestHeaders},function(error,response,body){if(!_this7.checkForError(error,response,callback)){var entitlement=new Entitlement;entitlement.initiateV1(body,response.headers.date),channelId&&(entitlement.assetId=channelId,entitlement.channelId=channelId),programId&&(entitlement.programId=programId),entitlement.playRequest=playRequest,entitlement.mimeType=playRequest.type,_this7.setStreamReferenceTime_(entitlement);var requestId=response.headers["x-request-id"];entitlement.requestId=requestId||"",entitlement.mdnRequestRouterUrl?EricssonMDN.getBaseUrl(entitlement,callback):callback(entitlement)}})},EricssonExposure.prototype.getServerTime=function(callback){var customer=this.customer,businessUnit=this.businessUnit;if(!customer||!businessUnit)return log$1.warn("getServerTime no customer or businessUnit"),void callback(new Date);if(!1===window.navigator.onLine)return log$1("getServerTime offline"),void callback(new Date);var requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/time";return xhr.get(requestURL,null,function(error,response,body){if(error)return void callback(null,error);var json=JSON.parse(body),date=new Date(json.iso8601);callback(date)})},EricssonExposure.prototype.getPreferences=function(callback){var _this8=this,customer=this.customer,businessUnit=this.businessUnit,requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/preferences";return xhr.get(requestURL,{headers:this.requestHeaders},function(error,response,body){if(!_this8.checkForError(error,response,callback)){var json=JSON.parse(body);callback(json)}})},EricssonExposure.prototype.savePreferences=function(preferences,callback){var _this9=this,customer=this.customer,businessUnit=this.businessUnit;if(!preferences)return void log$1.error("Preferences was not provided.");var data={preferences:preferences},requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/preferences";return xhr.post(requestURL,{json:data,headers:this.requestHeaders},function(error,response,body){_this9.checkForError(error,response,callback)||callback(!0)})},EricssonExposure.prototype.getEPG=function(channelId,from,to,callback){var _this10=this,customer=this.customer,businessUnit=this.businessUnit,requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/epg/"+channelId;return requestURL+="?from="+from+"&to="+to,xhr.get(requestURL,null,function(error,response,body){if(!_this10.checkForError(error,response,callback)){var json=JSON.parse(body);callback(json)}})},EricssonExposure.prototype.getProgramInfo=function(channelId,date,callback,programId){var customer=this.customer,businessUnit=this.businessUnit,params=null,requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/epg/"+channelId;return programId?requestURL=requestURL+"/program/"+programId:(params={from:date.getTime(),to:date.getTime()},requestURL+="?from="+params.from+"&to="+params.to),xhr.get(requestURL,null,function(error,response,body){if(error)return void callback(null,error);var json=JSON.parse(body),program=void 0;if(json.programs&&json.programs.length>0)program=json.programs[0];else{if(!json.programId)return void callback(null,"No programs found.");program=json}program.start=new Date(program.startTime),program.end=new Date(program.endTime),program.duration=new Date(program.endTime)-new Date(program.startTime),callback(program)})},EricssonExposure.prototype.getChannelInfo=function(channelId){var callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.getAssetInfo(channelId,callback)},EricssonExposure.prototype.getAssetInfo=function(assetId,callback){var _this11=this,customer=this.customer,businessUnit=this.businessUnit,requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/content/asset/"+assetId;return xhr.get(requestURL,null,function(error,response,body){if(error)return void callback(null,error);if(!_this11.checkForError(error,response,callback)){var asset=JSON.parse(body);callback(asset)}})},EricssonExposure.prototype.verifyEntitlement=function(assetId,playRequest){var _this12=this,callback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},customer=this.customer,businessUnit=this.businessUnit;if(!customer)throw new EntitlementError("Customer was not provided.");if(!businessUnit)throw new EntitlementError("Business unit was not provided.");if(!assetId)throw new EntitlementError("assetId was not provided.");if(!playRequest)throw new EntitlementError("playRequest was not provided.");var requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/entitlement/"+assetId+"?drm="+playRequest.drm+"&format="+playRequest.format;return xhr.get(requestURL,{headers:this.requestHeaders},function(error,response,body){_this12.checkForError(error,response,callback)||void 0!==(void 0===callback?"undefined":_typeof(callback))&&callback(JSON.parse(body))})},EricssonExposure.prototype.verifySession=function(okFn,nokFn){var _this13=this,customer=this.customer,businessUnit=this.businessUnit,requestURL=this.options_.exposureApiURL+"/"+this.options_.exposureApiVersion+"/customer/"+customer+"/businessunit/"+businessUnit+"/auth/session";return xhr.get(requestURL,{headers:this.requestHeaders},function(error,response,body){if(_this13.checkForError(error,response))return void(nokFn&&nokFn());okFn&&okFn()})},createClass(EricssonExposure,[{key:"requestHeaders",get:function(){var headers={Authorization:"Bearer "+this.sessionToken};return this.options_.apiKey&&(headers=assign({"EMP-Auth":this.options_.apiKey},headers)),headers}},{key:"customer",get:function(){return this.customer_||this.options_.customer||null},set:function(customer){this.customer_=customer}},{key:"businessUnit",get:function(){return this.businessUnit_||this.options_.businessUnit||null},set:function(businessUnit){this.businessUnit_=businessUnit}},{key:"sessionToken",get:function(){return this.options_.sessionToken||null},set:function(sessionToken){this.options_.sessionToken=sessionToken}}]),EricssonExposure}(EntitlementEngine);EntitlementEngine.registerEntitlementEngine("EricssonExposure",EricssonExposure);var EntitlementRequest=function(){function EntitlementRequest(options){classCallCheck(this,EntitlementRequest),this.assetId=options.assetId||null,this.programId=options.programId||null,this.channelId=options.channelId||null}return createClass(EntitlementRequest,[{key:"assetId",get:function(){return this.assetId_},set:function(assetId){this.assetId_=assetId}},{key:"programId",get:function(){return this.programId_},set:function(programId){this.programId_=programId}},{key:"channelId",get:function(){return this.channelId_},set:function(channelId){this.channelId_=channelId}}]),EntitlementRequest}(),Plugin$1=videojs.getPlugin("plugin"),ProgramService=function(_Plugin){function ProgramService(player,options){classCallCheck(this,ProgramService);var _this=possibleConstructorReturn(this,_Plugin.call(this,player,options));return log$1("ProgramService","create"),_this.MIN_PROGRAM_CHECK_TIMEOUT=1e3,_this.checkForProgramChangeBind=_this.checkForProgramChange_.bind(_this),_this.onEntitlementChangeBind=_this.onEntitlementChange.bind(_this),_this.clearProgramChangeTimeoutBind=_this.clearProgramChangeTimeout_.bind(_this),_this.options_=options||{},_this.programChangeTimeout_=null,_this.programChangeCheckTimestamp_=0,_this.player.on(empPlayerEvents.ENTITLEMENT_CHANGE,_this.onEntitlementChangeBind),_this}return inherits(ProgramService,_Plugin),ProgramService.prototype.entitlement=function(value){return void 0===value?this.entitlement_:(this.entitlement_=value,value)},ProgramService.prototype.options=function(obj){if(!obj)return this.options_;this.options_=obj},ProgramService.prototype.onEntitlementChange=function(event,data){var entitlement=data&&data.entitlement;entitlement&&(entitlement instanceof Entitlement||(this.stop(),entitlement=assign(new Entitlement({}),entitlement)),this.entitlement(entitlement)),extplayer.supportsEpgProgramChange(this.player)||(this.player.off(empPlayerEvents.PLAYING,this.checkForProgramChangeBind),this.player.one(empPlayerEvents.PLAYING,this.checkForProgramChangeBind))},ProgramService.prototype.start=function(){log$1("ProgramService","start"),this.entitlement()&&this.checkForProgramChange_({type:"startplayback"})},ProgramService.prototype.stop=function(){log$1("ProgramService stop"),this.clearProgramChangeTimeout_(),this.player&&(this.player.off(empPlayerEvents.SEEKED,this.checkForProgramChangeBind),this.player.off(empPlayerEvents.PLAYING,this.checkForProgramChangeBind),this.player.off(empPlayerEvents.PAUSE,this.clearProgramChangeTimeoutBind),this.player.off(empPlayerEvents.PLAY,this.checkForProgramChangeBind)),this.currentProgram_=null,this.currentVOD_=null},ProgramService.prototype.reset=function(){this.stop(),this.currentProgram_=null,this.currentVOD_=null,this.entitlement_=null},ProgramService.prototype.clearProgramChangeTimeout_=function(event,data){this.programChangeTimeout_&&(event&&log$1("clearProgramChangeTimeout",event.type),clearTimeout(this.programChangeTimeout_),this.programChangeTimeout_=null)},ProgramService.prototype.running=function(){return!!this.programChangeTimeout_&&(log$1("ProgramService:running",this.programChangeCheckTimestamp_?new Date(this.programChangeCheckTimestamp_):0),!0)},ProgramService.prototype.dispose=function(){log$1("ProgramService","dispose"),this.player.off(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.stop(),_Plugin.prototype.dispose.call(this)},ProgramService.prototype.checkForProgramChange_=function(event,data){var _this2=this;if(!event)return void log$1.error("checkForProgramChange","event was not provided.");if(log$1("checkForProgramChange",event.type),(this.entitlement().live||this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive||event.type!==empPlayerEvents.SEEKED)&&this.player&&this.player.options_){if(this.player.options_.absoluteStartTime&&event.type===empPlayerEvents.SEEKED)return void log$1("checkForProgramChange","ignore livepoint");if(this.clearProgramChangeTimeout_(),extplayer.supportsEpgProgramChange(this.player)){if(extplayer.program(this.player))return void log$1("updateCurrentProgram from player")}var assetId=this.entitlement().assetId,isLive=this.entitlement().live,programId=this.entitlement().programId;if(!isLive&&!programId)return void this.updateVOD_(assetId);var dateTime=void 0;if(isLive&&!programId){var serverDate=new Date(this.exposure.getCachedServerTime()),secondsBehind="startplayback"===event.type?15:extplayer.timeBehindLive(this.player);if(serverDate.setSeconds(serverDate.getSeconds()-secondsBehind),dateTime=serverDate,log$1("checkForProgramChange","Live",secondsBehind),this.currentProgram&&this.currentProgram.channelId===this.entitlement().channelId&&dateTime.getTime()<this.currentProgram.end.getTime()&&dateTime.getTime()>=this.currentProgram.start.getTime())return log$1("checkForProgramChange","Same"),dateTime=null,void this.updateCurrentProgram_(this.currentProgram,!1)}else if("startplayback"!==event.type&&(this.entitlement().isDynamicCachupAsLive||this.entitlement().isStaticCachupAsLive)){var playHeadTime=extplayer.getPlayheadTime(this.player);if(playHeadTime){dateTime=new Date(playHeadTime);new Date(this.exposure.getCachedServerTime());if(this.currentProgram&&this.entitlement().isStaticCachupAsLive&&dateTime.getTime()+2e3>=this.entitlement().streamInfo.end.getTime())return void(this.player.lineUpAsset&&dateTime.getTime()+2e3<this.currentProgram.end.getTime()?(log$1("checkForProgramChange","Load next stream",dateTime),this.player.lineUpAsset(null,this.currentProgram.channelId,this.currentProgram.programId,dateTime.getTime())):(log$1("checkForProgramChange","playNextProgram",dateTime),this.player.playNextProgram()));if(this.currentProgram&&dateTime.getTime()+2e3>=this.currentProgram.end.getTime())log$1("checkForProgramChange","Next",dateTime),dateTime.setSeconds(dateTime.getSeconds()+2);else{if(this.currentProgram&&dateTime.getTime()<this.currentProgram.end.getTime()&&dateTime.getTime()>=this.currentProgram.start.getTime())return log$1("checkForProgramChange","Same",dateTime),dateTime=null,void this.updateCurrentProgram_(this.currentProgram,!1);log$1("checkForProgramChange","Prev",dateTime)}}}this.exposure.getProgramInfo(assetId,dateTime,function(program,error){if(_this2.currentVOD_=null,error)return log$1("getProgramInfo","No EPG found.",error),void _this2.pollingForEPG_();_this2.updateCurrentProgram_(program,"startplayback"===event.type)},dateTime?null:programId)}},ProgramService.prototype.updateChannelInfo_=function(program,callback){var _this3=this;return program&&program.channelId?this.currentChannelAsset_&&this.currentChannelAsset_.assetId===program.channelId?(program.channelInfo=this.extractAssetMetadata(this.currentChannelAsset_),void callback()):void this.exposure.getChannelInfo(program.channelId,function(channelAsset,error){if(error)return log$1.warn("updateChannelInfo","No ChannelInfo found.",error),void callback();log$1("updateChannelInfo",program.channelId),_this3.currentChannelAsset_=channelAsset,program.channelInfo=_this3.extractAssetMetadata(_this3.currentChannelAsset_),callback()}):(log$1.error("updateChannelInfo","program or channelId empty"),void callback())},ProgramService.prototype.updateVOD_=function(assetId){var _this4=this;this.exposure.getAssetInfo(assetId,function(asset,error){if(_this4.currentProgram_=null,_this4.player)return error?(log$1.warn("No AssetInfo found.",error),_this4.currentVOD_=null,void _this4.player.trigger(empPlayerEvents.ASSET_CHANGED,{asset:null})):void(_this4.currentVOD_&&_this4.currentVOD_.assetId===asset.assetId||(_this4.currentVOD_=asset,log$1("ASSET_CHANGED"),_this4.player.trigger(empPlayerEvents.ASSET_CHANGED,{asset:asset})))})},ProgramService.prototype.updateCurrentProgram_=function(program,startplayback){var _this5=this;if(log$1("updateCurrentProgram",program,startplayback),this.clearProgramChangeTimeout_(),this.player){if(this.currentProgram_&&this.currentProgram_.programId===program.programId||(this.currentVOD_=null,this.currentProgram_=program,startplayback||this.verifyEntitlement(),this.updateChannelInfo_(program,function(){if(_this5.player){extplayer.currentAsset(_this5.player).channelId||(extplayer.currentAsset(_this5.player,program.channelId,program.programId,program.channelId),_this5.entitlement_&&!_this5.entitlement_.channelId&&(_this5.entitlement_.channelId=program.channelId,_this5.entitlement_.assetId=program.channelId)),extplayer.setTechProgram(_this5.player,program),_this5.player.removeClass("vjs-live"),_this5.player.trigger(empPlayerEvents.PROGRAM_CHANGED,{program:program}),_this5.player.trigger(empPlayerEvents.DURATION_CHANGE)}})),startplayback)return void log$1("updateCurrentProgram","startplayback");if(this.entitlement().isDynamicCachupAsLive||this.entitlement().live||this.entitlement().isStaticCachupAsLive){var date=void 0;if(this.entitlement().isStaticCachupAsLive||this.entitlement().isDynamicCachupAsLive){var playHeadTime=extplayer.getPlayheadTime(this.player);if(!playHeadTime)return void log$1("updateCurrentProgram","no playHeadTime",playHeadTime);date=new Date(playHeadTime)}else{var secondsBehind=extplayer.timeBehindLive(this.player);date=new Date(this.exposure.getCachedServerTime()),date.setSeconds(date.getSeconds()-secondsBehind)}var expiryDate=new Date(program.start.getTime()+program.duration),streamEnd=this.entitlement().streamInfo.end;streamEnd&&expiryDate.getTime()>streamEnd.getTime()&&(expiryDate=streamEnd);var timediff=expiryDate.getTime()-date.getTime();(!timediff||timediff<this.MIN_PROGRAM_CHECK_TIMEOUT)&&(log$1("updateCurrentProgram","timediff is below minimum",timediff),timediff=this.MIN_PROGRAM_CHECK_TIMEOUT),this.programChangeCheckTimestamp_=Date.now()+timediff,log$1("updateCurrentProgram","programChangeTimeout",new Date(this.programChangeCheckTimestamp_)),this.programChangeTimeout_=setTimeout(function(){_this5.checkForProgramChange_({type:"programend"}),_this5.programChangeTimeout_=null},timediff>2147483647?2147483647:timediff)}this.player.off(empPlayerEvents.SEEKED,this.checkForProgramChangeBind),this.player.one(empPlayerEvents.SEEKED,this.checkForProgramChangeBind),this.player.off(empPlayerEvents.PLAY,this.checkForProgramChangeBind),this.player.one(empPlayerEvents.PLAY,this.checkForProgramChangeBind),this.player.off(empPlayerEvents.PAUSE,this.clearProgramChangeTimeoutBind),this.player.one(empPlayerEvents.PAUSE,this.clearProgramChangeTimeoutBind)}},ProgramService.prototype.pollingForEPG_=function(){var _this6=this;this.currentProgram_;this.currentProgram_=null,this.player.trigger(empPlayerEvents.PROGRAM_CHANGED,{program:null}),this.player.trigger(empPlayerEvents.DURATION_CHANGE),this.player.addClass("vjs-live");this.programChangeCheckTimestamp_=Date.now()+12e4,this.programChangeTimeout_=setTimeout(function(){_this6.checkForProgramChange_({type:"pollingforepg"}),_this6.programChangeTimeout_=null},12e4)},ProgramService.prototype.getNextProgram=function(callback){if(!this.currentProgram&&callback)return void callback(null,{message:"getNextProgram No Current Program"});if(this.exposure.getCachedServerTime()<this.currentProgram.end.getTime())return void callback(this.currentProgram);var dateTime=new Date(this.currentProgram.endTime);dateTime.setSeconds(dateTime.getSeconds()+15),this.exposure.getProgramInfo(this.currentProgram.channelId,dateTime,function(program,error){error?callback(null,error):callback(program)},null)},ProgramService.prototype.getPreviousProgram=function(callback){if(!this.currentProgram&&callback)return void callback(null,{message:"getPreviousProgram No Current Program"});var dateTime=new Date(this.currentProgram.startTime);dateTime.setSeconds(dateTime.getSeconds()-15),this.exposure.getProgramInfo(this.currentProgram.channelId,dateTime,function(program,error){error?callback(null,error):callback(program)},null)},ProgramService.prototype.getProgram=function(dateTime,callback){if(!this.currentProgram&&callback)return void callback(null,{message:"getProgram No Current Program"});this.exposure.getProgramInfo(this.currentProgram.channelId,dateTime,function(program,error){error?callback(null,error):callback(program)},null)},ProgramService.prototype.verifyEntitlement=function(){var _this7=this;this.currentProgram&&this.exposure.verifyEntitlement(this.currentProgram.assetId,this.entitlement().playRequest,function(data,error){return error?(_this7.player.error("verifyEntitlement "+error.message),void extplayer.stop(_this7.player)):data&&"SUCCESS"===data.status?void log$1("verifyEntitlement",data.status):(_this7.player.error(data?data.status:"verifyEntitlement no status"),void extplayer.stop(_this7.player))})},ProgramService.prototype.getAssetMetadata=function(assetId,callback){var _this8=this,asset=this.currentProgram?this.currentProgram.asset:this.currentVOD;asset&&asset.assetId==assetId?callback(this.extractAssetMetadata(asset)):this.exposure.getAssetMetadata_(assetId,function(asset,error){return error?(log$1.warn("getAssetMetadata","No data found.",error),void callback(null,error)):void callback(_this8.extractAssetMetadata(asset))})},ProgramService.prototype.extractAssetMetadata=function(asset){var title=null,subtitle=null,images=null
;return asset&&asset.localized&&asset.localized.length>0&&(asset.localized[0].title&&(title=asset.localized[0].title),asset.localized[0].shortDescription&&(subtitle=asset.localized[0].shortDescription),asset.localized[0].images&&asset.localized[0].images.length>0&&asset.localized[0].images[0].url&&(images=asset.localized[0].images)),{title:title||"",subtitle:subtitle||"",images:images||[]}},createClass(ProgramService,[{key:"exposure",get:function(){if(!this.options_.exposure){var exposureServiceName=this.player.options_["entitlement-engine"];exposureServiceName||(exposureServiceName=this.player.options_["exposure-service"]?this.player.options_["exposure-service"]:"EricssonExposure");var entitlementOptions=this.player.options_[exposureServiceName.toLowerCase()];if(!entitlementOptions)return null;var Exposure=EntitlementEngine.getEntitlementEngine(exposureServiceName);this.options_.exposure=new Exposure(entitlementOptions)}return this.options_.exposure}},{key:"currentProgram",get:function(){if(extplayer.supportsEpgProgramChange(this.player)){return extplayer.program(this.player)}return this.currentProgram_}},{key:"currentChannelAsset",get:function(){return this.currentChannelAsset_}},{key:"currentVOD",get:function(){return this.currentVOD_}}]),ProgramService}(Plugin$1);ProgramService.VERSION="2.1.97-259",videojs.getPlugin("programService")?videojs.log.warn('A plugin named "programService" already exists.'):videojs.registerPlugin("programService",ProgramService);var Plugin$2=videojs.getPlugin("plugin"),EntitlementExpirationService=function(_Plugin){function EntitlementExpirationService(player,options){classCallCheck(this,EntitlementExpirationService);var _this=possibleConstructorReturn(this,_Plugin.call(this,player,options));return log$1("EntitlementExpirationService","create"),_this.options_=options,_this.onEntitlementChangeBind=_this.onEntitlementChange.bind(_this),_this}return inherits(EntitlementExpirationService,_Plugin),EntitlementExpirationService.prototype.dispose=function(){log$1("EntitlementExpirationService","dispose"),this.stop(),_Plugin.prototype.dispose.call(this)},EntitlementExpirationService.prototype.stop=function(){log$1("EntitlementExpirationService","stop"),this.player.off(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null)},EntitlementExpirationService.prototype.start=function(){log$1("EntitlementExpirationService","start"),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.player.off(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind),this.player.on(empPlayerEvents.ENTITLEMENT_CHANGE,this.onEntitlementChangeBind)},EntitlementExpirationService.prototype.entitlement=function(value){return void 0===value?this.entitlement_:(this.entitlement_=value,value)},EntitlementExpirationService.prototype.onEntitlementChange=function(event,data){this.entitlement(data&&data.entitlement),this.expirationTimeout_&&(clearTimeout(this.expirationTimeout_),this.expirationTimeout_=null),this.checkForExpiration()},EntitlementExpirationService.prototype.options=function(obj){if(!obj)return this.options_;this.options_=obj},EntitlementExpirationService.prototype.checkForExpiration=function(){var _this2=this,entitlement=this.entitlement();if(log$1("EntitlementExpirationService","checkForExpiration",entitlement.licenseExpiration),this.hasLicenseExpiration(entitlement)){var timediff=entitlement.licenseExpiration.getTime()-this.exposure.getCachedServerTime();if(timediff<=0)return this.player.error(this.errorForReason(entitlement.licenseExpirationReason)),void extplayer.stop(this.player);timediff<2147483647?this.expirationTimeout_=setTimeout(function(){_this2.expirationTimeout_=null,log$1("EntitlementExpirationService","license expired"),_this2.refreshEntitlement()},timediff):setTimeout(function(){return _this2.checkForExpiration()},1073741823)}},EntitlementExpirationService.prototype.refreshEntitlement=function(){extplayer.restart(this.player,!0)},EntitlementExpirationService.prototype.errorForReason=function(reason){switch(reason){case"GEO_BLOCKED":return this.player.localize("Not allowed from this region.");case"NOT_ENTITLED":return this.player.localize("The user is not entitled.");case"GAP_IN_EPG":return this.player.localize("Asset temporarily not available");case"EPG_PLAY_MAX_HOURS":default:return this.player.localize("Asset exceeded maximum playback time")}},EntitlementExpirationService.prototype.hasLicenseExpiration=function(entitlement){return!!entitlement.licenseExpiration},createClass(EntitlementExpirationService,[{key:"exposure",get:function(){return this.options_&&this.options_.exposure}}]),EntitlementExpirationService}(Plugin$2);EntitlementExpirationService.VERSION="2.1.97-259",videojs.getPlugin("entitlementExpirationService")?videojs.log.warn('A plugin named "entitlementExpirationService" already exists.'):videojs.registerPlugin("entitlementExpirationService",EntitlementExpirationService);var Tech$1=videojs$1.getComponent("Tech"),EntitlementMiddleware$1=function EntitlementMiddleware(player){return{setSource:function(srcObj,next){function startProgramService_(player,options,exposure,srcEntitlement,callback){player.options_.absoluteStartTime&&player.options_.absoluteStartTime>exposure.getCachedServerTime()?player.options_.absoluteStartTime=exposure.getCachedServerTime()-1e4:player.options_.startTime&&player.options_.startTime>exposure.getCachedServerTime()/1e3&&(player.options_.startTime=(exposure.getCachedServerTime()-1e4)/1e3);if(player.programService&&(!options.programService||!options.programService.disable)){if(player.programService().options({exposure:exposure}),srcEntitlement.isDynamicCachupAsLive&&options.playFrom)if("beginning"===options.playFrom||!srcEntitlement.live&&!player.options_.absoluteStartTime&&!player.options_.startTime){var startTime=srcEntitlement.streamInfo.start.getTime()+100;"application/dash+xml"===srcEntitlement.mimeType?(log$1("SET startTime",startTime),player.options({startTime:startTime/1e3}),srcEntitlement.options.startTime=startTime/1e3):(log$1("SET startTime",.1),player.options({startTime:.1}),srcEntitlement.options.startTime=.1)}else if(player.options_.absoluteStartTime){player.options_.absoluteStartTime<srcEntitlement.streamInfo.start.getTime()&&(player.options_.absoluteStartTime=srcEntitlement.streamInfo.start.getTime());var _startTime=player.options_.absoluteStartTime;"HLS"===player.streamType&&(_startTime=player.options_.absoluteStartTime-srcEntitlement.streamInfo.start.getTime()),_startTime=_startTime||.1,log$1("absoluteStartTime SET startTime",_startTime),player.options({startTime:_startTime/1e3}),srcEntitlement.options.startTime=_startTime/1e3,player.options_.absoluteStartTime=void 0,srcEntitlement.options.absoluteStartTime=void 0}else player.options_.startTime&&(srcEntitlement.options.startTime=player.options_.startTime,player.options_.absoluteStartTime=void 0,srcEntitlement.options.absoluteStartTime=void 0);else if(srcEntitlement.isStaticCachupAsLive&&player.options_.absoluteStartTime){player.options_.absoluteStartTime<srcEntitlement.streamInfo.start.getTime()&&(player.options_.absoluteStartTime=srcEntitlement.streamInfo.start.getTime());var _startTime2=player.options_.absoluteStartTime-srcEntitlement.streamInfo.start.getTime();log$1("absoluteStartTime SET startTime",_startTime2),player.options({startTime:_startTime2/1e3}),srcEntitlement.options.startTime=_startTime2/1e3,player.options_.absoluteStartTime=void 0,srcEntitlement.options.absoluteStartTime=void 0}else srcEntitlement.isStaticCachupAsLive&&player.options_.startTime&&(srcEntitlement.options.startTime=player.options_.startTime,player.options_.absoluteStartTime=void 0,srcEntitlement.options.absoluteStartTime=void 0);player.programService().start()}callback()}function setupEntitlement(entitlement,tech){if(!entitlement)return void log$1.error("setupEntitlement no entitlement");!0===options.useLastViewedOffset&&((entitlement.isStaticCachupAsLive||entitlement.isDynamicCachupAsLive||entitlement.live)&&(entitlement.lastViewedTime||entitlement.liveTime)?entitlement.liveTime&&(log$1("liveTime",new Date(entitlement.liveTime),entitlement.liveTime),player.options({absoluteStartTime:entitlement.liveTime})):entitlement.lastViewedOffset&&(log$1("lastViewedOffset",entitlement.lastViewedOffset/1e3),"DASH"!==player.streamType&&player.options({startTime:entitlement.lastViewedOffset/1e3}))),!1===entitlement.timeshiftEnabled&&player.options({timeShiftDisabled:!0}),player.trigger(empPlayerEvents.ENTITLEMENT_CHANGE,{entitlement:entitlement}),entitlement=assign(new Entitlement({}),entitlement),entitlement.type=entitlement.mimeType;var playOptions={autoplay:player.options_.autoplay,muted:player.options_.muted,language:player.options_.language,maxBitrate:player.options_.maxBitrate,timeShiftDisabled:player.options_.timeShiftDisabled,useLastViewedOffset:player.options_.useLastViewedOffset,startTime:player.options_.startTime,absoluteStartTime:player.options_.absoluteStartTime,audioLanguage:player.options_.audioLanguage,subtitleLanguage:player.options_.subtitleLanguage,liveDelay:player.options_.liveDelay};return entitlement.options=playOptions,entitlement.options.source=entitlement,player.entitlementExpirationService().start(),entitlement}var options=player.options(),srcEntitlement=null,preEntitlement=null,entitlementRequest=null;if(player.programService&&player.programService().stop(),function(entitlement){return entitlement&&entitlement.playSessionId&&entitlement.playToken&&entitlement.mediaLocator}(player.currentSource()))srcEntitlement=player.currentSource();else{var asset=parseSrc(srcObj.src);entitlementRequest=new EntitlementRequest(asset),player.trigger(empPlayerEvents.ENTITLEMENT_LOAD_START,entitlementRequest)}var exposureServiceName=options["entitlement-engine"];exposureServiceName||(exposureServiceName=options["exposure-service"]?options["exposure-service"]:"EricssonExposure");var entitlementOptions=options[exposureServiceName.toLowerCase()];if(!entitlementOptions){var error=new EmpPlayerError("Missing entitlementOptions in player options",EmpPlayerErrorCodes.ENTITLEMENT);return player.error(error),void next(error)}var exposure=EntitlementMiddleware.getExposure(entitlementOptions,exposureServiceName);if(!entitlementOptions.sessionToken)return void exposure.login("","",function(response){if(response.success)entitlementOptions.sessionToken=response.session.sessionToken,player.trigger(empPlayerEvents.REPLAY);else{log$1.error("Anonymous login fail",response.message);var error=new EmpPlayerError("Anonymous login fail",EmpPlayerErrorCodes.ENTITLEMENT);player.error(error)}},"");options.analytics&&options.analytics.disable||function(player,options,entitlementOptions,exposure){var analyticsDeviceInfo=options.analyticsDeviceInfo;analyticsDeviceInfo&&(log$1.warn("options.analyticsDeviceInfo is deprecated. Use options.analytics.deviceInfo."),options.analytics||(options.analytics={}),options.analytics.deviceInfo=analyticsDeviceInfo),player.analytics&&(player.analytics().options({exposure:exposure,analytics:options.analytics}),player.analytics().newAnalytics({exposureApiURL:entitlementOptions.exposureApiURL,customer:entitlementOptions.customer,businessUnit:entitlementOptions.businessUnit,sessionToken:entitlementOptions.sessionToken}),player.analytics().onEntitlementLoadStart())}(player,options,entitlementOptions,exposure),player.entitlementExpirationService().options({exposure:exposure});var techs=options.techOrder.map(function(techName){return techName.charAt(0).toUpperCase()+techName.slice(1)}).map(function(techName){return[techName,Tech$1.getTech(techName)]}).filter(function(_ref){var techName=_ref[0],tech=_ref[1];if(tech&&"Html5"!==techName&&"EmpCast"!==techName)return tech.isSupported()});if(0===techs.length){var _error=new EmpPlayerError("Unable to load asset: None of the playback technologies are supported",EmpPlayerErrorCodes.ENTITLEMENT);return player.error(_error),void next(_error)}var entitlementRequestError;asyncLoop(techs.length,function(loop){var i=loop.iteration();if(options.excludeTechs&&-1!==options.excludeTechs.indexOf(techs[i][0]))return void loop.next();var tech=techs[i][1];player.tech_&&player.techName_!==techs[i][0]&&(player.techCall_("reset"),player.unloadTech_());try{if(srcEntitlement)return srcEntitlement=setupEntitlement(srcEntitlement,tech),startProgramService_(player,options,exposure,srcEntitlement,function(){next(null,srcEntitlement)}),void loop.break();var techOptions=options[techs[i][0].toLowerCase()],playRequest=techOptions&&techOptions.streamType&&tech.entitlementPlayRequests?tech.entitlementPlayRequests[techOptions.streamType]:tech.entitlementPlayRequest;exposure.getEntitlement(entitlementRequest,playRequest,function(entitlement,error){if(error){if(player.options_.excludeTechs||(player.options_.excludeTechs=[]),player.options_.excludeTechs.push(techs[i][0]),entitlementRequestError=new EmpPlayerError(error.message+"  "+JSON.stringify(playRequest)+JSON.stringify(entitlementRequest),error.code,error.stack),error.fatal)return player.error(entitlementRequestError),extplayer.stop(player),void next(entitlementRequestError);preEntitlement=entitlement,loop.next()}else srcEntitlement=setupEntitlement(entitlement,tech),extplayer.currentAsset(player,entitlement.assetId,entitlement.programId,entitlement.channelId),srcEntitlement.adMediaLocator&&player.yospace?(log$1("play adMediaLocator with yospace",srcEntitlement.adMediaLocator),player.yospace().start("VoD",srcEntitlement.adMediaLocator).then(function(mediaLocator){log$1("yospace mediaLocator returned",mediaLocator),srcEntitlement.mediaLocator=mediaLocator,srcEntitlement.src=mediaLocator,startProgramService_(player,options,exposure,srcEntitlement,function(){next(null,srcEntitlement)}),loop.break()}).catch(function(errMsg){entitlementRequestError=new EmpPlayerError(errMsg,EmpPlayerErrorCodes.ENTITLEMENT),player.error(entitlementRequestError),extplayer.stop(player)})):(startProgramService_(player,options,exposure,srcEntitlement,function(){next(null,srcEntitlement)}),loop.break())})}catch(error){return log$1.warn("error try next tech",new EmpPlayerError(error,EmpPlayerErrorCodes.ENTITLEMENT)),void loop.next()}},function(){if(null===srcEntitlement)return entitlementRequestError||(entitlementRequestError=new EmpPlayerError("Unable to load asset: None of the playback technologies are supported",EmpPlayerErrorCodes.ENTITLEMENT)),player.error(entitlementRequestError),extplayer.stop(player),void next(entitlementRequestError)})}}};EntitlementMiddleware$1.isExposure=function(object){return EntitlementEngine.isEntitlementEngine(object)},EntitlementMiddleware$1.EntitlementClass=Entitlement,EntitlementMiddleware$1.getExposure=function(options,name){if(options){return new(EntitlementEngine.getEntitlementEngine(name))(options)}throw new EmpPlayerError("Missing exposureOptions",EmpPlayerErrorCodes.ENTITLEMENT)},EntitlementMiddleware$1.registerExposure=function(name,entitlementEngine){return EntitlementEngine.registerEntitlementEngine(name,entitlementEngine)},EntitlementMiddleware$1.getLog=function(){return log$1},EntitlementMiddleware$1.getEntitlementEngine=EntitlementEngine.getEntitlementEngine,EntitlementMiddleware$1.registerEntitlementEngine=EntitlementEngine.registerEntitlementEngine,EntitlementMiddleware$1.isEntitlementEngine=EntitlementEngine.isEntitlementEngine,EntitlementMiddleware$1.VERSION="2.1.97-259",videojs$1.EntitlementMiddleware?videojs$1.log.warn("EntitlementMiddleware already exists."):(videojs$1.use("video/emp",EntitlementMiddleware$1),videojs$1.EntitlementMiddleware=EntitlementMiddleware$1);var EntitlementMiddleware=window.empEntitlement?window.empEntitlement:EntitlementMiddleware$1,empPlayer=videojs$1;return empPlayer.canPlayUnencrypted=canPlayUnencrypted,empPlayer.canPlayEncrypted=canPlayEncrypted,empPlayer.getExposure=EntitlementMiddleware.getExposure,empPlayer.getEntitlementEngine=EntitlementMiddleware.getEntitlementEngine,empPlayer.registerEntitlementEngine=EntitlementMiddleware.registerEntitlementEngine,empPlayer.isEntitlementEngine=EntitlementMiddleware.isEntitlementEngine,empPlayer.EntitlementClass=EntitlementMiddleware.EntitlementClass,empPlayer.log=log$1,empPlayer.plugin=videojs$1.plugin,empPlayer.videojs=videojs$1,empPlayer.EntitlementMiddleware=EntitlementMiddleware,empPlayer.extend=videojs$1.extend,empPlayer.Events=empPlayerEvents,empPlayer.VERSION="2.1.97-259","function"==typeof define&&define.amd?define("empPlayer",[],function(){return empPlayer}):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))&&(module.exports=empPlayer),empPlayer});
